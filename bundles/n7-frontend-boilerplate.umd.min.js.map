{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://@n7-frontend/boilerplate/lib/common/services/configuration.service.ts","ng://@n7-frontend/boilerplate/lib/common/services/layouts-configuration.service.ts","ng://@n7-frontend/boilerplate/lib/common/services/main-state.service.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication-providers/apollo/config.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication-providers/apollo/apollo.provider.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication-providers/rest/config.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication-providers/rest/rest.provider.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication.service.ts","ng://@n7-frontend/boilerplate/lib/common/models/abstract-layout.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/main-layout/main-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/common/services/json-config.service.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input-checkbox.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input-text.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input-link.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input-select.ts","ng://@n7-frontend/boilerplate/lib/common/services/search.service.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/main-layout/main-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/header.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/subnav.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/breadcrumbs.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/facets.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/facets-wrapper.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/footer.ds.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/header.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/subnav.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/breadcrumbs.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/facets.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/facets-wrapper.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/footer.eh.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/main-layout/main-layout.config.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/main-layout/main-layout.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/page404-layout/page404-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/page404-layout/page404-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/page404-layout/page404-layout.config.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/page404-layout/page404-layout.ts","ng://@n7-frontend/boilerplate/lib/common/components/facets-wrapper/facets-wrapper.ts","ng://@n7-frontend/boilerplate/lib/common/n7-boilerplate-common.module.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/entita-layout/entita-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/entita-layout/entita-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/common/helpers.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/linked-objects.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/autocomplete-wrapper.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/bubble-chart.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/hero.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/table.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/home-hero-patrimonio.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/home-facets-wrapper.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/home-item-tags-wrapper.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/home-autocomplete.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/entita-nav.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/entita-metadata-viewer.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/tree.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/sidebar-header.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/scheda-breadcrumbs.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/scheda-metadata.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/scheda-image.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/scheda-inner-title.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/search-layout-tabs.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/linked-objects.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/autocomplete-wrapper.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/bubble-chart.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/hero.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/home-facets-wrapper.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/home-hero-patrimonio.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/home-item-tags-wrapper.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/home-autocomplete.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/entita-nav.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/scheda-breadcrumbs.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/sidebar-header.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/tree.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/search-layout-tabs.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/table.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/entita-layout/entita-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/entita-layout/entita-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/home-layout/home-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/home-layout/home-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/home-layout/home-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/home-layout/home-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/scheda-layout/scheda-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/scheda-layout/scheda-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/scheda-layout/scheda-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/scheda-layout/scheda-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-facets.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/components/bubble-chart-wrapper/bubble-chart-wrapper.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/components/smart-breadcrumbs/smart-breadcrumbs.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/n7-boilerplate-arianna-web.module.ts","ng://@n7-frontend/boilerplate/lib/data-viz/components/data-widget-wrapper/data-widget-wrapper.ts","ng://@n7-frontend/boilerplate/lib/data-viz/layout/example-layout/example-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/data-viz/layout/example-layout/example-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/data-viz/data-sources/data-widget-wrapper.ds.ts","ng://@n7-frontend/boilerplate/lib/data-viz/data-sources/graph.ds.ts","ng://@n7-frontend/boilerplate/lib/data-viz/data-sources/inner-title.ds.ts","ng://@n7-frontend/boilerplate/lib/data-viz/data-sources/widget.ds.ts","ng://@n7-frontend/boilerplate/lib/data-viz/event-handlers/data-widget-wrapper.eh.ts","ng://@n7-frontend/boilerplate/lib/data-viz/layout/example-layout/example-layout.config.ts","ng://@n7-frontend/boilerplate/lib/data-viz/layout/example-layout/example-layout.ts","ng://@n7-frontend/boilerplate/lib/data-viz/n7-boilerplate-data-viz.module.ts","ng://@n7-frontend/boilerplate/lib/n7-boilerplate-lib.module.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__values","o","m","Symbol","iterator","next","value","done","__read","r","e","ar","push","error","ConfigurationService","config","_this","defaults","get","key","set","global","keys","forEach","Injectable","args","providedIn","Inject","LayoutsConfigurationService","layouts","MainStateService","custom","default","headTitle","ReplaySubject","pageTitle","subnav","breadcrumbs","filters","get$","_get","getCustom$","update","newValue","_update","updateCustom","has","hasCustom","addCustom","stream$","Error","type","ApolloProviderConfig","getLastPosts","queryName","queryBody","getTree","globalFilter","getEntityDetails","getItem","getNode","autoComplete","search","getMissingBubble","ApolloProvider","http","providerConfig","providers","apollo","err","request$","requestId","options","params","method","httpOptions","query","paramsStr","makeParamsStr","replace","baseUrl","post","pipe","map","response","data","isArray","arrStr_1","val","subParamsStr","join","indexOf","HttpClient","RestProviderConfig","RestProvider","rest","_a","urlParams","point","defaultMethod","toLowerCase","CommunicationService","communicationConfig","defaultProvider","provider","onError","catchError","handleError","console","warn","empty","AbstractLayout","widgets","lb","LayoutBuilder","layoutId","initPayload","onInit","ready$","subscribe","eventHandler","emitInner","init","widgetsConfig","widgetsDataSources","widgetsEventHandlers","dataSource","layoutDS","layoutEH","onDestroy","MainLayoutDS","tslib_1.__extends","configuration","mainState","router","titleService","route","Subject","one","items","setTitle","selected","onNavigate","payload","handler","path","queryParams","navigate","relativeTo","queryParamsHandling","_onRouterNavigate","hideAll","LayoutDataSource","JsonConfigService","load","of","tap","_handleResponse","toPromise","headTag","document","querySelector","styleElement","createElement","styles_1","configKey","color","hex","unshift","appendChild","createTextNode","FacetInput","isEmpty","output","transform","getId","id","getData","getConfig","getFacetId","facetId","getInputIndex","inputIndex","getSectionIndex","sectionIndex","getContext","filterConfig","context","getTarget","target","getSearchIn","searchIn","getType","getOutput","setIsEmpty","setData","newData","_setId","index","clear","FacetInputCheckbox","label","source","_meta","setActive","facetValue","checked","FacetInputText","disabled","placeholder","icon","inputPayload","trigger","enterPayload","iconPayload","FacetInputLink","_super","results","resultsCounter","_b","tslib_1.__values","_c","itemData","counter","hidden","classes","_isActive","text","itemEmpty","filter","item","emptyState","isActive","split","className","FacetInputSelect","option","INPUTS_MAP","checkbox","link","select","FILTERS_MAP","=",">","<",">=","<=","<>","LIKE","SearchModel","_filters","_facets","_inputs","_results$","_id","getFilters","getFacets","getInputs","_config","getTotalCount","_totalCount","getFields","fields","getResults$","setResults","_setFilters","_setFacets","_setPage","_setInputs","_setInputsData","_setTotalCount","SearchService","updateFiltersFromQueryParams","updateFilter","remove","getFiltersByFacetId","_clearInputs","clearAll","selectedFilters","getInputByFacetId","updateInputsFromFilters","updateFacets","facets","updateFacet","updateTotalCount","totalCount","selectedFacets","facet","reset","getRequestParams","_getRequestFacets","page","_page","getInternalFilters","filtersAsQueryParams","input","setInputData","filterTarget","inputs","targetInput","facetData","f","searchIns","_filterData","setSearchConfigOrderBy","orderBy","order","setSearchConfigDirection","direction","setPageConfigOffset","offset","setPageConfigLimit","limit","operator","refValue","searchData","searchDataKey_1","dataKey","dataValue","_filterDataEquals","inArray_1","rv","_filterDataGreaterThan","_filterDataLessThan","_filterDataGreaterOrEquals","_filterDataLessOrEquals","_filterDataNotEqual","_filterDataLike","haystack","needle","toLocaleLowerCase","field","sectionConfig","inputConfig","inputModel","facetConfig","hasStaticData","dataItem","_models","add","model","MainLayoutEH","destroyed$","listen","innerEvents$","_listenRouterChanges","EventHandler","globalEvents$","takeUntil","emitGlobal","HeaderDS","selectNavItem","selectedItem","nav","DataSource","SubnavDS","getActive","BreadcrumbsDS","FacetsDS","searchModel","FacetsWrapperDS","groups","fieldConfig","fieldIndex","groupId","header","_headerConfig","sections","_getSectionClasses","isOpen","toggleGroup","eventPayload","group","iconRight","onFacetChange","filterValue","updateFilteredTarget","section","inputOutput","updateInputLinks","linksFacetIds","FooterDS","HeaderEH","SubnavEH","BreadcrumbsEH","FacetsEH","FacetsWrapperEH","_facetsChanged","internalFacetsChange$","externalFacetsChange$","outerEvents$","debounceTime","requestParams","emitOuter","FooterEH","MainLayoutConfig","DS","EH","MainLayoutComponent","layoutsConfiguration","ngOnInit","ngOnDestroy","Component","selector","template","Router","ActivatedRoute","Title","Page404LayoutDS","Page404LayoutEH","Page404LayoutConfig","Page404LayoutComponent","FacetsWrapperComponent","headerEmit","eventType","emit","facetEmit","Input","COMPONENTS","N7BoilerplateCommonModule","forRoot","ngModule","provide","useValue","NgModule","declarations","imports","CommonModule","HttpClientModule","DvComponentsLibModule","exports","AwEntitaLayoutDS","showFields","myResponse","navHeader","pageSize","bubblesSize","updateComponent","updateOptions","handlePageNavigation","selectedTab","currentPage","pagination","size","relatedItems","location","go","entitaBasePath","currentId","handleNavUpdate","tab","updateWidgets","setTimeout","updateBubbes","relatedEntities","communication","snapshot","bubblesEnabled","simple","bubbleLimit","smallChartSize","overview","getNavigation","entityId","entitiesListSize","labels","loadItem","loadContent","res","campi","includes","typeOfEntity","AwEntitaLayoutEH","listenRoute","log","paths","undefined","schedaBasePath","forceReload","paramMap","entities","entity","helpers","prettifySnakeCase","word","ucFirst","str","charAt","toUpperCase","slice","AwLinkedObjectsDS","loadingData","checkForMore","force","loadedData","actions","result","totalObjects","handleIncomingData","incomingData","unpackData","itemsPagination","concat","isLoading","addPagination","totalPages","first","prev","last","links","makePagination","paginationLimit","lastPage","firstPage","Math","floor","String","lengthLimit","resultsLimit","dynamicPagination","enabledKeys","metadata","info","selection","el","infoData","infoDataItems","toeData","toe","relatedTypesOfEntity","image","title","maxLength","count","crumb","fallback","previews","total","ceil","loaderData","AwAutocompleteWrapperDS","regex","RegExp","suggestion","match","prefix","suffix","exec","AwBubbleChartDS","chartData","draw","closedEyes","tippyList","updateChart","smartSlice","smallView","l","handleBubbleClick","splice","tippyMaker","bubbles","destroy","buildTooltip","bubble","element","getElementsByClassName","cloneNode","innerHTML","selectButton","toggleBubbleText","getElementById","parentElement","tippy","content","interactive","appendTo","body","arrow","flip","theme","placement","delay","updateDuration","onMount","focusedBubble","fontRendering","transition","shuffle","domain","range","colorConfig","k","commonParams","containerId","setDraw","colorMatch","sizeRange","height","width","AwHeroDS","currentInputValue","button","backgroundImage","AwTableDS","TABLE_MOCK","AwHomeHeroPatrimonioDS","AwHomeFacetsWrapperDS","lockedFacets","lastData","openTippy","open","ac_1","contentNode","setAttribute","maxWidth","ac","show","hide","headers","j","lastFacet","find","enabled","locked","headerClasses","iconClasses","iconLeft","additionalText","widgetData","h","AwHomeItemTagsWrapperDS","AwHomeAutocompleteDS","itemIds","groupConfig","mainMetadata","currentItem","metadata_1","showMore","AwEntitaNavDS","param","navigation","extraTab","wikiTab","AwEntitaMetadataViewerDS","unpackedData","configuredKeys_1","filteredData","unpackFields","extracted","thisField","temp","AwTreeDS","_getCachedData","dataCache","rootId","_normalize","img","branches","hasBranches","flatData","flatIds","_getParent","_getTreePath","ids","parentId","reverse","_getTree","tree","loadItems","nextParent","childId","inPath","_getTreeItem","defaultIcon","activeId","toggle","meta","build","oldPathIndex","idIndex","highlightActive","control","currentClasses","founded","AwSidebarHeaderDS","toggleSidebar","sidebarData","AwSchedaBreadcrumbsDS","AwSchedaMetadataDS","AwSchedaImageDS","AwSchedaInnerTitleDS","AwSearchLayoutTabsDS","setSelected","tabId","AwLinkedObjectsEH","handleScroll","scrollTop","clientHeight","scrollHeight","startsWith","targetPage","AwAutocompleteWrapperEH","AwBubbleChartEH","toggleSelection","toggleFilter","AwHeroEH","AwHomeFacetsWrapperEH","changedInput$","handleEyeClick","updateFilters","selectedBubble","AwHomeHeroPatrimonioEH","AwHomeItemTagsWrapperEH","event","AwHomeAutocompleteEH","AwEntitaNavEH","AwSchedaSidebarEH","AwSidebarHeaderEH","AwTreeEH","AwSearchLayoutTabsEH","AwTableEH","AwEntitaLayoutConfig","AwEntitaLayoutComponent","Location","AwHomeLayoutDS","facetInputs","autocompletePopoverOpen","autocompleteChanged$","numOfItemsStr","currentHoverEntity","hasScrollBackground","selectedEntitiesIds","selectedBubbles","homeAutocompleteIsLoading","_listenAutoCompleteChanges","outerLinks","outerLinksTitle","makeRequest$","initialFilterRequest","parseInitialRequest","firstBubbleResponse","entitiesData","typeOfEntityData","TOEconfigData","renderPreviewsFromApolloQuery","numOfItems","numOfThousand","numOfItemsTmpStr","updateTags","onlyBubbles","renderItemTags","handleFacetSearchChange","change","handleFacetSearchEnter","enter","queryList","tagsData","theBubble","forkJoin","forkres","onHeroChange","homeAutocompleteQuery","_toggleAutocompletePopover","_scrollBackgroundControl","source$","fromEvent","_setHasScrollBackground","autocompletePopover","style","display","onHidden","AwHomeLayoutEH","handleSimpleAutocompleteClick","handleChartSelection","lastBubbleResponse","queryList_1","customBubbles","loadFilters","entityLinks","basePath","searchBasePath","entity-links","autocompleteValue","params_1","totalcount","type_1","query_1","outerLinkClick","window","AwHomeLayoutConfig","AwHomeLayoutComponent","AwSchedaLayoutDS","stickyControlTrigger$","contentParts","sidebarIsSticky","treeMaxHeight","sidebarCollapsed","bubbleChartSectionTitle","similarItemsSectionTitle","metadataSectionTitle","hasSimilarItems","_sidebarStickyControl","treeId","setTree","updateNavigation","maxSimilarItems","images_1","url","buildPyramid","imageViewerIstance","viewerId","_setViewer","viewer","titleObj","main","tools","subTitle","hasMetadata","breadcrumbs_1","breadcrumb","collapseSidebar","merge","windowTop","pageYOffset","windowBottom","scrollY","innerHeight","wrapper","wrapperTop","wrapperBottom","AwSchedaLayoutEH","paramId","loadNavigation","hasBubbles","AwPatrimonioLayoutConfig","AwSchedaLayoutComponent","facetsConfig","minChars","highlight","SEARCH_MODEL_ID","AwSearchLayoutDS","resetButtonEnabled","isFirstLoading","orderByLabel","orderByOptions","getSearchModelId","prettifyLabels","configKeys","cloneDeep","onSearchResponse","onOrderByChange","onPaginationChange","_updateSearchPage","onPaginationGoToChange","resetPagination","onResultsLimitChange","doSearchRequest$","requestPayload","searchParameters","resultsTitleIndex","resultsTitle","_addFacetsLabels","_addFacetsOptions","_normalizeItems","newOffset","singleItem","windowOffsetTop","wrapperOffsetTop","AwSearchLayoutEH","facetsChange$","_listenToFacetsChange","_listenToRouterChanges","changed","AwSearchLayoutConfig","AwSearchLayoutComponent","BubbleChartWrapperComponent","onClick","SmartBreadcrumbsComponent","ngAfterViewInit","parentWidth","bcdiv","nativeElement","clientWidth","childWidth","bcol","liArray","children","tippyData","innerText","tippyBuilder","node","ViewChild","read","ElementRef","static","N7BoilerplateAriannaWebModule","DataWidgetWrapperComponent","DvExampleLayoutDS","DvExampleLayoutEH","DvDataWidgetDS","DvGraphDS","libOptions","chart","toolbar","dataLabels","colors","fill","gradient","opacityFrom","opacityTo","stroke","curve","series","name","grid","borderColor","strokeDashArray","xaxis","lines","markers","hover","axisBorder","tickAmount","yaxis","showAlways","opposite","reversed","logarithmic","forceNiceScale","floating","minWidth","offsetX","offsetY","rotate","padding","fontSize","cssClass","axisTicks","tooltip","crosshairs","position","dashArray","legend","annotations","points","DvInnerTitleDS","secondary","DvWidgetDS","DATA_WIDGET_MOCK","DvDataWidgetEH","DvExampleLayoutConfig","DvExampleLayoutComponent","N7BoilerplateDataVizModule","N7BoilerplateLibModule"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { Injectable, Inject } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ConfigurationService {\n  private defaults: any = {};\n\n  constructor(@Inject('config') private config: any){\n    if(this.config.global){\n      Object.keys(this.config.global).forEach(key => {\n        this.set(key, this.config.global[key]);\n      });\n    }\n  }\n\n  public get = (key) => this.defaults[key];\n  public set = (key, value) => this.defaults[key] = value;\n}","import { Injectable, Inject } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LayoutsConfigurationService {\n  private defaults: any = {};\n\n  constructor(@Inject('config') private config: any){\n    if(this.config.layouts){\n      Object.keys(this.config.layouts).forEach(key => {\n        this.set(key, this.config.layouts[key]);\n      });\n    }\n  }\n\n  public get = (key) => this.defaults[key];\n  public set = (key, value) => this.defaults[key] = value;\n}","import { Injectable } from '@angular/core';\nimport { ReplaySubject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MainStateService {\n  // custom streams\n  private custom: any = {};\n  \n  // default streams\n  private default: {\n    headTitle: ReplaySubject<any>,\n    pageTitle: ReplaySubject<any>,\n    subnav: ReplaySubject<any>,\n    breadcrumbs: ReplaySubject<any>,\n    filters: ReplaySubject<any>,\n  } = {\n    headTitle: new ReplaySubject(),\n    pageTitle: new ReplaySubject(),\n    subnav: new ReplaySubject(),\n    breadcrumbs: new ReplaySubject(),\n    filters: new ReplaySubject(),\n  };\n\n  public get$ = (key: string) => this._get('default', key);\n  public getCustom$ = (key: string) => this._get('custom', key);\n\n  public update = (key: string, newValue: any) => this._update('default', key, newValue);\n  public updateCustom = (key: string, newValue: any) => this._update('custom', key, newValue);\n\n  public has = (key: string) => !!this.default[key];\n  public hasCustom = (key: string) => !!this.custom[key];\n\n  public addCustom(key: string, stream$: ReplaySubject<any>){\n    if(this.custom[key]) throw Error(`custom stream ${key} exists!`);\n\n    this.custom[key] = stream$;\n  }\n\n  private _update(type: string, key: string, newValue: any){\n    if(!this[type]) throw Error(`${type} stream group does not exists!`);\n    if(!this[type][key]) throw Error(`${type} stream ${key} does not exists!`);\n    \n    this[type][key].next(newValue);\n  }\n\n  private _get(type: string, key: string){\n    if(!this[type]) throw Error(`${type} stream group does not exists!`);\n    if(!this[type][key]) throw Error(`${type} stream ${key} does not exists!`);\n    \n    return this[type][key];\n  }\n\n}","export const ApolloProviderConfig = {\n  'getLastPosts': {\n    queryName: 'getLastPosts',\n    queryBody: `\n      {\n        getLastPosts(__PARAMS__) {\n          id\n          title\n        }\n      }\n    `\n  },\n  'getTree': {\n    queryName: 'getTreeOfItems',\n    queryBody: `\n    {\n      getTreeOfItems{\n        id\n        label\n        icon\n        branches {\n          label\n          id\n          img\n          branches {\n            label\n            id\n            icon\n            img\n            branches {\n              label\n              id\n              icon\n              img\n              branches {\n                label\n                id\n                icon\n                img\n                branches {\n                  label\n                  id\n                  icon\n                  img\n                  branches {\n                    label\n                    id\n                    icon\n                    img\n                    branches {\n                      label\n                      id\n                      icon\n                      img\n                      branches {\n                        label\n                        id\n                        icon\n                        img\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    `\n  },\n  'globalFilter': {\n    queryName: 'globalFilter',\n    queryBody: `{\n      globalFilter(__PARAMS__){\n        entitiesData {\n          entity {\n              id\n              label\n              typeOfEntity\n          } count\n        }\n        typeOfEntityData {\n          type\n          count\n        }\n        itemsPagination {\n          totalCount\n          items {\n            thumbnail\n            item {\n              id\n              label\n              fields\n              {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n              breadcrumbs {\n                label\n                link\n              }\n            }\n            relatedTypesOfEntity {\n              type\n              count\n            }\n          }\n        }\n      }\n      }`\n  },\n  'getEntityDetails': {\n    queryName: 'getEntity',\n    queryBody: `{\n      getEntity(__PARAMS__){\n        overviewTab\n        label\n        id\n        typeOfEntity\n        fields {\n          ...\n          on KeyValueField {\n            key\n            value\n          }\n          ... on\n          KeyValueFieldGroup {\n            label\n            fields\n            {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n            }\n          }\n        }\n        extraTab\n        wikiTab {\n          text\n          url\n        }\n        relatedItems {\n          thumbnail\n          item {\n            label\n            id\n            fields\n            {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n            }\n            breadcrumbs {\n              label\n              link\n            }\n          }\n          relatedTypesOfEntity {\n            type\n            count\n          }\n        }\n        relatedEntities {\n          entity {\n              id\n              label\n              typeOfEntity\n          }\n          count\n        }\n      }\n    }\n    `\n  },\n  'getItem': {\n    queryName: 'getItem',\n    queryBody: `{\n      getItem(__PARAMS__) {\n        id\n        label\n        icon\n        title\n        subTitle\n        image\n        text\n        fields {\n          ...\n          on KeyValueField {\n            key\n            value\n          }\n          ... on KeyValueFieldGroup {\n            label\n            fields {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n            }\n          }\n          }\n          relatedEntities {\n            count\n            entity{\n              id\n              label\n              typeOfEntity\n            }\n          }\n          relatedItems {\n            thumbnail\n            item {\n              label\n              id\n          }\n          relatedTypesOfEntity {\n            type\n            count\n          }\n        }\n        breadcrumbs {\n          label\n          link\n        }\n      }\n    }`\n  },\n  'getNode': {\n    queryName: 'getNode',\n    queryBody: `{\n      getNode(__PARAMS__) {\n        ... on Item {\n          id\n          label\n          icon\n          title\n          subTitle\n          image\n          text\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on KeyValueFieldGroup {\n              label\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n          relatedEntities {\n              count\n              entity{\n                id\n                label\n                typeOfEntity\n              }\n          }\n          relatedItems {\n              thumbnail\n              item {\n                label\n                id\n            }\n            relatedTypesOfEntity {\n              type\n              count\n            }\n          }\n          breadcrumbs {\n            label\n            link\n          }\n        }\n        ... on Node {\n          id\n          label\n          img\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on KeyValueFieldGroup {\n              label\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n        }\n      }\n    }`\n  },\n  'autoComplete': {\n    queryName: 'autoComplete',\n    queryBody: `{\n      autoComplete(__PARAMS__){\n        totalCount\n        results {\n          ... on EntityCountData {\n            count\n            entity {\n              id\n              label\n              typeOfEntity\n              fields {\n                ... on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ... on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n          ... on ItemListing {\n            item {\n              id\n              label\n              fields {\n                ... on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ... on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }`\n  },\n  'search': {\n    queryName: 'search',\n    queryBody: `{\n      search(__PARAMS__){\n        totalCount\n        facets {\n          id\n          type\n          operator\n          limit\n          order\n          data {\n            label\n            value\n            counter\n            searchData {\n              key\n              value\n            }\n          }\n        }\n        results {\n          order{\n            type\n            key\n            direction\n          }\n          fields\n          {\n            id\n            highlight\n            limit\n          }\n          items {\n            ... on Entity {\n              id\n              label\n              typeOfEntity\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n                ... on\n                KeyValueFieldGroup {\n                  label\n                  fields\n                  {\n                    ...\n                    on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n            ... on Item {\n              id\n              label\n              icon\n              title\n              subTitle\n              image\n              text\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ...\n                    on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }`\n  },\n  'getMissingBubble': {\n    queryName: 'getEntity',\n    queryBody: `{\n      getEntity(__PARAMS__){\n        label\n        id\n        typeOfEntity\n      }\n    }`\n  }\n};\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { ApolloProviderConfig } from './config';\nimport { ConfigurationService } from '../../configuration.service';\nimport { ICommunicationProvider } from '../communication-provider.interface';\nimport { map } from 'rxjs/operators';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ApolloProvider implements ICommunicationProvider {\n  private providerConfig: any;\n\n  constructor(private config: ConfigurationService, private http: HttpClient) {\n    try {\n      this.providerConfig = this.config.get('communication').providers.apollo;\n    } catch (err) {\n      throw Error('No config found for apollo provider!');\n    }\n  }\n\n  request$(requestId, options) {\n    const { params, method, httpOptions } = options;\n    let query = ApolloProviderConfig[requestId];\n\n    if (this.providerConfig.config && this.providerConfig.config[requestId]) {\n      query = this.providerConfig.config[requestId];\n    }\n\n    query = query || {};\n    const { queryName } = query;\n    let { queryBody } = query;\n\n    // config query control\n    if (!queryName || !queryBody) {\n      throw Error(`No config found for requestId '${requestId}'`);\n    }\n\n    if (params) {\n      const paramsStr = this.makeParamsStr(params);\n      queryBody = queryBody.replace('__PARAMS__', paramsStr);\n    } else {\n      queryBody = queryBody.replace('(__PARAMS__)', '');\n    }\n\n    let source$: Observable<any>;\n\n    if (method && method === 'GET') {\n      source$ = this.http.get(this.providerConfig.baseUrl);\n    } else {\n      source$ = this.http.post(\n        this.providerConfig.baseUrl,\n        { query: queryBody },\n        httpOptions\n      );\n    }\n\n    return source$.pipe(map((response: any) => response.data[queryName]));\n  }\n\n  private makeParamsStr(params) {\n    const paramsStr = [];\n    Object.keys(params).forEach(key => {\n      if (Array.isArray(params[key])) {\n        const arrStr = [];\n        params[key].forEach(val => {\n          if (typeof val === 'object') {\n            const subParamsStr = this.makeParamsStr(val);\n            arrStr.push(`{ ${subParamsStr} }`);\n          } else {\n            if (typeof val === 'number' || typeof val === 'boolean' || val === null) {\n              arrStr.push(`${val}`);\n            } else {\n              arrStr.push(`\"${val}\"`);\n            }\n          }\n        });\n        paramsStr.push(`${key}: [${arrStr.join(',')}]`);\n      } else if (typeof params[key] === 'object' && params[key]) {\n        const subParamsStr = this.makeParamsStr(params[key]);\n        paramsStr.push(`${key}: { ${subParamsStr} }`);\n      } else if (typeof params[key] === 'string' && key.indexOf('$') === 0) {\n        paramsStr.push(`${key.replace('$', '')}: ${params[key]}`);\n      } else {\n        if (typeof params[key] === 'number' || typeof params[key] === 'boolean' || params[key] === null) {\n          paramsStr.push(`${key}: ${params[key]}`);\n        } else {\n          paramsStr.push(`${key}: \"${params[key]}\"`);\n        }\n      }\n    });\n    return paramsStr.join(' ');\n  }\n}\n","export const RestProviderConfig = {\n  'getLastPosts': 'posts', \n};","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http'\nimport { RestProviderConfig } from './config';\nimport { ConfigurationService } from '../../configuration.service';\nimport { ICommunicationProvider } from '../communication-provider.interface';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RestProvider implements ICommunicationProvider {\n  private providerConfig: any;\n\n  constructor(\n    private config: ConfigurationService,\n    private http: HttpClient,\n  ) {\n    try {\n      this.providerConfig = this.config.get('communication').providers.rest;\n    } catch (err) {\n      throw Error('No config found for rest provider!');\n    }\n  }\n\n  request$(requestId, options: any = {}) {\n    let { params, method, httpOptions, urlParams = '' } = options;\n    let point = RestProviderConfig[requestId];\n\n    // default method\n    if (!method) { method = this.providerConfig.defaultMethod || 'GET'; }\n\n    if (this.providerConfig.config && this.providerConfig.config[requestId]) {\n      point = this.providerConfig.config[requestId];\n    }\n\n    // config point control\n    if (!point) {\n        throw Error(`No config found for requestId \"${requestId}\"`);\n    }\n    if (method === 'POST' || method === 'PUT') {\n      return this.http[method.toLowerCase()](this.providerConfig.baseUrl + point, params, httpOptions);\n    } else if (method === 'GET' || method === 'DELETE') {\n      return this.http[method.toLowerCase()](this.providerConfig.baseUrl + point + urlParams, httpOptions);\n    } else {\n        throw Error(`Rest method ${method} not supported`);\n    }\n\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ConfigurationService } from './configuration.service';\nimport { ApolloProvider } from './communication-providers/apollo/apollo.provider';\nimport { RestProvider } from './communication-providers/rest/rest.provider';\nimport { catchError } from 'rxjs/operators';\nimport { Observable, empty } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CommunicationService {\n  private defaultProvider: string;\n  private communicationConfig: any;\n\n  constructor(\n    private config: ConfigurationService,\n    private apollo: ApolloProvider,\n    private rest: RestProvider,\n  ){\n    try {\n      this.communicationConfig = this.config.get('communication');\n      this.defaultProvider = this.communicationConfig.defaultProvider;\n    } catch(err) {\n      throw Error('No communications.defaultProvider setted in config');\n    }\n  }\n\n  request$(requestId, options: any = {}, provider?){\n    provider = provider || this.defaultProvider;\n    if(!this[provider]) throw Error(`There is no ${provider} provider`);\n\n    const { onError } = options;\n    return this[provider].request$(requestId, options)\n      .pipe(\n        catchError((error) => this.handleError(error, onError))\n      );\n  }\n\n  handleError(error, onError): Observable<any> {\n    if(onError){\n      onError(error);\n    } else {\n      console.warn('No error handler for communication request', error);\n    }\n\n    return empty();\n  }\n}","import { LayoutBuilder } from '@n7-frontend/core';\n\nexport abstract class AbstractLayout {\n  protected config: any;\n  protected widgets: any[]; \n  public lb: any;\n  \n  constructor(config: any){\n    this.config = config;\n    this.widgets = this.config.widgets; \n    this.lb = new LayoutBuilder(this.config.layoutId);\n  }\n\n  protected initPayload(): any {};\n\n  protected onInit(){\n    // on ready\n    this.lb.ready$.subscribe(() => {\n      this.lb.eventHandler.emitInner('init', this.initPayload());\n    });\n\n    this.lb.init({\n      widgetsConfig: this.widgets,\n      widgetsDataSources: this.config.widgetsDataSources,\n      widgetsEventHandlers: this.config.widgetsEventHandlers,\n      dataSource: new this.config.layoutDS(),\n      eventHandler: new this.config.layoutEH(),\n    });\n  }\n\n  protected onDestroy(){\n    this.lb.eventHandler.emitInner('destroy');\n  }\n}","import { LayoutDataSource } from '@n7-frontend/core';\nimport tippy, { hideAll } from 'tippy.js';\nimport { Subject } from 'rxjs';\n\nexport class MainLayoutDS extends LayoutDataSource {\n  protected configuration: any;\n  protected mainState: any;\n  protected router: any;\n  protected route: any;\n  protected titleService: any;\n\n  public options: any;\n  public pageTitle: string;\n\n  onInit({ configuration, mainState, router, options, titleService, route }) {\n    this.configuration = configuration;\n    this.mainState = mainState;\n    this.router = router;\n    this.route = route;\n    this.titleService = titleService;\n    this.options = options;\n    this.mainState.addCustom('currentNav', new Subject());\n\n    // update header\n    if (this.configuration.get('header')) {\n      this.one('header').update({ 'items': this.configuration.get('header') });\n    }\n\n    if (this.configuration.get('footer')) {\n      this.one('footer').update({ 'items': this.configuration.get('footer') });\n    }\n\n    // main state updates\n    this.mainState.get$('headTitle').subscribe(val => this.titleService.setTitle(val));\n    this.mainState.get$('pageTitle').subscribe(val => this.pageTitle = val);\n    this.mainState.get$('subnav').subscribe(val => this.one('subnav').update(val));\n    this.mainState.get$('breadcrumbs').subscribe(val => this.one('breadcrumbs').update(val));\n\n    this.mainState.getCustom$('currentNav').subscribe(val => this.one('header').update({ \"items\": this.configuration.get('header'), 'selected': val }));\n\n    // mainState test\n    /* this.mainState.addCustom('customNav', new Subject());\n    this.mainState.get$('pageTitle').subscribe(val => console.log('pageTitle', val));\n    this.mainState.getCustom$('customNav').subscribe(val => console.log('customNav', val));\n\n    this.mainState.update('pageTitle', 'hola');\n    this.mainState.updateCustom('customNav', {'hello': 'mundo!'});\n\n    setTimeout(() => {\n      this.mainState.update('pageTitle', 'chao');\n      this.mainState.updateCustom('customNav', {'hello': 'world!'});\n      console.log('has', {\n        'pageSubTitle' : this.mainState.has('pageSubTitle'),\n        'customNav' : this.mainState.hasCustom('customNav'),\n        'customNavs' : this.mainState.has('customNavs'),\n      });\n    }, 5000); */\n  }\n\n  onNavigate(payload) {\n    // router navigation\n    if (payload.handler === 'router') {\n      const { path, queryParams } = payload;\n\n      // path control\n      if (!path) throw Error('onNavigate: no path for router navigate');\n\n      if (queryParams) {\n        this.router.navigate(path, {\n          relativeTo: this.route,\n          queryParams: queryParams,\n          queryParamsHandling: 'merge'\n        });\n      } else {\n        this.router.navigate(path);\n      }\n\n      // on change\n      this._onRouterNavigate();\n    }\n  }\n\n  private _onRouterNavigate() {\n    // hide tippy\n    hideAll();\n  }\n}","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { tap, catchError } from 'rxjs/operators';\nimport { ConfigurationService } from './configuration.service';\nimport { of } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class JsonConfigService {\n  constructor(\n    private http: HttpClient,\n    private config: ConfigurationService,\n  ){}\n\n  load(path): Promise<any> {\n    return this.http.get(path).pipe(\n      catchError((error) => of({})),\n      tap(response => this._handleResponse(response))\n    ).toPromise();\n  }\n\n  private _handleResponse(response){\n    if(response){\n      Object.keys(response).forEach(key => this.config.set(key, response[key]));\n\n      // config keys colors\n      if(response['config-keys']){\n        const headTag = document.querySelector('head'),\n          styleElement = document.createElement('style');\n\n        let styles = [];\n\n        Object.keys(response['config-keys']).forEach(key => {\n          const configKey = response['config-keys'][key] || {};\n          \n          if(configKey.color && configKey.color.hex){\n            // add css class\n            styles.push(`--color-${key}: ${configKey.color.hex};`);\n          }\n        });\n\n        if(styles.length){\n          styles.unshift(':root {');\n          styles.push('}');\n          styleElement.appendChild(document.createTextNode(styles.join('\\n')));\n          headTag.appendChild(styleElement);\n        }\n\n      }\n    }\n  }\n}","interface IFacetInputData {\n  value: string | number;\n  label: string;\n  counter: number;\n  hidden?: boolean;\n  options?: any;\n}\n\nexport abstract class FacetInput {\n  static index = 0;\n\n  private id: string;\n  protected config: any;\n  protected output: any;\n  protected data: IFacetInputData[];\n  protected isEmpty = false;\n\n  constructor(config) {\n    this.config = config;\n    this._setId();\n\n    FacetInput.index++;\n  }\n\n  public abstract setActive(facetValue: any): void;\n  protected abstract transform(): any;\n\n  public update = () => this.output = this.transform();\n  public getId = () => this.id;\n  public getData = () => this.data;\n  public getConfig = () => this.config;\n  public getFacetId = () => this.config.facetId;\n  public getInputIndex = () => this.config.inputIndex;\n  public getSectionIndex = () => this.config.sectionIndex;\n  public getContext = () => this.config.filterConfig.context || 'external';\n  public getTarget = () => this.config.filterConfig.target || null;\n  public getSearchIn = () => this.config.filterConfig.searchIn || null;\n  public getType = () => this.config.type;\n  public getOutput = () => this.output;\n  public clear() {}\n\n  public setIsEmpty = (empty: boolean) => {\n    this.isEmpty = empty;\n  }\n  public setData = (newData: IFacetInputData[]) => this.data = newData;\n  private _setId() {\n    this.id = `facet-input-${this.getType()}-${FacetInput.index}`;\n  }\n}\n","import { FacetInput } from './facet-input';\n\nexport class FacetInputCheckbox extends FacetInput {\n\n  protected transform(){\n    const facetId = this.getFacetId();\n  \n    return this.data.map(({ label, value }, index) => {\n      // normalize value\n      value = '' + value;\n\n      return {\n        type: 'checkbox', \n        id: this.getId() + '-' + index, \n        label: label, \n        payload: {\n          facetId,\n          source: 'input-checkbox',\n          value\n        }, \n        _meta: { facetId, value } \n      }\n    });\n  }\n\n  public setActive(facetValue){\n    const { isArray } = this.config.filterConfig;\n    \n    this.output.forEach(config => {\n      if(isArray && Array.isArray(facetValue) && facetValue.indexOf(config._meta.value) !== -1){\n        config.checked = true;\n      } else if(facetValue === config._meta.value) {\n        config.checked = true;\n      } else {\n        config.checked = false;\n      }\n    });\n  }\n  \n}","import { FacetInput } from './facet-input';\n\nexport class FacetInputText extends FacetInput {\n\n  protected transform() {\n    const facetId = this.getFacetId();\n    const payload = {\n      facetId,\n      source: 'input-text'\n    };\n\n    return {\n      type: 'text',\n      id: this.getId(),\n      label: this.config.label,\n      disabled: this.config.disabled,\n      placeholder: this.config.placeholder,\n      icon: this.config.icon,\n      inputPayload: {\n        ...payload,\n        trigger: 'input'\n      },\n      enterPayload: {\n        ...payload,\n        trigger: 'enter'\n      },\n      iconPayload: {\n        ...payload,\n        trigger: 'icon'\n      },\n      _meta: { facetId }\n    };\n  }\n\n  public setActive(facetValue) {\n    this.output.value = facetValue || null;\n  }\n}\n","import { FacetInput } from './facet-input';\n\nconst RESULTS_LIMIT = 1000;\n\nexport class FacetInputLink extends FacetInput {\n  private facetValue: string | string[];\n\n  protected transform() {\n    const facetId = this.getFacetId();\n    const results = [];\n    let resultsCounter = 0;\n\n    for (const itemData of this.data) {\n      const { label, counter, hidden } = itemData;\n      let { value, options } = itemData;\n      if (hidden) {\n        continue;\n      }\n      resultsCounter += 1;\n\n      if (resultsCounter > RESULTS_LIMIT) {\n        break;\n      }\n\n      // normalize value\n      value = '' + value;\n      options = options || {};\n\n      const classes = [];\n      if (options.classes) { classes.push(options.classes); }\n      if (this._isActive(this.facetValue, value)) { classes.push('is-active'); }\n\n      results.push({\n        type: 'link',\n        id: this.getId(),\n        text: label,\n        counter,\n        payload: {\n          facetId,\n          source: 'input-link',\n          value\n        },\n        icon: options.icon || null,\n        classes: classes.join(' '),\n        _meta: { facetId, value }\n      });\n    }\n\n    /* const results: any[] = this.data.map(({ label, value, counter, hidden, options }) => {\n      if (hidden) {\n        return;\n      }\n\n      resultsCounter += 1;\n      // normalize value\n      value = '' + value;\n      options = options || {};\n\n      const classes = [];\n      if (options.classes) { classes.push(options.classes); }\n      if (this._isActive(this.facetValue, value)) { classes.push('is-active'); }\n\n      return {\n        type: 'link',\n        id: this.getId(),\n        text: label,\n        counter,\n        payload: {\n          facetId,\n          source: 'input-link',\n          value\n        },\n        icon: options.icon || null,\n        classes: classes.join(' '),\n        _meta: { facetId, value }\n      };\n    });\n     */\n\n    // empty state control\n    const itemEmpty = results.filter(item => item.id === 'empty')[0];\n    if (this.isEmpty) {\n      if (itemEmpty) {\n        itemEmpty.classes = 'empty-text-link';\n      } else {\n        const { label } = this.getConfig().emptyState,\n          emptyId = 'empty-link';\n        results.push({\n          type: 'link',\n          id: emptyId,\n          text: label,\n          classes: 'empty-text-link',\n          _meta: { facetId: emptyId, value: null }\n        });\n      }\n    } else if (itemEmpty) {\n      itemEmpty.classes = 'empty-text-link is-hidden';\n    }\n\n    return results;\n  }\n\n  public setActive(facetValue) {\n    this.output.forEach(config => {\n      const isActive = this._isActive(facetValue, config._meta.value);\n      let classes = config.classes ? config.classes.split(' ') : [];\n      if (!isActive) {\n        classes = classes.filter(className => className !== 'is-active');\n      } else if (classes.indexOf('is-active') === -1) {\n        classes.push('is-active');\n      }\n      config.classes = classes.join(' ');\n    });\n  }\n\n  private _isActive(facetValue, value) {\n    this.facetValue = facetValue;\n\n    return (\n      (Array.isArray(facetValue) && facetValue.indexOf(value) !== -1) ||\n      (facetValue === value)\n    );\n  }\n\n  public clear(){\n    this.facetValue = [];\n  }\n}\n","import { FacetInput } from './facet-input';\n\nexport class FacetInputSelect extends FacetInput {\n\n  protected transform() {\n    const facetId = this.getFacetId();\n\n    return {\n      type: 'select',\n      id: this.getId(),\n      label: this.config.label,\n      disabled: this.config.disabled,\n      options: this.data ? this.data.map(({ value, label }) => ({\n        // normalize value\n        value: '' + value,\n        label\n      })) : [],\n      payload: {\n        facetId,\n        source: 'input-select',\n      },\n      _meta: { facetId }\n    };\n  }\n\n  public setActive(facetValue){\n    this.output.options\n      .filter(option => option.value === facetValue)\n      .forEach(option => option.selected = true);\n  }\n}\n","import { get as _get } from 'lodash';\nimport { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport {\n  FacetInput,\n  FacetInputCheckbox,\n  FacetInputText,\n  FacetInputLink,\n  FacetInputSelect\n} from '../models';\n\nexport type FilterOperators = '=' | '>' | '<' | '>=' | '<=' | '<>' | 'LIKE';\nexport type FacetTypes = 'value' | 'range';\nexport type FacetOperators = 'OR' | 'AND';\n\nconst INPUTS_MAP = {\n  checkbox: FacetInputCheckbox,\n  text: FacetInputText,\n  link: FacetInputLink,\n  select: FacetInputSelect\n};\n\nconst FILTERS_MAP = {\n  '=' : '_filterDataEquals',\n  '>' : '_filterDataGreaterThan',\n  '<' : '_filterDataLessThan',\n  '>=' : '_filterDataGreaterOrEquals',\n  '<=' : '_filterDataLessOrEquals',\n  '<>' : '_filterDataNotEqual',\n  'LIKE': '_filterDataLike'\n};\n\nexport interface ISearchConfig {\n  totalCount: number;\n  facets: any;\n  page: any;\n  results: any;\n  fields: any;\n}\n\nexport interface IFacet {\n  id: string;\n  type: FacetTypes;\n  operator: FacetOperators;\n  hasStaticData?: boolean;\n  searchData?: string[];\n  data?: any;\n}\n\nexport interface IFilter {\n  facetId: string;\n  value: number | string | (number | string)[] | null;\n  searchIn: Array<{\n    key: string;\n    operator?: FilterOperators;\n  }>;\n  isArray?: boolean;\n  context?: 'internal' | 'external';\n  target?: string;\n}\n\nexport class SearchModel {\n  private _id: string;\n  private _filters: IFilter[] = [];\n  private _facets: IFacet[] = [];\n  private _inputs: FacetInput[] = [];\n  private _page: any;\n  private _totalCount: number | null;\n  private _config: ISearchConfig;\n  private _results$: Subject<any[]> = new Subject();\n\n  constructor(id: string, config: ISearchConfig) {\n    this._id = id;\n    this._config = config;\n\n    this._setFilters();\n    this._setFacets();\n    this._setPage();\n    this._setInputs();\n    this._setInputsData();\n    this._setTotalCount();\n\n    // query params control\n    if (SearchService.queryParams) {\n      this.updateFiltersFromQueryParams(SearchService.queryParams);\n      SearchService.queryParams = null;\n    }\n  }\n\n  public getId = () => this._id;\n  public getFilters = () => this._filters;\n  public getFacets = () => this._facets;\n  public getInputs = () => this._inputs;\n  public getConfig = () => this._config;\n  public getTotalCount = () => this._totalCount;\n  public getFields = () => this._config.fields;\n  public getResults$ = () => this._results$;\n\n  public setResults = results => this._results$.next(results);\n\n  public updateFilter(facetId, value, remove?: boolean) {\n    const selectedFilters = this.getFiltersByFacetId(facetId);\n    selectedFilters.forEach(filter => {\n      if (Array.isArray(filter.value) && remove) {\n        filter.value = filter.value.filter(item => item !== value);\n      } else if (\n        Array.isArray(filter.value) &&\n        filter.value.indexOf(value) === -1\n      ) {\n        filter.value.push(value);\n      } else {\n        filter.value = !remove ? value : null;\n      }\n    });\n  }\n\n  public clear() {\n    this.updateFiltersFromQueryParams({}, true);\n    this._clearInputs();\n  }\n\n  public updateFiltersFromQueryParams(queryParams, clearAll: boolean = false) {\n    this._facets.forEach(({ id }) => {\n      const selectedFilters = this.getFiltersByFacetId(id),\n        value = queryParams[id],\n        isInternal = this.getInputByFacetId(id).getContext() === 'internal';\n\n      if (isInternal && !clearAll) {\n        return;\n      }\n\n      selectedFilters.forEach(filter => {\n        if (filter.isArray) {\n          filter.value = value ? value.split(',') : [];\n        } else {\n          filter.value = value ? value : null;\n        }\n      });\n    });\n  }\n\n  public updateInputsFromFilters() {\n    this._filters.forEach(({ facetId, value }) => {\n      this.getInputByFacetId(facetId).setActive(value);\n    });\n  }\n\n  public updateFacets(facets) {\n    facets.forEach(({ id, data }) => this.updateFacet(id, data));\n    this._setInputsData();\n  }\n\n  public updateTotalCount(totalCount) {\n    this._totalCount = totalCount;\n  }\n\n  public updateFacet(facetId, data) {\n    const selectedFacets = this._facets.filter(facet => facet.id === facetId);\n    if (!selectedFacets.length) {\n      throw Error(`Facet with id '${facetId}' does not exists`);\n    }\n\n    selectedFacets.forEach(facet => (facet.data = data));\n  }\n\n  public reset() {\n    this._filters.forEach(filter => (filter.value = null));\n  }\n\n  public getRequestParams() {\n    return {\n      facets: this._getRequestFacets(),\n      page: this._page,\n      results: this._config.results,\n      filters: this._filters\n        .filter(filter => filter.context !== 'internal')\n        .map(({ facetId, value, searchIn }) => ({ facetId, value, searchIn }))\n    };\n  }\n\n  public getInternalFilters() {\n    return this._filters\n      .filter(filter => {\n        return (\n          filter.context === 'internal' &&\n          ((Array.isArray(filter.value) && filter.value.length) ||\n            (!Array.isArray(filter.value) && filter.value))\n        );\n      })\n      .map(({ facetId, value, searchIn }) => ({ facetId, value, searchIn }));\n  }\n\n  public filtersAsQueryParams(filters) {\n    const queryParams: any = {};\n    filters.forEach(\n      filter =>\n        (queryParams[filter.facetId] = Array.isArray(filter.value)\n          ? filter.value.join(',')\n          : filter.value)\n    );\n\n    return queryParams;\n  }\n\n  public getFiltersByFacetId(facetId: string) {\n    return this._filters.filter(filter => filter.facetId === facetId);\n  }\n\n  public getInputByFacetId(facetId: string) {\n    return this._inputs.filter(input => input.getFacetId() === facetId)[0];\n  }\n\n  public setInputData(facetId, data) {\n    this.getInputByFacetId(facetId).setData(data);\n  }\n\n  public filterTarget(target) {\n    const inputs = this._inputs.filter(input => input.getTarget() === target),\n      targetInput = this.getInputByFacetId(target),\n      facet = this._facets.filter(f => f.id === target)[0],\n      facetData = facet.data;\n\n    const searchIns = [];\n    inputs.forEach(input => {\n      const filter = this.getFiltersByFacetId(input.getFacetId())[0],\n        searchIn = input.getSearchIn(),\n        value = filter.value;\n\n      searchIns.push([searchIn, value]);\n    });\n\n    // filter\n    facetData.forEach(item => this._filterData(searchIns, item));\n\n    // update\n    targetInput.setData(facetData);\n\n    if (targetInput.getConfig().emptyState) {\n      const isEmpty = !facetData.filter(data => !data.hidden).length;\n      targetInput.setIsEmpty(isEmpty);\n    }\n    targetInput.update();\n  }\n\n  public setSearchConfigOrderBy(orderBy) {\n    this._config.results.order.key = orderBy;\n  }\n\n  public setSearchConfigDirection(direction) {\n    this._config.results.order.direction = direction;\n  }\n\n  public setPageConfigOffset(offset) {\n    this._config.page.offset = offset;\n  }\n\n  public setPageConfigLimit(limit) {\n    this._config.page.limit = limit;\n  }\n\n  private _clearInputs(){\n    this._inputs.forEach(input => {\n      input.clear();\n    });\n  }\n\n  private _filterData(searchIns, item) {\n    // reset\n    item.hidden = false;\n    searchIns.forEach(([searchIn, value]) => {\n      searchIn.forEach(({ key, operator }) => {\n        if (item.hidden) {\n          return;\n        }\n        let refValue = _get(item, key, null);\n        if (key.indexOf('searchData') !== -1 && Array.isArray(item.searchData)) {\n          const searchDataKey = key.replace('searchData.', '');\n          item.searchData.forEach(({ key: dataKey, value: dataValue }) => {\n            if (dataKey === searchDataKey) {\n              refValue = dataValue;\n            }\n          });\n        }\n        if (refValue === null) {\n          item.hidden = true;\n        } else if (FILTERS_MAP[operator]) {\n          item.hidden = this[FILTERS_MAP[operator]](value, refValue);\n        } else {\n          console.warn(`SearchIn: operator ${operator} not supported`);\n        }\n      });\n    });\n  }\n\n  private _filterDataEquals(value, refValue) {\n    if (Array.isArray(refValue)) {\n      if (Array.isArray(value)) {\n        let inArray = value.length === 0 ? true : false;\n        refValue.forEach(rv => {\n          if (value.indexOf(rv) !== -1) {\n            inArray = true;\n          }\n        });\n        return !(inArray);\n      } else {\n        return !(value && refValue.indexOf(value) !== -1);\n      }\n    } else {\n      if (Array.isArray(value)) {\n        return !(\n          !value.length || value.indexOf(refValue) !== -1\n        );\n      } else {\n        return !(value && value === refValue);\n      }\n    }\n  }\n\n  private _filterDataGreaterThan(value, refValue) {\n    if (!Array.isArray(value)) {\n      return !(value && value > refValue);\n    }\n    return false;\n  }\n\n  private _filterDataLessThan(value, refValue) {\n    if (!Array.isArray(value)) {\n      return !(value && value < refValue);\n    }\n    return false;\n  }\n\n  private _filterDataGreaterOrEquals(value, refValue) {\n    if (!Array.isArray(value)) {\n      return !(value && value >= refValue);\n    }\n    return false;\n  }\n\n  private _filterDataLessOrEquals(value, refValue) {\n    if (!Array.isArray(value)) {\n      return !(value && value <= refValue);\n    }\n    return false;\n  }\n\n  private _filterDataNotEqual(value, refValue) {\n    if (!Array.isArray(value)) {\n      return !(value && value !== refValue);\n    }\n    return false;\n  }\n\n  private _filterDataLike(value, refValue) {\n    if (\n      value &&\n      typeof value === 'string' &&\n      typeof refValue === 'string'\n    ) {\n      const haystack = refValue.toLowerCase(),\n        needle = value.toLocaleLowerCase();\n\n      return !(haystack.indexOf(needle) !== -1);\n    }\n    return false;\n  }\n\n  private _setFilters() {\n    this._config.fields.forEach(field => {\n      field.inputs.forEach(input =>\n        this._filters.push({\n          ...input.filterConfig,\n          facetId: input.facetId,\n          value: input.filterConfig.isArray ? [] : null\n        })\n      );\n    });\n  }\n\n  private _setFacets() {\n    this._facets = this._config.facets;\n  }\n\n  private _setPage() {\n    this._page = this._config.page;\n  }\n\n  private _setTotalCount() {\n    this._totalCount = this._config.totalCount;\n  }\n\n  private _setInputs() {\n    this._config.fields.forEach((sectionConfig, sectionIndex) => {\n      sectionConfig.inputs.forEach((inputConfig, inputIndex) => {\n        const inputModel = INPUTS_MAP[inputConfig.type];\n        if (!inputModel) {\n          throw Error(`Input type ${inputConfig.type} not supported`);\n        }\n\n        this._inputs.push(\n          new inputModel({ ...inputConfig, inputIndex, sectionIndex })\n        );\n      });\n    });\n  }\n\n  private _setInputsData() {\n    this._facets.forEach(facet => this.setInputData(facet.id, facet.data));\n  }\n\n  private _getRequestFacets() {\n    const results: IFacet[] = [];\n    this._facets.forEach(f => {\n      const facetConfig = {...f};\n      if (!f.hasStaticData) {\n        delete facetConfig.data;\n      }\n      delete facetConfig.hasStaticData;\n\n      // searchData control\n      if (Array.isArray(facetConfig.data)) {\n        facetConfig.data\n          .filter(dataItem => typeof dataItem.searchData !== 'undefined')\n          .forEach(dataItem => {\n            delete dataItem.searchData;\n          });\n      }\n      results.push(facetConfig);\n    });\n    return results;\n  }\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SearchService {\n  static queryParams: any = null;\n  private _models: any = {};\n\n  public add(id: string, config: ISearchConfig) {\n    if (this._models[id]) {\n      throw Error(`Search model '${id}' already exists!`);\n    }\n\n    this._models[id] = new SearchModel(id, config);\n  }\n\n  public remove(id: string) {\n    if (this._models[id]) {\n      delete this._models[id];\n    }\n  }\n\n  public model(id: string): SearchModel {\n    return this._models[id] || null;\n  }\n}\n","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\nimport { takeUntil, first, filter } from 'rxjs/operators';\nimport { SearchService } from '../../services';\n\nexport class MainLayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n  private route: any;\n  private router: any;\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type) {\n        case 'main-layout.init':\n          this.dataSource.onInit(payload);\n\n          this.route = payload.route;\n          this.router = payload.router;\n\n          this._listenRouterChanges();\n          break;\n\n        case 'main-layout.destroy':\n            this.destroyed$.next();\n            break;\n\n        default:\n            break;\n      }\n    });\n\n    // listen to global events\n    EventHandler.globalEvents$.pipe(\n      takeUntil(this.destroyed$)\n    ).subscribe(({type, payload}) => {\n      switch(type){\n        case 'global.navigate':\n          this.dataSource.onNavigate(payload);\n          break;\n          \n        default: \n          break;\n      }\n    });\n  }\n\n  private _listenRouterChanges(){\n    this.route.queryParams.pipe(\n      filter(params => {\n        if(Object.keys(params).length) return true;\n        return false;\n      }),\n      // first(),\n    ).subscribe(params => {\n      this.emitGlobal('queryparams', params);\n\n      // to use in searchs\n      SearchService.queryParams = params;\n    });\n  } \n  \n}","import { DataSource } from '@n7-frontend/core';\n\nexport class HeaderDS extends DataSource {\n  protected transform(data) {\n\n    if (data.selected) {\n      this.selectNavItem(data.selected);\n    }\n\n    return data.items;\n  }\n\n  public selectNavItem(selectedItem) {\n    this.output.nav.items.forEach( item => {\n      item.classes = \"\";\n      if ( item.payload == selectedItem ){\n        item.classes = \"is-current\";\n      }\n    })\n    this.update({'items': this.output});\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class SubnavDS extends DataSource {\n\n  protected transform(data) {\n    return {\n      classes: 'main-subnav',\n      items: data\n    }\n  }\n\n  setActive(id){\n    this.output.items.forEach(item => {\n      if(item._meta.id === id){\n        item.classes = 'is-current';\n        item._meta.isActive = true;\n      } else {\n        item.classes = '';\n        item._meta.isActive = false;\n      }\n    });\n  }\n\n  getActive(){\n    return this.output.items.filter(item => item._meta.isActive)[0] || null;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\nimport { IBreadcrumbsData } from '@n7-frontend/components';\n\nexport class BreadcrumbsDS extends DataSource {\n  protected transform(data): IBreadcrumbsData | null {\n    return data;\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class FacetsDS extends DataSource {\n  public searchModel: any;\n\n  protected transform({ fields }) {\n\n    const { searchModel } = this.options;\n    this.searchModel = searchModel;\n\n    return fields;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\nimport { SearchModel, SearchService } from '../services/search.service';\n\nconst HEADER_ICON_OPEN = 'n7-icon-angle-down';\nconst HEADER_ICON_CLOSE = 'n7-icon-angle-right';\n\nexport class FacetsWrapperDS extends DataSource {\n  public searchModel: SearchModel;\n\n  protected transform(data) {\n\n    if(!this.searchModel) {\n      this.searchModel = data.searchModel;\n    }\n\n    const id = this.searchModel.getId(),\n      fields = this.searchModel.getFields();\n    \n    let groups = [];\n\n    fields.forEach((fieldConfig, fieldIndex) => {\n      const groupId = `group-${id}-${fieldIndex}`;\n      \n      // header config\n      const header = this._headerConfig(fieldConfig.header, groupId);\n\n      // inputs config\n      let sections = [];\n      this.searchModel.getInputs()\n        .filter(input => input.getSectionIndex() === fieldIndex)\n        .map(input => {\n          input.update();\n          return {\n            facetId: input.getFacetId(),\n            type: input.getType(),\n            output: input.getOutput()\n          }\n        })\n        .forEach(({ type, output, facetId }) => {\n          sections.push({ \n            classes: this._getSectionClasses(type),\n            inputs: Array.isArray(output) ? output : [output],\n            _meta: {\n              facetId\n            }\n          });\n        });\n\n      groups.push({ \n        header,\n        facet: { sections },\n        classes: `n7-facets-wrapper__${groupId}`,\n        isOpen: true, \n        _meta: {\n          groupId\n        }\n      })\n    });\n\n    return { \n      groups, \n      classes: `n7-facets-wrapper__${this.searchModel.getId()}` \n    };\n  }\n\n  public toggleGroup({ eventPayload }){\n    this.output.groups.forEach(group => {\n      if(group._meta.groupId === eventPayload.groupId) {\n        group.isOpen = !group.isOpen;\n        group.header.iconRight = group.isOpen ? HEADER_ICON_OPEN : HEADER_ICON_CLOSE;\n      }\n    });\n  }\n  \n  public onFacetChange({ eventPayload }){\n    const { facetId, source, trigger } = eventPayload.inputPayload,\n      filter = this.searchModel.getFiltersByFacetId(facetId)[0] || {},\n      filterValue = filter['value'];\n\n    let remove: boolean = false,\n      value: any = eventPayload.inputPayload.value || eventPayload.value;\n\n    // normalize\n    value = '' + value;\n      \n    // remove control\n    if(Array.isArray(filterValue)){\n      remove = filterValue.indexOf(value) !== -1;\n    } else {\n      remove = filterValue === value;\n    }\n\n    // input text control\n    // TODO: gestire i casi enter / icon click nel input text\n    if(source === 'input-text' && ['enter', 'icon'].indexOf(trigger) !== -1) return;\n\n    this.searchModel.updateFilter(facetId, value, remove);\n    this.searchModel.updateInputsFromFilters();\n  }\n\n  public updateFilteredTarget(target){\n    const input = this.searchModel.getInputByFacetId(target);\n    this.output.groups\n      .map(group => group.facet)\n      .map(facet => facet.sections)\n      .map(sections => {\n        sections.forEach(section => {\n          if(section._meta.facetId === target){\n            const inputOutput = input.getOutput();\n            section.inputs = Array.isArray(inputOutput) ? inputOutput : [inputOutput];\n          }\n        });\n      });\n  }\n\n  public updateInputLinks(){\n    const linksFacetIds = this.searchModel.getInputs()\n      .filter(input => input.getType() === 'link')\n      .map(input => input.getFacetId());\n\n    this.output.groups\n      .map(group => group.facet)\n      .map(facet => facet.sections)\n      .map(sections => {\n        sections.forEach(section => {\n          if(linksFacetIds.indexOf(section._meta.facetId) !== -1){\n            const input = this.searchModel.getInputByFacetId(section._meta.facetId);\n            input.update();\n            const inputOutput = input.getOutput();\n            section.inputs = Array.isArray(inputOutput) ? inputOutput : [inputOutput];\n          }\n        });\n      });\n  }\n\n  public getRequestParams = () => this.searchModel.getRequestParams();\n  public filtersAsQueryParams = (filters) => this.searchModel.filtersAsQueryParams(filters);\n  public updateFiltersFromQueryParams = (queryParams) => this.searchModel.updateFiltersFromQueryParams(queryParams);\n  public getInputByFacetId = (facetId) => this.searchModel.getInputByFacetId(facetId);\n  public filterTarget = (target) => this.searchModel.filterTarget(target);\n  public updateInputsFromFilters = () => this.searchModel.updateInputsFromFilters();\n\n  private _getSectionClasses(type){\n    const classesMap = {\n      'text': 'text',\n      'checkbox': 'checkboxes',\n      'link': 'links',\n      'select': 'select'\n    };\n\n    return `n7-facet__section-input-${classesMap[type]}`;\n  }\n\n  private _headerConfig(header, groupId){\n    return header ? {\n      text: header.label,\n      iconRight: HEADER_ICON_OPEN,\n      classes: header.classes,\n      payload: {\n        source: 'group-header',\n        id: `${groupId}-header`,\n        groupId: groupId\n      },\n      _meta: {\n        id: `${groupId}-header`\n      }\n    }: null;\n  }\n\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class FooterDS extends DataSource {\n  protected transform(data) {\n    if(!data) {\n      return;\n    }\n    return data.items;\n  }\n}\n","import { EventHandler } from '@n7-frontend/core';\n\nexport class HeaderEH extends EventHandler {\n\n  public listen(){\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case 'header.click':\n          // navigate control\n          // if(payload.source === 'navigate'){\n          this.dataSource.selectNavItem(payload);\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [payload]\n          });\n          // }\n          // global signal\n          // this.emitGlobal(type, payload);\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n\n}\n","import { EventHandler } from '@n7-frontend/core';\n\nexport class SubnavEH extends EventHandler {\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case 'subnav.click':\n          // navigate control\n          if(payload.source === 'navigate'){\n            this.emitGlobal('navigate', payload);\n          }\n\n          // global signal\n          this.emitGlobal(type, payload);\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class BreadcrumbsEH extends EventHandler {\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case 'breadcrumbs.click':\n          // navigate control\n          if(payload.source === 'navigate'){\n            this.emitGlobal('navigate', payload);\n          }\n\n          // global signal\n          this.emitGlobal(type, payload);\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class FacetsEH extends EventHandler {\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        // TODO\n        default:\n          break;\n      }\n    });\n  }\n}","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\n\nexport class FacetsWrapperEH extends EventHandler {\n  private _facetsChanged = false;\n  private internalFacetsChange$: Subject<any> = new Subject();\n  private externalFacetsChange$: Subject<any> = new Subject();\n\n  public listen() {\n    // listen to inner (widget) events\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'facets-wrapper.facet':\n          // empty payload control\n          if (!payload.eventPayload.inputPayload) {\n            return;\n          }\n          const { facetId } = payload.eventPayload.inputPayload,\n            input = this.dataSource.getInputByFacetId(facetId),\n            context = input.getContext();\n          this._facetsChanged = true;\n\n          // update\n          this.dataSource.onFacetChange(payload);\n\n          // internal\n          if (context === 'internal') {\n            this.internalFacetsChange$.next(input.getTarget());\n          // external\n          } else {\n            this.externalFacetsChange$.next();\n          }\n\n          break;\n\n        case 'facets-wrapper.facetheader':\n          this.dataSource.toggleGroup(payload);\n          break;\n\n        default:\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      if (type.indexOf('queryparamschange') !== -1 && this.dataSource.searchModel) {\n        this.dataSource.updateFiltersFromQueryParams(payload);\n        this.dataSource.updateInputsFromFilters();\n      }\n    });\n\n    // listen to global events\n    EventHandler.globalEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'global.searchresponse':\n          if (this.dataSource.searchModel && this.dataSource.searchModel.getId() === payload) {\n            this.dataSource.updateInputLinks();\n            const internalFilters = this.dataSource.searchModel.getInternalFilters();\n\n            internalFilters.forEach(filter => {\n              const input = this.dataSource.searchModel.getInputByFacetId(filter.facetId);\n              const target = input.getTarget();\n              this.dataSource.filterTarget(target);\n              this.dataSource.updateFilteredTarget(target);\n            });\n          }\n          break;\n\n        default:\n          break;\n      }\n    });\n\n    // internal facets change\n    this.internalFacetsChange$.pipe(\n      debounceTime(500)\n    ).subscribe(target => {\n      this.dataSource.filterTarget(target);\n      this.dataSource.updateFilteredTarget(target);\n    });\n\n    // internal facets change\n    this.externalFacetsChange$.pipe(\n      debounceTime(500)\n    ).subscribe(() => {\n      const requestParams = this.dataSource.getRequestParams(),\n      queryParams = this.dataSource.filtersAsQueryParams(requestParams.filters);\n\n      Object.keys(queryParams).forEach(key => queryParams[key] = queryParams[key] || null);\n      // signal\n      this.emitOuter('facetschange');\n\n      // router signal\n      this.emitGlobal('navigate', {\n        handler: 'router',\n        path: [],\n        queryParams\n      });\n    });\n  }\n\n}\n","import { EventHandler } from '@n7-frontend/core';\n\nexport class FooterEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        default:\n          console.warn('unhandled inner event of type', type)\n          break;\n      }\n    });\n  }\n\n}\n","import { MainLayoutDS } from './main-layout.ds';\nimport { MainLayoutEH } from './main-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const MainLayoutConfig = {\n  layoutId: 'main-layout',\n  widgets: [{\n    id: 'header'\n  }, {\n    id: 'subnav'\n  }, {\n    id: 'breadcrumbs'\n  }, {\n    id: 'footer'\n  }],\n  layoutDS: MainLayoutDS,\n  layoutEH: MainLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { Title } from '@angular/platform-browser';\nimport { AbstractLayout } from '../../models/abstract-layout'\nimport { ConfigurationService } from '../../services/configuration.service';\nimport { LayoutsConfigurationService } from '../../services/layouts-configuration.service';\nimport { MainStateService } from '../../services/main-state.service';\nimport { MainLayoutConfig as config } from './main-layout.config';\n\n@Component({\n    selector: 'main-layout',\n    templateUrl: './main-layout.html'\n})\nexport class MainLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private configuration: ConfigurationService,\n    private layoutsConfiguration: LayoutsConfigurationService,\n    private mainState: MainStateService,\n    private titleService: Title\n  ){\n    super(layoutsConfiguration.get('MainLayoutConfig') || config);\n  }\n\n  protected initPayload(){\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      router: this.router,\n      route: this.route,\n      titleService: this.titleService,\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit(){\n    this.onInit();\n  }\n\n  ngOnDestroy(){\n    this.onDestroy();\n  }\n}\n","import { LayoutDataSource } from '@n7-frontend/core';\n\nexport class Page404LayoutDS extends LayoutDataSource {\n  public options: any;\n\n  onInit({ options }){\n    this.options = options;\n  }\n}","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\n\nexport class Page404LayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type) {\n        case 'n7-page404-layout.init':\n          this.dataSource.onInit(payload);\n          break;\n\n        case 'n7-page404-layout.destroy':\n            this.destroyed$.next();\n            break;\n\n        default:\n            break;\n      }\n    });\n\n    // listen to global events\n    /* EventHandler.globalEvents$.pipe(\n      takeUntil(this.destroyed$)\n    ).subscribe(({type, payload}) => {\n      switch(type){\n        case 'global.navigate':\n          this.dataSource.onNavigate(payload);\n          break;\n          \n        default: \n          break;\n      }\n    }); */\n  }\n  \n}","import { Page404LayoutDS } from './page404-layout.ds';\nimport { Page404LayoutEH } from './page404-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const Page404LayoutConfig = {\n  layoutId: 'n7-page404-layout',\n  widgets: [],\n  layoutDS: Page404LayoutDS,\n  layoutEH: Page404LayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { AbstractLayout } from '../../models/abstract-layout'\nimport { LayoutsConfigurationService } from '../../services/layouts-configuration.service';\nimport { Page404LayoutConfig as config } from './page404-layout.config';\n\n@Component({\n    selector: 'n7-page404-layout',\n    templateUrl: './page404-layout.html'\n})\nexport class Page404LayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    layoutsConfiguration: LayoutsConfigurationService,\n  ){\n    super(layoutsConfiguration.get('Page404LayoutConfig') || config);\n  }\n\n  protected initPayload(){\n    return {\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit(){\n    this.onInit();\n  }\n\n  ngOnDestroy(){\n    this.onDestroy();\n  }\n}\n","import { Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'n7-facets-wrapper',\n  templateUrl: './facets-wrapper.html',\n})\nexport class FacetsWrapperComponent {\n  @Input() data: any;\n  @Input() emit: any;\n\n  headerEmit(eventType, eventPayload){\n    if(!this.emit) return;\n\n    this.emit('facetheader', { eventType, eventPayload });\n  }\n\n  facetEmit(eventType, eventPayload){\n    if(!this.emit) return;\n\n    this.emit('facet', { eventType, eventPayload });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { ModuleWithProviders } from '@angular/compiler/src/core';\nimport { DvComponentsLibModule } from '@n7-frontend/components';\n\n// services\nimport { ConfigurationService } from './services/configuration.service';\nimport { LayoutsConfigurationService } from './services/layouts-configuration.service';\nimport { MainStateService } from './services/main-state.service';\nimport { CommunicationService } from './services/communication.service';\nimport { ApolloProvider } from './services/communication-providers/apollo/apollo.provider';\n\n// layouts\nimport { MainLayoutComponent } from './layouts/main-layout/main-layout';\nimport { Page404LayoutComponent } from './layouts/page404-layout/page404-layout';\nimport { FacetsWrapperComponent } from './components/facets-wrapper/facets-wrapper';\n\nconst COMPONENTS = [\n  MainLayoutComponent,\n  Page404LayoutComponent,\n  FacetsWrapperComponent,\n];\n\n@NgModule({\n  declarations: COMPONENTS,\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    DvComponentsLibModule\n  ],\n  providers: [],\n  exports: COMPONENTS\n})\nexport class N7BoilerplateCommonModule {\n  static forRoot(config: any): ModuleWithProviders {\n    return {\n      ngModule: N7BoilerplateCommonModule,\n      providers: [\n        MainStateService, \n        ConfigurationService, \n        LayoutsConfigurationService, \n        CommunicationService, \n        ApolloProvider, \n        { provide: 'config', useValue: config }\n      ]\n    }\n  }\n}\n","import { LayoutDataSource } from '@n7-frontend/core';\n\nexport class AwEntitaLayoutDS extends LayoutDataSource {\n  protected configuration: any;\n  protected mainState: any;\n  protected router: any;\n  protected location: any;\n  protected titleService: any;\n  protected route: any;\n\n  public options: any;\n  public pageTitle: string;\n  public showFields: boolean = false;\n  public myResponse: any = {}; // backend response object\n  public selectedTab: string; // selected nav item\n  public navHeader: any = {}; // nav-header (custom) data\n  public currentId: string; // selected entity (url param)\n  public currentPage: any; // pagination value (url param)\n  public pageSize: number = 10; // linked objects page size\n  // BUBBLE CHART DATA â\n  public bubblesSize: number = 10; // related entities (bubbles) page size\n  public bubblesEnabled: boolean;\n\n  private communication: any;\n\n  onInit({ configuration, mainState, router, route, location, options, titleService, communication }) {\n    this.route = route;\n    this.communication = communication;\n    this.configuration = configuration;\n    this.mainState = mainState;\n    this.options = options;\n    this.router = router;\n    this.location = location;\n    this.titleService = titleService;\n    this.currentId = \"\";\n    this.currentPage = +this.route.snapshot.params.page;\n    this.bubblesEnabled = this.configuration.get('features-enabled') ? this.configuration.get('features-enabled')['bubblechart'] : false;\n    this.bubblesSize = this.configuration.get('entita-layout') ? this.configuration.get('entita-layout')['entitiesQuerySize'] : this.bubblesSize;\n    this.one('aw-bubble-chart').updateOptions({\n      simple: true,\n      config: this.configuration,\n      limit: this.configuration.get('bubble-chart').bubbleLimit,\n      smallChartSize: this.configuration.get('entita-layout').overview.smallChartSize\n    });\n\n    // update head title\n    this.mainState.update('headTitle', 'Arianna Web > EntitÃ ');\n  }\n\n  public updateComponent = (id, data, options?) => {\n    if (options) {\n      this.one(id).updateOptions(options)\n    }\n    this.one(id).update(data)\n  }\n\n  getNavigation(id) {\n    /*\n      Requests data from communication provider\n     */\n    return this.communication.request$('getEntityDetails', {\n      onError: (error) => console.error(error),\n      params: { entityId: id, entitiesListSize: this.bubblesSize }\n    })\n  }\n\n  /*\n    Updates selected tab on tab change\n  */\n  handlePageNavigation = () => {\n    this.one('aw-linked-objects').updateOptions({\n      context: this.selectedTab,\n      config: this.configuration,\n      page: this.currentPage,\n      pagination: true,\n      size: this.pageSize,\n    })\n    this.one('aw-linked-objects').update({ items: this.myResponse.relatedItems });\n    this.location.go(`${this.configuration.get('paths').entitaBasePath}${this.currentId}/oggetti-collegati/${this.currentPage}`)\n  };\n\n  handleNavUpdate = tab => {\n    this.selectedTab = tab\n    this.updateWidgets(this.myResponse)\n    const page = tab == 'oggetti-collegati' ? \"/1\" : \"\";\n    if (tab == 'oggetti-collegati') {\n      this.one('aw-linked-objects').updateOptions({\n        context: this.selectedTab,\n        config: this.configuration,\n        page: this.currentPage,\n        pagination: true,\n        size: this.pageSize,\n      })\n      this.one('aw-linked-objects').update({ items: this.myResponse.relatedItems });\n    } else if (tab == \"overview\") {\n      this.one('aw-linked-objects').updateOptions({\n        size: 3,\n        config: this.configuration,\n        context: 'entita'\n      })\n      this.one('aw-linked-objects').update({ items: this.myResponse.relatedItems });\n    }\n    if (tab == \"overview\" || tab == \"entita-collegate\") {\n      setTimeout(() => { this.updateBubbes(this.myResponse.relatedEntities) }, 800);\n    }\n    this.location.go(`${this.configuration.get('paths').entitaBasePath}${this.currentId}/${tab}${page}`)\n  }\n\n  /*\n    Updates the widgets on this layout, based on route\n  */\n  updateWidgets(data) {\n    const selected = this.selectedTab\n    this.one('aw-entita-nav').update({ data, selected })\n    this.updateComponent(\n      'aw-entita-metadata-viewer',\n      this.myResponse.fields,\n      {\n        context: this.selectedTab,\n        config: this.configuration,\n        labels: this.configuration.get(\"labels\")\n      }\n    )\n  }\n  /*\n    Helper function to update the graph\n  */\n  updateBubbes(data) {\n    this.one('aw-bubble-chart').update(data);\n  }\n\n  /*\n    Loads the data for the selected nav item, into the adjacent text block.\n  */\n  loadItem(id, tab) {\n    if (id && tab) {\n      this.currentId = id // store selected item from url\n      this.selectedTab = tab // store selected tab from url\n      return this.communication.request$('getEntityDetails', {\n        onError: error => console.error(error),\n        params: { entityId: id, entitiesListSize: this.bubblesSize }\n      })\n    }\n    else {\n      this.pageTitle = 'EntitÃ  Test'\n    }\n  }\n\n  loadContent(res) {\n    // console.log('(entita) Apollo responded with: ', { res })\n    this.myResponse = res\n    if ((res.fields || []).filter(field => ((this.configuration.get('entita-layout') || {}).overview || {}).campi.includes(field.key)).length > 0) {\n      // look at the response array, filtered by configuration values.\n      // if the filtered response has some values, show the fields section.\n      this.showFields = true\n    } else {\n      this.showFields = false\n    }\n    this.navHeader = { // always render nav header\n      icon: this.configuration.get(\"config-keys\")[this.myResponse.typeOfEntity] ? this.configuration.get(\"config-keys\")[this.myResponse.typeOfEntity].icon : \"\",\n      text: this.myResponse.label,\n      color: this.myResponse.typeOfEntity.replace(/ /g, '-')\n    }\n    this.one('aw-entita-nav').updateOptions({ bubblesEnabled: this.bubblesEnabled });\n    this.one('aw-entita-metadata-viewer').updateOptions({ context: this.selectedTab, labels: this.configuration.get(\"labels\"), config: this.configuration });\n    this.one('aw-entita-metadata-viewer').update(res.fields);\n    if (this.selectedTab == 'oggetti-collegati') {\n      this.one('aw-linked-objects').updateOptions({\n        context: this.selectedTab,\n        config: this.configuration,\n        page: this.currentPage,\n        pagination: true,\n        size: this.pageSize,\n      })\n    } else {\n      this.one('aw-linked-objects').updateOptions({\n        size: 3,\n        config: this.configuration,\n        context: 'entita'\n      })\n    }\n    this.one('aw-linked-objects').update({ items: res.relatedItems });\n    // update head title\n    this.mainState.update('headTitle', `Arianna Web > EntitÃ  > ${this.myResponse.label}`);\n  }\n}","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\n\nexport class AwEntitaLayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n  private configuration: any;\n  private route: any;\n  private entityId: string;\n  // private selectedTab: string;\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-entita-layout.init':\n          this.dataSource.onInit(payload);\n          this.configuration = payload.configuration;\n          this.route = payload.route;\n          this.entityId = this.route.snapshot.params.id || \"\";\n          this.dataSource.currentPage = this.route.snapshot.params.page || 1;\n          this.listenRoute(this.entityId);\n          break;\n\n        case 'aw-entita-layout.destroy':\n          this.destroyed$.next();\n          break;\n\n        case 'aw-entita-layout.showmore':\n          if (payload) {\n            this.dataSource.handleNavUpdate(payload)\n            this.emitGlobal('navigate', {\n              path: [\n                this.configuration.get(\"paths\").entitaBasePath\n                + '/' +\n                this.entityId\n                + '/' +\n                payload\n              ],\n              handler: 'router'\n            });\n          }\n          break;\n\n        default:\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-entita-nav.click':\n          if (payload) {\n            this.dataSource.selectedTab = payload;\n            this.dataSource.handleNavUpdate(payload)\n          }\n          break;\n        case 'aw-linked-objects.pagination':\n          console.log(payload)\n          this.dataSource.currentPage = +payload.split('-')[1];\n          this.dataSource.handlePageNavigation()\n          break\n        case 'aw-linked-objects.goto':\n          console.log(payload)\n          this.dataSource.currentPage = +payload.replace('goto-', '')\n          this.dataSource.handlePageNavigation()\n          break\n        case 'aw-linked-objects.change': // changed page size value (pagination)\n          this.dataSource.pageSize = payload;\n          this.dataSource.currentPage = 1 // reset page\n          let options = {\n            context: this.dataSource.selectedTab,\n            config: this.dataSource.configuration,\n            page: this.dataSource.currentPage,\n            pagination: true,\n            size: this.dataSource.pageSize,\n          }\n          this.dataSource.updateComponent(\n            'aw-linked-objects',\n            { items: this.dataSource.myResponse.relatedItems },\n            options\n          )\n          break;\n        case \"aw-bubble-chart.bubble-tooltip-goto-click\":\n          if (!payload || !payload.entityId) return;\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [`aw/entita/${payload.entityId}`]\n          });\n          break;\n        case 'aw-bubble-chart.bubble-filtered':\n          if (this.dataSource.selectedTab == \"overview\" || this.dataSource.selectedTab == \"entita-collegate\") {\n            this.emitOuter('filterbubbleresponse', payload.relatedEntities);\n          }\n          break;\n        case 'aw-linked-objects.click':\n          const paths = this.configuration.get('paths');\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [payload.type == undefined ? paths.schedaBasePath : paths.entitaBasePath, payload.id]\n          });\n          break;\n        default:\n          break;\n      }\n    })\n\n  }\n\n  /**\n   * Listens to routing events of this layout.\n   */\n  private listenRoute(selectedItem = \"\", forceReload = false) {\n    // get URL parameters with angular's paramMap\n    this.route.paramMap.subscribe(params => {\n      // look for id\n      if (params.get('id')) {\n        if (this.dataSource.currentId == params.get('id') && !forceReload) return;\n        // get item from response with id === id and return as promise\n        this.dataSource.loadItem(params.get('id'), params.get('tab')).subscribe(res => {\n          if (res) {\n            this.dataSource.loadContent(res);\n            // remove the entity of this page\n            const entities = res.relatedEntities.filter(entity => entity.id !== params.get('id'))\n            this.dataSource.updateWidgets(res);\n            if (selectedItem) {\n              this.emitOuter('selectItem', selectedItem);\n            }\n            this.emitOuter('filterbubbleresponse', entities);\n          }\n        });\n      } else {\n        this.dataSource.loadItem();\n      }\n    });\n  }\n}","export default {\n  prettifySnakeCase(key: string, label?: string) {\n    if (label) {\n      return label;\n    }\n    return (key || '').split('_').map((word, index) => index === 0 ? this.ucFirst(word) : word).join(' ');\n  },\n  ucFirst(str: string) {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n  }\n};\n","import { DataSource } from '@n7-frontend/core';\nimport helpers from '../../common/helpers';\nimport { get as _get } from 'lodash'; // used for cherry-picking object keys from app-config.json\n\nexport class AwLinkedObjectsDS extends DataSource {\n\n  public currentPage: number;\n  public totalPages: number;\n  public totalObjects: number;\n  public pageSize: number;\n  public context: string;\n  public loadedData: any;\n  public loadingData = false;\n  public paths: any; // use dynamic object paths from config\n\n  protected transform(data) {\n    this.paths = this.options.config.get('item-preview');\n    this.pageSize = this.options.size;\n    this.totalObjects = data.totalCount;\n    this.currentPage = this.options.page ? +this.options.page : 1;\n    if (this.options.dynamicPagination && this.options.dynamicPagination.total) {\n      this.totalPages = Math.ceil(this.options.dynamicPagination.total / this.pageSize);\n    } else if (data.items) {\n      this.totalPages = Math.ceil(data.items.length / this.pageSize);\n    } else if (data.relatedItems) {\n      this.totalPages = Math.ceil(data.relatedItems.length / this.pageSize);\n    }\n    this.context = this.options.context;\n    this.loadedData = this.unpackData(data);\n    if (this.options.pagination) {\n      this.addPagination(this.currentPage, this.totalPages, this.pageSize);\n    }\n    this.checkForMore(); // checks if <Show More> button should be enabled\n    this.loadedData.loaderData = {};\n    return this.loadedData;\n  }\n\n  public checkForMore = (force?: boolean) => {\n    /*\n      Checks if it is possible to load more item previews.\n      Can receive a boolean argument to force the button to be\n      enabled or disabled. (Used while data is loading)\n    */\n    if (!this.loadedData.actions) {\n      // if not using actions, don't check\n      return;\n    }\n    if (typeof force !== 'undefined') {\n      this.loadedData.actions[1].disabled = !force;\n      return;\n    }\n    if (this.loadedData.result.length >= this.totalObjects) {\n      this.loadedData.actions[1].disabled = true;\n    } else {\n      this.loadedData.actions[1].disabled = false;\n    }\n    return;\n  }\n\n  public handleIncomingData = incomingData => {\n    /*\n      Called by infinite scroller, adds the incoming\n      data to the linked objects component.\n    */\n    this.currentPage += 1;\n    const newData: any = this.unpackData(incomingData.itemsPagination);\n    this.loadedData.result = this.loadedData.result.concat(newData.result);\n    this.checkForMore();\n    this.loadedData.isLoading = false;\n  }\n\n  public addPagination = (page, totalPages, size) => {\n    const sizeOptions = [10, 25, 50];\n    this.loadedData.pagination = {\n      first: { payload: `goto-${1}`, classes: page === 1 ? 'is-disabled' : '' },\n      prev: { payload: `goto-${page / 1 - 1}`, classes: page === 1 ? 'is-disabled' : '' },\n      next: { payload: `goto-${page / 1 + 1}`, classes: page === totalPages ? 'is-disabled' : '' },\n      last: { payload: `goto-${totalPages}`, classes: page === totalPages ? 'is-disabled' : '' },\n      links: this.makePagination(totalPages, page),\n      select: {\n        label: 'Numero di risultati',\n        options: sizeOptions.map(o => {\n          return {\n            text: o,\n            selected: o === size,\n          };\n        }),\n        payload: 'select-size'\n      },\n      // previews: result\n    };\n  }\n\n  public makePagination = (totalPages, currentPage) => {\n    /*\n      Called by this.unpackData() when this.options.page is defined.\n      Returns the data for <n7-pagination> component.\n    */\n    const result = [];\n    let limit = this.paths.paginationLimit - 1;\n\n    if (totalPages <= limit) {\n      limit = totalPages - 1;\n    }\n\n    // always push the first page\n    if (limit) {\n      let lastPage: number, firstPage: number;\n      if (currentPage > Math.floor(limit / 2)) {\n        if (totalPages === 2) {\n          lastPage = totalPages;\n          firstPage = 1;\n          // when currentPage is after half-point\n          // (example: [ 14 ][ 15 ][!16!][ 17 ][ 18 ])\n        } else if (currentPage < (totalPages - Math.floor(limit / 2))) {\n          lastPage = currentPage / 1 + Math.floor(limit / 2);\n          firstPage = currentPage / 1 - Math.floor(limit / 2);\n        } else {\n          lastPage = totalPages;\n          firstPage = currentPage - limit + (totalPages - currentPage);\n        }\n      } else {\n        // when currentPage is before half-point\n        // (example: [ 1 ][!2!][ 3 ][ 4 ][ 5 ])\n        lastPage = limit + 1;\n        firstPage = 1;\n      }\n\n      for (let i = firstPage; i <= lastPage; i++) {\n        result.push({\n          text: String(i),\n          payload: 'page-' + String(i),\n          classes: currentPage === i ? 'is-active' : ''\n        });\n      }\n    } else {\n      result.push({\n        text: '1',\n        payload: 'page-1',\n        classes: currentPage === 1 ? 'is-active' : ''\n      });\n      for (let i = 1; i < totalPages; i++) {\n        result.push({ text: String(i + 1), payload: 'page-' + String(i + 1), classes: currentPage === i + 1 ? 'is-active' : '' });\n      }\n    }\n    return result;\n  }\n\n  private unpackData = data => {\n    /*\n      Dynamically returns the data object for each HTML component\n      data: {\n        previews: [ breadcrumbs: { items[] }, classes, image, metadata, payload, title ],\n        pagination: { first, last, links, next, prev, select }\n      }\n    */\n    const\n      config = this.options.config,       // app-config.json\n      paths = config.get('item-preview'), // item preview dynamic paths\n      totalCount = data.totalCount,       // total amount of items available on backend\n      totalPages = this.totalPages,       // calculated number of pages\n      page = this.currentPage,            // current page (if using pagination)\n      context = this.context,             // parent layout name\n      size = this.pageSize,               // items per page (if using pagination)\n      labels = config.get('labels'),\n      { dynamicPagination } = this.options,\n      keys = config ? config.get('config-keys') : {};\n    let\n      lengthLimit: null,\n      resultsLimit: null,\n      d = data.items ? data.items : data.relatedItems; // items to iterate over\n\n    if (config) {\n      // dynamic search for max-item-length\n      if (config.get(context + '-layout')) {\n        lengthLimit = config.get(context + '-layout')['max-item-length'];\n        resultsLimit = config.get(context + '-layout')['results-limit'];\n      }\n    }\n    // resize data\n    if (!dynamicPagination && size && page) {\n      d = d.slice(page * size - size, page * size);\n    } else if (size) {\n      d = d.slice(0, size);\n    }\n\n    const result = [];\n    const enabledKeys = paths.metadata.info.selection.map(info => info.key);\n    d.forEach(el => {\n      const infoData = _get(el, paths.metadata.info.data, el.item.fields),\n        infoDataItems = infoData ? infoData.filter(data => enabledKeys.indexOf(data.key) !== -1) : [],\n        toeData = _get(el, paths.metadata.toe.data, el.relatedTypesOfEntity),\n        breadcrumbs = _get(el, paths.metadata.breadcrumbs.data, el.breadcrumbs),\n        item = {\n          image: _get(el, paths.image, el.image),\n          title:\n            // if there is a max string length in config, use it\n            +paths.title.maxLength && _get(el, paths.title, el.item.label).length > +paths.title.maxLength ?\n              _get(el, paths.title, el.item.label).slice(0, +paths.title.maxLength) + 'â¦' :\n              _get(el, paths.title, el.item.label),\n          text: !paths.text ? null : // make text block (in config) optional\n            +paths.text.maxLength && _get(el, paths.text.data, el.item.text).length > +paths.text.maxLength ?\n              _get(el, paths.text.data, el.item.text).slice(0, +paths.text.maxLength) + 'â¦' :\n              _get(el, paths.text.data, el.item.text),\n          payload: { id: _get(el, paths.payload, el.item.id), type: el.item.typeOfEntity },\n          classes: ['entita', 'search'].includes(context) ? 'is-fullwidth' : '',\n          metadata: infoDataItems.length || toeData ? [] : null,\n          breadcrumbs: null\n        };\n      // metadata\n      if (infoDataItems.length) {\n        item.metadata.push({\n          classes: 'n7-objects__metadata-artist',\n          items: infoDataItems.map(data => ({\n            label: helpers.prettifySnakeCase(data.key, labels[data.key]),\n            value: data.value\n          }))\n        });\n      }\n      if (toeData) {\n        item.metadata.push({\n          classes: 'n7-objects__metadata-linked',\n          items: toeData.map(toe => {\n            return { // persona: 6, Organizz: 12, Luoghi: 2, Concetti: 32\n              value: _get(toe, paths.metadata.toe.value, toe.count),\n              // icon: 'n7-icon-bell' // TODO: link icon to config key\n              icon: keys[\n                _get(toe, paths.metadata.toe.icon, toe.type).replace(' ', '-')]\n                ? keys[_get(toe, paths.metadata.toe.icon, toe.type).replace(' ', '-')].icon\n                : '',\n              classes: 'color-' + _get(toe, paths.metadata.toe.icon, toe.type).replace(' ', '-')\n            };\n          })\n        });\n      }\n      // breadcrumbs\n      if (breadcrumbs) {\n        item['breadcrumbs'] = { // n7-breadcrumbs uses this as it's own data\n          items: _get(el, paths.metadata.breadcrumbs.data, el.breadcrumbs).map(crumb => {\n            return {\n              label: _get(crumb, paths.metadata.breadcrumbs.label, crumb.label),\n              payload: _get(crumb, paths.metadata.breadcrumbs.payload, crumb.link),\n            };\n          })\n        };\n      }\n      result.push(item);\n    });\n    if (context === 'home') {\n      const actions = [\n        {\n          label: 'Mostra Tutti (' + totalCount + ')'\n        },\n        lengthLimit ?\n          {\n            label: 'Mostra Altri (' + resultsLimit + ')',\n            disabled: false,\n          } : null,\n      ];\n      return {\n        result,\n        actions,\n        isLoading: false,\n        fallback: config.get('home-layout')['linked-objects-fallback']\n      };\n    }\n    return { previews: result };\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwAutocompleteWrapperDS extends DataSource {\n\n  protected transform(data) {\n    const { key, response } = data\n    const regex = new RegExp('(.*?)' + key + '(.*)', 'i') // 'i' = case insensitive\n    const suggestion = []\n    const config = this.options.config\n    const maxLength = config.get('home-layout')['max-item-length'] / 2\n    const fResults = response.results.filter(el => typeof el.entity == 'object')\n\n    fResults.forEach(el => {\n      if (el.entity.id == 'fallback') { // build and return fallback data\n        suggestion.push({\n          match: '',\n          payload: 'fallback-simple-autocomplete',\n          prefix: el.entity.label,\n          suffix: ''\n        })\n        return { suggestion }\n      }\n      // divide prefix and suffix\n      let match = regex.exec(el.entity.label)\n      if (match) {\n        let prefix = match[1]\n        let suffix = match[2]\n        // string manipulation\n        if (maxLength && (prefix.length > maxLength)) {\n          prefix = '...' + prefix.slice(prefix.length - maxLength, prefix.length)\n        }\n        if (maxLength && (suffix.length > maxLength)) {\n          suffix = suffix.slice(0, maxLength) + '...'\n        }\n        suggestion.push({\n          match: match.input.slice(match[1].length, match[1].length + key.length),\n          prefix,\n          suffix,\n          payload: el.entity.id\n        })\n      }\n    });\n    return { suggestion }\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport tippy, { createSingleton } from 'tippy.js';\n\nexport class AwBubbleChartDS extends DataSource {\n  public chartData: any = []      // data rendered into the graph\n  public draw: any = null;        // exposed component draw function to update the view\n  public selected: string[] = []  // list of selected bubbles\n  public filters: any[] = []      // list of active filters to show only some TypeOfEntity(s)\n  public closedEyes: any[] = []\n  public tippyList: any[] = []    // list of tippy instances\n  public focusedBubble: string    // id of the focused bubble\n\n  protected transform(data) {\n    const { config } = this.options\n    const { fontRendering, transition, shuffle } = config.get('bubble-chart')\n    const domain = [], range = []\n    const colorConfig = config.get('config-keys')\n\n    Object.keys(colorConfig).forEach(k => {\n      domain.push(k.replace(/-/g, ' '))\n      range.push(((colorConfig[k] || {}).color || {}).hex)\n    })\n\n    const commonParams = {\n      containerId: 'bubbleChartContainer',\n      setDraw: draw => this.draw = draw,\n      colorMatch: { domain, range },\n      selected: this.selected,\n      sizeRange: [.5, 500],\n      fontRendering,\n      height: 500,\n      width: 500,\n      transition,\n      shuffle,\n    }\n    /*\n      Two data streams are ouputted.\n      The default stream is for the normal visualization,\n      \"smallView\" is used for a compressed view of the same data.\n    */\n    return {\n      ...commonParams,\n      data: this.smartSlice(data),\n      smallView: {\n        ...commonParams,\n        data: this.smartSlice(data, this.options.smallChartSize),\n      },\n    }\n  }\n\n  updateChart = res => {\n    /*\n      Redraws the graph with the incoming data.\n      \"res\" should be Apollo's \"response.entitiesData\".\n      When res is passed as null, the chart is rendered with the previous data.\n    */\n    if (res === null) {\n      res = this.chartData\n    } else {\n      this.chartData = res\n    }\n    if (this.filters.length > 0) { // apply filters to the response\n      res = this.chartData.filter(el => !this.filters.includes(el.entity.typeOfEntity.replace(/ /g, '-')))\n    }\n    if (!this.draw) {\n      this.update(this.smartSlice(res)) // component self-update\n    } else {\n      this.output.selected = this.selected;\n      this.output.data = this.smartSlice(res);\n      this.output.smallView.data = this.smartSlice(res, this.options.smallChartSize);\n      this.draw()\n    }\n  }\n\n  smartSlice = (d, length?) => {\n    const l = length ? length : this.options.limit\n    if (l && l < d.length) {\n      return d.slice(0, l)\n    } else {\n      return d\n    }\n  }\n\n  handleBubbleClick = payload => {\n    /*\n      Toggles the selection of the clicked bubble.\n    */\n    const id = payload\n    if (this.selected.includes(id)) {\n      this.selected.splice(this.selected.indexOf(id), 1) // remove selection\n    } else {\n      this.selected.push(id) // add selection\n    }\n  }\n\n  tippyMaker = bubbles => {\n    // flush existing tooltips\n    this.tippyList.forEach(t => { if (t) { t.destroy() } })\n    this.tippyList = []\n\n    const buildTooltip = bubble => {\n      let element = <Element>document.getElementsByClassName('bubble-chart__tippy-template')[0].cloneNode(true)\n      let gotoButton = element.getElementsByClassName('aw-bubble-popup-menu__text')[0]\n      gotoButton.innerHTML =\n        `Ã collegato a ${bubble.count} entitÃ `\n      element.getElementsByClassName('aw-bubble-popup-menu__title')[0].innerHTML =\n        `${bubble.entity.label}`\n      let selectButton = element.getElementsByClassName('aw-bubble-popup-menu__link')[1]\n      if (this.options.simple) {\n        if (selectButton) selectButton.remove()\n      } else {\n        let toggleBubbleText = this.selected.includes(bubble.entity.id) ? `Deseleziona` : `Seleziona`\n        selectButton.innerHTML = toggleBubbleText\n      }\n      // console.log(element)\n      return element.innerHTML\n    }\n    const focusBubble = id => {\n      this.focusedBubble = id\n    }\n\n    if (this.filters.length > 0) { // apply filters to the data before adding tooltips\n      bubbles = bubbles.filter(el => !this.filters.includes(el.entity.typeOfEntity.replace(/ /g, '-')))\n    }\n    // make new tooltips\n    bubbles.forEach(b => {\n      let el = document.getElementById(b.entity.id)\n      let group = el ? el.parentElement : false // selects a <g> element\n      if (group) {\n        this.tippyList.push( // add this tippy to the array of instances\n          tippy(group, {\n            content: buildTooltip(b),\n            interactive: true,\n            appendTo: document.body, // suppress interactive warning\n            arrow: true,\n            flip: false,\n            theme: 'light-border no-padding',\n            placement: 'top',\n            delay: [150, 30],\n            updateDuration: 400,\n            onMount() {\n              focusBubble(b.entity.id)\n            }\n          })\n        )\n      }\n    });\n\n    // createSingleton(this.tippyList, {\n    //   interactive: true,\n    //   appendTo: document.body, // suppress interactive warning\n    //   arrow: true,\n    //   flip: false,\n    //   theme: 'light-border no-padding',\n    //   placement: 'top',\n    //   delay: [150, 30],\n    //   updateDuration: 400,\n    // onTrigger(ref) {\n    //   console.log({ref})\n    //   console.log('fired')\n    // }\n    // })\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwHeroDS extends DataSource {\n  public currentInputValue: string = ''\n\n  protected transform(data){\n    const { title, text, button, backgroundImage, input } = data;\n    return {\n      title,\n      text,\n      backgroundImage,\n      button: {\n        text: button.text,\n        payload: 'cerca'\n      },\n      input: {\n        placeholder: input.placeholder,\n        payload: \"cerca-in-maxxi\"\n      }\n    };\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport { TABLE_MOCK } from '@n7-frontend/components';\n\nexport class AwTableDS extends DataSource {\n\n  protected transform(data){\n    return TABLE_MOCK;\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwHomeHeroPatrimonioDS extends DataSource {\n\n  protected transform(data) {\n    const { title, backgroundImage, image, text, button } = data;\n\n    return {\n      title,\n      backgroundImage,\n      image,\n      text,\n      button: {\n        text: button.text,\n        payload: \"naviga-patrimonio\"\n      }\n    };\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport tippy from 'tippy.js';\n\nexport class AwHomeFacetsWrapperDS extends DataSource {\n  private autoComplete = {}; // autocomplete data for each facet\n  public lockedFacets = {}   // locked means that the eye cannot be closed\n  public lastData = {}       // store the last response so the component can be rendered again with the same data\n  public closedEyes = []     // list of closed eyes\n  public openTippy = ''      // tipe of entity of the currently open tippy\n\n  protected transform(data) {\n    this.lastData = data\n    const headers: any[] = [];\n    const inputs: any[] = [];\n    const facetData = data\n    const lockedFacets = this.lockedFacets // locked means that the eye cannot be closed\n    const closedEyes = this.closedEyes     // list of closed eyes\n\n    // when facet data changes, destroy every tippy and reset autocomplete data.\n    Object.keys(this.autoComplete).forEach(id => {\n      if (this.autoComplete[id] && this.autoComplete[id].tippy) {\n        this.autoComplete[id].tippy.destroy() // destroy\n      }\n    })\n    this.autoComplete = {} // reset data\n\n    facetData.forEach((facet, j) => {\n      /*\n       For each facet on back-end, push a header-component\n       and a facet-component (search input only) to each array.\n       ---//---\n       # LOGIC:\n       Each facet can be \"locked\" or \"enabled\".\n       if a facet is locked, it means that it cannot be enabled or disabled.\n       if a facet is enabled or disabled it means that the filter is active or inactive.\n\n       there are 2 ways that a facet can be \"locked\"\n         1. When a bubble of the same type is selected in the chart\n         2. When that facet is the only enabled facet\n\n       The first case is managed by pushing the selected bubble's ID to the corresponding array\n       of lockedFacets.\n       The second case is managed by pushing a \"LOCK_LAST\" string to the lockedFacets array of the last\n       enabled facet.\n      */\n      Object.keys(lockedFacets).forEach(key => {\n        // clear all locked facets arrays from \"LOCK_LAST\" values (reset all locks)\n        let index = lockedFacets[key].indexOf('LOCK_LAST')\n        if (index >= 0) {\n          lockedFacets[key].splice(index, 1)\n        }\n      })\n      if (closedEyes) {\n        if (closedEyes.length == facetData.length - 1) {\n          let lastFacet = facetData.find(f => !closedEyes.includes(f.type.replace(/ /g, '-')))\n          if (lastFacet) {\n            if (closedEyes[lastFacet.type]) {\n              lockedFacets[lastFacet.type].push('LOCK_LAST')\n            } else {\n              lockedFacets[lastFacet.type] = ['LOCK_LAST']\n            }\n          }\n        }\n        if (closedEyes.includes(facet.type.replace(/ /g, '-'))) { // check if the eyes are open\n          facet.enabled = false;\n        } else {\n          facet.enabled = true;\n        }\n      }\n      if (Object.keys(lockedFacets).length) { // check if bubble chart wants to lock this facet\n        if (lockedFacets[facet.type] && lockedFacets[facet.type].length > 0) {\n          // if bubble chart say lock this facet, lock it\n          facet.locked = true;\n        } else {\n          facet.locked = false;\n        }\n      } else {\n        facet.locked = false;\n      }\n      const headerClasses = [];\n      const iconClasses = [facet.icon];\n      if (!facet.enabled) { headerClasses.push('is-disabled'); }\n      if (facet.configKey) {\n        headerClasses.push(`color-${facet.configKey}`);\n        iconClasses.push(`color-${facet.configKey}`);\n      }\n      // make array of headers data\n      headers.push({\n        iconLeft: iconClasses.join(' '),\n        text: facet.label,\n        additionalText: facet.count,\n        iconRight: facet.enabled ? 'n7-icon-eye' : 'n7-icon-eye-slash',\n        classes:\n          headerClasses.join(' ') +\n          (facet.locked\n            ? ' is-blocked'\n            : ' not-blocked'),\n        payload: facet.locked === true ? null : facet.type.replace(/ /g, '-')\n      });\n      // make array of inputs data\n      inputs.push({\n        sections: [\n          {\n            inputs: [\n              {\n                id: `${facet.type.replace(/ /g, '-')}-${j}`,\n                type: 'text',\n                placeholder: facet['input-placeholder'],\n                icon: 'n7-icon-search',\n                disabled: !facet.enabled,\n                inputPayload: String(facet.type.replace(/ /g, '-')) + '-search',\n                iconPayload: String(facet.type.replace(/ /g, '-')) + '-search',\n                enterPayload: String(facet.type.replace(/ /g, '-')) + '-search',\n                classes: String(facet.type.replace(' ', '-')) + '-search'\n              }\n            ]\n          }\n        ]\n      });\n    });\n\n    // zipping arrays to render widgets with separate data (see home-layout.html)\n    const widgetData: any[] = [];\n    headers.map((h, i) => {\n      widgetData.push({ header: h, input: inputs[i] });\n    });\n    return widgetData;\n  }\n\n  public tippyMaker = (res, id) => {\n    /*\n      Builds or updates Tippy for the input in use (id)\n    */\n    id = id.replace(/ /g, '-')\n    // create data for this facet\n    if (!this.autoComplete[id]) {\n      this.autoComplete[id] = {\n        tippy: undefined, // tippy data / config\n        open: true // show or hide tippy\n      };\n      const ac = this.autoComplete[id];\n      const getContent = () => {\n        const contentNode = document.getElementsByClassName(\n          'aw-simple-autocomplete__template'\n        )[0];\n        contentNode.setAttribute('style', 'display: block');\n        return contentNode;\n      }\n\n      if (!ac.tippy) {\n        const target = document.getElementsByClassName(id)[1]; // target the correct this.autoComplete[id] input class\n        ac.tippy = tippy(target, {\n          content: getContent(),\n          trigger: 'manual',\n          interactive: true,\n          arrow: false,\n          flip: false,\n          appendTo: 'parent',\n          theme: 'light-border aw-home__facet-tippy',\n          placement: 'bottom-start',\n          maxWidth: '100%',\n        }); // attach tippy to input type text\n      }\n    }\n    const ac = this.autoComplete[id];\n    if (res.results.length > 0 && ac.tippy) {\n      ac.tippy.show();\n    } else {\n      ac.tippy.hide();\n    }\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwHomeItemTagsWrapperDS extends DataSource {\n\n  protected transform(data) {\n    return data;\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport helpers from '../../common/helpers';\n\nexport class AwHomeAutocompleteDS extends DataSource {\n  protected transform(data) {\n    const { results, totalCount } = data,\n          { keys, config } = this.options,\n          labels = this.options.labels || {},\n          itemIds = [],\n          groups = {};\n\n    results.forEach(({ item, entity }) => {\n      const groupId = entity ? entity.typeOfEntity.replace(' ', '-') : 'oggetto-culturale',\n        groupConfig = keys[groupId],\n        mainMetadata = groupConfig['main-metadata'],\n        currentItem = item || entity;\n\n      if (!groups[groupId]) {\n        const { label, icon } = groupConfig;\n        groups[groupId] = {\n          title: label,\n          icon,\n          classes: `color-${groupId}`,\n          items: [],\n          type: groupId\n        };\n      }\n\n      if (itemIds.indexOf(currentItem.id) === -1) {\n        const metadata = [];\n        if (currentItem.fields) {\n          currentItem.fields.forEach(({ key, value }) => {\n            if (mainMetadata && key === mainMetadata) {\n              metadata.push({ key: helpers.prettifySnakeCase(key, labels[key]), value });\n            }\n          });\n        }\n        groups[groupId].items.push({\n          title: currentItem.label,\n          metadata,\n          payload: {\n            source: 'item',\n            id: currentItem.id,\n            type: (groups[groupId] || {}).type\n          }\n        });\n      }\n    });\n\n    return {\n      results: Object.keys(groups).map(key => ({\n        group: {\n          title: groups[key].title,\n          icon: groups[key].icon,\n          classes: groups[key].classes\n        },\n        items: groups[key].items\n      })),\n      actions: {\n        showMore: {\n          text: `Visualizza tutti i ${totalCount} risultati`,\n          payload: {\n            source: 'showMore'\n          }\n        }\n      },\n      fallback: ((config.get('home-layout') || {})[\"top-hero\"] || {}).fallback\n    };\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwEntitaNavDS extends DataSource {\n\n  protected transform( param ){\n    if (!param) return;\n    const data = param.data\n    const selected = param.selected\n    const navigation = { items: [], payload: 'entita-nav' }\n\n    navigation.items.push({\n      text: 'OVERVIEW',\n      payload: 'overview',\n      classes: selected == 'overview' ? 'is-selected' : ''\n    })\n    if (data.fields && data.fields.length > 0) {\n      navigation.items.push({\n        text: 'CAMPI',\n        payload: 'campi',\n        classes: selected == 'campi' ? 'is-selected' : ''\n      })\n    }\n    if (data.relatedItems) {\n      navigation.items.push({\n        text: 'OGGETTI-COLLEGATI',\n        payload: 'oggetti-collegati',\n        classes: selected == 'oggetti-collegati' ? 'is-selected' : ''\n      })    }\n    if (data.relatedEntities && this.options['bubblesEnabled']) {\n      navigation.items.push({\n        text: 'ENTITÃ COLLEGATE',\n        payload: 'entita-collegate',\n        classes: selected == 'entita-collegate' ? 'is-selected' : ''\n      })    }\n    if (data.extraTab) {\n      navigation.items.push({\n        text: 'MAXXI',\n        payload: 'maxxi',\n        classes: selected == 'maxxi' ? 'is-selected' : ''\n      })    }\n    if (data.wikiTab) {\n      navigation.items.push({\n        text: 'WIKIPEDIA',\n        payload: 'wiki',\n        classes: selected == 'wiki' ? 'is-selected' : ''\n      })    }\n    return navigation\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport helpers from '../../common/helpers';\n\nexport class AwEntitaMetadataViewerDS extends DataSource {\n  protected transform(data) {\n    /*\n      Access and use this.options if the rendering\n      changes based on context.\n    */\n\n    let { context, labels, config } = this.options;\n    labels = labels || {};\n\n    let unpackedData = []\n    if (context == 'overview') {\n      let configuredKeys = ((config.get('entita-layout') || {}).overview || {}).campi\n      let filteredData = data.filter(d => configuredKeys.includes(d.key))\n      unpackedData = AwEntitaMetadataViewerDS.unpackFields(filteredData)\n    } else {\n      unpackedData = AwEntitaMetadataViewerDS.unpackFields(data);\n    }\n    // prettify labels\n    unpackedData.forEach(section => {\n      section.items\n        .filter(item => item.label)\n        .forEach(item => item.label = helpers.prettifySnakeCase(item.label, labels[item.label]));\n    });\n    return {\n      group: unpackedData\n    };\n  }\n\n  // tslint:disable-next-line: member-ordering\n  static unpackFields(fields) {\n    /*\n      Recursive unpacking for rendering res.fields\n      - - -\n      This function transforms the response object tree\n      into an array, usable by metadata-viewer-component\n    */\n    let extracted = []; // holds transformed object\n    // if the server returns an array of key-value tuples\n    if (fields instanceof Array) {\n      extracted = fields.map(el => {\n        return { label: el.key, value: el.value };\n      });\n      return [{ items: extracted }];\n    }\n    if (!fields) { return []; } // if is empty â quit\n    for (let i = 0; i < fields.length; i++) {\n      const thisField = fields[i]; // rename current field\n      const title = thisField.label; // field title\n      const label = thisField.key; // item label\n      const value = thisField.value; // item value\n      const group = thisField.fields; // child group\n      const temp: any = {}; // temporary object\n\n      if (title) {\n        // if there is a title, use it\n        temp.title = title;\n      }\n      if (label && value) {\n        // if there are a lable and value, use them\n        temp.label = label;\n        temp.value = value;\n      }\n      if (group) {\n        // if there is a child group\n        if (group[0].key) {\n          // if this group has a tuple of (label, value)\n          temp.items = AwEntitaMetadataViewerDS.unpackFields(group); // make items array\n        } else {\n          temp.group = AwEntitaMetadataViewerDS.unpackFields(group); // make child group array\n        }\n      }\n      extracted.push(temp); // add this object to the new array\n    }\n    return extracted;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwTreeDS extends DataSource {\n  static dataCache: any = {};\n  private rootId: string;\n  private currentId: string;\n  private activeId: string;\n\n  protected transform(tree) {\n    if (!tree) {\n      return;\n    }\n    return tree;\n  }\n\n  public load(data) {\n    const { tree } = data;\n    this.rootId = tree.id;\n    // save in cache\n    if (!AwTreeDS.dataCache[this.rootId]) {\n      AwTreeDS.dataCache[this.rootId] = { flatIds: [], flatData: {} };\n      this._normalize(tree);\n    }\n  }\n\n  public build(id) {\n    const path = this._getTreePath(id),\n      oldPath = this._getTreePath(this.currentId),\n      oldPathIndex = oldPath.indexOf(id);\n\n    if (oldPathIndex > 0) {\n      path.splice(oldPathIndex);\n      this.currentId = null;\n    } else if (this.currentId === id) {\n      const idIndex = path.indexOf(this.currentId);\n      path.splice(idIndex);\n      this.currentId = null;\n    } else {\n      this.currentId = id;\n    }\n\n    const tree: any = this._getTree(path);\n    this.update(tree);\n  }\n\n  public setActive(id) {\n    this.activeId = id;\n  }\n\n  public highlightActive() {\n    const control = (items) => {\n      items.forEach(item => {\n        const founded = item.meta === this.activeId,\n          hasActive = item.classes.indexOf('is-active') !== -1;\n\n        // clear is-active\n        if (hasActive && !founded) {\n          const currentClasses = item.classes.split(' ');\n          currentClasses.splice(currentClasses.indexOf('is-active'), 1);\n          item.classes = currentClasses.join(' ');\n        }\n\n        if (founded) {\n          const currentClasses = item.classes.split(' ');\n          if (currentClasses.indexOf('is-active') === -1) {\n            currentClasses.push('is-active');\n          }\n          item.classes = currentClasses.join(' ');\n        }\n\n        if (Array.isArray(item.items) && item.items.length) {\n          control(item.items);\n        }\n      });\n    };\n    control(this.output.items);\n  }\n\n  private _getCachedData = () => {\n    return AwTreeDS.dataCache[this.rootId];\n  }\n\n  private _normalize = ({ id, label, icon, img, branches }) => {\n    const hasBranches = !!(Array.isArray(branches) && branches.length);\n    this._getCachedData().flatData[id] = { id, label, icon, img, hasBranches };\n    if (hasBranches) {\n      branches.forEach(data => {\n        this._getCachedData().flatIds.push([id, data.id]);\n        this._normalize(data);\n      });\n    }\n  }\n\n  private _getParent = (id) => {\n    return this._getCachedData().flatIds\n      .filter(([, childId]) => childId === id)\n      .map(([parentId]) => parentId)[0] || null;\n  }\n\n  private _getTreePath = (id) => {\n    const ids = [id];\n    let currentId = id;\n    while (currentId) {\n      const parentId = this._getParent(currentId);\n      if (parentId) {\n        ids.push(parentId);\n      }\n      currentId = parentId;\n    }\n    return ids.reverse();\n  }\n\n  private _getTree = (path) => {\n    const tree = {};\n    let counter = 0;\n\n    const loadItems = (id, source) => {\n      counter += 1;\n      const nextParent = path[counter];\n      source.items = [];\n\n      this._getCachedData().flatIds\n        .filter(([parentId]) => parentId === id)\n        .forEach(([, childId], index) => {\n          const inPath = childId === nextParent;\n          const item = this._getTreeItem(childId, inPath);\n          source.items.push(item);\n          if (inPath) {\n            loadItems(childId, source.items[index]);\n          }\n        });\n    };\n\n    // init\n    loadItems(path[0], tree);\n    return tree;\n  }\n\n  private _getTreeItem = (id, inPath) => {\n    const { label, icon, img, hasBranches } = this._getCachedData().flatData[id];\n    const defaultIcon = inPath ? 'n7-icon-angle-down' : 'n7-icon-angle-right';\n    const classes = [];\n    if (inPath) {\n      classes.push('is-expanded');\n    }\n    if (this.activeId === id) {\n      classes.push('is-active');\n    }\n    return {\n      classes: classes.join(' '),\n      text: label || null,\n      img: img || null,\n      icon: icon || null,\n      toggle: hasBranches ? {\n        icon: icon || defaultIcon,\n        payload: {\n          source: 'toggle',\n          id: id,\n        }\n      } : null,\n      meta: id,\n      payload: {\n        id,\n        source: 'menuitem',\n      }\n    };\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSidebarHeaderDS extends DataSource {\n\n  protected transform(data) {\n    return data;\n  }\n\n  toggleSidebar() {\n      let sidebarData = this.output;\n      if ( sidebarData.classes == 'is-expanded' ) {\n        sidebarData.classes = 'is-collapsed';\n        sidebarData.iconRight = 'n7-icon-tree-icon';\n\n      } else {\n        sidebarData.classes = 'is-expanded';\n        sidebarData.iconRight = 'n7-icon-angle-left';\n    }\n    this.update(sidebarData);\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSchedaBreadcrumbsDS extends DataSource {\n\n  protected transform(data) {  \n    return data;\n  }\n\n  toggleSidebar() {\n      let sidebarData = this.output;    \n      if ( sidebarData.classes == \"is-expanded\" ) {\n        sidebarData.classes = \"is-collapsed\";\n    } else {\n        sidebarData.classes = \"is-expanded\";\n    }\n    this.update(sidebarData);\n  }\n}","import { DataSource } from \"@n7-frontend/core\";\nimport helpers from \"../../common/helpers\";\n\nexport class AwSchedaMetadataDS extends DataSource {\n  protected transform(data) {\n    let { labels } = this.options;\n    labels = labels || {};\n\n    let group = { group: [] };\n    if (data.fields) {\n      data.fields.forEach(field => {\n        let items = [];\n        if (field.fields) {\n          field.fields.forEach(item => {\n            items.push({ label: helpers.prettifySnakeCase(item.key, labels[item.key]), value: item.value });\n          });\n\n          group.group.push({\n            title: field.label,\n            items: items\n          });\n        } else {\n          items.push({ label: helpers.prettifySnakeCase(field.key, labels[field.key]), value: field.value });\n          group.group.push({\n            items: items\n          });\n        }\n      });\n    }\n    return group;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSchedaImageDS extends DataSource {\n\n  protected transform(data) {\n    return data;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSchedaInnerTitleDS extends DataSource {\n\n  protected transform(data) {\n    return data;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSearchLayoutTabsDS extends DataSource {\n  private selected: string = 'list';\n\n  protected transform(data){\n    return { \n      items: [{\n        text: 'LISTA', \n        payload: 'list',\n        classes: this.selected === 'list' ? 'is-selected' : ''\n      }, {\n        text: 'GRAFICO', \n        payload: 'chart',\n        classes: this.selected === 'chart' ? 'is-selected' : ''\n      }, {\n        text: 'TIMELINE', \n        payload: 'timeline',\n        classes: this.selected === 'timeline' ? 'is-selected' : ''\n      }] \n    }\n  }\n\n  public setSelected(tabId){\n    this.selected = tabId;\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwLinkedObjectsEH extends EventHandler {\n\n  public listen() {\n\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-linked-objects.click':\n          if (typeof payload == 'string') { // click on pagination\n            if (payload.startsWith('page')) {\n              // pagination routing is handled by the parent layout\n              this.emitOuter('pagination', payload)\n            } else if (payload.startsWith('goto')) {\n              let targetPage = +payload.replace('goto-', '')\n              // kill impossible page navigations\n              if (targetPage > this.dataSource.totalPages) return;\n              else if (targetPage < 1 || targetPage === this.dataSource.currentPage) return;\n              else this.emitOuter('goto', payload)\n            }\n          } else { // click on a linked object\n            this.emitOuter('click', payload);\n          }\n          break;\n        case 'aw-linked-objects.change': // changed page size value (pagination)\n          this.emitOuter('change', +payload.value)\n          break;\n        default:\n          console.warn('unhandled event type: ', type, ' with payload: ', payload)\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-home-layout.viewmore':\n          // ask home-layout for more data\n          this.dataSource.checkForMore(false)\n          this.emitOuter('datarequest', {\n            currentPage: this.dataSource.currentPage\n          })\n          break;\n        case 'aw-home-layout.dataresponse':\n          // handle incoming data from home-layout\n          let { res } = payload\n          this.dataSource.handleIncomingData(res)\n        case 'aw-home-layout.scroll':\n          this.handleScroll(payload)\n          break;\n        default:\n          break;\n      }\n    })\n  }\n\n  public handleScroll = target => {\n    const { totalObjects, loadedData } = this.dataSource,\n      loadedTotal = Array.isArray(loadedData.result) ? loadedData.result.length : 0;\n\n    if (loadedTotal >= totalObjects) {\n      return;\n    }\n    /*\n      Check if the target element is scrolled near the end while data is not already loading.\n      If the condition is met, a request for more data is sent.\n    */\n    if (target.scrollTop + target.clientHeight >= target.scrollHeight - 150 && this.dataSource.loadedData.isLoading == false) {\n      this.dataSource.loadedData.isLoading = true\n      this.emitOuter('datarequest', {\n        currentPage: this.dataSource.currentPage\n      })\n    }\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwAutocompleteWrapperEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-autocomplete-wrapper.click':\n          if (payload != 'fallback-simple-autocomplete') { // if this is the fallback item, kill the event.\n            this.emitOuter('clickresult', payload)\n          }\n          break;\n        default:\n          console.warn('unhandled event of type:', type)\n          break;\n      }\n    });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwBubbleChartEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-bubble-chart.click':\n          this.toggleSelection(payload)\n          this.emitOuter('lockfilter', this.dataSource.chartData.find(el => payload == el.entity.id))\n          break;\n        case 'aw-bubble-chart.d3end': // end of d3.js draw()\n          this.dataSource.tippyMaker(this.dataSource.chartData) // make tooltips\n          break;\n        case 'aw-bubble-chart.bubble-tooltip-goto-click':\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [`aw/entita/${this.dataSource.focusedBubble}`]\n          });\n          break;\n        case 'aw-bubble-chart.bubble-tooltip-select-click':\n          this.toggleSelection(this.dataSource.focusedBubble)\n          this.emitOuter('lockfilter', this.dataSource.chartData.find(el => this.dataSource.focusedBubble == el.entity.id))\n          break;\n        default:\n          console.warn('unhandled inner event of type', type, 'with payload', payload)\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-home-layout.tagclick':\n          this.toggleSelection(payload)\n          break;\n        case 'aw-home-layout.facetclick':\n          if (!this.dataSource.selected.includes(payload)) {\n            this.toggleSelection(payload)\n          }\n          break;\n        case 'aw-home-layout.togglefilter':\n          this.toggleFilter(payload)\n          break;\n        case 'aw-home-layout.clearselection':\n          this.dataSource.selected = []\n          this.emitOuter('selection', [])\n          break;\n        case 'aw-scheda-layout.filterbubbleresponse':\n        case 'aw-entita-layout.filterbubbleresponse':\n        case 'aw-home-layout.filterbubbleresponse':\n          this.dataSource.updateChart(payload)\n          break;\n        default:\n          break;\n      }\n    });\n  }\n\n  toggleSelection = id => {\n    /*\n      Expects the ID of a bubble.\n      Updates the graph with a new request\n    */\n    this.dataSource.handleBubbleClick(id)\n    this.emitOuter('selection', this.dataSource.selected)\n  }\n\n  toggleFilter = f => {\n    /*\n      Toggle the clicked filter in the filteres array and\n      redraw the graph.\n    */\n    if (this.dataSource.filters.includes(f)) {\n      this.dataSource.filters.splice(this.dataSource.filters.indexOf(f), 1)\n    } else {\n      this.dataSource.filters.push(f)\n    }\n    this.dataSource.updateChart(null) // null means \"keep using the same response\"\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHeroEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-hero.click':\n          this.emitOuter('click', this.dataSource.currentInputValue);\n          break;\n        case 'aw-hero.change':\n          this.dataSource.currentInputValue = payload\n          this.emitOuter('change', payload);\n          break;\n        case 'aw-hero.enter':\n          this.emitOuter('enter', payload);\n          break;\n\n        default:\n          console.log('(hero) unhandled event of type', type)\n          break;\n      }\n    });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\n\nexport class AwHomeFacetsWrapperEH extends EventHandler {\n\n  private changedInput$: Subject<any> = new Subject()\n\n  public listen() {\n    this.changedInput$.pipe(debounceTime(500)).subscribe(payload => {\n      this.emitOuter('change', payload);\n    })\n\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        // toggle visibility from facet header\n        case 'aw-home-facets-wrapper.click':\n          if (payload === null) { // interrupt event for locked facets\n            break;\n          }\n          this.emitOuter('click', payload);\n          this.handleEyeClick(payload)\n          break;\n        // change search input text\n        case 'aw-home-facets-wrapper.change':\n          this.dataSource.openTippy = payload.inputPayload.replace('-search', '')\n          this.changedInput$.next(payload)\n          break;\n        // pressed return while typing in search\n        case 'aw-home-facets-wrapper.enter':\n          this.emitOuter('enter', payload);\n          break;\n        default:\n          console.warn('unhandled inner event of type:', type);\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-home-layout.facetswrapperresponse': // incoming autocomplete response\n          this.dataSource.tippyMaker(payload.response, payload.facetId.inputPayload);\n          break;\n        case 'aw-home-layout.lockfilter':\n          this.updateFilters(payload)\n          break;\n        case 'aw-home-layout.tagclick':\n          Object.keys(this.dataSource.lockedFacets).forEach(key => {\n            if (this.dataSource.lockedFacets[key].includes(payload)) {\n              this.dataSource.lockedFacets[key].splice(this.dataSource.lockedFacets[key].indexOf(payload), 1)\n            }\n          });\n          this.dataSource.update(this.dataSource.lastData)\n          break;\n        case 'aw-home-layout.clearselection':\n          this.dataSource.lockedFacets = {}\n          this.dataSource.closedEyes = []\n          this.dataSource.update(this.dataSource.lastData)\n          break;\n        case 'aw-home-layout.facetclick':\n          let { openTippy } = this.dataSource\n          if (this.dataSource.lockedFacets[openTippy]) {\n            if (this.dataSource.lockedFacets[openTippy].indexOf(payload) == -1) {\n              this.dataSource.lockedFacets[openTippy].push(payload)\n            }\n          } else {\n            this.dataSource.lockedFacets[openTippy] = [payload]\n          }\n          this.dataSource.update(this.dataSource.lastData)\n          break;\n        default:\n          break;\n      }\n    });\n  }\n\n  handleEyeClick = type => {\n    /*\n      Toggles the status of the selected eye, then reloads the component.\n    */\n    if (this.dataSource.closedEyes) {\n      let i = this.dataSource.closedEyes.indexOf(type)\n      if (i >= 0) { // if the eye was closed\n        this.dataSource.closedEyes.splice(i, 1) // open the eye\n      } else { // if the eye was open\n        this.dataSource.closedEyes.push(type) // close the eye\n      }\n    } else {\n      this.dataSource.closedEyes = [type]\n    }\n    this.dataSource.update(this.dataSource.lastData) // reload the component with the same data\n  }\n\n  updateFilters = selectedBubble => {\n    /*\n      Adds (or removes) the ID of the selected bubble from the array of that type of entity.\n      Example:\n        â¢ Click on bubble \"0263a407-d0dd\" of type \"org\"\n        â¢ Add \"0263a407-d0dd\" to array \"org\".\n      Result:\n        â¢ lockedFacets = { \"org\":[ \"0263a407-d0dd\" ] }\n    */\n    selectedBubble.entity.id.replace(/ /g, '-') // fix for space in ID\n    const { id, typeOfEntity } = selectedBubble.entity // payload is the selected bubble\n    if (!this.dataSource.lockedFacets[typeOfEntity]) {\n      this.dataSource.lockedFacets[typeOfEntity] = []\n    }\n    if (this.dataSource.lockedFacets[typeOfEntity].includes(id)) {\n      let i = this.dataSource.lockedFacets[typeOfEntity].indexOf(id)\n      this.dataSource.lockedFacets[typeOfEntity].splice(i, 1)\n    } else {\n      this.dataSource.lockedFacets[typeOfEntity].push(id)\n    }\n    this.dataSource.update(this.dataSource.lastData) // reload the component with the same data\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHomeHeroPatrimonioEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-home-hero-patrimonio.click':\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: ['aw/patrimonio']\n          });\n          break;\n        default:\n          break;\n      }\n    });\n    /*\n    this.outerEvents$.subscribe(event => {\n      \n    });\n    */\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHomeItemTagsWrapperEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe( (event) => {\n      switch(event.type){\n        case \"aw-home-item-tags-wrapper.click\":\n          this.emitOuter('click',event.payload);\n          break;\n        default:\n          break;\n      }\n    });\n    /* this.outerEvents$.subscribe(event => {\n    \n    }); */\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHomeAutocompleteEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case \"aw-home-autocomplete.click\":\n          this.emitOuter('click', payload);\n          break;\n          \n        default:\n          break;\n      }\n    });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwEntitaNavEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({type, payload}) => {\n      switch(type) {\n        case 'aw-entita-nav.click':\n          this.emitOuter('click', payload)\n          break;\n        default:\n          console.warn('unhandled event type')\n          break;\n      }\n    });\n    /*\n\n    this.outerEvents$.subscribe(event => {\n      \n    });\n    */\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwSchedaSidebarEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {   \n      if( type == 'aw-sidebar-header.click'){\n        this.dataSource.toggleSidebar();\n        this.emitOuter(type, payload);\n      }\n    });\n\n    /* this.outerEvents$.subscribe(event => {\n    \n    }); */\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwSidebarHeaderEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {   \n      if( type == 'aw-sidebar-header.click'){\n        this.dataSource.toggleSidebar();\n        this.emitOuter('click', payload);\n      }\n    });\n\n    /* this.outerEvents$.subscribe(event => {\n    \n    }); */\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwTreeEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (payload.source) {\n        case 'toggle':\n          this.dataSource.build(payload.id);\n          break;\n        case 'menuitem':\n          this.dataSource.setActive(payload.id);\n          this.dataSource.highlightActive();\n          this.emitOuter('click', payload.id);\n          break;\n        default:\n          break;\n      }\n    });\n\n     this.outerEvents$.subscribe(({ type, payload }) => {\n        switch ( type ) {\n          case 'aw-sidebar-header.click':\n            this.dataSource.toggleSidebar();\n            break;\n          case 'aw-scheda-layout.selectItem':\n            this.dataSource.build(payload);\n            break;\n          case 'aw-scheda-layout.navigationresponse':\n            if (payload.currentItem) {\n              this.dataSource.setActive(payload.currentItem);\n            }\n            const currentId = payload.currentItem || payload.tree.id;\n            this.dataSource.load(payload);\n            this.dataSource.build(currentId);\n            break;\n          }\n      });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwSearchLayoutTabsEH extends EventHandler {\n\n  public listen() {\n    // TODO\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwTableEH extends EventHandler {\n\n  public listen() {\n    /*\n    this.innerEvents$.subscribe(event => {\n      \n    });\n\n    this.outerEvents$.subscribe(event => {\n      \n    });\n    */\n  }\n\n}","import { AwEntitaLayoutDS } from './entita-layout.ds';\nimport { AwEntitaLayoutEH } from './entita-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const AwEntitaLayoutConfig = {\n  layoutId: 'aw-entita-layout',\n  widgets: [ // array of components of this layout\n    { id: 'aw-entita-nav', hasStaticData: true},\n    { id: 'aw-entita-metadata-viewer' },\n    { id: 'aw-linked-objects'},\n    { id: 'aw-bubble-chart'},\n  ],\n  layoutDS: AwEntitaLayoutDS,\n  layoutEH: AwEntitaLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Location } from '@angular/common';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { Title } from '@angular/platform-browser';\nimport { AbstractLayout } from \"../../../common/models/abstract-layout\";\nimport { ConfigurationService } from '../../../common/services/configuration.service';\nimport { LayoutsConfigurationService } from '../../../common/services/layouts-configuration.service';\nimport { MainStateService } from '../../../common/services';\nimport { AwEntitaLayoutConfig as config } from './entita-layout.config';\nimport { CommunicationService } from '../../../common/services';\n\n@Component({\n  selector: 'aw-entita-layout',\n  templateUrl: './entita-layout.html'\n})\nexport class AwEntitaLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private location: Location,\n    private configuration: ConfigurationService,\n    private layoutsConfiguration: LayoutsConfigurationService,\n    private communication: CommunicationService,\n    private mainState: MainStateService,\n    private titleService: Title\n  ) {\n    super(layoutsConfiguration.get('AwEntitaLayoutConfig') || config);\n  }\n\n  /*\n    Optional variables that can be accessed from the layout's logic.\n    If removed, they must also be removed from the layout's DataSource file,\n    and from this file imports.\n   */\n  protected initPayload() {\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      router: this.router,\n      route: this.route,\n      location: this.location,\n      titleService: this.titleService,\n      communication: this.communication,\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit() {\n    this.onInit();\n  }\n\n  ngOnDestroy() {\n    this.onDestroy();\n  }\n}","import { LayoutDataSource } from '@n7-frontend/core';\nimport { Subject, forkJoin, fromEvent } from 'rxjs';\nimport { debounceTime, takeUntil } from 'rxjs/operators';\n\nexport class AwHomeLayoutDS extends LayoutDataSource {\n    private communication: any;\n    private mainState: any;\n    private tippy: any;\n    private configuration: any;\n    private facetInputs: any = {};\n    private autocompletePopover: any;\n    private autocompletePopoverOpen: boolean = false;\n    private autocompleteChanged$: Subject<string> = new Subject();\n    public numOfItemsStr: string = null;\n    public currentHoverEntity: any = null;\n    public hasScrollBackground: boolean = false;\n    public resultsLimit = -1;\n    public selectedEntitiesIds = [];\n    public outerLinks: any;\n    public outerLinksTitle: string;\n    public homeAutocompleteQuery: string;\n    private destroyed$: Subject<any> = new Subject();\n    // BUBBLE CHART DATA â\n    public bubblesEnabled: boolean = false; // true if this Arianna Web project has the bubble chart module\n    public selectedBubbles: any[] = []      // array of IDs\n    public lastBubbleResponse: any          // store last bubble response to refresh the graph with the same data\n    public firstBubbleResponse: any         // store the first array of bubbles, to find them in case of zero results (entities data returned as empty array from backend)\n    // BUBBLE CHART DATA â\n    public homeAutocompleteIsLoading = false;\n\n    onInit({ communication, mainState, configuration, tippy }) {\n        this.communication = communication;\n        this.configuration = configuration;\n        // this.facetData = [];\n        this.mainState = mainState;\n        this.tippy = tippy;\n        this.resultsLimit = this.configuration.get('home-layout')['results-limit']\n        this.bubblesEnabled = this.configuration.get('features-enabled') ? this.configuration.get('features-enabled')['bubblechart'] : false;\n        this.one('aw-hero').update(this.configuration.get('home-layout')['top-hero']);\n        this.one('aw-home-hero-patrimonio').update(this.configuration.get('home-layout')['bottom-hero']);\n        // update streams\n        this.mainState.update('headTitle', 'Arianna Web > Home');\n        this.mainState.update('pageTitle', 'Arianna Web: Home Layout');\n        this.mainState.updateCustom('currentNav', 'aw/home');\n        // listen autocomplete changes\n        this._listenAutoCompleteChanges();\n        this.outerLinks = this.configuration.get('home-layout')['outer-links']['test'];\n        this.outerLinksTitle = this.configuration.get('home-layout')['outer-links']['title'];\n        this.one('aw-bubble-chart').updateOptions({ config: this.configuration, limit: this.configuration.get('bubble-chart').bubbleLimit })\n    }\n\n    onDestroy(){\n        this.destroyed$.next()\n    }\n\n    public makeRequest$(query, params) {\n        // make request from EH\n        return this.communication.request$(query, {\n            onError: (error) => console.error(error),\n            params\n        });\n    }\n\n    public updateComponent = (id, data, options?) => {\n        // update components from EH\n        if (options) {\n            this.one(id).updateOptions(options)\n        }\n        this.one(id).update(data)\n    }\n\n    initialFilterRequest() {\n        return this.communication.request$('globalFilter', {\n            onError: (error) => console.error(error),\n            params: {\n                entitiesListSize: this.configuration.get('home-layout')['entitiesQuerySize']\n            },\n        })\n    }\n\n    parseInitialRequest(response) {\n        this.firstBubbleResponse = response.entitiesData\n        const facetData = []\n        response.typeOfEntityData.forEach((toe) => {\n            const TOEconfigData = this.configuration.get(\"config-keys\")[toe.type.replace(\" \", \"-\")];\n            facetData.push({\n                ...toe,\n                enabled: true,\n                locked: false,\n                configKey: toe.type.replace(\" \", \"-\"),\n                ...TOEconfigData\n            });\n        });\n        this.one('aw-home-facets-wrapper').update(facetData);\n    }\n\n    renderPreviewsFromApolloQuery(response: any) {\n        if (!response || !response.itemsPagination) {\n            return\n        };\n        let numOfItems = response.itemsPagination.totalCount;\n        if (numOfItems > 0) {\n            let numOfThousand = 0;\n            while (numOfItems > 999) {\n                numOfItems -= 1000;\n                numOfThousand += 1;\n            }\n            let numOfItemsTmpStr = numOfItems + '';\n            if (numOfItems < 10) numOfItemsTmpStr = '00' + numOfItems;\n            else if (numOfItems < 100) numOfItemsTmpStr = '0' + numOfItems;\n            if (numOfThousand > 0)\n                this.numOfItemsStr = numOfThousand + '.' + numOfItemsTmpStr;\n            else\n                this.numOfItemsStr = numOfItems + '';\n        } else {\n            this.numOfItemsStr = '0';\n        }\n        this.one('aw-linked-objects').updateOptions({\n            context: 'home',\n            config: this.configuration,\n        })\n        this.one('aw-linked-objects').update(response.itemsPagination);\n    }\n\n    public updateTags(onlyBubbles?: boolean) {\n        if (!onlyBubbles) {\n            this.renderItemTags();\n        }\n    }\n\n    handleFacetSearchChange(change) {\n        var payload: string = change.inputPayload;\n        var value: string = change.value;\n        // store the entered text in facetInputs\n        this.facetInputs[payload] = value;\n    }\n\n    handleFacetSearchEnter(enter) {\n        var payload: string = enter.inputPayload;\n        // get the text entered in this input\n        var value: string = this.facetInputs[payload];\n    }\n\n    renderItemTags() {\n        /*\n            Try to build an item tag for each selected query looking at the data from the\n            first response. If the needed bubble data cannot be found, ask the backend\n            for that bubble's data.\n        */\n        let queryList = [] // list of pending queries\n        let tagsData = []  // list of tags data built from query\n        this.selectedBubbles.forEach(b => { // try to get the data of each selected bubble\n            let theBubble = this.firstBubbleResponse.find(el => el.entity.id == b)\n            if (theBubble) { // if a bubble was found\n                tagsData.push({\n                    label: theBubble.entity.label,\n                    icon: 'n7-icon-close',\n                    payload: b,\n                    classes: `tag-${theBubble.entity.typeOfEntity.replace(/ /g, '-')}`\n                })\n            } else { // if the bubble was not found, make a query\n                let params = { entityId: b, entitiesListSize: 1 }\n                queryList.push(this.makeRequest$('getMissingBubble', params))\n            }\n        });\n        if (queryList.length > 0) { // if there are pending bubble queries\n            forkJoin(queryList).subscribe(forkres => {\n                forkres.forEach(r => {\n                    tagsData.push({\n                        label: r.label,\n                        icon: 'n7-icon-close',\n                        payload: r.id,\n                        classes: `tag-${r.typeOfEntity.replace(/ /g, '-')}`\n                    })\n                });\n                this.one('aw-home-item-tags-wrapper').update(tagsData);\n            })\n        } else {\n            this.one('aw-home-item-tags-wrapper').update(tagsData);\n        }\n    }\n\n    onHeroChange(value) {\n        this.autocompleteChanged$.next(value);\n        this.homeAutocompleteIsLoading = true;\n        this.homeAutocompleteQuery = value;\n        if (!this.autocompletePopoverOpen) {\n            this._toggleAutocompletePopover();\n        }\n    }\n\n    private _scrollBackgroundControl() {\n        const el = document.getElementById('bubble-results-list'),\n            source$ = fromEvent(document.getElementById('bubble-results-list'), 'scroll');\n\n        // height control\n        setTimeout(() => {\n            this._setHasScrollBackground(el);\n        }, 500);\n\n        // scroll listen\n        source$.pipe(\n            debounceTime(50)\n        ).subscribe(({ target }: { target: any }) => {\n            this._setHasScrollBackground(target);\n        });\n    }\n\n    private _setHasScrollBackground({ scrollTop, scrollHeight, clientHeight }) {\n        this.hasScrollBackground = scrollHeight > (scrollTop + clientHeight);\n    }\n\n    private _listenAutoCompleteChanges() {\n        this.one('aw-home-autocomplete').updateOptions({\n            keys: this.configuration.get('config-keys'),\n            config: this.configuration,\n            labels: this.configuration.get('labels')\n        });\n        this.autocompleteChanged$.pipe(\n            debounceTime(500),\n            takeUntil(this.destroyed$)\n        ).subscribe(value => {\n            if (value) {\n                this.communication.request$('autoComplete', {\n                    onError: (error) => console.error(error),\n                    params: {\n                        input: value,\n                        itemsPagination: { offset: 0, limit: this.configuration.get('home-layout')['results-limit'] }\n                    }\n                }).subscribe((response) => {\n                    this.homeAutocompleteIsLoading = false;\n                    this.one('aw-home-autocomplete').update(response);\n                });\n            } else {\n                this._toggleAutocompletePopover();\n            }\n        });\n    }\n\n    private _toggleAutocompletePopover() {\n        if (!this.autocompletePopover) {\n            const template = document.getElementById('aw-home-advanced-autocomplete-popover');\n            template.style.display = 'block';\n            this.autocompletePopover = this.tippy('.aw-home__top-hero .n7-hero__input', {\n                content: template,\n                trigger: 'manual',\n                interactive: true,\n                arrow: false,\n                flip: false,\n                appendTo: 'parent',\n                theme: 'light-border',\n                placement: 'bottom-start',\n                maxWidth: '100%',\n                onHidden: () => this.autocompletePopoverOpen = false,\n            })[0];\n        }\n        if (this.autocompletePopoverOpen) {\n            this.autocompletePopover.hide();\n        } else {\n            this.autocompletePopover.show();\n        }\n        this.autocompletePopoverOpen = !this.autocompletePopoverOpen;\n    }\n}\n","import { EventHandler } from '@n7-frontend/core';\nimport { Subject, forkJoin } from 'rxjs';\n\nexport class AwHomeLayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n  private configuration: any;\n  private route: any;\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-home-layout.init':\n          this.dataSource.onInit(payload);\n          this.loadFilters();\n          this.configuration = payload.configuration;\n          break;\n        case 'aw-home-layout.outerlinkclick':\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: payload\n          });\n          break;\n        case 'aw-home-layout.destroy':\n          this.dataSource.onDestroy()\n          break;\n        case 'aw-home-layout.bubbleresultsviewallclick':\n          const entityLinks = this.dataSource.selectedBubbles.join(',');\n          const basePath = this.configuration.get('paths').searchBasePath;\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [basePath],\n            queryParams: { 'entity-links': entityLinks }\n          });\n          break;\n        case 'aw-home-layout.clearselection':\n          this.emitOuter('clearselection')\n          break;\n        default:\n          console.warn('(home) unhandled inner event of type: ', type)\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-hero.enter':\n        case 'aw-hero.click':\n          const query = payload.value;\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [this.configuration.get(\"paths\").searchBasePath],\n            queryParams: { query }\n          });\n          break;\n        case 'aw-hero.change':\n          this.dataSource.autocompleteValue = payload.value\n          this.dataSource.onHeroChange(payload.value);\n          break;\n        case 'aw-home-facets-wrapper.click':\n          this.emitOuter('togglefilter', payload)\n          break;\n        case 'aw-home-facets-wrapper.change':\n          if (payload.value) {\n            let params = {\n              input: payload.value,\n              typeOfEntity: payload.inputPayload.replace(/-search/g, '').replace(/-/g, ' '),\n              itemsPagination: {\n                offset: 0, limit: this.configuration.get('home-layout')['results-limit']\n              }\n            }\n            this.dataSource.makeRequest$('autoComplete', params).subscribe(response => {\n              if (response.results.length < 1) {\n                let fallback = {\n                  totalcount: 0,\n                  results: [\n                    {\n                      entity: {\n                        id: 'fallback',\n                        label: // use fallback string from configuration\n                          this.configuration.get('home-layout')['autocomplete-fallback'] ?\n                            this.configuration.get('home-layout')['autocomplete-fallback'] :\n                            'Nessun risultato trovato'\n                      }\n                    }\n                  ]\n                }\n                this.emitOuter('facetswrapperresponse', { facetId: payload, response: fallback })\n                this.dataSource.updateComponent(\n                  'aw-autocomplete-wrapper',\n                  { key: payload.value, response: fallback },\n                  { config: this.configuration }\n                )\n              } else {\n                this.emitOuter('facetswrapperresponse', { facetId: payload, response })\n                this.dataSource.updateComponent(\n                  'aw-autocomplete-wrapper', // ID\n                  { key: payload.value, response }, // DATA\n                  { config: this.configuration } // OPTIONS\n                )\n              }\n            })\n          }\n          break;\n        case 'aw-home-facets-wrapper.enter':\n          this.dataSource.handleFacetSearchEnter(payload);\n          break;\n        case 'aw-home-item-tags-wrapper.click':\n          this.emitOuter('tagclick', payload)\n          break;\n        case 'aw-linked-objects.datarequest':\n          const { currentPage } = payload;\n          const params = {\n            selectedEntitiesIds: this.dataSource.selectedBubbles,\n            itemsPagination: {\n              offset: currentPage * this.dataSource.resultsLimit,\n              limit: this.dataSource.resultsLimit\n            }\n          };\n          this.dataSource.makeRequest$('globalFilter', params).subscribe(res => {\n            if (res) {\n              this.emitOuter('dataresponse', { res })\n            } else {\n              console.log('Unable to fetch additional data.')\n            }\n          })\n          break;\n        case 'aw-linked-objects.click':\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [this.configuration.get(\"paths\").schedaBasePath, payload.id]\n          });\n          break;\n        case 'aw-autocomplete-wrapper.clickresult':\n          this.handleSimpleAutocompleteClick(payload)\n          break;\n        case 'aw-home-autocomplete.click':\n          const { source, type } = payload;\n          let basePath;\n          if (source === \"item\") {\n            if (type === \"oggetto-culturale\") {\n              basePath = this.configuration.get(\"paths\").schedaBasePath;\n            } else {\n              basePath = this.configuration.get(\"paths\").entitaBasePath;\n            }\n            this.emitGlobal('navigate', {\n              handler: 'router',\n              path: [basePath, payload.id]\n            });\n          } else if (source === \"showMore\") {\n            const query = this.dataSource.homeAutocompleteQuery;\n            basePath = this.configuration.get(\"paths\").searchBasePath;\n            this.emitGlobal('navigate', {\n              handler: 'router',\n              path: [basePath],\n              queryParams: { query }\n            });\n          }\n          break;\n        case 'aw-bubble-chart.selection':\n          this.handleChartSelection(payload)\n          break;\n        case 'aw-bubble-chart.lockfilter':\n          this.emitOuter('lockfilter', payload) // let aw-home-facets-wrapper handle this event\n          break;\n        default:\n          break;\n      }\n    });\n  }\n\n  private loadFilters() {\n    this.dataSource.initialFilterRequest().subscribe((response) => {\n      // console.log('(home) Apollo responded with:', response)\n      if (!response) { return }\n      this.dataSource.parseInitialRequest(response);\n      if (this.dataSource.bubblesEnabled) {\n        this.emitOuter('filterbubbleresponse', response.entitiesData);\n      }\n    });\n  }\n\n  public handleSimpleAutocompleteClick = payload => {\n    this.emitOuter('facetclick', payload)\n  }\n\n  public outerLinkClick(type, payload) {\n    window.open(payload, \"_blank\");\n  }\n\n  public handleChartSelection = payload => {\n    let selectedEntitiesIds = payload\n    this.dataSource.selectedBubbles = payload\n    this.dataSource.makeRequest$('globalFilter', {\n      selectedEntitiesIds,\n      entitiesListSize: this.configuration.get('home-layout')['entitiesQuerySize']\n    }).subscribe(res => {\n      if (res && res.entitiesData.length > 0) {\n        // if some linked objects exist for the selected entities:\n        this.dataSource.lastBubbleResponse = res.entitiesData\n        this.emitOuter('filterbubbleresponse', res.entitiesData);\n        this.dataSource.renderPreviewsFromApolloQuery(res)\n        this.dataSource.renderItemTags()\n      } else {\n        // if the backend returns an empty list of results:\n        const queryList = []\n        this.dataSource.selectedBubbles.forEach(b => {\n          let params = { entityId: b, entitiesListSize: 1 }\n          queryList.push( // make a query for each selected bubble\n            this.dataSource.makeRequest$('getMissingBubble', params)\n          )\n        });\n        // await for every missing bubble and build a custom response\n        forkJoin(queryList).subscribe(forkres => {\n          let customBubbles = []\n          forkres.forEach(r => { customBubbles.push({ count: 0, entity: r }) });\n          this.emitOuter('filterbubbleresponse', customBubbles);\n          this.dataSource.renderPreviewsFromApolloQuery(res)\n          this.dataSource.renderItemTags()\n        })\n      }\n    })\n  }\n\n}\n","import { AwHomeLayoutDS } from './home-layout.ds';\nimport { AwHomeLayoutEH } from './home-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const AwHomeLayoutConfig = {\n  layoutId: 'aw-home-layout',\n  widgets: [{\n    id: 'aw-hero',\n  }, {\n    id: 'aw-home-hero-patrimonio',\n  }, {\n    id: 'aw-bubble-chart',\n  }, {\n    id: 'aw-home-facets-wrapper',\n  }, {\n    id: 'aw-home-item-tags-wrapper',\n  }, {\n    id: 'aw-home-autocomplete',\n  }, {\n    id: 'aw-linked-objects',\n  }, {\n    id: 'aw-autocomplete-wrapper',\n  }],\n  layoutDS: AwHomeLayoutDS,\n  layoutEH: AwHomeLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AbstractLayout } from '../../../common/models/abstract-layout'\nimport { ConfigurationService } from '../../../common/services/configuration.service';\nimport { LayoutsConfigurationService } from '../../../common/services/layouts-configuration.service';\nimport { MainStateService } from '../../../common/services/main-state.service';\nimport { AwHomeLayoutConfig as config } from './home-layout.config';\nimport { CommunicationService } from '../../../common/services';\nimport tippy from 'tippy.js';\n\n@Component({\n    selector: 'aw-home-layout',\n    templateUrl: './home-layout.html'\n})\nexport class AwHomeLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    layoutsConfiguration: LayoutsConfigurationService,\n    private router: Router,\n    private configuration: ConfigurationService,\n    private communication: CommunicationService,\n    private mainState: MainStateService,\n  ){\n    super(layoutsConfiguration.get('AwHomeLayoutConfig') || config);\n  }\n\n  protected initPayload(){\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      router: this.router,\n      communication: this.communication,\n      options: this.config.options || {},\n      tippy: tippy,\n    }\n  }\n\n  ngOnInit(){\n    this.onInit();\n  }\n\n  ngOnDestroy(){\n    this.onDestroy();\n  }\n}\n","import { LayoutDataSource } from '@n7-frontend/core';\nimport { fromEvent, Subject, of, merge } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\nexport class AwSchedaLayoutDS extends LayoutDataSource {\n  static tree: any = null;\n  private destroyed$: Subject<any> = new Subject();\n  private stickyControlTrigger$: Subject<any> = new Subject();\n  private communication: any;\n  protected configuration: any;\n  protected mainState: any;\n  protected router: any;\n  protected titleService: any;\n  // private allBubbles: any[] = null;\n  // public selectedBubbles: any[] = [];\n  public options: any;\n  public pageTitle: string;\n  public hasBreadcrumb: boolean;\n  public contentParts: any = {};\n  public tree: any;\n  public sidebarCollapsed: boolean;\n  public bubbleChartSectionTitle: string;\n  public similarItemsSectionTitle: string;\n  public metadataSectionTitle: string;\n  public hasMetadata: boolean;\n  public hasBubbles: boolean;\n  public bubblesEnabled: boolean;\n  public hasSimilarItems: boolean;\n  public imageViewerIstance: any;\n  public sidebarIsSticky = false;\n  public treeMaxHeight = '100%';\n\n  onInit({ configuration, mainState, router, options, titleService, communication }) {\n    this.configuration = configuration;\n    this.mainState = mainState;\n    this.router = router;\n    this.titleService = titleService;\n    this.communication = communication;\n    this.options = options;\n    this.sidebarCollapsed = false;\n    this.bubbleChartSectionTitle = this.configuration.get('scheda-layout')['bubble-chart']['title'];\n    this.similarItemsSectionTitle = this.configuration.get('scheda-layout')['related-items']['title'];\n    this.metadataSectionTitle = this.configuration.get('scheda-layout')['metadata']['title'];\n    this.hasSimilarItems = false;\n    this.bubblesEnabled = this.configuration.get('features-enabled') ? this.configuration.get('features-enabled')['bubblechart'] : false;\n    this.one('aw-bubble-chart').updateOptions({ simple: true, config: this.configuration, limit: this.configuration.get('bubble-chart').bubbleLimit })\n\n    this.mainState.update('headTitle', 'Arianna Web > Patrimonio');\n    this.mainState.update('pageTitle', 'Arianna Web: patrimonio Layout');\n    this.mainState.updateCustom('currentNav', 'aw/patrimonio');\n\n    // sidebar sticky control\n    this._sidebarStickyControl();\n  }\n\n  onDestroy(){\n    this.destroyed$.next();\n  }\n\n  getNavigation(id) {\n    if (AwSchedaLayoutDS.tree) {\n      return of(AwSchedaLayoutDS.tree);\n    }\n    return this.communication.request$('getTree', {\n      onError: (error) => console.error(error),\n      params: { treeId: id }\n    });\n  }\n\n  setTree(tree) {\n    AwSchedaLayoutDS.tree = tree;\n  }\n  getTree = () => AwSchedaLayoutDS.tree;\n\n  updateNavigation(data) {\n    let header = {\n      iconLeft: 'n7-icon-tree-icon',\n      text: data['label'],\n      iconRight: 'n7-icon-angle-left',\n      classes: 'is-expanded',\n      payload: 'header'\n    };\n    this.one('aw-sidebar-header').update(header);\n  }\n\n  loadItem(id) {\n    if (id) {\n      const maxSimilarItems = this.configuration.get('scheda-layout')['related-items']['max-related-items'];\n      return this.communication.request$('getNode', {\n        onError: (error) => console.error(error),\n        params: { id: id, maxSimilarItems: maxSimilarItems }\n      })\n    } else {\n      /* TODO: valori statici, da prendere da config */\n      this.pageTitle = 'Collezione d\\'Arte';\n      this.contentParts = [\n        {\n          type: 'text',\n          title: 'Collezione d\\'Arte',\n          content: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi gravida sagittis pulvinar. Etiam iaculis maximus metus, id tincidunt libero auctor et. Proin tempus turpis vel erat ultrices, id vestibulum ante cursus. Vestibulum lobortis, ante at eleifend consequat, massa libero bibendum justo, id fermentum magna odio ac nulla. Cras aliquet scelerisque malesuada. Mauris congue fermentum tristique. Nulla imperdiet accumsan dui, tristique lobortis metus eleifend non. Donec quis odio massa. Cras sit amet sem eu turpis molestie blandit vitae sed nibh. Pellentesque ornare enim nisl, et efficitur ante elementum a. Ut nec ex finibus, congue libero feugiat, aliquam ante. Cras sem neque, pellentesque eget mi at, auctor vulputate tellus. Sed aliquam mi a tortor ultricies interdum. Etiam tincidunt nunc commodo nulla porttitor semper. Etiam porta lacinia libero a mattis. Lorem ipsum dolor sit amet, consectetur adipiscing elit.'\n        },\n        {\n          type: 'text',\n          title: 'Centro Archivi',\n          content: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi gravida sagittis pulvinar. Etiam iaculis maximus metus, id tincidunt libero auctor et. Proin tempus turpis vel erat ultrices, id vestibulum ante cursus. Vestibulum lobortis, ante at eleifend consequat, massa libero bibendum justo, id fermentum magna odio ac nulla. Cras aliquet scelerisque malesuada. Mauris congue fermentum tristique. Nulla imperdiet accumsan dui, tristique lobortis metus eleifend non. Donec quis odio massa. Cras sit amet sem eu turpis molestie blandit vitae sed nibh. Pellentesque ornare enim nisl, et efficitur ante elementum a. Ut nec ex finibus, congue libero feugiat, aliquam ante. Cras sem neque, pellentesque eget mi at, auctor vulputate tellus. Sed aliquam mi a tortor ultricies interdum. Etiam tincidunt nunc commodo nulla porttitor semper. Etiam porta lacinia libero a mattis. Lorem ipsum dolor sit amet, consectetur adipiscing elit.'\n        }\n      ]\n    }\n    /*Breadcrumb section*/\n    let breadcrumbs = {\n      items: []\n    };\n    this.one('aw-scheda-breadcrumbs').update(breadcrumbs);\n  }\n\n  loadContent(response) {\n    if (response) {\n      this.contentParts = [];\n      const content = {};\n\n      if (response.text) {\n        content['content'] = response.text;\n      }\n      this.contentParts.push(content);\n      if (response.image) {\n        const images = [{ type: 'image', url: response.image, buildPyramid: false }];\n        if (!this.imageViewerIstance) {\n          this.one('aw-scheda-image').update({\n            viewerId: 'scheda-layout-viewer',\n            _setViewer: (viewer) => {\n              this.imageViewerIstance = viewer;\n              viewer.open(images);\n            },\n          });\n        } else {\n          this.imageViewerIstance.open(images);\n        }\n      }\n\n      const titleObj = {\n        icon: response.icon,\n        title: {\n          main: {\n            text: response.title || response.label,\n            classes: 'bold',\n          }\n        },\n        tools: response.subTitle,\n        actions: {}\n      };\n\n      this.one('aw-scheda-inner-title').update(titleObj);\n\n      this.hasMetadata = response.fields != null;\n      this.one('aw-scheda-metadata').updateOptions({ labels: this.configuration.get(\"labels\") });\n      this.one('aw-scheda-metadata').update(response);\n\n      // Breadcrumb section\n      const breadcrumbs = {\n        items: []\n      };\n\n      if (response.breadcrumb) {\n        response.breadcrumbs.forEach(element => {\n          breadcrumbs.items.push({\n            label: element.label,\n            payload: element.link\n          })\n        });\n        this.one('aw-scheda-breadcrumbs').update(breadcrumbs);\n      }\n\n      // update head title\n      this.mainState.update('headTitle', `Arianna Web > Patrimonio > ${response.title || response.label}`);\n    }\n\n    if (response.relatedItems) {\n      this.hasSimilarItems = true;\n      this.one('aw-linked-objects').updateOptions({ context: 'scheda', config: this.configuration })\n      this.one('aw-linked-objects').update(response);\n    } else {\n      this.hasSimilarItems = false;\n    }\n\n    // control sticky\n    setTimeout(() => {\n      this.stickyControlTrigger$.next();\n    });\n  }\n\n  collapseSidebar() {\n    this.sidebarCollapsed = !this.sidebarCollapsed;\n  }\n\n  private _sidebarStickyControl() {\n    const source$ = fromEvent(window, 'scroll');\n\n    merge(source$, this.stickyControlTrigger$).pipe(\n      takeUntil(this.destroyed$)\n    ).subscribe(() => {\n      const windowTop = window.pageYOffset,\n        windowBottom = window.scrollY + window.innerHeight,\n        wrapper = document.getElementsByClassName('sticky-parent')[0],\n        wrapperTop = wrapper['offsetTop'],\n        wrapperBottom = wrapperTop + wrapper.clientHeight;\n\n        this.sidebarIsSticky = wrapperTop <= windowTop;\n\n        // tree height control\n        if (this.sidebarIsSticky && windowBottom < wrapperBottom) {\n          this.treeMaxHeight = (windowBottom - windowTop - 50) + 'px';\n        } else if (this.sidebarIsSticky && windowBottom >= wrapperBottom) {\n          this.treeMaxHeight = (wrapperBottom - windowTop - 50) + 'px';\n        } else if (windowBottom < wrapperBottom) {\n          this.treeMaxHeight = (windowBottom - wrapperTop - 50) + 'px';\n        } else {\n          this.treeMaxHeight = (wrapperBottom - wrapperTop - 50) + 'px';\n        }\n    });\n  }\n}\n","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\n\nexport class AwSchedaLayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n  private configuration: any;\n  private route: any;\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-scheda-layout.init':\n          this.dataSource.onInit(payload);\n          this.configuration = payload.configuration;\n          this.route = payload.route;\n          let paramId = this.route.snapshot.params.id || \"\";\n          this.listenRoute();\n          this.loadNavigation(paramId);\n          break;\n\n        case 'aw-scheda-layout.destroy':\n          this.destroyed$.next();\n          this.dataSource.onDestroy();\n          break;\n\n        default:\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-tree.click':\n          if (payload) {\n            this.emitGlobal('navigate', { path: [this.configuration.get('paths').schedaBasePath + payload], handler: 'router' });\n          }\n          break;\n        case 'aw-sidebar-header.click': this.dataSource.collapseSidebar();\n          break;\n        case \"aw-bubble-chart.bubble-tooltip-goto-click\":\n          if (!payload || !payload.entityId) return;\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [`aw/entita/${payload.entityId}/overview`]\n          });\n          break;\n        case 'aw-linked-objects.click':\n          const paths = this.configuration.get('paths');\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [paths.schedaBasePath, payload.id]\n          });\n          break;\n        default:\n          break;\n      }\n    });\n  }\n\n  private listenRoute() {\n    this.route.paramMap.subscribe(params => {\n      const paramId = params.get('id');\n      if (paramId) {\n        this.dataSource.loadItem(paramId).subscribe((response) => {\n          if (response) {\n            this.dataSource.loadContent(response);\n            if (response.relatedEntities) {\n              this.dataSource.hasBubbles = true;\n              if (this.dataSource.bubblesEnabled) {\n                this.emitOuter('filterbubbleresponse', response.relatedEntities);\n              }\n            }\n          }\n        });\n      } else {\n        this.dataSource.loadItem();\n      }\n    });\n  }\n\n  private loadNavigation(selectedItem) {\n    this.dataSource.getNavigation('patrimonio').subscribe((response) => {\n      if (response) {\n        this.dataSource.setTree(response);\n        this.dataSource.updateNavigation(this.dataSource.getTree());\n        this.emitOuter('navigationresponse', {tree: this.dataSource.getTree(), currentItem: selectedItem});\n      }\n    });\n  }\n}","import { AwSchedaLayoutDS } from './scheda-layout.ds';\nimport { AwSchedaLayoutEH } from './scheda-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const AwPatrimonioLayoutConfig = {\n  layoutId: 'aw-scheda-layout',\n  /**\n   * Array of components you want to use\n   * in this leyout\n   */\n  widgets: [\n     { id: 'aw-sidebar-header'},\n     { id: 'aw-tree' },\n     { id: 'aw-scheda-breadcrumbs' },\n     { id: 'aw-scheda-metadata' },\n     { id: 'aw-scheda-image' },\n     { id: 'aw-scheda-inner-title' },\n     { id: 'aw-bubble-chart' },\n     { id: 'aw-linked-objects' }\n  ],\n  layoutDS: AwSchedaLayoutDS,\n  layoutEH: AwSchedaLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { Title } from '@angular/platform-browser';\nimport { AbstractLayout } from '../../../common/models/abstract-layout'\nimport { ConfigurationService } from '../../../common/services/configuration.service';\nimport { LayoutsConfigurationService } from '../../../common/services/layouts-configuration.service';\nimport { MainStateService } from '../../../common/services';\nimport { AwPatrimonioLayoutConfig as config } from './scheda-layout.config';\nimport { CommunicationService } from '../../../common/services';\n\n@Component({\n  selector: 'aw-scheda-layout',\n  templateUrl: './scheda-layout.html'\n})\n\nexport class AwSchedaLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private configuration: ConfigurationService,\n    private layoutsConfiguration: LayoutsConfigurationService,\n    private mainState: MainStateService,\n    private titleService: Title,\n    private communication: CommunicationService,\n\n  ) {\n    super(layoutsConfiguration.get('AwPatrimonioLayoutConfig') || config);\n  }\n\n  /**\n   * Optional variables that can be accessed from the layout's logic.\n   * If removed, they must also be removed from the layout's DataSource file,\n   * and from this file imports.\n   */\n  protected initPayload() {\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      router: this.router,\n      route: this.route,\n      titleService: this.titleService,\n      communication: this.communication,\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit() {\n    this.onInit();\n  }\n\n  ngOnDestroy() {\n    this.onDestroy();\n  }\n}","export default {\n  totalCount: 0,\n  facets: [\n    {\n      id: 'query',\n      type: 'value'\n    },\n    {\n      id: 'query-all',\n      type: 'value',\n      hasStaticData: true,\n      data: [\n        {\n          value: '1',\n          label: 'Cerca in tutti campi delle schede'\n        }\n      ]\n    },\n    {\n      id: 'query-links',\n      type: 'value'\n    },\n    {\n      id: 'entity-types',\n      type: 'value',\n      operator: 'OR',\n      limit: 10,\n      order: 'count'\n    },\n    {\n      id: 'entity-search',\n      type: 'value'\n    },\n    {\n      id: 'entity-links',\n      type: 'value',\n      searchData: ['entity-type']\n    },\n    /* {\n      id: 'date-from',\n      type: 'value'\n    },\n    {\n      id: 'date-to',\n      type: 'value'\n    } */\n  ],\n  fields: [\n    {\n      inputs: [\n        {\n          type: 'text',\n          facetId: 'query',\n          placeholder: 'Cerca...',\n          // icon: 'n7-icon-search',\n          filterConfig: {\n            delay: 500,\n            minChars: 3,\n            searchIn: [\n              {\n                key: 'label',\n                operator: 'LIKE'\n              }\n            ]\n          }\n        },\n        {\n          type: 'checkbox',\n          facetId: 'query-all',\n          filterConfig: {\n            searchIn: [\n              {\n                key: 'query-all',\n                operator: '='\n              }\n            ]\n          }\n        },\n        {\n          type: 'link',\n          facetId: 'query-links',\n          filterConfig: {\n            isArray: true,\n            searchIn: [\n              {\n                key: 'source.entityType',\n                operator: '='\n              }\n            ]\n          }\n        }\n      ]\n    },\n    {\n      header: {\n        label: 'Relazione con',\n        classes: 'related-class'\n      },\n      inputs: [\n        {\n          type: 'checkbox',\n          facetId: 'entity-types',\n          filterConfig: {\n            isArray: true,\n            context: 'internal',\n            target: 'entity-links',\n            searchIn: [\n              {\n                key: 'searchData.entity-type',\n                operator: '='\n              }\n            ]\n          }\n        },\n        {\n          type: 'text',\n          facetId: 'entity-search',\n          placeholder: 'Cerca entitÃ ',\n          // icon: 'n7-icon-search',\n          filterConfig: {\n            delay: 500,\n            minChars: 3,\n            context: 'internal',\n            target: 'entity-links',\n            searchIn: [\n              {\n                key: 'label',\n                operator: 'LIKE'\n              }\n            ]\n          }\n        },\n        {\n          type: 'link',\n          facetId: 'entity-links',\n          emptyState: {\n            label: 'La tua ricerca non ha dato risultati, prova a cambiare i filtri'\n          },\n          filterConfig: {\n            isArray: true,\n            limit: 20,\n            searchIn: [\n              {\n                key: 'relatedEntities.id',\n                operator: '='\n              }\n            ]\n          }\n        }\n      ]\n    },\n    /*{\n      header: {\n        label: 'Data',\n        classes: 'date-class'\n      },\n      inputs: [\n        {\n          type: 'select',\n          facetId: 'date-from',\n          label: 'Dal',\n          filterConfig: {\n            searchIn: [\n              {\n                key: 'source.dateStart',\n                operator: '>='\n              }\n            ]\n          }\n        },\n        {\n          type: 'select',\n          facetId: 'date-to',\n          label: 'Al',\n          filterConfig: {\n            searchIn: [\n              {\n                key: 'source.dateEnd',\n                operator: '<='\n              }\n            ]\n          }\n        }\n      ]\n    }*/\n  ],\n  results: {\n    order: {\n      type: 'text', // score | text | date\n      key: 'label', // docPath, elastic key, ecc\n      direction: 'ASC' // ASC | DESC\n    },\n    fields: [\n      {\n        id: 'description',\n        highlight: true,\n        limit: 200\n      }\n    ]\n  },\n  page: { offset: 0, limit: 10 }\n};\n","import { cloneDeep } from 'lodash';\nimport { LayoutDataSource } from '@n7-frontend/core';\nimport {\n  SearchService,\n  SearchModel\n} from '../../../common/services';\nimport facetsConfig from './search-facets.config';\nimport { tap, takeUntil } from 'rxjs/operators';\nimport { Observable, of, fromEvent, Subject } from 'rxjs';\nimport helpers from '../../../common/helpers';\n\nconst SEARCH_MODEL_ID = 'aw-search-layout';\n\nexport class AwSearchLayoutDS extends LayoutDataSource {\n  private destroyed$: Subject<any> = new Subject();\n  private communication: any;\n  private configuration: any;\n  private mainState: any;\n  private search: SearchService;\n  private searchModel: SearchModel;\n  private prettifyLabels: any;\n  private configKeys: any;\n  private fallback: string;\n  private resetButtonEnabled = true;\n\n  public pageTitle: string;\n  public resultsTitle: string;\n  public totalCount: number;\n  public currentPage: any = 1; // pagination value (url param)\n  public pageSize = 10; // linked objects page size\n  public sidebarIsSticky = false;\n  public isFirstLoading = true;\n\n  public options: any;\n\n  public orderByLabel = 'Ordina per';\n  public orderByOptions: any = [\n    {\n      value: 'label_ASC',\n      label: 'Ordine alfabetico (AâZ)'\n    },\n    {\n      value: 'label_DESC',\n      label: 'Ordine alfabetico (ZâA)'\n    }\n  ];\n\n  onInit({ configuration, mainState, options, communication, search }) {\n    this.configuration = configuration;\n    this.mainState = mainState;\n    this.communication = communication;\n    this.search = search;\n    this.options = options;\n    this.prettifyLabels = this.configuration.get('labels');\n    this.configKeys = this.configuration.get('config-keys');\n    this.fallback = this.configuration.get('search-layout').fallback;\n\n    this.pageTitle = this.configuration.get('search-layout').title;\n\n    // remove first\n    // stateless search\n    if (this.search.model(SEARCH_MODEL_ID)) {\n      this.search.remove(SEARCH_MODEL_ID);\n    }\n\n    this.search.add(SEARCH_MODEL_ID, cloneDeep(facetsConfig));\n    this.searchModel = this.search.model(SEARCH_MODEL_ID);\n\n    // query params control\n    if (SearchService.queryParams) {\n      this.searchModel.updateFiltersFromQueryParams(SearchService.queryParams);\n      SearchService.queryParams = null;\n    }\n\n    // sidebar sticky control\n    this._sidebarStickyControl();\n\n    this.mainState.update('headTitle', 'Arianna Web > Ricerca');\n  }\n\n  onDestroy() {\n    this.destroyed$.next();\n    SearchService.queryParams = null;\n  }\n\n  onSearchResponse(){\n    this.resetButtonEnabled = true;\n    if (this.isFirstLoading) {\n      this.isFirstLoading = false;\n      this.one('facets-wrapper').update({ searchModel: this.searchModel });\n      this.searchModel.updateInputsFromFilters();\n    }\n  }\n\n  onOrderByChange(payload) {\n    const [orderBy, direction] = payload.split('_');\n\n    this.searchModel.setSearchConfigOrderBy(orderBy);\n    this.searchModel.setSearchConfigDirection(direction);\n  }\n\n  onPaginationChange(payload): Observable<boolean> {\n    const page = payload.replace('page-', '');\n    return this._updateSearchPage(page);\n  }\n\n  onPaginationGoToChange(payload): Observable<boolean> {\n    const page = payload.replace('goto-', '');\n    return this._updateSearchPage(page);\n  }\n\n  resetPagination() {\n    this._updateSearchPage(1);\n  }\n\n  onResultsLimitChange(payload) {\n    this.pageSize = payload;\n    this.searchModel.setPageConfigLimit(payload);\n\n    // reset page & offset\n    this.currentPage = 1;\n    this.searchModel.setPageConfigOffset(0);\n  }\n\n  public getSearchModelId = () => SEARCH_MODEL_ID;\n\n  public doSearchRequest$(): Observable<any> {\n    const requestParams = this.searchModel.getRequestParams();\n    const requestPayload = {\n      searchParameters: {\n        // FIXME: togliere totalCount\n        totalCount: 100,\n        ...requestParams\n      }\n    };\n    return this.communication.request$('search', {\n      onError: error => console.error(error),\n      params: requestPayload\n    }).pipe(\n      tap(({ totalCount, results, facets }) => {\n        this.totalCount = totalCount;\n        let resultsTitleIndex = 0;\n        // results title\n        if (this.totalCount > 1) {\n          resultsTitleIndex = 2;\n        } else if (this.totalCount === 1) {\n          resultsTitleIndex = 1;\n        }\n        this.resultsTitle = this.configuration.get('search-layout').results[\n          resultsTitleIndex\n        ];\n\n        // facets labels\n        this._addFacetsLabels(facets);\n        // facets options\n        this._addFacetsOptions(facets);\n\n        this.searchModel.updateFacets(facets);\n        this.searchModel.updateTotalCount(totalCount);\n\n        this.one('aw-linked-objects').updateOptions({\n          context: 'search',\n          config: this.configuration,\n          page: this.currentPage,\n          pagination: true,\n          dynamicPagination: {\n            total: totalCount\n          },\n          size: this.pageSize\n        });\n\n        this.one('aw-linked-objects').update({ items: this._normalizeItems(results.items) });\n      })\n    );\n  }\n\n  private _updateSearchPage(page) {\n    if (+page === this.currentPage) {\n      return of(false);\n    }\n\n    this.currentPage = +page;\n\n    const searchConfig = this.searchModel.getConfig(),\n      pageConfig = searchConfig.page,\n      { limit } = pageConfig,\n      newOffset = (this.currentPage - 1) * limit;\n\n    this.searchModel.setPageConfigOffset(newOffset);\n\n    return of(true);\n  }\n\n  private _addFacetsLabels(facets) {\n    facets\n      .filter(f => Array.isArray(f.data))\n      .forEach(f => {\n        f.data.forEach(dataItem => {\n          const key = dataItem.label;\n          dataItem.label = helpers.prettifySnakeCase(key, this.prettifyLabels[key]);\n        });\n      });\n  }\n\n  private _addFacetsOptions(facets) {\n    facets\n      .filter(f => f.id === 'query-links')\n      .forEach(f => {\n        f.data.forEach(dataItem => {\n          const key = dataItem.value.replace(' ', '-'),\n            config = this.configKeys[key];\n          if (config) {\n            dataItem.options = {\n              icon: config.icon,\n              classes: `color-${key}`\n            };\n          }\n        });\n      });\n  }\n\n  private _normalizeItems(items) {\n    return items.map(singleItem => ({ item: { ...singleItem } }));\n  }\n\n  private _sidebarStickyControl() {\n    const source$ = fromEvent(window, 'scroll');\n\n    source$.pipe(\n      takeUntil(this.destroyed$)\n    ).subscribe(() => {\n      const windowOffsetTop = window.pageYOffset,\n        wrapperOffsetTop = document.getElementsByClassName('sticky-parent')[0]['offsetTop'];\n      this.sidebarIsSticky = wrapperOffsetTop <= windowOffsetTop;\n    });\n  }\n}\n","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\nimport { debounceTime, takeUntil } from 'rxjs/operators';\n\nexport class AwSearchLayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n  private route: any;\n  private facetsChange$: Subject<any> = new Subject();\n  private configuration: any;\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-search-layout.init':\n          this.route = payload.route;\n          this.configuration = payload.configuration;\n          this.dataSource.onInit(payload);\n          this._listenToFacetsChange();\n          this._listenToRouterChanges();\n          break;\n\n        case 'aw-search-layout.destroy':\n          this.dataSource.onDestroy();\n          this.destroyed$.next();\n          break;\n\n        case 'aw-search-layout.orderbychange':\n          this.dataSource.onOrderByChange(payload);\n          this.facetsChange$.next();\n          break;\n\n        case 'aw-search-layout.searchreset':\n          this.dataSource.resetButtonEnabled = false;\n          this.dataSource.searchModel.clear();\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [this.configuration.get('paths').searchBasePath]\n          });\n          break;\n\n        default:\n          console.warn('(search) unhandled inner event of type', type)\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'facets-wrapper.facetschange':\n          this.dataSource.resetPagination();\n          break;\n\n        case 'aw-linked-objects.pagination':\n          this.dataSource.onPaginationChange(payload).subscribe(changed => {\n            if (changed) {\n              this.facetsChange$.next();\n            }\n          });\n          break;\n\n        case 'aw-linked-objects.change':\n          this.dataSource.onResultsLimitChange(payload);\n          this.facetsChange$.next();\n          break;\n\n        case 'aw-linked-objects.goto':\n          this.dataSource.onPaginationGoToChange(payload).subscribe(changed => {\n            if (changed) {\n              this.facetsChange$.next();\n            }\n          });\n          break;\n\n        case 'aw-linked-objects.click':\n          const paths = this.dataSource.configuration.get('paths');\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [payload.type == undefined ? paths.schedaBasePath : paths.entitaBasePath, payload.id]\n          });\n          break;\n        default:\n          break;\n      }\n    });\n  }\n\n  private _listenToFacetsChange() {\n    this.facetsChange$.pipe(\n      debounceTime(500)\n    ).subscribe(() => {\n      this.dataSource.doSearchRequest$().subscribe(() => {\n        this.dataSource.onSearchResponse();\n        this.emitGlobal('searchresponse', this.dataSource.getSearchModelId());\n      });\n    });\n  }\n\n  private _listenToRouterChanges() {\n    this.route.queryParams.pipe(\n      takeUntil(this.destroyed$)\n    ).subscribe(params => {\n      this.emitOuter('queryparamschange', params);\n      this.facetsChange$.next();\n    });\n  }\n\n}\n","import { AwSearchLayoutDS } from './search-layout.ds';\nimport { AwSearchLayoutEH } from './search-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\nimport { FacetsWrapperDS } from '../../../common/data-sources';\nimport { FacetsWrapperEH } from '../../../common/event-handlers';\n\nexport const AwSearchLayoutConfig = {\n  layoutId: 'aw-search-layout',\n  /**\n   * Array of components you want to use\n   * in this layout\n   */\n  widgets: [\n    { id: 'facets-wrapper', dataSource: FacetsWrapperDS, eventHandler: FacetsWrapperEH },\n    { id: 'aw-linked-objects' },\n    { id: 'aw-search-layout-tabs', hasStaticData: true },\n  ],\n  layoutDS: AwSearchLayoutDS,\n  layoutEH: AwSearchLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { AbstractLayout } from '../../../common/models/abstract-layout'\nimport { \n  ConfigurationService,\n  LayoutsConfigurationService,\n  MainStateService,\n  SearchService,\n  CommunicationService,\n} from '../../../common/services';\nimport { AwSearchLayoutConfig as config } from './search-layout.config';\nimport { ActivatedRoute } from '@angular/router';\n\n@Component({\n  selector: 'aw-search-layout',\n  templateUrl: './search-layout.html'\n})\n\nexport class AwSearchLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n\n  constructor(\n    private configuration: ConfigurationService,\n    private layoutsConfiguration: LayoutsConfigurationService,\n    private mainState: MainStateService,\n    private communication: CommunicationService,\n    private search: SearchService,\n    private route: ActivatedRoute\n  ) {\n    super(layoutsConfiguration.get('AwSearchLayoutConfig') || config);\n  }\n\n  /**\n   * Optional variables that can be accessed from the layout's logic.\n   * If removed, they must also be removed from the layout's DataSource file,\n   * and from this file imports.\n   */\n  protected initPayload() {\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      communication: this.communication,\n      search: this.search,\n      route: this.route,\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit() {\n    this.onInit();\n  }\n\n  ngOnDestroy() {\n    this.onDestroy();\n  }\n}","//---------------------------\n// BubbleChartWrapper.ts\n//---------------------------\n\nimport { Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'aw-bubble-chart-wrapper',\n  templateUrl: './bubble-chart-wrapper.html'\n})\nexport class BubbleChartWrapperComponent {\n  @Input() emit: any;\n  @Input() container: string;\n  @Input() buttons: any;\n\n  onClick(type, payload) {\n    this.emit(type, payload);\n  }\n}","//---------------------------\n// BREADCRUMBS.ts\n//---------------------------\n\nimport { Component, Input, ViewChild, ElementRef, AfterViewInit } from '@angular/core';\nimport tippy from 'tippy.js';\n\n/**\n * Interface for a single BreadcrumbsComponent's \"Item\"\n *\n * @property label (required)\n * @property payload (required)\n * @property classes (optional)\n * @property _meta (optional)\n *\n */\nexport interface ISmartBreadcrumbsItem {\n    /**\n     * item's label\n     */\n    label: string;\n    /**\n     * action click's payload\n     */\n    payload: any;\n    /**\n     * additional html classes\n     */\n    classes?: any;\n    /**\n     * additional info useful for the component's logic\n     */\n    _meta?: any;\n}\n\n/**\n * Interface for BreadcrumbsComponent's \"Data\"\n *\n * @property items (required)\n * @property classes (optional)\n *\n */\nexport interface ISmartBreadcrumbsData {\n    /**\n     * each item renders a breadcrumb level\n     */\n    items: ISmartBreadcrumbsItem[];\n    /**\n     * additional html classes\n     */\n    classes?: any;\n}\n\n@Component({\n    selector: 'n7-smart-breadcrumbs',\n    templateUrl: './smart-breadcrumbs.html'\n})\nexport class SmartBreadcrumbsComponent implements AfterViewInit {\n    @Input() data: ISmartBreadcrumbsData;\n    @Input() emit: any;\n    @ViewChild('bcol', { read: ElementRef, static: false }) bcol: ElementRef\n    @ViewChild('bcdiv', { read: ElementRef, static: false }) bcdiv: ElementRef\n\n    ngAfterViewInit = () => {\n        let\n            parentWidth = this.bcdiv.nativeElement.clientWidth,\n            childWidth = this.bcol.nativeElement.clientWidth,\n            liArray = this.bcol.nativeElement.children\n\n        // collapse condition\n        if (parentWidth === childWidth) {\n            let tippyData = document.createElement('ol')\n            let i = 1\n            tippyData.className = 'n7-smart-breadcrumbs__tippy-content'\n            while (parentWidth === childWidth && i < liArray.length - 1) {\n                if (i > 1) {\n                    tippyData.appendChild(liArray[i])\n                } else {\n                    tippyData.appendChild(liArray[i])\n                    liArray[i].children[0].innerText = 'â¦'\n                }\n                this.tippyBuilder(liArray[i], tippyData)\n                i++\n                // update widths\n                parentWidth = this.bcdiv.nativeElement.clientWidth\n                childWidth = this.bcol.nativeElement.clientWidth\n            }\n        }\n    }\n\n    onClick(payload) {\n        if (!this.emit) return;\n        this.emit('click', payload);\n    }\n\n    tippyBuilder = (node, content) => {\n        /*\n            Builds tippy data for a node.\n        */\n        document.body.appendChild(content)\n        tippy(node, {\n            content,\n            // allowHTML: true,\n            // trigger: 'manual',\n            interactive: true,\n            arrow: true,\n            theme: 'light-border no-padding',\n            // placement: 'bottom',\n            // maxWidth: 500,\n        })\n    }\n\n}\n","// MODULES\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DvComponentsLibModule } from '@n7-frontend/components';\nimport { N7BoilerplateCommonModule } from '../common/n7-boilerplate-common.module';\n// LAYOUTS\nimport { AwEntitaLayoutComponent } from './layouts/entita-layout/entita-layout';\nimport { AwHomeLayoutComponent } from './layouts/home-layout/home-layout';\nimport { AwSchedaLayoutComponent } from './layouts/scheda-layout/scheda-layout';\nimport { AwSearchLayoutComponent } from './layouts/search-layout/search-layout';\n// COMPONENTS\nimport { BubbleChartWrapperComponent } from './components/bubble-chart-wrapper/bubble-chart-wrapper';\nimport { SmartBreadcrumbsComponent } from './components/smart-breadcrumbs/smart-breadcrumbs';\n\nconst COMPONENTS = [\n  AwEntitaLayoutComponent,\n  AwHomeLayoutComponent,\n  AwSchedaLayoutComponent,\n  AwSearchLayoutComponent,\n  BubbleChartWrapperComponent,\n  SmartBreadcrumbsComponent\n];\n\n\n@NgModule({\n  declarations: COMPONENTS,\n  imports: [\n    CommonModule,\n    DvComponentsLibModule,\n    N7BoilerplateCommonModule,\n  ],\n  providers: [],\n  exports: COMPONENTS\n})\nexport class N7BoilerplateAriannaWebModule { }\n","import { Component, Input } from '@angular/core';\n\nexport interface IDataWidgetWrapperData {\n    classes?: string;\n}\n\n@Component({\n    selector: 'dv-data-widget-wrapper',\n    templateUrl: './data-widget-wrapper.html'\n})\nexport class DataWidgetWrapperComponent{\n    @Input() data: IDataWidgetWrapperData;\n    @Input() emit: any;\n}\n  ","import { LayoutDataSource } from '@n7-frontend/core';\n\nexport class DvExampleLayoutDS extends LayoutDataSource {\n  \n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class DvExampleLayoutEH extends EventHandler {\n\n  public listen() {\n    \n  } \n}","import { DataSource } from '@n7-frontend/core';\n\nexport class DvDataWidgetDS extends DataSource {\n    protected transform(data){\n        if ( !data ){ return null; }\n    }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class DvGraphDS extends DataSource {\n\n\tprotected transform(data){\n        return {\n\t\t\tcontainerId: 'test-Chart',\n\t\t\tlibOptions:{\n\t\t\t\tchart: {\n\t\t\t\t\t\t\"height\":550,\n\t\t\t\t\t\t\"width\": 1500,\n\t\t\t\t\t\t\"type\":\"area\",\n\t\t\t\t\t\t\"toolbar\":{\"show\":true}\n\t\t\t\t},\n\t\t\t\tdataLabels: {\"enabled\":false},\n\t\t\t\tcolors:[\"rgba(15,200,255)\"],\n\t\t\t\tfill:{\n\t\t\t\t\t\t\"colors\":[\"#0fc8ff\"],\n\t\t\t\t\t\t\"gradient\":{\"opacityFrom\":0.5,\"opacityTo\":0.1}\n\t\t\t\t},\n\t\t\t\tstroke:{\"curve\":\"straight\",\"width\":[2,1]},\n\t\t\t\tseries:[\n\t\t\t\t\t{\n\t\t\t\t\t\t\"name\":\"Reddish value\",\n\t\t\t\t\t\t\"data\":[[\"2019-08-01\",\"770.17\"],[\"2019-08-02\",\"645.03\"],\n\t\t\t\t\t\t\t[\"2019-08-03\",\"709.32\"],[\"2019-08-04\",\"708.11\"],\n\t\t\t\t\t\t\t[\"2019-08-05\",\"706.59\"],[\"2019-08-06\",\"607.28\"],\n\t\t\t\t\t\t\t[\"2019-08-07\",\"494.59\"],[\"2019-08-08\",\"636.81\"],\n\t\t\t\t\t\t\t[\"2019-08-09\",\"709.04\"],[\"2019-08-10\",\"717.31\"],\n\t\t\t\t\t\t\t[\"2019-08-11\",\"805.61\"],[\"2019-08-12\",\"758.60\"],\n\t\t\t\t\t\t\t[\"2019-08-13\",\"612.82\"],[\"2019-08-14\",\"608.90\"],\n\t\t\t\t\t\t\t[\"2019-08-15\",\"734.68\"],[\"2019-08-16\",\"838.54\"],\n\t\t\t\t\t\t\t[\"2019-08-17\",\"692.88\"]]\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tgrid:{\n\t\t\t\t\t\"borderColor\":\"#e7e7e7\",\n\t\t\t\t\t\"strokeDashArray\":3,\n\t\t\t\t\t\"xaxis\":{\"lines\":{\"show\":true}}\n\t\t\t\t},\n\t\t\t\tmarkers:{\"size\":3,\"hover\":{\"size\":6}},\n\t\t\t\txaxis:{\n\t\t\t\t\t\t\"axisBorder\":{\"show\":true,\"color\":\"#f4f6fc\"},\n\t\t\t\t\t\t\"labels\":{},\n\t\t\t\t\t\t\"type\":\"datetime\",\"tickAmount\":6\n\t\t\t\t},\n\t\t\t\tyaxis:[\n\t\t\t\t\t{\n\t\t\t\t\t\t\"show\":true,\n\t\t\t\t\t\t\"showAlways\":false,\n\t\t\t\t\t\t\"opposite\":false,\n\t\t\t\t\t\t\"reversed\":false,\n\t\t\t\t\t\t\"logarithmic\":false,\n\t\t\t\t\t\t\"forceNiceScale\":false,\n\t\t\t\t\t\t\"floating\":false,\n\t\t\t\t\t\t\"labels\": {\n\t\t\t\t\t\t\t\t\"show\":true,\n\t\t\t\t\t\t\t\t\"minWidth\":0,\n\t\t\t\t\t\t\t\t\"maxWidth\":160,\n\t\t\t\t\t\t\t\t\"offsetX\":0,\n\t\t\t\t\t\t\t\t\"offsetY\":0,\n\t\t\t\t\t\t\t\t\"rotate\":0,\n\t\t\t\t\t\t\t\t\"padding\":20,\n\t\t\t\t\t\t\t\t\"style\": { \"colors\":[], \"fontSize\":\"11px\", \"cssClass\":\"\" }\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"axisBorder\":{\"show\":true,\"color\":\"#f4f6fc\",\"offsetX\":0,\"offsetY\":0},\n\t\t\t\t\t\t\"axisTicks\":{\"show\":false,\"color\":\"#78909C\",\"width\":6,\"offsetX\":0,\"offsetY\":0},\n\t\t\t\t\t\t\"title\":{\"text\":\"P Totale Â°C\",\"rotate\":90,\"offsetY\":0,\"offsetX\":0,\"style\":{\"fontSize\":\"11px\",\"cssClass\":\"\"}},\n\t\t\t\t\t\t\"tooltip\":{\"enabled\":false,\"offsetX\":0},\n\t\t\t\t\t\t\"crosshairs\":{\"show\":true,\"position\":\"front\",\"stroke\":{\"color\":\"#b6b6b6\",\"width\":1,\"dashArray\":0}}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tlegend:{\"show\":true},\n\t\t\t\ttooltip:{},\n\t\t\t\tannotations:{\"yaxis\":[],\"xaxis\":[],\"points\":[]}\n\t\t\t}\n\t\t}\n\t}\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class DvInnerTitleDS extends DataSource {\n\n\tprotected transform(data){\n\t\treturn {\n\t\t\ttitle: {\n\t\t\t\tmain: {\n\t\t\t\t\ttext:\"Dipendenti\",\n\t\t\t\t\tclasses: \"n7-main-widget-title\",\n\t\t\t\t},\n\t\t\t\tsecondary: {\n\t\t\t\t\ttext: \"Dipendeti al 10/10/10\",\n\t\t\t\t\tclasses: \"n7-secondary-widget-title\",\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n}\n","import { DataSource } from '@n7-frontend/core';\nimport { DATA_WIDGET_MOCK } from \"@n7-frontend/components\";\n\nexport class DvWidgetDS extends DataSource {\n\n\tprotected transform(data){\n        return DATA_WIDGET_MOCK\n\t}\n}\n","import { EventHandler } from '@n7-frontend/core';\n\nexport class DvDataWidgetEH extends EventHandler {\n    public listen() {\n        console.log(\"....\")\n    }\n}","import { DvExampleLayoutDS } from './example-layout.ds';\nimport { DvExampleLayoutEH } from './example-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const DvExampleLayoutConfig = {\n  layoutId: 'dv-example-layout',\n  /**\n   * Array of components you want to use\n   * in this leyout\n   */\n  widgets: [\n    { id: 'dv-inner-title', hasStaticData: true },\n    { id: 'dv-widget', hasStaticData: true },\n    { id: 'dv-graph', hasStaticData: true },\n  ],\n  layoutDS: DvExampleLayoutDS,\n  layoutEH: DvExampleLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { AbstractLayout } from '../../../common/models/abstract-layout'\nimport { DvExampleLayoutConfig as config } from './example-layout.config';\n\n@Component({\n    selector: 'dv-example-layout',\n    templateUrl: './example-layout.html'\n})\nexport class DvExampleLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n    constructor(){\n        super(config);\n    }\n\n    ngOnInit(){\n        this.onInit();\n    }\n\n    ngOnDestroy(){\n        this.onDestroy();\n    }\n}","// MODULES\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DvComponentsLibModule } from '@n7-frontend/components';\nimport { N7BoilerplateCommonModule } from '../common/n7-boilerplate-common.module';\n//COMPONENTS\nimport { DataWidgetWrapperComponent } from './components/data-widget-wrapper/data-widget-wrapper';\n// LAYOUTS\nimport { DvExampleLayoutComponent } from './layout/example-layout/example-layout';\n\nconst COMPONENTS = [\n  DataWidgetWrapperComponent,\n  DvExampleLayoutComponent,\n];\n\n@NgModule({\n  declarations: COMPONENTS,\n  imports: [\n    CommonModule,\n    DvComponentsLibModule,\n    N7BoilerplateCommonModule,\n  ],\n  providers: [],\n  exports: COMPONENTS\n})\nexport class N7BoilerplateDataVizModule { }","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { N7BoilerplateCommonModule } from './common/n7-boilerplate-common.module';\nimport { N7BoilerplateAriannaWebModule } from './arianna-web/n7-boilerplate-arianna-web.module';\nimport { N7BoilerplateDataVizModule} from './data-viz/n7-boilerplate-data-viz.module';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  providers: [],\n  exports: [\n    //COMMON\n    N7BoilerplateCommonModule,\n    //AW\n    N7BoilerplateAriannaWebModule,\n    //DV\n    N7BoilerplateDataVizModule,\n  ]\n})\nexport class N7BoilerplateLibModule { }\n"]}