{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://@n7-frontend/boilerplate/lib/common/services/configuration.service.ts","ng://@n7-frontend/boilerplate/lib/common/services/layouts-configuration.service.ts","ng://@n7-frontend/boilerplate/lib/common/services/main-state.service.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication-providers/apollo/config.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication-providers/apollo/apollo.provider.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication-providers/rest/config.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication-providers/rest/rest.provider.ts","ng://@n7-frontend/boilerplate/lib/common/services/communication.service.ts","ng://@n7-frontend/boilerplate/lib/common/models/abstract-layout.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/main-layout/main-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/common/services/json-config.service.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input-checkbox.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input-text.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input-link.ts","ng://@n7-frontend/boilerplate/lib/common/models/facet-inputs/facet-input-select.ts","ng://@n7-frontend/boilerplate/lib/common/services/search.service.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/main-layout/main-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/header.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/subnav.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/breadcrumbs.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/facets.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/facets-wrapper.ds.ts","ng://@n7-frontend/boilerplate/lib/common/data-sources/footer.ds.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/header.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/subnav.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/breadcrumbs.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/facets.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/facets-wrapper.eh.ts","ng://@n7-frontend/boilerplate/lib/common/event-handlers/footer.eh.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/main-layout/main-layout.config.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/main-layout/main-layout.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/page404-layout/page404-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/page404-layout/page404-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/page404-layout/page404-layout.config.ts","ng://@n7-frontend/boilerplate/lib/common/layouts/page404-layout/page404-layout.ts","ng://@n7-frontend/boilerplate/lib/common/components/facets-wrapper/facets-wrapper.ts","ng://@n7-frontend/boilerplate/lib/common/n7-boilerplate-common.module.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/about-layout/about-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/about-layout/about-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/linked-objects.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/autocomplete-wrapper.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/bubble-chart.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/hero.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/table.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/home-hero-patrimonio.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/home-bubble-chart.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/home-facets-wrapper.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/home-item-tags-wrapper.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/home-autocomplete.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/entita-nav.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/entita-metadata-viewer.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/tree.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/sidebar-header.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/scheda-breadcrumbs.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/scheda-metadata.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/scheda-image.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/scheda-inner-title.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/data-sources/search-layout-tabs.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/linked-objects.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/autocomplete-wrapper.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/bubble-chart.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/hero.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/home-bubble-chart.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/home-facets-wrapper.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/home-hero-patrimonio.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/home-item-tags-wrapper.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/home-autocomplete.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/entita-nav.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/scheda-breadcrumbs.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/sidebar-header.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/tree.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/search-layout-tabs.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/event-handlers/table.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/about-layout/about-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/about-layout/about-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/entita-layout/entita-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/entita-layout/entita-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/entita-layout/entita-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/entita-layout/entita-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/home-layout/home-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/home-layout/home-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/home-layout/home-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/home-layout/home-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/scheda-layout/scheda-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/scheda-layout/scheda-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/scheda-layout/scheda-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/scheda-layout/scheda-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/works-layout/works-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/works-layout/works-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/works-layout/works-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/works-layout/works-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-facets.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-mock-request.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-layout.ds.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-layout.eh.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-layout.config.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/layouts/search-layout/search-layout.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/components/bubble-chart-wrapper/bubble-chart-wrapper.ts","ng://@n7-frontend/boilerplate/lib/arianna-web/n7-boilerplate-arianna-web.module.ts","ng://@n7-frontend/boilerplate/lib/n7-boilerplate-lib.module.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__read","o","m","Symbol","iterator","r","e","ar","next","done","push","value","error","ConfigurationService","config","_this","defaults","get","key","set","global","keys","forEach","Injectable","args","providedIn","Inject","LayoutsConfigurationService","layouts","MainStateService","custom","default","headTitle","ReplaySubject","pageTitle","subnav","breadcrumbs","filters","get$","_get","getCustom$","update","newValue","_update","updateCustom","has","hasCustom","addCustom","stream$","Error","type","ApolloProviderConfig","getLastPosts","queryName","queryBody","getTree","globalFilter","getEntityDetails","getItemDetails","autoComplete","search","ApolloProvider","http","providerConfig","providers","apollo","err","request$","requestId","options","params","method","httpOptions","query","paramsStr","makeParamsStr","replace","baseUrl","post","pipe","map","response","data","isArray","arrStr_1","val","subParamsStr","isNaN","join","indexOf","HttpClient","RestProviderConfig","RestProvider","rest","point","defaultMethod","toLowerCase","CommunicationService","communicationConfig","defaultProvider","provider","onError","catchError","handleError","console","warn","empty","AbstractLayout","widgets","lb","LayoutBuilder","layoutId","initPayload","onInit","ready$","subscribe","eventHandler","emitInner","init","widgetsConfig","widgetsDataSources","widgetsEventHandlers","dataSource","layoutDS","layoutEH","onDestroy","MainLayoutDS","tslib_1.__extends","_a","configuration","mainState","router","titleService","route","Subject","one","items","setTitle","selected","onNavigate","payload","handler","path","queryParams","navigate","relativeTo","queryParamsHandling","_onRouterNavigate","tippy","hideAll","LayoutDataSource","JsonConfigService","load","of","tap","_handleResponse","toPromise","headTag","document","querySelector","styleElement","createElement","styles_1","configKey","color","hex","unshift","appendChild","createTextNode","FacetInput","output","transform","getId","id","getData","getConfig","getFacetId","facetId","getInputIndex","inputIndex","getSectionIndex","sectionIndex","getContext","filterConfig","context","getTarget","target","getSearchIn","searchIn","getType","getOutput","setData","newData","_setId","index","FacetInputCheckbox","label","source","_meta","setActive","facetValue","checked","FacetInputText","disabled","placeholder","icon","inputPayload","trigger","enterPayload","iconPayload","FacetInputLink","counter","hidden","classes","_isActive","text","split","filter","className","FacetInputSelect","option","INPUTS_MAP","checkbox","link","select","SearchModel","_filters","_facets","_inputs","_results$","_id","getFilters","getFacets","getInputs","_config","getTotalCount","_totalCount","getFields","fields","getResults$","setResults","results","_setFilters","_setFacets","_setPage","_setInputs","_setInputsData","_setTotalCount","updateFilter","remove","getFiltersByFacetId","item","updateFiltersFromQueryParams","selectedFilters","updateInputsFromFilters","getInputByFacetId","updateFacets","facets","updateFacet","updateTotalCount","totalCount","selectedFacets","facet","reset","getRequestParams","page","_page","getInternalFilters","filtersAsQueryParams","input","setInputData","filterTarget","inputs","targetInput","facetData","searchIns","_filterData","setSearchConfigOrderBy","orderBy","order","setSearchConfigDirection","direction","setPageConfigOffset","offset","setPageConfigLimit","limit","_b","operator","metadata","haystack","needle","toLocaleLowerCase","field","sectionConfig","inputConfig","inputModel","SearchService","_models","add","model","MainLayoutEH","_super","destroyed$","listen","innerEvents$","_listenRouterChanges","EventHandler","globalEvents$","takeUntil","first","emitGlobal","HeaderDS","selectNavItem","selectedItem","nav","DataSource","SubnavDS","isActive","getActive","BreadcrumbsDS","FacetsDS","searchModel","FacetsWrapperDS","groups","fieldConfig","fieldIndex","groupId","header","_headerConfig","sections","_getSectionClasses","isOpen","toggleGroup","eventPayload","group","iconRight","onFacetChange","filterValue","updateFilteredTarget","section","inputOutput","updateInputLinks","linksFacetIds","FooterDS","FOOTER_MOCK","HeaderEH","SubnavEH","BreadcrumbsEH","FacetsEH","FacetsWrapperEH","_facetsChanged","requestParams","queryParams_1","emitOuter","FooterEH","MainLayoutConfig","hasStaticData","DS","EH","MainLayoutComponent","layoutsConfiguration","ngOnInit","ngOnDestroy","Component","selector","template","Router","ActivatedRoute","Title","Page404LayoutDS","Page404LayoutEH","Page404LayoutConfig","Page404LayoutComponent","FacetsWrapperComponent","headerEmit","eventType","emit","facetEmit","Input","COMPONENTS","N7BoilerplateCommonModule","forRoot","ngModule","provide","useValue","NgModule","declarations","imports","CommonModule","HttpClientModule","DvComponentsLibModule","exports","AwAboutLayoutDS","AwAboutLayoutEH","AwLinkedObjectsDS","handleShowMoreClick","incomingData","log","makePagination","totalPages","currentPage","result","String","unpackData","size","pageSize","lengthLimit","resultsLimit","slice","el","image","thumbnail","title","includes","info","relatedTOEData","toe","count","crumb","pagination","prev","last","links","previews","actions","Math","floor","AwAutocompleteWrapperDS","regex","RegExp","suggestion","maxLength","match","exec","prefix","suffix","AwBubbleChartDS","thresholdShowTitle","thresholdShowValue","allBubbles","entityBubbleIdMap","selectedBubbles","bubblePopup","currentHoverEntity","_bubbleChart","maxBubblesSelectable","windowResizeSet","destroyTooltip","bubbles","filterBubblesBasedOnFacetsEnabled","bubbleCointainer","getElementById","containerId","cWidth","width","offsetWidth","containerSize","bubblesData","bubbleContainerId","containerWidth","containerHeight","isForceSimulationEnabled","maxBubblesSelected","maxBubbleCount","minBubbleCount","numOfBubbles","bubble","numOfSelectedBubbles","bId","bubblePercentage","bubbleRadius","sqrt","bubbleData","texts","radius","entity","x_function","x","y_function","mNum","y","user_select","fontSize_function","cHeight","hasCloseIcon","xPull","xPullStrength","yPull","yPullStrength","collisionStrengh","collisionIterations","velocityDecay","setUpdateReference","setBubbleChart","setWindowResize","setAllBubblesFromApolloQuery","entitiesData","currentToE","j","entitiesCountData","configKeys","countData","connectedEntities","typeOfEntity","convertEntityIdToBubbleId","entityId","enabled","onBubbleMouseEnter","bubbleId","hoverEntityId","hide","destroy","setTimeout","templateClone","cloneNode","display","content","allowHTML","interactive","arrow","theme","placement","maxWidth","show","onBubbleTooltipClick","bubbleId_1","bubble_1","selectAll","each","onBubbleSelected","getBubbleFromId","getSelectedBubbles","getAllBubbles","getEntityIdMap","fromEvent","window","debounce","interval","bubblePayload","AwHeroDS","button","backgroundImage","AwTableDS","TABLE_MOCK","AwHomeHeroPatrimonioDS","AwHomeBubbleChartDS","maxBubbleValue","minBubbleValue","AwHomeFacetsWrapperDS","tippyMaker","res","undefined","open","ac_1","flip","appendTo","onHidden","onShow","node","getElementsByClassName","setAttribute","setContent","ac","lockedFacets","headers","locked","headerClasses","iconClasses","iconLeft","additionalText","every","f","widgetData","h","AwHomeItemTagsWrapperDS","AwHomeAutocompleteDS","itemIds","metaDataValue_1","infoData","showMore","fallback","AwEntitaNavDS","param","navigation","fieldsTab","entities","extraTab","wikiTab","AwEntitaMetadataViewerDS","unpackFields","extracted","thisField","temp","AwTreeDS","toggleNav","updateTree","parents","it","selectTreeItem","currentItem","toggleSidebar","sidebarData","parseData","treeObj","parseTree","toggle","currParents","concat","__spread","treeItem","showToggle","AwSidebarHeaderDS","AwSchedaBreadcrumbsDS","AwSchedaMetadataDS","AwSchedaImageDS","AwSchedaInnerTitleDS","AwSearchLayoutTabsDS","setSelected","tabId","AwLinkedObjectsEH","startsWith","targetPage","Number","outerEvents$","AwAutocompleteWrapperEH","AwBubbleChartEH","event","entityIdmap","currBubble","selectData","AwHeroEH","AwHomeBubbleChartEH","AwHomeFacetsWrapperEH","AwHomeHeroPatrimonioEH","AwHomeItemTagsWrapperEH","AwHomeAutocompleteEH","AwEntitaNavEH","AwSchedaSidebarEH","AwSidebarHeaderEH","AwTreeEH","AwSearchLayoutTabsEH","AwTableEH","AwAboutLayoutConfig","layoutOptions","AwAboutLayoutComponent","AwEntitaLayoutDS","myResponse","navHeader","handleNavUpdate","tab","selectedTab","updateWidgets","communication","bubblesEnabled","getNavigation","loadItem","currentId","loadContent","updateOptions","AwEntitaLayoutEH","snapshot","listenRoute","loadNavigation","entitaBasePath","paramMap","AwEntitaLayoutConfig","AwEntitaLayoutComponent","AwHomeLayoutDS","facetInputs","autocompletePopoverOpen","autocompleteChanged$","numOfItemsStr","lastWindowWidth","hasScrollBackground","loadingBubbles","updateComponent","outerWidth","_listenAutoCompleteChanges","makeRequest$","initialFilterRequest","parseInitialRequest","ent","teoConfigData","renderPreviewsFromApolloQuery","itemsPagination","numOfItems","numOfThousand","numOfItemsTmpStr","onBubbleDeselected","filterRequest","getBubblePayload","bubbleCref","selectedEntitiesIds","k_1","activeBubbles_1","places","people","concepts","organizations","sB","obj","c","find","updateBubbles","onlyBubbles","updateBubbleFilter","updateTags","renderItemTags","handleFacetSearchChange","change","handleFacetSearchEnter","enter","handleFacetHeaderClick","enabledFacets","disableFacetsIds_1","fD","filteredSelectedBubbles","tagsData","sBubble","onTagClicked","onHeroChange","_scrollBackgroundControl","source$","_setHasScrollBackground","debounceTime","scrollTop","scrollHeight","clientHeight","_toggleAutocompletePopover","autocompletePopover","style","AwHomeLayoutEH","loadFilters","typeOfConfigKey","dataSource_1","AwHomeLayoutConfig","AwHomeLayoutComponent","AwSchedaLayoutDS","sidebarCollapsed","bubbleChartSectionTitle","similarItemsSectionTitle","metadataSectionTitle","hasSimilarItems","treeId","updateNavigation","maxSimilarItems","itemId","contentParts","images_1","url","buildPyramid","imageViewerIstance","viewerId","_setViewer","viewer","titleObj","main","tools","subTitle","group_1","hasMetadata","breadcrumbs_1","element","collapseSidebar","innerWidth","AwSchedaLayoutEH","paramId","schedaBasePath","hasBubbles","AwPatrimonioLayoutConfig","AwSchedaLayoutComponent","AwWorksLayoutDS","AwWorksLayoutEH","AwWorksLayoutConfig","AwWorksLayoutComponent","facetsConfig","delay","minChars","highlight","_getFacet","_getQueryLinksData","random","_getEntityTypesData","_getDateFromData","_getDateToData","_getEntityLinksData","types","entity-type","SEARCH_MODEL_ID","AwSearchLayoutDS","orderByLabel","orderByOptions","getSearchModelId","doSearchRequest$","onOrderByChange","onPaginationChange","_updateSearchPage","onPaginationGoToChange","onResultsLimitChange","withLatestFrom","fakeSearchRequest$","resultsResponse","searchResponse","resultsTitleIndex","resultsTitle","newOffset","AwSearchLayoutEH","facetsChange$","_listenToFacetsChange","changed","AwSearchLayoutConfig","AwSearchLayoutComponent","BubbleChartWrapperComponent","onClick","N7BoilerplateAriannaWebModule","N7BoilerplateLibModule"],"mappings":"m6BAgBA,IAAIA,EAAgB,SAASC,EAAGC,GAI5B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,MACpDN,EAAGC,IAGrB,SAASO,EAAUR,EAAGC,GAEzB,SAASQ,IAAOC,KAAKC,YAAcX,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEY,UAAkB,OAANX,EAAaC,OAAOW,OAAOZ,IAAMQ,EAAGG,UAAYX,EAAEW,UAAW,IAAIH,GAG5E,IAAIK,EAAW,WAQlB,OAPAA,EAAWZ,OAAOa,QAAU,SAAkBC,GAC1C,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAIZ,KADTW,EAAIG,UAAUF,GACOhB,OAAOU,UAAUL,eAAee,KAAKL,EAAGX,KAAIU,EAAEV,GAAKW,EAAEX,IAE9E,OAAOU,IAEKO,MAAMb,KAAMU,YAkFzB,SAASI,EAAOC,EAAGN,GACtB,IAAIO,EAAsB,mBAAXC,QAAyBF,EAAEE,OAAOC,UACjD,IAAKF,EAAG,OAAOD,EACf,IAAmBI,EAAYC,EAA3BZ,EAAIQ,EAAEJ,KAAKG,GAAOM,EAAK,GAC3B,IACI,WAAc,IAANZ,GAAgBA,KAAM,MAAQU,EAAIX,EAAEc,QAAQC,MAAMF,EAAGG,KAAKL,EAAEM,OAExE,MAAOC,GAASN,EAAI,CAAEM,MAAOA,GACjC,QACQ,IACQP,IAAMA,EAAEI,OAASP,EAAIR,EAAU,SAAIQ,EAAEJ,KAAKJ,GAE1D,QAAkB,GAAIY,EAAG,MAAMA,EAAEM,OAE7B,OAAOL,ECrIX,IAAAM,EAAA,WAQE,SAAAA,EAAsCC,GAAtC,IAAAC,EAAA7B,KAAsCA,KAAA4B,OAAAA,EAF9B5B,KAAA8B,SAAgB,GAUjB9B,KAAA+B,IAAG,SAAIC,GAAQ,OAAAH,EAAKC,SAASE,IAC7BhC,KAAAiC,IAAG,SAAID,EAAKP,GAAU,OAAAI,EAAKC,SAASE,GAAOP,GAR7CzB,KAAK4B,OAAOM,QACb1C,OAAO2C,KAAKnC,KAAK4B,OAAOM,QAAQE,QAAO,SAACJ,GACtCH,EAAKI,IAAID,EAAKH,EAAKD,OAAOM,OAAOF,iCATxCK,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,6EAKCC,EAAAA,OAAMF,KAAA,CAAC,4IARtB,GCAA,IAAAG,EAAA,WAQE,SAAAA,EAAsCb,GAAtC,IAAAC,EAAA7B,KAAsCA,KAAA4B,OAAAA,EAF9B5B,KAAA8B,SAAgB,GAUjB9B,KAAA+B,IAAG,SAAIC,GAAQ,OAAAH,EAAKC,SAASE,IAC7BhC,KAAAiC,IAAG,SAAID,EAAKP,GAAU,OAAAI,EAAKC,SAASE,GAAOP,GAR7CzB,KAAK4B,OAAOc,SACblD,OAAO2C,KAAKnC,KAAK4B,OAAOc,SAASN,QAAO,SAACJ,GACvCH,EAAKI,IAAID,EAAKH,EAAKD,OAAOc,QAAQV,iCATzCK,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,6EAKCC,EAAAA,OAAMF,KAAA,CAAC,4IARtB,GCAA,IAAAK,EAAA,WAGA,SAAAA,IAAA,IAAAd,EAAA7B,KAKUA,KAAA4C,OAAc,GAGd5C,KAAA6C,QAMJ,CACFC,UAAW,IAAIC,EAAAA,cACfC,UAAW,IAAID,EAAAA,cACfE,OAAQ,IAAIF,EAAAA,cACZG,YAAa,IAAIH,EAAAA,cACjBI,QAAS,IAAIJ,EAAAA,eAGR/C,KAAAoD,KAAI,SAAIpB,GAAgB,OAAAH,EAAKwB,KAAK,UAAWrB,IAC7ChC,KAAAsD,WAAU,SAAItB,GAAgB,OAAAH,EAAKwB,KAAK,SAAUrB,IAElDhC,KAAAuD,OAAM,SAAIvB,EAAawB,GAAkB,OAAA3B,EAAK4B,QAAQ,UAAWzB,EAAKwB,IACtExD,KAAA0D,aAAY,SAAI1B,EAAawB,GAAkB,OAAA3B,EAAK4B,QAAQ,SAAUzB,EAAKwB,IAE3ExD,KAAA2D,IAAG,SAAI3B,GAAgB,QAAEH,EAAKgB,QAAQb,IACtChC,KAAA4D,UAAS,SAAI5B,GAAgB,QAAEH,EAAKe,OAAOZ,WAE3CW,EAAAzC,UAAA2D,UAAP,SAAiB7B,EAAa8B,GAC5B,GAAG9D,KAAK4C,OAAOZ,GAAM,MAAM+B,MAAM,iBAAiB/B,EAAG,YAErDhC,KAAK4C,OAAOZ,GAAO8B,GAGbnB,EAAAzC,UAAAuD,QAAR,SAAgBO,EAAchC,EAAawB,GACzC,IAAIxD,KAAKgE,GAAO,MAAMD,MAASC,EAAI,kCACnC,IAAIhE,KAAKgE,GAAMhC,GAAM,MAAM+B,MAASC,EAAI,WAAWhC,EAAG,qBAEtDhC,KAAKgE,GAAMhC,GAAKV,KAAKkC,IAGfb,EAAAzC,UAAAmD,KAAR,SAAaW,EAAchC,GACzB,IAAIhC,KAAKgE,GAAO,MAAMD,MAASC,EAAI,kCACnC,IAAIhE,KAAKgE,GAAMhC,GAAM,MAAM+B,MAASC,EAAI,WAAWhC,EAAG,qBAEtD,OAAOhC,KAAKgE,GAAMhC,wBAhDrBK,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,kHAJd,GCAA,IAAa0B,EAAuB,CAClCC,aAAgB,CACdC,UAAW,eACXC,UAAW,0GAUbC,QAAW,CACTF,UAAW,iBACXC,UAAW,sbA4BbE,aAAgB,CACdH,UAAW,eACXC,UAAW,g4BA+CbG,iBAAoB,CAClBJ,UAAW,mBACXC,UAAW,+9BA0DbI,eAAkB,CAChBL,UAAW,iBACXC,UAAW,ijCAwDbK,aAAgB,CACdN,UAAW,eACXC,UAAW,wWAsBbM,OAAU,CACRP,UAAW,SACXC,UAAW,qIC5OfO,EAAA,WAeE,SAAAA,EACU/C,EACAgD,GADA5E,KAAA4B,OAAAA,EACA5B,KAAA4E,KAAAA,EAER,IACE5E,KAAK6E,eAAiB7E,KAAK4B,OAAOG,IAAI,iBAAiB+C,UAAUC,OACjE,MAAMC,GACN,MAAMjB,MAAM,gDAIhBY,EAAAzE,UAAA+E,SAAA,SAASC,EAAWC,GACV,IAAAC,EAAAD,EAAAC,OAAQC,EAAAF,EAAAE,OAAQC,EAAAH,EAAAG,YACpBC,EAAQtB,EAAqBiB,GAE9BlF,KAAK6E,eAAejD,QAAU5B,KAAK6E,eAAejD,OAAOsD,KAC1DK,EAAQvF,KAAK6E,eAAejD,OAAOsD,IAI/B,IAAAf,GADNoB,EAAQA,GAAS,IACXpB,UAAWC,EAAAmB,EAAAnB,UAGjB,IAAID,IAAcC,EAAW,MAAML,MAAM,kCAAkCmB,EAAS,KAEpF,GAAGE,EAAO,KACJI,EAAYxF,KAAKyF,cAAcL,GACnChB,EAAYA,EAAUsB,QAAQ,aAAcF,QAE5CpB,EAAYA,EAAUsB,QAAQ,eAAgB,IAWhD,OANGL,GAAqB,QAAXA,EACDrF,KAAK4E,KAAK7C,IAAI/B,KAAK6E,eAAec,SAElC3F,KAAK4E,KAAKgB,KAAK5F,KAAK6E,eAAec,QAAS,CAAEJ,MAAOnB,GAAakB,IAG/DO,KACbC,EAAAA,IAAG,SAAEC,GAAkB,OAAAA,EAASC,KAAK7B,OAIjCQ,EAAAzE,UAAAuF,cAAR,SAAsBL,GAAtB,IAAAvD,EAAA7B,KACMwF,EAAY,GAwBhB,OAvBAhG,OAAO2C,KAAKiD,GAAQhD,QAAO,SAACJ,GAC1B,GAAGrC,MAAMsG,QAAQb,EAAOpD,IAAM,KACxBkE,EAAS,GACbd,EAAOpD,GAAKI,QAAO,SAAE+D,GACnB,GAAiB,iBAAd,EAAuB,KACpBC,EAAevE,EAAK4D,cAAcU,GACtCD,EAAO1E,KAAK,KAAK4E,EAAY,WAEzBC,MAAMF,GACLD,EAAO1E,KAAK,IAAI2E,EAAG,KADRD,EAAO1E,KAAK,GAAG2E,KAInCX,EAAUhE,KAAQQ,EAAG,MAAMkE,EAAOI,KAAK,KAAI,UACtC,GAA0B,iBAAflB,EAAOpD,IAAoBoD,EAAOpD,GAAM,KAClDoE,EAAevE,EAAK4D,cAAcL,EAAOpD,IAC7CwD,EAAUhE,KAAQQ,EAAG,OAAOoE,EAAY,UACX,iBAAfhB,EAAOpD,IAAyC,IAArBA,EAAIuE,QAAQ,KACvDf,EAAUhE,KAAQQ,EAAI0D,QAAQ,IAAK,IAAG,KAAKN,EAAOpD,IAE9CqE,MAAMjB,EAAOpD,IACZwD,EAAUhE,KAAQQ,EAAG,MAAMoD,EAAOpD,GAAI,KADnBwD,EAAUhE,KAAQQ,EAAG,KAAKoD,EAAOpD,MAItDwD,EAAUc,KAAK,0BA5EzBjE,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,oDAPLZ,SAFA6E,EAAAA,6JADT,GCAA,IAAaC,EAAqB,CAChCvC,aAAgB,SCDlBwC,EAAA,WAaE,SAAAA,EACU9E,EACAgD,GADA5E,KAAA4B,OAAAA,EACA5B,KAAA4E,KAAAA,EAER,IACE5E,KAAK6E,eAAiB7E,KAAK4B,OAAOG,IAAI,iBAAiB+C,UAAU6B,KACjE,MAAM3B,GACN,MAAMjB,MAAM,8CAIhB2C,EAAAxG,UAAA+E,SAAA,SAASC,EAAWC,QAAA,IAAAA,IAAAA,EAAA,IACZ,IAAAC,EAAAD,EAAAC,OAAQC,EAAAF,EAAAE,OAAQC,EAAAH,EAAAG,YAClBsB,EAAQH,EAAmBvB,GAU/B,GAPIG,IAAQA,EAASrF,KAAK6E,eAAegC,eAAiB,OAEvD7G,KAAK6E,eAAejD,QAAU5B,KAAK6E,eAAejD,OAAOsD,KAC1D0B,EAAQ5G,KAAK6E,eAAejD,OAAOsD,KAIjC0B,EAAO,MAAM7C,MAAM,kCAAkCmB,EAAS,KAElE,GAAc,SAAXG,GAAgC,QAAXA,EACtB,OAAOrF,KAAK4E,KAAKS,EAAOyB,eAAe9G,KAAK6E,eAAec,QAAUiB,EAAOxB,EAAQE,GAC/E,GAAc,QAAXD,GAA+B,WAAXA,EAC5B,OAAOrF,KAAK4E,KAAKS,EAAOyB,eAAe9G,KAAK6E,eAAec,QAAUiB,EAAOtB,GAE5E,MAAMvB,MAAM,eAAesB,EAAM,uCApCtChD,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,oDALLZ,SAFA6E,EAAAA,6JADT,GCAA,IAAAO,EAAA,WAcE,SAAAA,EACUnF,EACAmD,EACA4B,GAFA3G,KAAA4B,OAAAA,EACA5B,KAAA+E,OAAAA,EACA/E,KAAA2G,KAAAA,EAER,IACE3G,KAAKgH,oBAAsBhH,KAAK4B,OAAOG,IAAI,iBAC3C/B,KAAKiH,gBAAkBjH,KAAKgH,oBAAoBC,gBAChD,MAAMjC,GACN,MAAMjB,MAAM,8DAIhBgD,EAAA7G,UAAA+E,SAAA,SAASC,EAAWC,EAAmB+B,GAAvC,IAAArF,EAAA7B,KAEE,QAFkB,IAAAmF,IAAAA,EAAA,KAEdnF,KADJkH,EAAWA,GAAYlH,KAAKiH,iBACR,MAAMlD,MAAM,eAAemD,EAAQ,aAE/C,IAAAC,EAAAhC,EAAAgC,QACR,OAAOnH,KAAKkH,GAAUjC,SAASC,EAAWC,GACvCU,KACCuB,EAAAA,WAAU,SAAE1F,GAAU,OAAAG,EAAKwF,YAAY3F,EAAOyF,OAIpDJ,EAAA7G,UAAAmH,YAAA,SAAY3F,EAAOyF,GAOjB,OANGA,EACDA,EAAQzF,GAER4F,QAAQC,KAAK,6CAA8C7F,GAGtD8F,EAAAA,6BAtCVnF,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,oDAPLZ,SACAgD,SACA+B,uJAHT,GCEA,iBAKE,SAAAe,EAAY7F,GACV5B,KAAK4B,OAASA,EACd5B,KAAK0H,QAAU1H,KAAK4B,OAAO8F,QAC3B1H,KAAK2H,GAAK,IAAIC,EAAAA,cAAc5H,KAAK4B,OAAOiG,UAuB5C,OApBYJ,EAAAvH,UAAA4H,YAAV,aAEUL,EAAAvH,UAAA6H,OAAV,WAAA,IAAAlG,EAAA7B,KAEEA,KAAK2H,GAAGK,OAAOC,UAAS,WACtBpG,EAAK8F,GAAGO,aAAaC,UAAU,OAAQtG,EAAKiG,iBAG9C9H,KAAK2H,GAAGS,KAAK,CACXC,cAAerI,KAAK0H,QACpBY,mBAAoBtI,KAAK4B,OAAO0G,mBAChCC,qBAAsBvI,KAAK4B,OAAO2G,qBAClCC,WAAY,IAAIxI,KAAK4B,OAAO6G,SAC5BP,aAAc,IAAIlI,KAAK4B,OAAO8G,YAIxBjB,EAAAvH,UAAAyI,UAAV,WACE3I,KAAK2H,GAAGO,aAAaC,UAAU,YAEnCV,uBC7BA,SAAAmB,mDA4EA,OA5EkCC,EAAAA,EAAAA,GAUhCD,EAAA1I,UAAA6H,OAAA,SAAOe,GAAP,IAAAjH,EAAA7B,KAAS+I,EAAAD,EAAAC,cAAeC,EAAAF,EAAAE,UAAWC,EAAAH,EAAAG,OAAQ9D,EAAA2D,EAAA3D,QAAS+D,EAAAJ,EAAAI,aAAcC,EAAAL,EAAAK,MAChEnJ,KAAK+I,cAAgBA,EACrB/I,KAAKgJ,UAAYA,EACjBhJ,KAAKiJ,OAASA,EACdjJ,KAAKmJ,MAAQA,EACbnJ,KAAKkJ,aAAeA,EACpBlJ,KAAKmF,QAAUA,EACfnF,KAAKgJ,UAAUnF,UAAU,aAAc,IAAIuF,EAAAA,SAG3CpJ,KAAKqJ,IAAI,UAAU9F,OAAO,CAAC+F,MAAStJ,KAAK+I,cAAchH,IAAI,YAG3D/B,KAAKgJ,UAAU5F,KAAK,aAAa6E,UAAS,SAAC9B,GAAO,OAAAtE,EAAKqH,aAAaK,SAASpD,KAC7EnG,KAAKgJ,UAAU5F,KAAK,aAAa6E,UAAS,SAAC9B,GAAO,OAAAtE,EAAKmB,UAAYmD,IACnEnG,KAAKgJ,UAAU5F,KAAK,UAAU6E,UAAS,SAAC9B,GAAO,OAAAtE,EAAKwH,IAAI,UAAU9F,OAAO4C,KACzEnG,KAAKgJ,UAAU5F,KAAK,eAAe6E,UAAS,SAAC9B,GAAO,OAAAtE,EAAKwH,IAAI,eAAe9F,OAAO4C,KAEnFnG,KAAKgJ,UAAU1F,WAAW,cAAc2E,UAAS,SAAC9B,GAAO,OAAAtE,EAAKwH,IAAI,UAAU9F,OAAO,CAAC+F,MAASzH,EAAKkH,cAAchH,IAAI,UAAWyH,SAAYrD,OAqB7IyC,EAAA1I,UAAAuJ,WAAA,SAAWC,GAET,GAAuB,WAApBA,EAAQC,QAAqB,CACtB,IAAAC,EAAAF,EAAAE,KAAMC,EAAAH,EAAAG,YAGd,IAAID,EAAM,MAAM7F,MAAM,2CAEnB8F,EACD7J,KAAKiJ,OAAOa,SAASF,EAAM,CACzBG,WAAY/J,KAAKmJ,MACjBU,YAAaA,EACbG,oBAAqB,UAGvBhK,KAAKiJ,OAAOa,SAASF,GAIvB5J,KAAKiK,sBAIDrB,EAAA1I,UAAA+J,kBAAR,WAEEC,EAAMC,WAEVvB,GA5EkCwB,EAAAA,kBCJlC,IAAAC,EAAA,WAUE,SAAAA,EACUzF,EACAhD,GADA5B,KAAA4E,KAAAA,EACA5E,KAAA4B,OAAAA,SAGVyI,EAAAnK,UAAAoK,KAAA,SAAKV,GAAL,IAAA/H,EAAA7B,KACE,OAAOA,KAAK4E,KAAK7C,IAAI6H,GAAM/D,KACzBuB,EAAAA,WAAU,SAAE1F,GAAU,OAAA6I,EAAAA,GAAG,MACzBC,EAAAA,IAAG,SAACzE,GAAY,OAAAlE,EAAK4I,gBAAgB1E,MACrC2E,aAGIL,EAAAnK,UAAAuK,gBAAR,SAAwB1E,GAAxB,IAAAlE,EAAA7B,KACE,GAAG+F,IACDvG,OAAO2C,KAAK4D,GAAU3D,QAAO,SAACJ,GAAO,OAAAH,EAAKD,OAAOK,IAAID,EAAK+D,EAAS/D,MAGhE+D,EAAS,gBAAe,KACnB4E,EAAUC,SAASC,cAAc,QACrCC,EAAeF,SAASG,cAAc,SAEpCC,EAAS,GAEbxL,OAAO2C,KAAK4D,EAAS,gBAAgB3D,QAAO,SAACJ,OACrCiJ,EAAYlF,EAAS,eAAe/D,IAAQ,GAE/CiJ,EAAUC,OAASD,EAAUC,MAAMC,KAEpCH,EAAOxJ,KAAK,WAAWQ,EAAG,KAAKiJ,EAAUC,MAAMC,IAAG,OAInDH,EAAOrK,SACRqK,EAAOI,QAAQ,WACfJ,EAAOxJ,KAAK,KACZsJ,EAAaO,YAAYT,SAASU,eAAeN,EAAO1E,KAAK,QAC7DqE,EAAQU,YAAYP,0BAxC7BzI,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,oDANLiE,EAAAA,kBAEA7E,oJAHT,GCQA,IAAA4J,EAAA,WAQE,SAAAA,EAAY3J,GAAZ,IAAAC,EAAA7B,KAUOA,KAAAuD,OAAM,WAAS,OAAA1B,EAAK2J,OAAS3J,EAAK4J,aAClCzL,KAAA0L,MAAK,WAAS,OAAA7J,EAAK8J,IACnB3L,KAAA4L,QAAO,WAAS,OAAA/J,EAAKmE,MACrBhG,KAAA6L,UAAS,WAAS,OAAAhK,EAAKD,QACvB5B,KAAA8L,WAAU,WAAS,OAAAjK,EAAKD,OAAOmK,SAC/B/L,KAAAgM,cAAa,WAAS,OAAAnK,EAAKD,OAAOqK,YAClCjM,KAAAkM,gBAAe,WAAS,OAAArK,EAAKD,OAAOuK,cACpCnM,KAAAoM,WAAU,WAAS,OAAAvK,EAAKD,OAAOyK,aAAaC,SAAW,YACvDtM,KAAAuM,UAAS,WAAS,OAAA1K,EAAKD,OAAOyK,aAAaG,QAAU,MACrDxM,KAAAyM,YAAW,WAAS,OAAA5K,EAAKD,OAAOyK,aAAaK,UAAY,MACzD1M,KAAA2M,QAAO,WAAS,OAAA9K,EAAKD,OAAOoC,MAC5BhE,KAAA4M,UAAS,WAAS,OAAA/K,EAAK2J,QAEvBxL,KAAA6M,QAAO,SAAIC,GAA+B,OAAAjL,EAAKmE,KAAO8G,GAtB3D9M,KAAK4B,OAASA,EACd5B,KAAK+M,SAELxB,EAAWyB,QAuBf,OAHUzB,EAAArL,UAAA6M,OAAR,WACE/M,KAAK2L,GAAK,eAAe3L,KAAK2M,UAAS,IAAIpB,EAAWyB,OAhCjDzB,EAAAyB,MAAgB,EAkCzBzB,EAnCA,qBCNA,SAAA0B,mDAqCA,OArCwCpE,EAAAA,EAAAA,GAE5BoE,EAAA/M,UAAAuL,UAAV,WAAA,IAAA5J,EAAA7B,KACQ+L,EAAU/L,KAAK8L,aAErB,OAAO9L,KAAKgG,KAAKF,IAAG,SAAEgD,EAAkBkE,OAAhBE,EAAApE,EAAAoE,MAAOzL,EAAAqH,EAAArH,MAI7B,OAFAA,EAAQ,GAAKA,EAEN,CACLuC,KAAM,WACN2H,GAAI9J,EAAK6J,QAAU,IAAMsB,EACzBE,MAAOA,EACPxD,QAAS,CACPqC,QAAOA,EACPoB,OAAQ,iBACR1L,MAAKA,GAEP2L,MAAO,CAAErB,QAAOA,EAAEtK,MAAKA,OAKtBwL,EAAA/M,UAAAmN,UAAP,SAAiBC,GACP,IAAArH,EAAAjG,KAAA4B,OAAAyK,aAAApG,QAERjG,KAAKwL,OAAOpJ,QAAO,SAACR,GACfqE,GAAWtG,MAAMsG,QAAQqH,KAA2D,IAA5CA,EAAW/G,QAAQ3E,EAAOwL,MAAM3L,OACzEG,EAAO2L,SAAU,EACTD,IAAe1L,EAAOwL,MAAM3L,MACpCG,EAAO2L,SAAU,EAEjB3L,EAAO2L,SAAU,KAKzBN,GArCwC1B,iBCAxC,SAAAiC,mDAqCA,OArCoC3E,EAAAA,EAAAA,GAExB2E,EAAAtN,UAAAuL,UAAV,eACQM,EAAU/L,KAAK8L,aAEfpC,EAAU,CACdqC,QAAOA,EACPoB,OAAQ,cAGV,MAAO,CACLnJ,KAAM,OACN2H,GAAI3L,KAAK0L,QACTwB,MAAOlN,KAAK4B,OAAOsL,MACnBO,SAAUzN,KAAK4B,OAAO6L,SACtBC,YAAa1N,KAAK4B,OAAO8L,YACzBC,KAAM3N,KAAK4B,OAAO+L,KAClBC,aAAYxN,EAAA,GACPsJ,EAAO,CACVmE,QAAS,UAEXC,aAAY1N,EAAA,GACPsJ,EAAO,CACVmE,QAAS,UAEXE,YAAW3N,EAAA,GACNsJ,EAAO,CACVmE,QAAS,SAEXT,MAAO,CAAErB,QAAOA,KAIbyB,EAAAtN,UAAAmN,UAAP,SAAiBC,GACftN,KAAKwL,OAAO/J,MAAQ6L,GAAc,MAGtCE,GArCoCjC,iBCApC,SAAAyC,mDAsDA,OAtDoCnF,EAAAA,EAAAA,GAGxBmF,EAAA9N,UAAAuL,UAAV,WAAA,IAAA5J,EAAA7B,KACQ+L,EAAU/L,KAAK8L,aAErB,OAAO9L,KAAKgG,KAAKF,IAAG,SAAEgD,OAAEoE,EAAApE,EAAAoE,MAAOzL,EAAAqH,EAAArH,MAAOwM,EAAAnF,EAAAmF,QAASC,EAAApF,EAAAoF,OAAQ/I,EAAA2D,EAAA3D,QAErD1D,EAAQ,GAAKA,MAGT0M,EAAU,GAKd,OAPAhJ,EAAUA,GAAW,IAGVgJ,SAASA,EAAQ3M,KAAK2D,EAAQgJ,SACtCD,GAAQC,EAAQ3M,KAAK,aACrBK,EAAKuM,UAAUvM,EAAKyL,WAAY7L,IAAQ0M,EAAQ3M,KAAK,aAEjD,CACLwC,KAAM,OACN2H,GAAI9J,EAAK6J,QACT2C,KAAMnB,EACNe,QAAOA,EACPvE,QAAS,CACPqC,QAAOA,EACPoB,OAAQ,aACR1L,MAAKA,GAEPkM,KAAMxI,EAAQwI,MAAQ,KACtBQ,QAASA,EAAQ7H,KAAK,KACtB8G,MAAO,CAAErB,QAAOA,EAAEtK,MAAKA,OAKtBuM,EAAA9N,UAAAmN,UAAP,SAAiBC,GAAjB,IAAAzL,EAAA7B,KACEA,KAAKwL,OAAOpJ,QAAO,SAACR,OACduM,EAAUvM,EAAOuM,QAAUvM,EAAOuM,QAAQG,MAAM,KAAO,GAC9CzM,EAAKuM,UAAUd,EAAY1L,EAAOwL,MAAM3L,QAGT,IAAlC0M,EAAQ5H,QAAQ,cACxB4H,EAAQ3M,KAAK,aAFb2M,EAAUA,EAAQI,OAAM,SAACC,GAAa,MAAc,cAAdA,IAIxC5M,EAAOuM,QAAUA,EAAQ7H,KAAK,QAI1B0H,EAAA9N,UAAAkO,UAAR,SAAkBd,EAAY7L,GAG5B,OAFAzB,KAAKsN,WAAaA,EAGf3N,MAAMsG,QAAQqH,KAA8C,IAA/BA,EAAW/G,QAAQ9E,IAChD6L,IAAe7L,GAGtBuM,GAtDoCzC,qBCApC,SAAAkD,mDA6BA,OA7BsC5F,EAAAA,EAAAA,GAE1B4F,EAAAvO,UAAAuL,UAAV,eACQM,EAAU/L,KAAK8L,aAErB,MAAO,CACL9H,KAAM,SACN2H,GAAI3L,KAAK0L,QACTwB,MAAOlN,KAAK4B,OAAOsL,MACnBO,SAAUzN,KAAK4B,OAAO6L,SACtBtI,QAASnF,KAAKgG,KAAKF,IAAG,SAAEgD,GAAqB,MAAA,CAE3CrH,MAAO,GAFiBqH,EAAArH,MAGxByL,MAH+BpE,EAAAoE,SAKjCxD,QAAS,CACPqC,QAAOA,EACPoB,OAAQ,gBAEVC,MAAO,CAAErB,QAAOA,KAIb0C,EAAAvO,UAAAmN,UAAP,SAAiBC,GACftN,KAAKwL,OAAOrG,QACToJ,OAAM,SAACG,GAAU,OAAAA,EAAOjN,QAAU6L,IAClClL,QAAO,SAACsM,GAAU,OAAAA,EAAOlF,UAAW,KAG3CiF,GA7BsClD,GCYhCoD,EAAa,CACjBC,SAAY3B,EACZoB,KAAQb,EACRqB,KAAQb,EACRc,OAAUL,GA8BZ,IAAAM,EAAA,WAUE,SAAAA,EAAYpD,EAAY/J,GAAxB,IAAAC,EAAA7B,KARQA,KAAAgP,SAAsB,GACtBhP,KAAAiP,QAAoB,GACpBjP,KAAAkP,QAAwB,GAIxBlP,KAAAmP,UAA4B,IAAI/F,EAAAA,QAcjCpJ,KAAA0L,MAAK,WAAS,OAAA7J,EAAKuN,KACnBpP,KAAAqP,WAAU,WAAS,OAAAxN,EAAKmN,UACxBhP,KAAAsP,UAAS,WAAS,OAAAzN,EAAKoN,SACvBjP,KAAAuP,UAAS,WAAS,OAAA1N,EAAKqN,SACvBlP,KAAA6L,UAAS,WAAS,OAAAhK,EAAK2N,SACvBxP,KAAAyP,cAAa,WAAS,OAAA5N,EAAK6N,aAC3B1P,KAAA2P,UAAS,WAAS,OAAA9N,EAAK2N,QAAQI,QAC/B5P,KAAA6P,YAAW,WAAS,OAAAhO,EAAKsN,WAEzBnP,KAAA8P,WAAU,SAAIC,GAAY,OAAAlO,EAAKsN,UAAU7N,KAAKyO,IApBnD/P,KAAKoP,IAAMzD,EACX3L,KAAKwP,QAAU5N,EAEf5B,KAAKgQ,cACLhQ,KAAKiQ,aACLjQ,KAAKkQ,WACLlQ,KAAKmQ,aACLnQ,KAAKoQ,iBACLpQ,KAAKqQ,iBAsPT,OAxOStB,EAAA7O,UAAAoQ,aAAP,SAAoBvE,EAAStK,EAAO8O,GACVvQ,KAAKwQ,oBAAoBzE,GACjC3J,QAAO,SAACmM,GACnB5O,MAAMsG,QAAQsI,EAAO9M,QAAU8O,EAChChC,EAAO9M,MAAQ8M,EAAO9M,MAAM8M,OAAM,SAACkC,GAAQ,OAAAA,IAAShP,IAC5C9B,MAAMsG,QAAQsI,EAAO9M,SAA2C,IAAjC8M,EAAO9M,MAAM8E,QAAQ9E,GAC5D8M,EAAO9M,MAAMD,KAAKC,GAElB8M,EAAO9M,MAAS8O,EAAiB,KAAR9O,KAKxBsN,EAAA7O,UAAAwQ,6BAAP,SAAoC7G,GAApC,IAAAhI,EAAA7B,KACER,OAAO2C,KAAK0H,GAAazH,QAAO,SAAC2J,OACzB4E,EAAkB9O,EAAK2O,oBAAoBzE,GAC/CtK,EAAQoI,EAAYkC,GAEtB4E,EAAgBvO,QAAO,SAACmM,GACtBA,EAAO9M,MAAQ8M,EAAOtI,QAAUxE,EAAM6M,MAAM,KAAO7M,OAKlDsN,EAAA7O,UAAA0Q,wBAAP,WAAA,IAAA/O,EAAA7B,KACEA,KAAKgP,SAAS5M,QAAO,SAAE0G,OAAEiD,EAAAjD,EAAAiD,QAAStK,EAAAqH,EAAArH,MAChCI,EAAKgP,kBAAkB9E,GAASsB,UAAU5L,MAIvCsN,EAAA7O,UAAA4Q,aAAP,SAAoBC,GAApB,IAAAlP,EAAA7B,KACE+Q,EAAO3O,QAAO,SAAE0G,OAAE6C,EAAA7C,EAAA6C,GAAI3F,EAAA8C,EAAA9C,KAAW,OAAAnE,EAAKmP,YAAYrF,EAAI3F,KACtDhG,KAAKoQ,kBAGArB,EAAA7O,UAAA+Q,iBAAP,SAAwBC,GACtBlR,KAAK0P,YAAcwB,GAGdnC,EAAA7O,UAAA8Q,YAAP,SAAmBjF,EAAS/F,OACtBmL,EAAiBnR,KAAKiP,QAAQV,OAAM,SAAC6C,GAAS,OAAAA,EAAMzF,KAAOI,IAC/D,IAAIoF,EAAexQ,OACjB,MAAMoD,MAAM,kBAAkBgI,EAAO,qBAGvCoF,EAAe/O,QAAO,SAACgP,GAAS,OAAAA,EAAMpL,KAAOA,KAGxC+I,EAAA7O,UAAAmR,MAAP,WACErR,KAAKgP,SAAS5M,QAAO,SAACmM,GAAU,OAAAA,EAAO9M,MAAQ,QAG1CsN,EAAA7O,UAAAoR,iBAAP,WACE,MAAO,CACLP,OAAQ/Q,KAAKiP,QACbsC,KAAMvR,KAAKwR,MACXzB,QAAS/P,KAAKwP,QAAQO,QACtB5M,QAASnD,KAAKgP,SACXT,OAAM,SAACA,GAAU,MAAmB,aAAnBA,EAAOjC,UACxBxG,IAAG,SAAEgD,GAAiC,MAAA,CAAGiD,QAAlCjD,EAAAiD,QAA2CtK,MAAlCqH,EAAArH,MAAyCiL,SAAlC5D,EAAA4D,cAIvBqC,EAAA7O,UAAAuR,mBAAP,WACE,OAAOzR,KAAKgP,SACPT,OAAM,SAACA,GACN,MAA2B,aAAnBA,EAAOjC,UACZ3M,MAAMsG,QAAQsI,EAAO9M,QAAU8M,EAAO9M,MAAMd,SAC3ChB,MAAMsG,QAAQsI,EAAO9M,QAAU8M,EAAO9M,SAG3CqE,IAAG,SAAEgD,GAAiC,MAAA,CAAGiD,QAAlCjD,EAAAiD,QAA2CtK,MAAlCqH,EAAArH,MAAyCiL,SAAlC5D,EAAA4D,aAGvBqC,EAAA7O,UAAAwR,qBAAP,SAA4BvO,OACtB0G,EAAmB,GAGvB,OAFA1G,EAAQf,QAAO,SAACmM,GAAU,OAAA1E,EAAY0E,EAAOxC,SAAWpM,MAAMsG,QAAQsI,EAAO9M,OAAS8M,EAAO9M,MAAM6E,KAAK,KAAOiI,EAAO9M,QAE/GoI,GAGFkF,EAAA7O,UAAAsQ,oBAAP,SAA2BzE,GACzB,OAAO/L,KAAKgP,SAAST,OAAM,SAACA,GAAU,OAAAA,EAAOxC,UAAYA,KAGpDgD,EAAA7O,UAAA2Q,kBAAP,SAAyB9E,GACvB,OAAO/L,KAAKkP,QAAQX,OAAM,SAACoD,GAAS,OAAAA,EAAM7F,eAAiBC,IAAS,IAG/DgD,EAAA7O,UAAA0R,aAAP,SAAoB7F,EAAS/F,GAC3BhG,KAAK6Q,kBAAkB9E,GAASc,QAAQ7G,IAGnC+I,EAAA7O,UAAA2R,aAAP,SAAoBrF,GAApB,IAAA3K,EAAA7B,KACQ8R,EAAS9R,KAAKkP,QAAQX,OAAM,SAACoD,GAAS,OAAAA,EAAMpF,cAAgBC,IAChEuF,EAAc/R,KAAK6Q,kBAAkBrE,GAErCwF,EADQhS,KAAKiP,QAAQV,OAAM,SAAC6C,GAAS,OAAAA,EAAMzF,KAAOa,IAAQ,GACxCxG,KAEhBiM,EAAY,GAChBH,EAAO1P,QAAO,SAACuP,OACPpD,EAAS1M,EAAK2O,oBAAoBmB,EAAM7F,cAAc,GAC1DY,EAAWiF,EAAMlF,cACjBhL,EAAQ8M,EAAO9M,MAEjBwQ,EAAUzQ,KAAK,CAACkL,EAAUjL,MAI5BuQ,EAAU5P,QAAO,SAACqO,GAAQ,OAAA5O,EAAKqQ,YAAYD,EAAWxB,KAGtDsB,EAAYlF,QAAQmF,GACpBD,EAAYxO,UAGPwL,EAAA7O,UAAAiS,uBAAP,SAA8BC,GAC5BpS,KAAKwP,QAAQO,QAAQsC,MAAMrO,KAAOoO,GAG7BrD,EAAA7O,UAAAoS,yBAAP,SAAgCC,GAC9BvS,KAAKwP,QAAQO,QAAQsC,MAAME,UAAYA,GAGlCxD,EAAA7O,UAAAsS,oBAAP,SAA2BC,GACzBzS,KAAKwP,QAAQ+B,KAAKkB,OAASA,GAGtB1D,EAAA7O,UAAAwS,mBAAP,SAA0BC,GACxB3S,KAAKwP,QAAQ+B,KAAKoB,MAAQA,GAGpB5D,EAAA7O,UAAAgS,YAAR,SAAoBD,EAAWxB,GAC7BwB,EAAU7P,QAAO,SAAE0G,OAAA8J,EAAA9R,EAAAgI,EAAA,GAAC4D,EAAAkG,EAAA,GAAUnR,EAAAmR,EAAA,GAC5BlG,EAAStK,QAAO,SAAE0G,OAAE9G,EAAA8G,EAAA9G,IAAK6Q,EAAA/J,EAAA+J,SACvB,OAAOA,GAEL,IAAK,IACAlT,MAAMsG,QAAQxE,GACfgP,EAAKvC,UAAYzM,EAAMd,SAAiD,IAAvCc,EAAM8E,QAAQkK,EAAKqC,SAAS9Q,KAE7DyO,EAAKvC,SAAWzM,GAASA,IAAUgP,EAAKqC,SAAS9Q,IAEnD,MAEF,IAAK,IACCrC,MAAMsG,QAAQxE,KAChBgP,EAAKvC,SAAWzM,GAASA,EAAQgP,EAAKqC,SAAS9Q,KAEjD,MAEF,IAAK,IACCrC,MAAMsG,QAAQxE,KAChBgP,EAAKvC,SAAWzM,GAASA,EAAQgP,EAAKqC,SAAS9Q,KAEjD,MAEF,IAAK,KACCrC,MAAMsG,QAAQxE,KAChBgP,EAAKvC,SAAWzM,GAASA,GAASgP,EAAKqC,SAAS9Q,KAElD,MAEF,IAAK,KACCrC,MAAMsG,QAAQxE,KAChBgP,EAAKvC,SAAWzM,GAASA,GAASgP,EAAKqC,SAAS9Q,KAElD,MAEF,IAAK,KACCrC,MAAMsG,QAAQxE,KAChBgP,EAAKvC,SAAWzM,GAASA,IAAUgP,EAAKqC,SAAS9Q,KAEnD,MAEF,IAAK,OACH,GACEP,GACAgP,EAAKqC,SAAS9Q,IACG,iBAAVP,GACuB,iBAAvBgP,EAAKqC,SAAS9Q,GACtB,KACO+Q,EAAWtC,EAAKqC,SAAS9Q,GAAK8E,cAClCkM,EAASvR,EAAMwR,oBAEjBxC,EAAKvC,UAAyC,IAA9B6E,EAASxM,QAAQyM,IAEnC,MACF,QACE1L,QAAQC,KAAK,sBAAsBsL,EAAQ,wBAO7C9D,EAAA7O,UAAA8P,YAAR,WAAA,IAAAnO,EAAA7B,KACEA,KAAKwP,QAAQI,OAAOxN,QAAO,SAAC8Q,GAC1BA,EAAMpB,OAAO1P,QAAO,SAACuP,GAAS,OAAA9P,EAAKmN,SAASxN,KAAIpB,EAAA,GAC3CuR,EAAMtF,aAAY,CACrBN,QAAS4F,EAAM5F,QACftK,MAAOkQ,EAAMtF,aAAapG,QAAU,GAAK,aAKvC8I,EAAA7O,UAAA+P,WAAR,WACEjQ,KAAKiP,QAAUjP,KAAKwP,QAAQuB,QAGtBhC,EAAA7O,UAAAgQ,SAAR,WACElQ,KAAKwR,MAAQxR,KAAKwP,QAAQ+B,MAGpBxC,EAAA7O,UAAAmQ,eAAR,WACErQ,KAAK0P,YAAc1P,KAAKwP,QAAQ0B,YAG1BnC,EAAA7O,UAAAiQ,WAAR,WAAA,IAAAtO,EAAA7B,KACEA,KAAKwP,QAAQI,OAAOxN,QAAO,SAAE+Q,EAAehH,GAC1CgH,EAAcrB,OAAO1P,QAAO,SAAEgR,EAAanH,OACnCoH,EAAa1E,EAAWyE,EAAYpP,MAC1C,IAAIqP,EAAY,MAAMtP,MAAM,cAAcqP,EAAYpP,KAAI,kBAE1DnC,EAAKqN,QAAQ1N,KAAK,IAAI6R,EAAUjT,EAAA,GAAMgT,EAAW,CAAEnH,WAAUA,EAAEE,aAAYA,WAKzE4C,EAAA7O,UAAAkQ,eAAR,WAAA,IAAAvO,EAAA7B,KACEA,KAAKiP,QAAQ7M,QAAO,SAACgP,GAAS,OAAAvP,EAAK+P,aAAaR,EAAMzF,GAAIyF,EAAMpL,SAEpE+I,EAzQA,GA2QA,IAAAuE,EAAA,WAAA,SAAAA,IAIUtT,KAAAuT,QAAe,UAGhBD,EAAApT,UAAAsT,IAAP,SAAW7H,EAAY/J,GACrB,GAAG5B,KAAKuT,QAAQ5H,GAAK,MAAM5H,MAAM,iBAAiB4H,EAAE,qBAEpD3L,KAAKuT,QAAQ5H,GAAM,IAAIoD,EAAYpD,EAAI/J,IAGlC0R,EAAApT,UAAAuT,MAAP,SAAa9H,GACX,OAAO3L,KAAKuT,QAAQ5H,IAAO,MATtB2H,EAAAzJ,YAAmB,yBAL3BxH,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,kHADd,qBCtTA,SAAAmR,IAAA,IAAA7R,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YACU6B,EAAA+R,WAA2B,IAAIxK,EAAAA,UAuDzC,OAxDkCP,EAAAA,EAAAA,GAKzB6K,EAAAxT,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAO1F,GACL,IAAK,mBACHnC,EAAK2G,WAAWT,OAAO2B,GAEvB7H,EAAKsH,MAAQO,EAAQP,MACrBtH,EAAKoH,OAASS,EAAQT,OAEtBpH,EAAKkS,uBACL,MAEF,IAAK,sBACDlS,EAAK+R,WAAWtS,UASxB0S,EAAAA,aAAaC,cAAcpO,KACzBqO,EAAAA,UAAUlU,KAAK4T,aACf3L,UAAS,SAAEa,OAAC9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QAClB,OAAO1F,GACL,IAAK,kBACHnC,EAAK2G,WAAWiB,WAAWC,OAS3BgK,EAAAxT,UAAA6T,qBAAR,WAAA,IAAAlS,EAAA7B,KACEA,KAAKmJ,MAAMU,YAAYhE,KACrB0I,EAAAA,OAAM,SAACnJ,GACL,QAAG5F,OAAO2C,KAAKiD,GAAQzE,SAGzBwT,EAAAA,SACAlM,UAAS,SAAC7C,GACVvD,EAAKuS,WAAW,cAAehP,GAG/BkO,EAAczJ,YAAczE,KAIlCsO,GAxDkCM,EAAAA,gCCHlC,SAAAK,mDAmBA,OAnB8BxL,EAAAA,EAAAA,GAClBwL,EAAAnU,UAAAuL,UAAV,SAAoBzF,GAMlB,OAJIA,EAAKwD,UACPxJ,KAAKsU,cAActO,EAAKwD,UAGnBxD,EAAKsD,OAGP+K,EAAAnU,UAAAoU,cAAP,SAAqBC,GACnBvU,KAAKwL,OAAOgJ,IAAIlL,MAAMlH,QAAO,SAAEqO,GAC7BA,EAAKtC,QAAU,GACVsC,EAAK/G,SAAW6K,IACnB9D,EAAKtC,QAAU,gBAGnBnO,KAAKuD,OAAO,CAAC+F,MAAStJ,KAAKwL,UAE/B6I,GAnB8BI,EAAAA,0BCA9B,SAAAC,mDAwBA,OAxB8B7L,EAAAA,EAAAA,GAElB6L,EAAAxU,UAAAuL,UAAV,SAAoBzF,GAClB,MAAO,CACLmI,QAAS,cACT7E,MAAOtD,IAIX0O,EAAAxU,UAAAmN,UAAA,SAAU1B,GACR3L,KAAKwL,OAAOlC,MAAMlH,QAAO,SAACqO,GACrBA,EAAKrD,MAAMzB,KAAOA,GACnB8E,EAAKtC,QAAU,aACfsC,EAAKrD,MAAMuH,UAAW,IAEtBlE,EAAKtC,QAAU,GACfsC,EAAKrD,MAAMuH,UAAW,MAK5BD,EAAAxU,UAAA0U,UAAA,WACE,OAAO5U,KAAKwL,OAAOlC,MAAMiF,OAAM,SAACkC,GAAQ,OAAAA,EAAKrD,MAAMuH,WAAU,IAAM,MAEvED,GAxB8BD,EAAAA,0BCC9B,SAAAI,mDAIA,OAJmChM,EAAAA,EAAAA,GACvBgM,EAAA3U,UAAAuL,UAAV,SAAoBzF,GAClB,OAAOA,GAEX6O,GAJmCJ,EAAAA,0BCDnC,SAAAK,mDAUA,OAV8BjM,EAAAA,EAAAA,GAGlBiM,EAAA5U,UAAAuL,UAAV,SAAoB3C,OAAE8G,EAAA9G,EAAA8G,OAEZmF,EAAA/U,KAAAmF,QAAA4P,YAGR,OAFA/U,KAAK+U,YAAcA,EAEZnF,GAEXkF,GAV8BL,EAAAA,gBCI9BO,EAAA,SAAArB,GAAA,SAAAqB,IAAA,IAAAnT,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YA0IS6B,EAAAyP,iBAAgB,WAAS,OAAAzP,EAAKkT,YAAYzD,oBAC1CzP,EAAA6P,qBAAoB,SAAIvO,GAAY,OAAAtB,EAAKkT,YAAYrD,qBAAqBvO,IAC1EtB,EAAA6O,6BAA4B,SAAI7G,GAAgB,OAAAhI,EAAKkT,YAAYrE,6BAA6B7G,IAC9FhI,EAAAgP,kBAAiB,SAAI9E,GAAY,OAAAlK,EAAKkT,YAAYlE,kBAAkB9E,IACpElK,EAAAgQ,aAAY,SAAIrF,GAAW,OAAA3K,EAAKkT,YAAYlD,aAAarF,MAiClE,OA/KqC3D,EAAAA,EAAAA,GAGzBmM,EAAA9U,UAAAuL,UAAV,SAAoBzF,GAApB,IAAAnE,EAAA7B,KAEMA,KAAK+U,cACP/U,KAAK+U,YAAc/O,EAAK+O,iBAGpBpJ,EAAK3L,KAAK+U,YAAYrJ,QAC1BkE,EAAS5P,KAAK+U,YAAYpF,YAExBsF,EAAS,GAkDb,OAhDArF,EAAOxN,QAAO,SAAE8S,EAAaC,OACrBC,EAAU,SAASzJ,EAAE,IAAIwJ,EAGzBE,EAASxT,EAAKyT,cAAcJ,EAAYG,OAAQD,GAGlDG,EAAW,GACf1T,EAAKkT,YAAYxF,YACdhB,OAAM,SAACoD,GAAS,OAAAA,EAAMzF,oBAAsBiJ,IAC5CrP,IAAG,SAAC6L,GAEH,OADAA,EAAMpO,SACC,CACLwI,QAAS4F,EAAM7F,aACf9H,KAAM2N,EAAMhF,UACZnB,OAAQmG,EAAM/E,eAGjBxK,QAAO,SAAE0G,OAAE9E,EAAA8E,EAAA9E,KAAMwH,EAAA1C,EAAA0C,OAAQO,EAAAjD,EAAAiD,QACxBwJ,EAAS/T,KAAK,CACZ2M,QAAStM,EAAK2T,mBAAmBxR,GACjC8N,OAAQnS,MAAMsG,QAAQuF,GAAUA,EAAS,CAACA,GAC1C4B,MAAO,CACLrB,QAAOA,OAKfkJ,EAAOzT,KAAK,CACV6T,OAAMA,EACNjE,MAAO,CAAEmE,SAAQA,GACjBpH,QAAS,sBAAsBiH,EAC/BK,QAAQ,EACRrI,MAAO,CACLgI,QAAOA,OAMV9B,EAAczJ,cACf7J,KAAK+U,YAAYrE,6BAA6B4C,EAAczJ,aAC5D7J,KAAK+U,YAAYnE,0BAGjB0C,EAAczJ,YAAc,MAGvB,CACLoL,OAAMA,EACN9G,QAAS,sBAAsBnO,KAAK+U,YAAYrJ,UAI7CsJ,EAAA9U,UAAAwV,YAAP,SAAmB5M,OAAE6M,EAAA7M,EAAA6M,aACnB3V,KAAKwL,OAAOyJ,OAAO7S,QAAO,SAACwT,GACtBA,EAAMxI,MAAMgI,UAAYO,EAAaP,UACtCQ,EAAMH,QAAUG,EAAMH,OACtBG,EAAMP,OAAOQ,UAAYD,EAAMH,OA3Ed,qBACC,0BA+EjBT,EAAA9U,UAAA4V,cAAP,SAAqBhN,OAAE6M,EAAA7M,EAAA6M,aACf/C,EAAA+C,EAAA/H,aAAE7B,EAAA6G,EAAA7G,QAASoB,EAAAyF,EAAAzF,OAAQU,EAAA+E,EAAA/E,QAEvBkI,GADS/V,KAAK+U,YAAYvE,oBAAoBzE,GAAS,IAAM,IACjC,MAE1BwE,GAAkB,EACpB9O,EAAakU,EAAa/H,aAAanM,OAASkU,EAAalU,MAG/DA,EAAQ,GAAKA,EAIX8O,EADC5Q,MAAMsG,QAAQ8P,IAC0B,IAAhCA,EAAYxP,QAAQ9E,GAEpBsU,IAAgBtU,EAKb,eAAX0L,IAAmE,IAAxC,CAAC,QAAS,QAAQ5G,QAAQsH,KAExD7N,KAAK+U,YAAYzE,aAAavE,EAAStK,EAAO8O,GAC9CvQ,KAAK+U,YAAYnE,4BAGZoE,EAAA9U,UAAA8V,qBAAP,SAA4BxJ,OACpBmF,EAAQ3R,KAAK+U,YAAYlE,kBAAkBrE,GACjDxM,KAAKwL,OAAOyJ,OACTnP,IAAG,SAAC8P,GAAS,OAAAA,EAAMxE,QACnBtL,IAAG,SAACsL,GAAS,OAAAA,EAAMmE,WACnBzP,IAAG,SAACyP,GACHA,EAASnT,QAAO,SAAC6T,GACf,GAAGA,EAAQ7I,MAAMrB,UAAYS,EAAO,KAC5B0J,EAAcvE,EAAM/E,YAC1BqJ,EAAQnE,OAASnS,MAAMsG,QAAQiQ,GAAeA,EAAc,CAACA,SAMhElB,EAAA9U,UAAAiW,iBAAP,WAAA,IAAAtU,EAAA7B,KACQoW,EAAgBpW,KAAK+U,YAAYxF,YACpChB,OAAM,SAACoD,GAAS,MAAoB,SAApBA,EAAMhF,YACtB7G,IAAG,SAAC6L,GAAS,OAAAA,EAAM7F,eAEtB9L,KAAKwL,OAAOyJ,OACTnP,IAAG,SAAC8P,GAAS,OAAAA,EAAMxE,QACnBtL,IAAG,SAACsL,GAAS,OAAAA,EAAMmE,WACnBzP,IAAG,SAACyP,GACHA,EAASnT,QAAO,SAAC6T,GACf,IAAqD,IAAlDG,EAAc7P,QAAQ0P,EAAQ7I,MAAMrB,SAAgB,KAC/C4F,EAAQ9P,EAAKkT,YAAYlE,kBAAkBoF,EAAQ7I,MAAMrB,SAC/D4F,EAAMpO,aACA2S,EAAcvE,EAAM/E,YAC1BqJ,EAAQnE,OAASnS,MAAMsG,QAAQiQ,GAAeA,EAAc,CAACA,SAYhElB,EAAA9U,UAAA0Q,wBAAP,WACE5Q,KAAK+U,YAAYnE,2BAGXoE,EAAA9U,UAAAsV,mBAAR,SAA2BxR,GAQzB,MAAO,2BAPY,CACjBqK,KAAQ,OACRO,SAAY,aACZC,KAAQ,QACRC,OAAU,UAGiC9K,IAGvCgR,EAAA9U,UAAAoV,cAAR,SAAsBD,EAAQD,GAC5B,OAAOC,EAAS,CACdhH,KAAMgH,EAAOnI,MACb2I,UArKmB,qBAsKnB1H,QAASkH,EAAOlH,QAChBzE,QAAS,CACPyD,OAAQ,eACRxB,GAAOyJ,EAAO,UACdA,QAASA,GAEXhI,MAAO,CACLzB,GAAOyJ,EAAO,YAEf,MAGPJ,EA/KA,CAAqCP,EAAAA,8BCHrC,SAAA4B,mDAIA,OAJ8BxN,EAAAA,EAAAA,GAClBwN,EAAAnW,UAAAuL,UAAV,SAAoBzF,GAClB,OAAOsQ,EAAAA,aAEXD,GAJ8B5B,EAAAA,2HCD9B,SAAA8B,mDAwBA,OAxB8B1N,EAAAA,EAAAA,GAErB0N,EAAArW,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAO1F,GACL,IAAK,eAGHnC,EAAK2G,WAAW8L,cAAc5K,GAC9B7H,EAAKuS,WAAW,WAAY,CAC1BzK,QAAS,SACTC,KAAM,CAACF,SAanB6M,GAxB8BvC,EAAAA,4BCA9B,SAAAwC,mDAmBA,OAnB8B3N,EAAAA,EAAAA,GACrB2N,EAAAtW,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAO1F,GACL,IAAK,eAEmB,aAAnB0F,EAAQyD,QACTtL,EAAKuS,WAAW,WAAY1K,GAI9B7H,EAAKuS,WAAWpQ,EAAM0F,OAQhC8M,GAnB8BxC,EAAAA,4BCA9B,SAAAyC,mDAmBA,OAnBmC5N,EAAAA,EAAAA,GAC1B4N,EAAAvW,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAO1F,GACL,IAAK,oBAEmB,aAAnB0F,EAAQyD,QACTtL,EAAKuS,WAAW,WAAY1K,GAI9B7H,EAAKuS,WAAWpQ,EAAM0F,OAQhC+M,GAnBmCzC,EAAAA,4BCAnC,SAAA0C,mDAUA,OAV8B7N,EAAAA,EAAAA,GACrB6N,EAAAxW,UAAA2T,OAAP,WACE7T,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM8E,EAAAY,WAQzCgN,GAV8B1C,EAAAA,4BCA9B,SAAA2C,IAAA,IAAA9U,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YACU6B,EAAA+U,gBAA0B,IA+DpC,OAhEqC/N,EAAAA,EAAAA,GAG5B8N,EAAAzW,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KAEEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAO1F,GACL,IAAK,uBACK,IAAA+H,EAAArC,EAAAiM,aAAA/H,aAAA7B,QACN4F,EAAQ9P,EAAK2G,WAAWqI,kBAAkB9E,GAC1CO,EAAUqF,EAAMvF,aAOlB,GANAvK,EAAK+U,gBAAiB,EAGtB/U,EAAK2G,WAAWsN,cAAcpM,GAGf,aAAZ4C,EACDzK,EAAK2G,WAAWqJ,aAAaF,EAAMpF,aACnC1K,EAAK2G,WAAWwN,qBAAqBrE,EAAMpF,iBAGtC,KACCsK,EAAgBhV,EAAK2G,WAAW8I,mBACpCwF,EAAcjV,EAAK2G,WAAWkJ,qBAAqBmF,EAAc1T,SAEnE3D,OAAO2C,KAAK2U,GAAa1U,QAAO,SAACJ,GAAO,OAAA8U,EAAY9U,GAAO8U,EAAY9U,IAAQ,OAG/EH,EAAKkV,UAAU,gBAGflV,EAAKuS,WAAW,WAAY,CAC1BzK,QAAS,SACTC,KAAM,GACNC,YAAWiN,IAIf,MAEF,IAAK,6BACHjV,EAAK2G,WAAWkN,YAAYhM,MASlCsK,EAAAA,aAAaC,cAAchM,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QAC5C,OAAO1F,GACL,IAAK,wBACAnC,EAAK2G,WAAWuM,YAAYrJ,UAAYhC,GACzC7H,EAAK2G,WAAW2N,uBAS5BQ,GAhEqC3C,EAAAA,gCCArC,SAAAgD,mDAYA,OAZ8BnO,EAAAA,EAAAA,GAErBmO,EAAA9W,UAAA2T,OAAP,WACE7T,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM8E,EAAAY,QAG/BpC,QAAQC,KAAK,gCAAiCvD,MAMxDgT,GAZ8BhD,EAAAA,+GCGjBiD,EAAmB,CAC9BpP,SAAU,cACVH,QAAS,CAAC,CACRiE,GAAI,UACH,CACDA,GAAI,UACH,CACDA,GAAI,eACH,CACDA,GAAI,SACJuL,eAAe,IAEjBzO,SAAUG,EACVF,SAAUgL,EACVpL,mBAAoB6O,EACpB5O,qBAAsB6O,EACtBjS,QAAS,kBCPT,SAAAkS,EACUpO,EACAE,EACAJ,EACAuO,EACAtO,EACAE,GANV,IAAArH,EAQE8R,EAAA/S,KAAAZ,KAAMsX,EAAqBvV,IAAI,qBAAuBH,IAAO5B,YAPrD6B,EAAAoH,OAAAA,EACApH,EAAAsH,MAAAA,EACAtH,EAAAkH,cAAAA,EACAlH,EAAAyV,qBAAAA,EACAzV,EAAAmH,UAAAA,EACAnH,EAAAqH,aAAAA,IAuBZ,OA9ByCL,EAAAA,EAAAA,GAY7BwO,EAAAnX,UAAA4H,YAAV,WACE,MAAO,CACLiB,cAAe/I,KAAK+I,cACpBC,UAAWhJ,KAAKgJ,UAChBC,OAAQjJ,KAAKiJ,OACbE,MAAOnJ,KAAKmJ,MACZD,aAAclJ,KAAKkJ,aACnB/D,QAASnF,KAAK4B,OAAOuD,SAAW,KAIpCkS,EAAAnX,UAAAqX,SAAA,WACEvX,KAAK+H,UAGPsP,EAAAnX,UAAAsX,YAAA,WACExX,KAAK2I,iCAhCR8O,EAAAA,UAASnV,KAAA,CAAC,CACPoV,SAAU,cACVC,SAAA,o7BAVKC,EAAAA,cAAQC,EAAAA,sBAGRlW,SACAc,SACAE,SAJAmV,EAAAA,SAyCTT,GA9ByC5P,qBCXzC,SAAAsQ,mDAMA,OANqClP,EAAAA,EAAAA,GAGnCkP,EAAA7X,UAAA6H,OAAA,SAAOe,OAAE3D,EAAA2D,EAAA3D,QACPnF,KAAKmF,QAAUA,GAEnB4S,GANqC3N,EAAAA,oCCCrC,SAAA4N,IAAA,IAAAnW,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YACU6B,EAAA+R,WAA2B,IAAIxK,EAAAA,UAiCzC,OAlCqCP,EAAAA,EAAAA,GAG5BmP,EAAA9X,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAO1F,GACL,IAAK,yBACHnC,EAAK2G,WAAWT,OAAO2B,GACvB,MAEF,IAAK,4BACD7H,EAAK+R,WAAWtS,WAuB5B0W,GAlCqChE,EAAAA,cCErC,IAAaiE,EAAsB,CACjCpQ,SAAU,oBACVH,QAAS,GACTe,SAAUsP,EACVrP,SAAUsP,EACV1P,mBAAoB6O,EACpB5O,qBAAsB6O,EACtBjS,QAAS,mBCCT,SAAA+S,EAGEZ,UAGA3D,EAAA/S,KAAAZ,KAAMsX,EAAqBvV,IAAI,wBAA0BH,IAAO5B,KAmBpE,OA1B4C6I,EAAAA,EAAAA,GAUhCqP,EAAAhY,UAAA4H,YAAV,WACE,MAAO,CAIL3C,QAASnF,KAAK4B,OAAOuD,SAAW,KAIpC+S,EAAAhY,UAAAqX,SAAA,WACEvX,KAAK+H,UAGPmQ,EAAAhY,UAAAsX,YAAA,WACExX,KAAK2I,iCA5BR8O,EAAAA,UAASnV,KAAA,CAAC,CACPoV,SAAU,oBACVC,SAAA,qHANKlV,KAkCTyV,GA1B4CzQ,GCZ5C0Q,GAAA,WAEA,SAAAA,KAmBA,OAXEA,EAAAjY,UAAAkY,WAAA,SAAWC,EAAW1C,GAChB3V,KAAKsY,MAETtY,KAAKsY,KAAK,cAAe,CAAED,UAASA,EAAE1C,aAAYA,KAGpDwC,EAAAjY,UAAAqY,UAAA,SAAUF,EAAW1C,GACf3V,KAAKsY,MAETtY,KAAKsY,KAAK,QAAS,CAAED,UAASA,EAAE1C,aAAYA,yBAjB/C8B,EAAAA,UAASnV,KAAA,CAAC,CACToV,SAAU,oBACVC,SAAA,0gBAGCa,EAAAA,oBACAA,EAAAA,SAaHL,EArBA,OCkBMM,GAAa,CACjBpB,EACAa,GACAC,IAGFO,GAAA,WAAA,SAAAA,KAwBA,OAbSA,EAAAC,QAAP,SAAe/W,GACb,MAAO,CACLgX,SAAUF,EACV5T,UAAW,CACTnC,EACAhB,EACAc,EACAsE,EACApC,EACA,CAAEkU,QAAS,SAAUC,SAAUlX,0BApBtCmX,EAAAA,SAAQzW,KAAA,CAAC,CACR0W,aAAcP,GACdQ,QAAS,CACPC,EAAAA,aACAC,EAAAA,iBACAC,EAAAA,uBAEFtU,UAAW,GACXuU,QAASZ,OAgBXC,EAxBA,kBCtBA,SAAAY,mDAIA,OAJqCzQ,EAAAA,EAAAA,GACnCyQ,EAAApZ,UAAA6H,OAAA,SAAO2B,KAGT4P,GAJqClP,EAAAA,iCCArC,SAAAmP,mDAYA,OAZqC1Q,EAAAA,EAAAA,GAE5B0Q,EAAArZ,UAAA2T,OAAP,aAUF0F,GAZqCvF,EAAAA,6BCArC,SAAAwF,IAAA,IAAA3X,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YAeS6B,EAAA4X,oBAAmB,SAAGC,GAK3BpS,QAAQqS,IAAI,uBAIP9X,EAAA+X,eAAc,SAAIC,EAAYC,OAK/BC,EAAS,GAEbA,EAAOvY,KAAK,CACV6M,KAAM,IACN3E,QAAS,SACTyE,QAAwB,GAAf2L,EAAmB,YAAc,KAE5C,IAAK,IAAItZ,EAAI,EAAGA,EAAIqZ,EAAYrZ,IAC9BuZ,EAAOvY,KAAK,CAAE6M,KAAM2L,OAAOxZ,EAAI,GAAIkJ,QAAS,QAAUsQ,OAAOxZ,EAAI,GAAI2N,QAAS2L,GAAetZ,EAAI,EAAI,YAAc,KAErH,OAAOuZ,GAGDlY,EAAAoY,WAAU,SAAGjU,OASjBpE,EAASC,EAAKsD,QAAQvD,OACtBsP,EAAalL,EAAKkL,WAClB2I,EAAahY,EAAKgY,WAClBtI,EAAO1P,EAAKiY,YACZxN,EAAUzK,EAAKyK,QACf4N,EAAOrY,EAAKsY,SAEZ7a,EAAI0G,EAAKsD,MAEX,GAAI1H,EAAQ,KACNO,EAAOP,EAAOG,IAAI,eAEtB,GAAIH,EAAOG,IAAIuK,EAAU,eACnB8N,EAAcxY,EAAOG,IAAIuK,EAAU,WAAW,mBAC9C+N,EAAezY,EAAOG,IAAIuK,EAAU,WAAW,iBAInD4N,GAAQ3I,EACVjS,EAAIA,EAAEgb,MAAM/I,EAAO2I,EAAOA,EAAM3I,EAAO2I,GAC9BA,IACT5a,EAAIA,EAAEgb,MAAM,EAAGJ,QAGbH,EAAS,GA2Cb,GA1CAza,EAAE8C,QAAO,SAACmY,OACJ9J,EAAO,CACT+J,MAAOD,EAAGE,UACVC,MAEEN,GAAeG,EAAG9J,KAAKvD,MAAMvM,OAASyZ,EACpCG,EAAG9J,KAAKvD,MAAMoN,MAAM,EAAGF,GAAe,MAAQG,EAAG9J,KAAKvD,MAC1DxD,QAAS6Q,EAAG9J,KAAK9E,GACjBwC,QAAS,CAAC,SAAU,UAAUwM,SAASrO,GAAW,eAAiB,GACnEwG,SAAU,CACR,CACE3E,QAAS,8BACT7E,MAAOiR,EAAG9J,KAAKmK,KAAK9U,IAAG,SAAEgD,OAAErH,EAAAqH,EAAArH,MAAiB,MAAA,CAC1CyL,MAAe,WADiBpE,EAAA9G,IACN,UAAY,KACtCP,MAAKA,MAGT,CACE0M,QAAS,8BACT7E,MAAOiR,EAAGM,eAAe/U,IAAG,SAACgV,GAC3B,MAAO,CACLrZ,MAAOqZ,EAAIC,MAEXpN,KAAMxL,EAAK2Y,EAAI9W,KAAKiH,WAAW0C,KAC/BQ,QAAS,SAAW2M,EAAI9W,KAAKiH,gBAMnCsP,EAAGrX,cACLuN,EAAkB,YAAI,CACpBnH,MAAOiR,EAAGrX,YAAY4C,IAAG,SAACkV,GACxB,MAAO,CACL9N,MAAO8N,EAAM9N,MACbxD,QAASsR,EAAMnM,UAKvBkL,EAAOvY,KAAKiP,KAEVc,EAAM,CAER,MAAO,CACL0J,WAAY,CACV9G,MAAO,CAAEzK,QAAS,SAAayE,QAAiB,GAARoD,EAAY,cAAgB,IACpE2J,KAAM,CAAExR,QAAS,SAAQ6H,EAAO,GAAKpD,QAAiB,GAARoD,EAAY,cAAgB,IAC1EjQ,KAAM,CAAEoI,QAAS,SAAQ6H,EAAO,GAAKpD,QAASoD,GAAQsI,EAAa,cAAgB,IACnFsB,KAAM,CAAEzR,QAAS,QAAQmQ,EAAc1L,QAASoD,GAAQsI,EAAa,cAAgB,IACrFuB,MAAOvZ,EAAK+X,eAAeC,EAAYtI,GACvCzC,OAAQ,CACN5B,MAAO,sBACP/H,QAVY,CAAC,GAAI,GAAI,IAUAW,IAAG,SAAC/E,GACvB,MAAO,CACLsN,KAAMtN,EACNyI,SAAUzI,GAAKmZ,KAKnBxQ,QAAS,gBAGb2R,SAAUtB,GAGd,MAAgB,SAAZzN,EACK,CACLyN,OAAMA,EACNuB,QACE,CACE,CAAEpO,MAAO,iBAAmBgE,EAAa,KACzCkJ,EACE,CAAElN,MAAO,iBAAmBmN,EAAe,KAC3C,QAIV/S,QAAQqS,IAAI,wBAAyBI,GAC9BA,MAEX,OA9JuClR,EAAAA,EAAAA,GAO3B2Q,EAAAtZ,UAAAuL,UAAV,SAAoBzF,GAKlB,OAJAhG,KAAKma,SAAWna,KAAKmF,QAAQ+U,KAC7Bla,KAAK8Z,YAAsB9Z,KAAKmF,QAAY,KAC5CnF,KAAK6Z,WAAa0B,KAAKC,MAAMxV,EAAKrF,OAASX,KAAKma,UAChDna,KAAKsM,QAAUtM,KAAKmF,QAAQmH,QACrBtM,KAAKia,WAAWjU,IAkJ3BwT,GA9JuC/E,EAAAA,+BCAvC,SAAAgH,mDAgCA,OAhC6C5S,EAAAA,EAAAA,GAEjC4S,EAAAvb,UAAAuL,UAAV,SAAoBzF,GACV,IAAAhE,EAAAgE,EAAAhE,IAAK+D,EAAAC,EAAAD,SACP2V,EAAQ,IAAIC,OAAO,QAAU3Z,EAAM,OAAQ,KAC3C4Z,EAAa,GAEbC,EADS7b,KAAKmF,QAAQvD,OACHG,IAAI,eAAe,mBAAqB,EAuBjE,OArBAgE,EAASuD,MAAMlH,QAAO,SAACmY,OAEjBuB,EAAQJ,EAAMK,KAAKxB,EAAG9J,KAAKvD,OAC/B,GAAI4O,EAAO,KACLE,EAASF,EAAM,GACfG,EAASH,EAAM,GAEfD,GAAcG,EAAOrb,OAASkb,IAChCG,EAAS,MAAQA,EAAO1B,MAAM0B,EAAOrb,OAASkb,EAAWG,EAAOrb,SAE9Dkb,GAAcI,EAAOtb,OAASkb,IAChCI,EAASA,EAAO3B,MAAM,EAAGuB,GAAa,OAExCD,EAAWpa,KAAK,CACdsa,MAAOA,EAAMnK,MAAM2I,MAAMwB,EAAM,GAAGnb,OAAQmb,EAAM,GAAGnb,OAASqB,EAAIrB,QAChEqb,OAAMA,EACNC,OAAMA,EACNvS,QAAS6Q,EAAG9J,KAAK9E,QAIhB,CAAEiQ,WAAUA,IAEvBH,GAhC6ChH,EAAAA,2BCI7C,SAAAyH,IAAA,IAAAra,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YAEU6B,EAAAsa,mBAA4B,GAC5Bta,EAAAua,mBAA4B,GAE5Bva,EAAAwa,WAAoB,KACpBxa,EAAAya,kBAAyB,GAC1Bza,EAAA0a,gBAAyB,GACxB1a,EAAAmQ,UAAmB,KACnBnQ,EAAA2a,YAAmB,KACpB3a,EAAA4a,mBAA0B,KACzB5a,EAAA6a,aAAoB,KACpB7a,EAAA8a,qBAA8B,EAE9B9a,EAAA+a,iBAAkB,IA6S5B,OA3TqC/T,EAAAA,EAAAA,GAgBzBqT,EAAAhc,UAAAuL,UAAV,SAAoBzF,GAApB,IAAAnE,EAAA7B,KACE,IAAMgG,EAAQ,OAAO,KAErBhG,KAAK6c,iBAEL7c,KAAKgS,UAAYhM,EAAKgM,UAAYhM,EAAKgM,UAAY,GACnDhS,KAAKkK,MAAQA,EAEblE,EAAK8W,QAAU9c,KAAK+c,wCAChBC,EAAmBpS,SAASqS,eAAejd,KAAKmF,QAAQ+X,aACtDC,EAASnX,EAAKoX,MAAQpX,EAAKoX,MAAQJ,EAAiBK,YAIpDC,EADU,IACMH,EAElBI,EAAc,CAChBL,YAAald,KAAKmF,QAAQqY,kBAC1BC,eAAiBN,EACjBO,gBANc,IAOdC,0BAA0B,EAC1BC,mBAAmB,EAGrBL,YAA6B,IAEzBM,GAAkB,EAClBC,GAAkB,EAClBC,EAAe,EA2EnB,OAvEA/X,EAAK8W,QAAQ1a,QAAO,SAAE4b,GACfH,EAAiBG,EAAOjD,QAAQ8C,EAAiBG,EAAOjD,QACxD+C,EAAiB,GAAKA,EAAeE,EAAOjD,SAAQ+C,EAAiBE,EAAOjD,OACjFgD,IACcC,EAAOjD,MAClBiD,EAAOxU,UAAUyU,IAGtBjY,EAAK8W,QAAQ1a,QAAO,SAAE4b,OAChBE,EAAMF,EAAOrS,GACbwS,GAAqBH,EAAOjD,MAAS+C,EAAe,IAAuB,EAAfD,EAAqBC,EAAe,GAChGM,EAAgB7C,KAAK5B,IAAI2D,GAAe,IAAsB,EAAjBa,IAAqB,GAAG5C,KAAK8C,KAAKN,IAC/EO,EAAa,CACf3S,GAAIuS,EACJK,MAAO,CACL,CACE5S,GAAGuS,EAAI,UACPhR,MAAK,SAAG5N,GAAQ,OAAGA,EAAEkf,OAAO3c,EAAKsa,mBAA2B,KAAa6B,EAAOS,OAAOvR,OACvFwR,WAAU,SAAGpf,GAAM,OAAAA,EAAEqf,GACrBC,WAAU,SAAGtf,OACPuf,EAAQvf,EAAEkf,OAAO,EAErB,OADGlf,EAAEkf,OAAO3c,EAAKua,qBAAoByC,EAAK,GACnCvf,EAAEwf,EAAED,GAEbE,YAAc,OACdC,kBAAiB,SAAG1f,GAAM,OAAAA,EAAEkf,OAAO,GACnCtT,MAAO,QACPiD,QAAU,IAEZ,CACExC,GAAGuS,EAAI,UACPhR,MAAK,SAAG5N,GAAQ,OAAGA,EAAEkf,OAAO3c,EAAKua,mBAA2B,KAAa4B,EAAOjD,OAChF2D,WAAU,SAAGpf,GAAM,OAAAA,EAAEqf,GACrBC,WAAU,SAAGtf,GAAM,OAAAA,EAAEwf,EAAGxf,EAAEkf,OAAO,GACjCO,YAAc,OACdC,kBAAiB,SAAG1f,GAAM,OAAAA,EAAEkf,OAAO,GACnCtT,MAAO,QACPiD,QAAU,KAGdwQ,EAAGxB,EAAO,EAAE,GACZ2B,EAAGG,IACHT,OAAUJ,EACVlT,MAAM8S,EAAO9S,MACbgU,eAAgBlB,EAAOxU,UAAWwU,EAAOxU,SACzCE,QAAQ,CACNiC,GAAIuS,IAIRX,EAAyB,YAAE/b,KAAK8c,KAIlCf,EAAiC,oBAAI,CACnC4B,MAAOhC,EAAO,EACdiC,eAAgB,IAChBC,MAAOJ,IACPK,eAAgB,IAChBC,iBAAkB,IAClBC,oBAAqB,EACrBC,cAAe,KAGdzZ,EAAKqL,QAAOkM,EAAmB,MAAIvX,EAAKqL,OAExCrL,EAAK0Z,qBAAoBnC,EAAgC,mBAAIvX,EAAK0Z,oBAClE1Z,EAAK2Z,iBAAgBpC,EAA4B,eAAIvX,EAAK2Z,gBAE7D3f,KAAK4f,kBAEErC,GAGTrB,EAAAhc,UAAA2f,6BAAA,SAA6B7Z,EAAWqL,GAAxC,IAAAxP,EAAA7B,KACQ+F,EAAWC,EAAKmH,OAQtB,GANAnN,KAAKqc,WAAa,GAEbrW,EAAKuW,kBACRvc,KAAKuc,gBAAkBvW,EAAKuW,iBAG1BxW,EAAS+Z,aACX,IAAK,IAAItf,EAAI,EAAIA,EAAIuF,EAAS+Z,aAAanf,OAAQH,IAIjD,QAFIuf,EAAaha,EAAS+Z,aAAatf,GAE7Bwf,EAAI,EAAGA,EAAID,EAAWE,kBAAkBtf,OAAQqf,IACxDhgB,KAAKqc,WAAW7a,KAAIpB,EAAA,GAEb2f,EAAWE,kBAAkBD,GAAE,CAClC9U,MAAOlL,KAAKmF,QAAQ+a,WAAWH,EAAWI,UAAUnc,KAAKiH,WAAkB,MAAO,YAM1F,IAAUzK,EAAI,EAAGA,EAAIuF,EAASqa,kBAAkBzf,OAAQH,IAAK,KACrD0K,EAAQlL,KAAKmF,QAAQ+a,WACzBlgB,KAAKmF,QAAQ+a,WAAWna,EAASqa,kBAAkB5f,GAAGie,OAAO4B,aAAapV,WAAajL,KAAKmF,QAAQ+a,WAAWna,EAASqa,kBAAkB5f,GAAGie,OAAO4B,aAAapV,WAAkB,MAAO,IAAI,GAC9L,KACFjL,KAAKqc,WAAW7a,KAAIpB,EAAA,CAEhBuL,GAAI3L,KAAKsgB,0BAA2Bva,EAASqa,kBAAkB5f,GAAGie,OAAO9S,KACtE5F,EAASqa,kBAAkB5f,GAAE,CAChC0K,MAAOA,KAKflL,KAAKsc,kBAAoB,GACzBtc,KAAKqc,WAAWja,QAAO,SAAG4b,GAKxB,OAFAA,EAAOrS,GAAK9J,EAAKye,0BAA0BtC,EAAOS,OAAO9S,IACzD9J,EAAKya,kBAAkB0B,EAAOrS,IAAMqS,EAAOS,OAAO9S,GAC3CqS,IAEThe,KAAKqc,WAAWja,QAAO,SAAG4b,GACxBA,EAAOxU,UAAW,EAClB,IAAK,IAAIhJ,EAAI,EAAGA,EAAIqB,EAAK0a,gBAAgB5b,OAAQH,IAC1CqB,EAAK0a,gBAAgB/b,GAAGmL,KAAOqS,EAAOrS,KACzCqS,EAAOxU,UAAW,KAKxBxJ,KAAKuD,OAAOyC,IAGNkW,EAAAhc,UAAAogB,0BAAR,SAAkCC,GAChC,OAAMA,EACG,KAAOA,EAAS7a,QAAQ,KAAM,KADb,MAI5BwW,EAAAhc,UAAA6c,kCAAA,WAAA,IAAAlb,EAAA7B,KAWE,OAVaA,KAAKqc,WAAW9N,OAAM,SAChCyP,GACC,IAAM,IAAIxd,EAAI,EAAGA,EAAIqB,EAAKmQ,UAAUrR,OAAQH,IAC1C,GAAKwd,EAAOS,OAAO4B,aAAa1U,KAAO9J,EAAKmQ,UAAUxR,GAAGwD,KAAK2H,KACtD9J,EAAKmQ,UAAUxR,GAAGggB,QAAY,OAAO,EAG/C,OAAO,KAMbtE,EAAAhc,UAAAugB,mBAAA,SAAmB/W,GAAnB,IAAA7H,EAAA7B,KACE,GAAM0J,GAAYA,EAAQsU,OAA1B,CAGA,QAFM0C,EAAWhX,EAAQsU,OAAOrS,GAC5BgV,EAAgB3gB,KAAKsc,kBAAkB5S,EAAQsU,OAAOrS,IACjDnL,EAAI,EAAGA,EAAIR,KAAKqc,WAAW1b,OAAQH,IAAK,KAC3Cwd,EAAShe,KAAKqc,WAAW7b,GAC7B,GAAKwd,EAAOS,OAAO9S,KAAKgV,EAAe,CACrC3gB,KAAKyc,mBAAqBuB,EAAOS,OACjCze,KAAKyc,mBAAmB1B,MAAQiD,EAAOjD,MACvC,OAGD/a,KAAKwc,cACNxc,KAAKwc,YAAYoE,OACjB5gB,KAAKwc,YAAYqE,UACjB7gB,KAAKwc,YAAc,MAErBsE,WAAU,eAEJC,EADWnW,SAASqS,eAAe,qBACV+D,WAAU,GACvCD,EAAqB,MAAEE,QAAU,eACjCpf,EAAK2a,YAAc3a,EAAKqI,MAAM,IAAIwW,EAAY,CAC5CQ,QAASH,EACTI,WAAW,EACXtT,QAAS,SACTuT,aAAa,EACbC,OAAO,EACPC,MAAO,0BACPC,UAAW,MACXC,SAAU,MAET,GACHV,WAAU,WAAajf,EAAK2a,aAAa3a,EAAK2a,YAAYiF,QAAW,SAIzEvF,EAAAhc,UAAA2c,eAAA,WACK7c,KAAKwc,cACNxc,KAAKwc,YAAYoE,OACjB5gB,KAAKwc,YAAYqE,UACjB7gB,KAAKwc,YAAc,OAIvBN,EAAAhc,UAAAwhB,qBAAA,SAAqBvU,EAAezD,GAClC,OAAOyD,GACL,IAAK,SACH,IAAIzD,EAAS,WACPiY,EAAW3hB,KAAKsgB,0BAA0B5W,EAAQ6W,UACxD,IAAIoB,EAAU,WACVC,EAAS,KACb,GAAGlY,EAAQgT,eACThT,EAAQgT,aAAamF,UAAU,KAAKC,KAAI,SAAEviB,GACrCA,EAAEoM,KAAKgW,IAAUC,EAAOriB,KAE1BqiB,GAAQ,OAAOA,IAQnB1F,EAAAhc,UAAA6hB,iBAAP,SAAwB/D,GACnBA,IACGhe,KAAKuc,gBAAgB5B,SAASqD,IAC7Bhe,KAAKuc,gBAAgB5b,OAAOX,KAAK2c,sBAClC3c,KAAKuc,gBAAgB/a,KAAKwc,KAO3B9B,EAAAhc,UAAA8hB,gBAAP,SAAuBrW,OACf+U,EAAW1gB,KAAKsgB,0BAA0B3U,GAChD,GAAI+U,EAAJ,KACI1C,EAAS,KACb,OAAGhe,KAAK0c,eACN1c,KAAK0c,aAAamF,UAAU,KAAKC,KAAI,SAAEviB,GAClCA,EAAEoM,KAAK+U,IAAU1C,EAAOze,KAE1Bye,GAAeA,OAJpB,IAQF9B,EAAAhc,UAAA+hB,mBAAA,WACE,OAAOjiB,KAAKuc,iBAGdL,EAAAhc,UAAAgiB,cAAA,WACE,OAAOliB,KAAKqc,YAGdH,EAAAhc,UAAAiiB,eAAA,WACE,OAAOniB,KAAKsc,mBAGdJ,EAAAhc,UAAA0f,gBAAA,WAAA,IAAA/d,EAAA7B,KACOA,KAAK4c,kBACRwF,EAAAA,UAAWC,OAAS,UAAWxc,KAAKyc,EAAAA,SAAQ,WAAO,OAAAC,EAAAA,SAAS,QAC5Dta,UAAS,eAKDua,EAAgB,CAClBpF,MAFgBxS,SAASqS,eAAepb,EAAKsD,QAAQ+X,aAEpCG,YACjBhM,OAAO,GAETxP,EAAK0B,OAAOif,KAEdxiB,KAAK4c,iBAAkB,IAK/BV,GA3TqCzH,EAAAA,+BCJrC,SAAAgO,mDAkBA,OAlB8B5Z,EAAAA,EAAAA,GAClB4Z,EAAAviB,UAAAuL,UAAV,SAAoBzF,GACV,IAAA0U,EAAA1U,EAAA0U,MAAOrM,EAAArI,EAAAqI,KAAMqU,EAAA1c,EAAA0c,OAAQC,EAAA3c,EAAA2c,gBAAiBhR,EAAA3L,EAAA2L,MAE9C,MAAO,CACL+I,MAAKA,EACLrM,KAAIA,EACJsU,gBAAeA,EACfD,OAAQ,CACNrU,KAAMqU,EAAOrU,KACb3E,QAAS,SAEXiI,MAAO,CACLjE,YAAaiE,EAAMjE,YACnBhE,QAAS,oBAIjB+Y,GAlB8BhO,EAAAA,2BCC9B,SAAAmO,mDAKA,OAL+B/Z,EAAAA,EAAAA,GAEnB+Z,EAAA1iB,UAAAuL,UAAV,SAAoBzF,GAClB,OAAO6c,EAAAA,YAEXD,GAL+BnO,EAAAA,2BCD/B,SAAAqO,mDAgBA,OAhB4Cja,EAAAA,EAAAA,GAEhCia,EAAA5iB,UAAAuL,UAAV,SAAoBzF,GAGlB,MAAO,CACL0U,MAHM1U,EAAA0U,MAINiI,gBAJa3c,EAAA2c,gBAKbnI,MAL8BxU,EAAAwU,MAM9BnM,KANqCrI,EAAAqI,KAOrCqU,OAAQ,CACNrU,KARyCrI,EAAA0c,OAQ5BrU,KACb3E,QAAS,uBAIjBoZ,GAhB4CrO,EAAAA,2BCC5C,SAAAsO,IAAA,IAAAlhB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YAGU6B,EAAAsa,mBAA4B,GAE5Bta,EAAAua,mBAA4B,KAqHtC,OA1HyCvT,EAAAA,EAAAA,GAO7Bka,EAAA7iB,UAAAuL,UAAV,SAAoBzF,GAApB,IAAAnE,EAAA7B,KACE,IAAIgG,EAAM,OAAO,SAEXmX,EADiBvS,SAASqS,eAAe,0BACfI,YAM1BC,EAFU,IAEMH,EAGlBI,EAAc,CAChBL,YAAa,uBACbO,eAAiBN,EACjBO,gBARc,IASdC,0BAA0B,EAC1BC,mBAAmB,EAIrBL,YAA6B,IAIzByF,GAAgB,EAChBC,GAAgB,EAChBlF,EAAa,EAsFjB,OAnFA/X,EAAK8W,QAAQ1a,QAAO,SAAE4b,GACjBgF,EAAehF,EAAOjD,QAAOiI,EAAehF,EAAOjD,QACnDkI,EAAe,GAAKA,EAAejF,EAAOjD,SAAOkI,EAAejF,EAAOjD,OAC1EgD,IACaC,EAAOjD,MACjBiD,EAAOxU,UAAUyU,IAKtBjY,EAAK8W,QAAQ1a,QAAO,SAAE4b,OAChBE,EAAMF,EAAOrS,GAWbwS,GAAqBH,EAAOjD,MAASkI,EAAe,IAAuB,EAAfD,EAAqBC,EAAe,GAEhG7E,EAAgB7C,KAAK5B,IAAI2D,GAAe,IAAsB,EAAjBa,IAAqB,GAAG5C,KAAK8C,KAAKN,IAG/EO,EAAa,CACf3S,GAAIuS,EACJK,MAAO,CACL,CACE5S,GAAGuS,EAAI,UACPhR,MAAK,SAAG5N,GAAQ,OAAGA,EAAEkf,OAAO3c,EAAKsa,mBAA2B,KAAa6B,EAAOS,OAAOvR,OACvFwR,WAAU,SAAGpf,GAAM,OAAAA,EAAEqf,GACrBC,WAAU,SAAGtf,OACPuf,EAAQvf,EAAEkf,OAAO,EAErB,OADGlf,EAAEkf,OAAO3c,EAAKua,qBAAoByC,EAAK,GACnCvf,EAAEwf,EAAED,GAEbE,YAAc,OACdC,kBAAiB,SAAG1f,GAAM,OAAAA,EAAEkf,OAAO,GACnCtT,MAAO,QACPiD,QAAU,IAEZ,CACExC,GAAGuS,EAAI,UACPhR,MAAK,SAAG5N,GAAQ,OAAGA,EAAEkf,OAAO3c,EAAKua,mBAA2B,KAAa4B,EAAOjD,OAChF2D,WAAU,SAAGpf,GAAM,OAAAA,EAAEqf,GACrBC,WAAU,SAAGtf,GAAM,OAAAA,EAAEwf,EAAGxf,EAAEkf,OAAO,GACjCO,YAAc,OACdC,kBAAiB,SAAG1f,GAAM,OAAAA,EAAEkf,OAAO,GACnCtT,MAAO,QACPiD,QAAU,KAGdwQ,EAAGxB,EAAO,EAAE,GACZ2B,EAAGG,IACHT,OAAUJ,EACVlT,MAAM8S,EAAO9S,MACbgU,eAAgBlB,EAAOxU,UAAWwU,EAAOxU,SACzCE,QAAQ,CACNiC,GAAIuS,IAIRX,EAAyB,YAAE/b,KAAK8c,KAIlCf,EAAiC,oBAAI,CACnC4B,MAAOhC,EAAO,EACdiC,eAAgB,IAChBC,MAAOJ,IACPK,eAAgB,IAChBC,iBAAkB,IAClBC,oBAAqB,EACrBC,cAAe,KAGdzZ,EAAKqL,QAAOkM,EAAmB,MAAIvX,EAAKqL,OACxCrL,EAAK0Z,qBAAoBnC,EAAgC,mBAAIvX,EAAK0Z,oBAClE1Z,EAAK2Z,iBAAgBpC,EAA4B,eAAIvX,EAAK2Z,gBAEtDpC,GAEXwF,GA1HyCtO,EAAAA,+BCAzC,SAAAyO,IAAA,IAAArhB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YAEU6B,EAAA4C,aAAe,GA8DhB5C,EAAAshB,WAAU,SAAIC,EAAKzX,GAExB,IAAK9J,EAAK4C,aAAakH,GAAK,CAC1B9J,EAAK4C,aAAakH,GAAM,CAEtBgM,cAAU0L,EACVnZ,WAAOmZ,EACPC,MAAM,OAEFC,EAAK1hB,EAAK4C,aAAakH,GAC7B,IAAK4X,EAAGrZ,MAAO,KACPsC,EAAS,IAAMb,EACrB4X,EAAGrZ,MAAQA,EAAMsC,EAAQ,CACvB0U,QAAS,+BACTrT,QAAS,SACTuT,aAAa,EACbC,OAAO,EACPmC,MAAM,EACNC,SAAU,SACVnC,MAAO,oCACPC,UAAW,eACXC,SAAU,OACVkC,SAAQ,WACNH,EAAGD,MAAO,GAEZK,OAAM,eACAC,EAAOhZ,SAASiZ,uBAAuB,2BAA6BlY,EAAGjG,QAAQ,UAAW,KAAK,GAE/Fke,IACFA,EAAKE,aAAa,QAAS,kBAC3BP,EAAGrZ,MAAM6Z,WAAWH,OAGvB,QAIHI,EAAKniB,EAAK4C,aAAakH,GACvByX,EAAIlS,WAAa,EACnB8S,EAAG9Z,MAAMuX,OAETuC,EAAG9Z,MAAM0W,UAGf,OA5G2C/X,EAAAA,EAAAA,GAI/Bqa,EAAAhjB,UAAAuL,UAAV,SAAoB3C,OAAEkJ,EAAAlJ,EAAAkJ,UAAWiS,EAAAnb,EAAAmb,aAC3BC,EAAiB,GACjBpS,EAAgB,GAEpBE,EAAU5P,QAAO,SAACgP,GAKZ6S,EAAa7S,EAAMpN,KAAK2H,GAAGjG,QAAQ,OAAQ,KAE7C0L,EAAM+S,QAAS,EAEf/S,EAAM+S,QAAS,MAEbC,EAAgB,GAChBC,EAAc,CAACjT,EAAMzD,MACpByD,EAAMoP,SAAS4D,EAAc5iB,KAAK,eACnC4P,EAAMpN,KAAKiH,YACbmZ,EAAc5iB,KAAK,SAAS4P,EAAMpN,KAAKiH,WACvCoZ,EAAY7iB,KAAK,SAAS4P,EAAMpN,KAAKiH,YAGvCiZ,EAAQ1iB,KAAK,CACX8iB,SAAUD,EAAY/d,KAAK,KAC3B+H,KAAM+C,EAAMlE,MACZqX,eAAgBnT,EAAM2J,MACtBlF,UAAYzE,EAAMoP,QAAU,cAAgB,oBAC5CrS,QAASiW,EAAc9d,KAAK,MAC1B8K,EAAM+S,OAAS,cAEbnS,EAAUwS,MAAK,SAACC,GACd,OAAQA,EAAEjE,SAAYiE,EAAEzgB,KAAK2H,KAAOyF,EAAMpN,KAAK2H,KAC5C,cAAgB,gBACzBjC,QAAS0H,EAAMpN,KAAK2H,KAGtBmG,EAAOtQ,KAAK,CACV+T,SAAU,CAAC,CACTzD,OAAQ,CAAC,CACP9N,KAAM,OACN0J,YAAa0D,EAAM,qBACnBzD,KAAM,iBACNF,UAAW2D,EAAMoP,QACjB5S,aAAcoM,OAAO5I,EAAMpN,KAAK2H,IAAM,UACtCoC,YAAaiM,OAAO5I,EAAMpN,KAAK2H,IAAM,UACrCmC,aAAckM,OAAO5I,EAAMpN,KAAK2H,IAAM,UACtCwC,QAAS6L,OAAO5I,EAAMpN,KAAK2H,IAAM,sBAMrC+Y,EAAoB,GAIxB,OAHAR,EAAQpe,IAAG,SAAE6e,EAAGnkB,GACdkkB,EAAWljB,KAAK,CAAE6T,OAAQsP,EAAGhT,MAAOG,EAAOtR,OAEtCkkB,GA+CXxB,GA5G2CzO,EAAAA,+BCD3C,SAAAmQ,mDAKA,OAL6C/b,EAAAA,EAAAA,GAEjC+b,EAAA1kB,UAAAuL,UAAV,SAAoBzF,GAClB,OAAOA,GAEX4e,GAL6CnQ,EAAAA,2BCC7C,SAAAoQ,mDAmDA,OAnD0Chc,EAAAA,EAAAA,GAE9Bgc,EAAA3kB,UAAAuL,UAAV,SAAoBzF,GAEV,IAAAsD,EAAAtD,EAAAsD,MAAO4H,EAAAlL,EAAAkL,WACPtP,EAAA5B,KAAAmF,QAAAvD,OAEJkjB,EAAU,GACZ7P,EAAS,GA8BX,OA5BA3L,EAAMlH,QAAO,SAAE0G,OAAE2H,EAAA3H,EAAA2H,KAAM4P,EAAAvX,EAAAuX,aACrB,IAAIpL,EAAOoL,EAAa1U,IAAK,CACrB,IAAAiH,EAAAhR,EAAAye,EAAApV,WAAEiC,EAAA0F,EAAA1F,MAAOS,EAAAiF,EAAAjF,KACfsH,EAAOoL,EAAa1U,IAAM,CACxB+O,MAAOxN,EACPS,KAAIA,EACJQ,QAAS,SAASkS,EAAapV,UAC/B3B,MAAO,IAIX,IAAiC,IAA9Bwb,EAAQve,QAAQkK,EAAK9E,IAAW,KAC7BoZ,EAAwB,GAC5BtU,EAAKmK,KAAKxY,QAAO,SAAC4iB,GACI,WAAjBA,EAAShjB,MAAkB+iB,EAAgB,MAAMC,EAASvjB,SAE/DwT,EAAOoL,EAAa1U,IAAIrC,MAAM9H,KAAK,CACjC0L,MAAOuD,EAAKvD,MACZzL,MAAOsjB,EACPrb,QAAS,CACPyD,OAAQ,OACRxB,GAAI8E,EAAK9E,SAOV,CACLoE,QAFcvQ,OAAO2C,KAAK8S,GAAQnP,IAAG,SAAC9D,GAAO,MAAA,CAAG4T,MAAKxV,EAAA,GAAM6U,EAAOjT,OAGlEsZ,QAAS,CACP2J,SAAU,CACR5W,KAAM,sBAAsB6C,EAAU,aACtCxH,QAAS,CACPyD,OAAQ,cAId+X,SAAU,yFAGhBL,GAnD0CpQ,EAAAA,2BCD1C,SAAA0Q,mDA+CA,OA/CmCtc,EAAAA,EAAAA,GAEvBsc,EAAAjlB,UAAAuL,UAAV,SAAqB2Z,GACnB,GAAKA,EAAL,KAEMpf,EAAOof,EAAMpf,KACbwD,EAAW4b,EAAM5b,SACjB6b,EAAa,CAAE/b,MAAO,GAAII,QAAS,cAsCzC,OApCA2b,EAAW/b,MAAM9H,KAAK,CACpB6M,KAAM,WACN3E,QAAS,WACTyE,QAAqB,YAAZ3E,EAAyB,cAAgB,KAEhDxD,EAAKsf,WACPD,EAAW/b,MAAM9H,KAAK,CACpB6M,KAAM,QACN3E,QAAS,QACTyE,QAAqB,SAAZ3E,EAAsB,cAAgB,KAG/CxD,EAAKsD,OACP+b,EAAW/b,MAAM9H,KAAK,CACpB6M,KAAM,oBACN3E,QAAS,oBACTyE,QAAqB,qBAAZ3E,EAAkC,cAAgB,KAE3DxD,EAAKuf,UAAYvlB,KAAKmF,QAAwB,gBAChDkgB,EAAW/b,MAAM9H,KAAK,CACpB6M,KAAM,mBACN3E,QAAS,mBACTyE,QAAqB,oBAAZ3E,EAAiC,cAAgB,KAE1DxD,EAAKwf,UACPH,EAAW/b,MAAM9H,KAAK,CACpB6M,KAAM,QACN3E,QAAS,QACTyE,QAAqB,SAAZ3E,EAAsB,cAAgB,KAE/CxD,EAAKyf,SACPJ,EAAW/b,MAAM9H,KAAK,CACpB6M,KAAM,YACN3E,QAAS,OACTyE,QAAqB,QAAZ3E,EAAqB,cAAgB,KAE3C6b,IAEXF,GA/CmC1Q,EAAAA,2BCAnC,SAAAiR,mDAiDA,OAjD8C7c,EAAAA,EAAAA,GAElC6c,EAAAxlB,UAAAuL,UAAV,SAAoBzF,GAQlB,MAAO,CACL4P,MAAO8P,EAAyBC,aAAa3f,KAI1C0f,EAAAC,aAAP,SAAqB/V,OAOfgW,EAAY,GAChB,IAAKhW,EAAQ,MAAO,GACpB,IAAM,IAAIpP,EAAI,EAAGA,EAAIoP,EAAOjP,OAAQH,IAAM,KACpCqlB,EAAYjW,EAAOpP,GACnBka,EAAQmL,EAAU3Y,MAClBA,EAAQ2Y,EAAU7jB,IAClBP,EAAQokB,EAAUpkB,MAClBmU,EAAQiQ,EAAUjW,OAClBkW,EAAW,GAEXpL,IACFoL,EAAKpL,MAAQA,GACTxN,GAASzL,IACbqkB,EAAK5Y,MAAQA,EACb4Y,EAAKrkB,MAAQA,GACTmU,IACAA,EAAM,GAAG5T,IACX8jB,EAAKxc,MAAQoc,EAAyBC,aAAa/P,GAEnDkQ,EAAKlQ,MAAQ8P,EAAyBC,aAAa/P,IAGvDgQ,EAAUpkB,KAAKskB,GAEjB,OAAOF,GAGXF,GAjD8CjR,EAAAA,2BCA9C,SAAAsR,mDAyIA,OAzI8Bld,EAAAA,EAAAA,GAI5Bkd,EAAA7lB,UAAA8lB,UAAA,aAIUD,EAAA7lB,UAAAuL,UAAV,SAAoBzF,GAClB,OAAOA,GAGT+f,EAAA7lB,UAAA+lB,WAAA,SAAWjgB,EAAMkgB,EAASva,GAA1B,IAAA9J,EAAA7B,KACQgG,IACJA,EAAOhG,KAAKwL,QAEdxF,EAAKsD,MAAMlH,QAAO,SAAG+jB,OACbhY,EAAUgY,EAAY,QACxBA,EAAU,OAAKxa,EACZwC,EAAQ5H,QAAQ,gBAAkB,GACrC4f,EAAY,QAAIhY,EAAQzI,QAAQ,eAAgB,gBAC3CygB,EAAW,SACdA,EAAW,OAAQ,KAAI,yBAGzBA,EAAY,QAAIhY,EAAQzI,QAAQ,gBAAiB,eAC5CygB,EAAW,SACdA,EAAW,OAAQ,KAAI,uBAGjBD,EAAQ3f,QAAS4f,EAAU,QAAO,IAC1CA,EAAY,QAAIhY,EAAU,qBAEJ,IAAfgY,EAAU,OAAoBA,EAAU,MAAExlB,OAAS,GAC5DkB,EAAKokB,WAAWE,EAAID,EAASva,KAGjC3L,KAAKuD,OAAOyC,IAGd+f,EAAA7lB,UAAAkmB,eAAA,SAAeza,EAAI3F,GAAnB,IAAAnE,EAAA7B,KACQgG,IACJA,EAAOhG,KAAKwL,QAGdxF,EAAKsD,MAAMlH,QAAO,SAAG+jB,GACjB,GAAKA,EAAU,OAAKxa,GAAMwa,EAAY,QAAE5f,QAAQ,aAAe,EAC3D4f,EAAY,QAAIA,EAAY,QAAI,aAChCtkB,EAAKwkB,YAAcF,MAChB,KACChY,EAAUgY,EAAY,QAC5BA,EAAY,QAAIhY,EAAQzI,QAAQ,YAAa,SAErB,IAAfygB,EAAU,OAAoBA,EAAU,MAAExlB,OAAS,GAC5DkB,EAAKukB,eAAeza,EAAIwa,KAG9BnmB,KAAKuD,OAAOyC,IAGd+f,EAAA7lB,UAAAomB,cAAA,eACMC,EAAcvmB,KAAKwL,OACK,eAAvB+a,EAAYpY,QACfoY,EAAYpY,QAAU,eAEpBoY,EAAYpY,QAAU,cAE1BnO,KAAKuD,OAAOgjB,IAGNR,EAAA7lB,UAAAsmB,UAAR,SAAkBxgB,GAAlB,IAAAnE,EAAA7B,KACMymB,EAAU,CACZnd,MAAO,IAELtD,EAAe,UACjBA,EAAe,SAAE5D,QAAO,SAAEqO,GACxBgW,EAAe,MAAEjlB,KAAMK,EAAK6kB,UAAUjW,GAAM,EAAO,OAGvDzQ,KAAKuD,OAAOkjB,IAGNV,EAAA7lB,UAAAwmB,UAAR,SAAkB1gB,EAAM2gB,EAAQT,GAAhC,IAAArkB,EAAA7B,KACM4mB,ErDmDD,WACH,IAAK,IAAIvlB,EAAK,GAAIb,EAAI,EAAGA,EAAIE,UAAUC,OAAQH,IAC3Ca,EAAKA,EAAGwlB,OAAO/lB,EAAOJ,UAAUF,KACpC,OAAOa,EqDtDQylB,CAAOZ,GAClBa,EAAW,GACTC,EAAcL,GAA8B,MAApB3gB,EAAe,SAiD7C,OAhDIghB,IACFD,EAAiB,OAAI,CACnBpZ,KAAM,sBACNjE,QAAS,CACLyD,OAAQ,SACRxB,GAAI3F,EAAS,GACbkgB,QAASU,KAIjBpnB,OAAO2C,KAAK6D,GAAM5D,QAAO,SAAEJ,GAC3B,GAAW,YAAPA,EAAoB,CACtB,OAAQA,GACN,IAAK,QAAS+kB,EAAe,KAAI/gB,EAAKhE,GAAM,MAC5C,IAAK,MAAQ+kB,EAAc,IAAI/gB,EAAKhE,GAAM,MAC1C,IAAK,OACGglB,GAA2B,MAAbhhB,EAAKhE,GACrB+kB,EAAiB,OAAQ,KAAI/gB,EAAKhE,GAElC+kB,EAAe,KAAI/gB,EAAKhE,GAE1B,MACJ,IAAK,KACD+kB,EAAgB,MAAK/gB,EAAKhE,GAC1B+kB,EAAkB,QAAI,CACpB5Z,OAAQ,WACRxB,GAAI3F,EAAS,IAEf,MACJ,QAAWA,EAAKhE,GAElB+kB,EAAkB,QAAI,oBAEK,MAApB/gB,EAAe,WACtB4gB,EAAYplB,KAAKwE,EAAS,IAGrB2gB,IACHI,EAAkB,QAAU,OAAI,iBAChCA,EAAkB,QAAW,QAAIH,GAGnCG,EAAgB,MAAI,GACpB/gB,EAAKhE,GAAKI,QAAO,SAAEqO,GACjBsW,EAAgB,MAAEvlB,KAAMK,EAAK6kB,UAAUjW,GAAM,EAAMmW,SAIhDG,GAGXhB,GAzI8BtR,EAAAA,+BCA9B,SAAAwS,mDAkBA,OAlBuCpe,EAAAA,EAAAA,GAE3Boe,EAAA/mB,UAAAuL,UAAV,SAAoBzF,GAClB,OAAOA,GAGTihB,EAAA/mB,UAAAomB,cAAA,eACQC,EAAcvmB,KAAKwL,OACK,eAAvB+a,EAAYpY,SACfoY,EAAYpY,QAAU,eACtBoY,EAAY1Q,UAAY,sBAGxB0Q,EAAYpY,QAAU,cACtBoY,EAAY1Q,UAAY,sBAE5B7V,KAAKuD,OAAOgjB,IAEhBU,GAlBuCxS,EAAAA,2BCAvC,SAAAyS,mDAeA,OAf2Cre,EAAAA,EAAAA,GAE/Bqe,EAAAhnB,UAAAuL,UAAV,SAAoBzF,GAClB,OAAOA,GAGTkhB,EAAAhnB,UAAAomB,cAAA,eACQC,EAAcvmB,KAAKwL,OACK,eAAvB+a,EAAYpY,QACfoY,EAAYpY,QAAU,eAEtBoY,EAAYpY,QAAU,cAE1BnO,KAAKuD,OAAOgjB,IAEhBW,GAf2CzS,EAAAA,2BCA3C,SAAA0S,mDAKA,OALwCte,EAAAA,EAAAA,GAE5Bse,EAAAjnB,UAAAuL,UAAV,SAAoBzF,GAClB,OAAOA,GAEXmhB,GALwC1S,EAAAA,2BCAxC,SAAA2S,mDAKA,OALqCve,EAAAA,EAAAA,GAEzBue,EAAAlnB,UAAAuL,UAAV,SAAoBzF,GAClB,OAAOA,GAEXohB,GALqC3S,EAAAA,2BCArC,SAAA4S,mDAKA,OAL0Cxe,EAAAA,EAAAA,GAE9Bwe,EAAAnnB,UAAAuL,UAAV,SAAoBzF,GAClB,OAAOA,GAEXqhB,GAL0C5S,EAAAA,2BCA1C,SAAA6S,IAAA,IAAAzlB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YACU6B,EAAA2H,SAAmB,SAwB7B,OAzB0CX,EAAAA,EAAAA,GAG9Bye,EAAApnB,UAAAuL,UAAV,SAAoBzF,GAClB,MAAO,CACLsD,MAAO,CAAC,CACN+E,KAAM,QACN3E,QAAS,OACTyE,QAA2B,SAAlBnO,KAAKwJ,SAAsB,cAAgB,IACnD,CACD6E,KAAM,UACN3E,QAAS,QACTyE,QAA2B,UAAlBnO,KAAKwJ,SAAuB,cAAgB,IACpD,CACD6E,KAAM,WACN3E,QAAS,WACTyE,QAA2B,aAAlBnO,KAAKwJ,SAA0B,cAAgB,OAKvD8d,EAAApnB,UAAAqnB,YAAP,SAAmBC,GACjBxnB,KAAKwJ,SAAWge,GAGpBF,GAzB0C7S,EAAAA,4cCA1C,SAAAgT,mDA4CA,OA5CuC5e,EAAAA,EAAAA,GAE9B4e,EAAAvnB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KAEEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,0BACH,GAAI0F,EAAQge,WAAW,QAErB7lB,EAAKkV,UAAU,aAAcrN,QACxB,GAAIA,EAAQge,WAAW,QAAS,KACjCC,EAAaC,OAAOle,EAAQhE,QAAQ,QAAS,KAEjD,GAAKiiB,EAAa9lB,EAAK2G,WAAWqR,WAAa,OAC1C,GAAK8N,EAAa,GAAKA,IAAe9lB,EAAK2G,WAAWsR,YAAc,OACpEjY,EAAKkV,UAAU,OAAQrN,QAG5B7H,EAAKuS,WAAW,WAAY,CAC1BzK,QAAS,SACTC,KAAM,CAAC,iBAAiBF,KAG5B,MACF,IAAK,2BACH7H,EAAKkV,UAAU,SAAU6Q,OAAOle,EAAQjI,QACxC,MACA,QACE6F,QAAQC,KAAK,yBAA0BvD,EAAM,kBAAmB0F,MAKxE1J,KAAK6nB,aAAa5f,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM8E,EAAAY,QACnC,OAAQ1F,GACN,IAAK,0BAEHsD,QAAQqS,IAAI,iBAAkB9X,EAAK2G,WAAWsR,iBAOxD2N,GA5CuCzT,EAAAA,6BCAvC,SAAA8T,mDAeA,OAf6Cjf,EAAAA,EAAAA,GAEpCif,EAAA5nB,UAAA2T,OAAP,WACE7T,KAAK8T,aAAa7L,UAAS,SAAEa,OAAC9E,EAAA8E,EAAA9E,KAAM8E,EAAAY,QAM9BpC,QAAQC,KAAK,2BAA4BvD,MAMnD8jB,GAf6C9T,EAAAA,6BCA7C,SAAA+T,mDAgFA,OAhFqClf,EAAAA,EAAAA,GAE5Bkf,EAAA7nB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAC+f,GAC1B,OAAQA,EAAMhkB,MACZ,IAAK,uBACH,MACF,IAAK,wBACHgkB,EAAMte,QAAQue,YAAcpmB,EAAK2G,WAAW2Z,iBAC5C6F,EAAMte,QAAQ2S,WAAaxa,EAAK2G,WAAW0Z,gBAC3CrgB,EAAKkV,UAAU,QAASiR,EAAMte,SAC9B,MACF,IAAK,kCACGwe,EAAarmB,EAAK2G,WAAWiY,mBACjC,CACE+B,cAAcwF,EAAMte,QAAQ8Y,cAC5BxE,OAAOgK,EAAMte,QAAQsU,SAEzBgK,EAAMte,QAAQwe,WAAaA,EAC3BrmB,EAAKkV,UAAU,cAAeiR,EAAMte,SACpC,MACF,IAAK,8BAMH7H,EAAKkV,UAAU,cAAeiR,EAAMte,SACpC,MACA,IAAK,6CACH7H,EAAKkV,UAAU,6BAA8BiR,EAAMte,SACnD,MACJ,IAAK,4CACH7H,EAAKkV,UAAU,4BAA6BiR,EAAMte,SAChD,MACJ,IAAK,8CACH7H,EAAKkV,UAAU,8BAA+BiR,EAAMte,SAClD,MACJ,QACEpC,QAAQC,KAAK,gCAAiCygB,EAAMhkB,SAK1DhE,KAAK6nB,aAAa5f,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAO1F,GACL,IAAK,iDACKmkB,EAAa,CACfnK,OAAUnc,EAAK2G,WAAWkZ,qBAAqB,SAAShY,GACxDue,YAAepmB,EAAK2G,WAAW2Z,iBAC/B9F,WAAcxa,EAAK2G,WAAW0Z,gBAC9B/U,OAAU,UAEZtL,EAAKkV,UAAU,QAASoR,GACxB,MACN,IAAK,+BACHtmB,EAAKkV,UAAU,kBACf,CACEsF,WAAcxa,EAAK2G,WAAW0Z,gBAC9B1Y,SAAY3H,EAAK2G,WAAWyZ,uBAE9B,MACF,IAAK,wCACL,IAAK,wCACL,IAAK,sCACCvY,EAAQyD,QACVtL,EAAK2G,WAAWqX,6BAA6BnW,GAC7C7H,EAAKkV,UAAU,kBACf,CACEsF,WAAcxa,EAAK2G,WAAW0Z,gBAC9B1Y,SAAY3H,EAAK2G,WAAWyZ,qBAC5BgG,YAAepmB,EAAK2G,WAAW2Z,oBAGjCtgB,EAAK2G,WAAWjF,OAAOmG,OAMnCqe,GAhFqC/T,EAAAA,6BCArC,SAAAoU,mDAmBA,OAnB8Bvf,EAAAA,EAAAA,GAErBuf,EAAAloB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,gBAEH,MAEF,IAAK,iBACHnC,EAAKkV,UAAU,SAAUrN,OASnC0e,GAnB8BpU,EAAAA,6BCA9B,SAAAqU,mDAoBA,OApByCxf,EAAAA,EAAAA,GAEhCwf,EAAAnoB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAC+f,GAC1B,OAAQA,EAAMhkB,MACZ,IAAK,6BACHnC,EAAKkV,UAAU,QAAQiR,EAAMte,SAC7B,MACF,IAAK,mCACH7H,EAAKkV,UAAU,cAAciR,EAAMte,SACnC,MACF,IAAK,mCACH7H,EAAKkV,UAAU,cAAciR,EAAMte,aAQ7C2e,GApByCrU,EAAAA,6BCAzC,SAAAsU,mDAsCA,OAtC2Czf,EAAAA,EAAAA,GAElCyf,EAAApoB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GAEN,IAAK,+BACHnC,EAAKkV,UAAU,QAASrN,GACxB,MAEF,IAAK,gCACH7H,EAAKkV,UAAU,SAAUrN,GACzB,MAEF,IAAK,+BACH7H,EAAKkV,UAAU,QAASrN,GAC1B,QACEpC,QAAQC,KAAK,iCAAkCvD,MAKrDhE,KAAK6nB,aAAa5f,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,uCACHnC,EAAK2G,WAAW2a,WAAWzZ,EAAQ3D,SAAU2D,EAAQqC,QAAQ6B,kBAavE0a,GAtC2CtU,EAAAA,6BCA3C,SAAAuU,mDAsBA,OAtB4C1f,EAAAA,EAAAA,GAEnC0f,EAAAroB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM8E,EAAAY,QACnC,OAAQ1F,GACN,IAAK,gCACHnC,EAAKuS,WAAW,WAAY,CAC1BzK,QAAS,SACTC,KAAM,CAAC,uBAcnB2e,GAtB4CvU,EAAAA,6BCA5C,SAAAwU,mDAiBA,OAjB6C3f,EAAAA,EAAAA,GAEpC2f,EAAAtoB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAG+f,GAC5B,OAAOA,EAAMhkB,MACX,IAAK,kCACHnC,EAAKkV,UAAU,QAAQiR,EAAMte,aAWvC8e,GAjB6CxU,EAAAA,6BCA7C,SAAAyU,mDAeA,OAf0C5f,EAAAA,EAAAA,GAEjC4f,EAAAvoB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAO1F,GACL,IAAK,6BACA0F,GAA8B,SAAnBA,EAAQyD,QAAmBtL,EAAKkV,UAAU,QAASrN,OAS3E+e,GAf0CzU,EAAAA,6BCA1C,SAAA0U,mDAoBA,OApBmC7f,EAAAA,EAAAA,GAE1B6f,EAAAxoB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAC9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QAClC,OAAO1F,GACL,IAAK,sBACHnC,EAAKkV,UAAU,QAASrN,GACxB,MACF,QACEpC,QAAQC,KAAK,4BAWvBmhB,GApBmC1U,EAAAA,6BCAnC,SAAA2U,mDAeA,OAfuC9f,EAAAA,EAAAA,GAE9B8f,EAAAzoB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACvB,2BAAR1F,IACFnC,EAAK2G,WAAW8d,gBAChBzkB,EAAKkV,UAAU/S,EAAM0F,OAS7Bif,GAfuC3U,EAAAA,6BCAvC,SAAA4U,mDAeA,OAfuC/f,EAAAA,EAAAA,GAE9B+f,EAAA1oB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACvB,2BAAR1F,IACFnC,EAAK2G,WAAW8d,gBAChBzkB,EAAKkV,UAAU,QAASrN,OAShCkf,GAfuC5U,EAAAA,6BCAvC,SAAA6U,mDA2BA,OA3B8BhgB,EAAAA,EAAAA,GAErBggB,EAAA3oB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,GAAEA,EAAA9E,SAAM0F,EAAAZ,EAAAY,QACnC,GAAGA,QAAoC,IAAlBA,EAAQyD,OAC3B,OAASzD,EAAQyD,QACf,IAAK,SAAkBtL,EAAK2G,WAAWyd,WAAY,KAAMvc,EAAQwc,QAASxc,EAAQiC,IAAM,MACxF,IAAK,iBAAkB9J,EAAK2G,WAAWyd,WAAY,KAAMvc,EAAQwc,QAASxc,EAAQiC,IAClF,IAAK,WAAkB9J,EAAK2G,WAAW4d,eAAgB1c,EAAQiC,IACxC9J,EAAKkV,UAAU,QAASrN,EAAQiC,OAM5D3L,KAAK6nB,aAAa5f,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QAClC,OAAQ1F,GACN,IAAK,0BAA2BnC,EAAK2G,WAAW8d,gBAAiB,MACjE,IAAK,8BACHzkB,EAAK2G,WAAW4d,eAAgB1c,GAChC7H,EAAK2G,WAAWyd,WAAY,KAAMpkB,EAAK2G,WAAW6d,YAAY3c,QAAQwc,QAASxc,GAAW,MAC5F,IAAK,sCACH7H,EAAK2G,WAAWge,UAAU9c,OAKtCmf,GA3B8B7U,EAAAA,6BCA9B,SAAA8U,mDAMA,OAN0CjgB,EAAAA,EAAAA,GAEjCigB,EAAA5oB,UAAA2T,OAAP,aAIFiV,GAN0C9U,EAAAA,6BCA1C,SAAA+U,mDAcA,OAd+BlgB,EAAAA,EAAAA,GAEtBkgB,EAAA7oB,UAAA2T,OAAP,aAYFkV,GAd+B/U,EAAAA,0VCGlBgV,GAAsB,CACjCnhB,SAAU,kBACVH,QAAS,GACTe,SAAU6Q,GACV5Q,SAAU6Q,GACVjR,mBAAoB6O,GACpB5O,qBAAsB6O,GACtB6R,cAAe,mBCHf,SAAAC,WAEEvV,EAAA/S,KAAAZ,KAAM4B,KAAO5B,KAWjB,OAd4C6I,EAAAA,EAAAA,GAM1CqgB,EAAAhpB,UAAAqX,SAAA,WACEvX,KAAK+H,UAGPmhB,EAAAhpB,UAAAsX,YAAA,WACExX,KAAK2I,iCAfR8O,EAAAA,UAASnV,KAAA,CAAC,CACToV,SAAU,kBACVC,SAAA,0GAgBFuR,GAd4CzhB,kBCN5C,SAAA0hB,IAAA,IAAAtnB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YASS6B,EAAAunB,WAAkB,GAElBvnB,EAAAwnB,UAAiB,GAGjBxnB,EAAAsY,SAAmB,GA0B1BtY,EAAAynB,gBAAe,SAAGC,GAIhB1nB,EAAK2nB,YAAcD,EACnB1nB,EAAK4nB,cAAc5nB,EAAKunB,eA2F5B,OAxIsCvgB,EAAAA,EAAAA,GAmBpCsgB,EAAAjpB,UAAA6H,OAAA,SAAOe,OAAEC,EAAAD,EAAAC,cAAeC,EAAAF,EAAAE,UAAWC,EAAAH,EAAAG,OAAQ9D,EAAA2D,EAAA3D,QAAS+D,EAAAJ,EAAAI,aAAcwgB,EAAA5gB,EAAA4gB,cAChE1pB,KAAK0pB,cAAgBA,EACrB1pB,KAAK+I,cAAgBA,EACrB/I,KAAKgJ,UAAYA,EACjBhJ,KAAKmF,QAAUA,EACfnF,KAAKiJ,OAASA,EACdjJ,KAAKkJ,aAAeA,EACpBlJ,KAAK2pB,iBAAiB3pB,KAAK+I,cAAchH,IAAI,qBAAsB/B,KAAK+I,cAAchH,IAAI,oBAAiC,aAI7HonB,EAAAjpB,UAAA0pB,cAAA,SAAcje,GAIZ,OAAO3L,KAAK0pB,cAAczkB,SAAS,mBAAoB,CACrDkC,QAAO,SAAGzF,GAAU,OAAA4F,QAAQ5F,MAAMA,IAClC0D,OAAQ,CAAEmb,SAAU5U,MAYxBwd,EAAAjpB,UAAAupB,cAAA,SAAczjB,OAINwD,EAAWxJ,KAAKwpB,YACtBxpB,KAAKqJ,IAAI,iBAAiB9F,OAAO,CAAEyC,KAAIA,EAAEwD,SAAQA,KAGnD2f,EAAAjpB,UAAA2pB,SAAA,SAASle,EAAI4d,GAIX,GAAI5d,GAAM4d,EAGR,OAFAvpB,KAAK8pB,UAAYne,EACjB3L,KAAKwpB,YAAcD,EACZvpB,KAAK0pB,cAAczkB,SAAS,mBAAoB,CACrDkC,QAAO,SAAEzF,GAAS,OAAA4F,QAAQ5F,MAAMA,IAChC0D,OAAQ,CAAEmb,SAAU5U,KAItB3L,KAAKgD,UAAY,eAIrBmmB,EAAAjpB,UAAA6pB,YAAA,SAAY3G,GAWV,OAVA9b,QAAQqS,IAAI,0BAA2B,CAAEyJ,IAAGA,IAC5CpjB,KAAKopB,WAAahG,EAClBpjB,KAAKqpB,UAAY,CACf1b,KAAM3N,KAAK+I,cAAchH,IAAI,eAAe/B,KAAKopB,WAAW3K,OAAO4B,aAAapV,WAAW0C,KAC3FU,KAAMrO,KAAKopB,WAAW3K,OAAOvR,MAC7BhC,MAAOlL,KAAKopB,WAAW3K,OAAO4B,aAAapV,WAG7CjL,KAAKqJ,IAAI,iBAAiB2gB,cAAc,CAACL,eAAgB3pB,KAAK2pB,iBAEtD3pB,KAAKwpB,aACX,IAAK,WACHxpB,KAAKqJ,IAAI,mBAAmB2gB,cAAc,CACxC1d,QAAS,SACT4T,WAAYlgB,KAAK+I,cAAchH,IAAI,eACnCyb,kBAAmB,+BACnBN,YAAa,oCAEfld,KAAKqJ,IAAI,6BAA6B2gB,cAAc,CAAE1d,QAAStM,KAAKwpB,cACpExpB,KAAKqJ,IAAI,6BAA6B9F,OAAO6f,EAAIkC,WACjDtlB,KAAKqJ,IAAI,qBAAqB2gB,cAAc,CAAE9P,KAAM,EAAGtY,OAAQ5B,KAAK+I,cAAeuD,QAAS,WAC5FtM,KAAKqJ,IAAI,qBAAqB9F,OAAO6f,GACrC,MAEF,IAAK,QACHpjB,KAAKqJ,IAAI,6BAA6B2gB,cAAc,CAAE1d,QAAStM,KAAKwpB,cACpExpB,KAAKqJ,IAAI,6BAA6B9F,OAAO6f,EAAIkC,WACjD,MAEF,IAAK,oBACHtlB,KAAKqJ,IAAI,qBAAqB2gB,cAAc,CAC1C1d,QAAStM,KAAKwpB,YACd5nB,OAAQ5B,KAAK+I,cACbwI,KAAMvR,KAAK8Z,YACXI,KAAMla,KAAKma,WAEbna,KAAKqJ,IAAI,qBAAqB9F,OAAO6f,GACrC,MAEF,IAAK,mBACHpjB,KAAKqJ,IAAI,mBAAmB2gB,cAAc,CACxC1d,QAAS,SACT4T,WAAYlgB,KAAK+I,cAAchH,IAAI,eACnCyb,kBAAmB,uBACnBN,YAAa,2BAEf,MAEF,IAAK,QAIL,IAAK,OAEH,MAEF,QAEE5V,QAAQC,KAAK,+BAIrB4hB,GAxIsC/e,EAAAA,qCCCtC,SAAA6f,IAAA,IAAApoB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YACU6B,EAAA+R,WAA2B,IAAIxK,EAAAA,UAiIzC,OAlIsCP,EAAAA,EAAAA,GAO7BohB,EAAA/pB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,wBACHnC,EAAK2G,WAAWT,OAAO2B,GACvB7H,EAAKkH,cAAgBW,EAAQX,cAC7BlH,EAAKsH,MAAQO,EAAQP,MACrBtH,EAAK0e,SAAW1e,EAAKsH,MAAM+gB,SAAS9kB,OAAOuG,IAAM,GACjD9J,EAAK2G,WAAWsR,YAAcjY,EAAKsH,MAAM+gB,SAAS9kB,OAAOmM,MAAQ,GACjE1P,EAAKsoB,cACLtoB,EAAKuoB,eAAevoB,EAAK0e,UACzB,MAEF,IAAK,2BACH1e,EAAK+R,WAAWtS,OAChB,MAEF,IAAK,4BACCoI,GACF7H,EAAKuS,WAAW,WAAY,CAC1BxK,KAAM,CACJ/H,EAAKkH,cAAchH,IAAI,SAASsoB,eAC9B,IACFxoB,EAAK0e,SACH,IACF7W,GAEFC,QAAS,cAUnB3J,KAAK6nB,aAAa5f,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,sBACC0F,IACF7H,EAAK2G,WAAWghB,YAAc9f,EAC9B7H,EAAK2G,WAAW8gB,gBAAiB5f,GACjC7H,EAAKuS,WAAW,WAAY,CAC1BxK,KAAM,CACJ/H,EAAKkH,cAAchH,IAAI,SAASsoB,eAC9B,IACFxoB,EAAK0e,SACH,IACF7W,GAEFC,QAAS,YAGb,MACF,IAAK,+BACH9H,EAAK2G,WAAWsR,YAAcpQ,EAAQ4E,MAAM,KAAK,GACjDzM,EAAKuS,WAAW,WAAY,CAC1BzK,QAAS,SACTC,KAAM,CAAC,aAAa/H,EAAKsH,MAAM+gB,SAAS9kB,OAAOuG,GAAE,sBAAsBjC,EAAQ4E,MAAM,KAAK,MAE5F,MACF,IAAK,yBACcsZ,OAAOle,EAAQhE,QAAQ,QAAS,KAKjD,MACF,IAAK,2BACH7D,EAAK2G,WAAW2R,SAAWzQ,EAC3B7H,EAAKsoB,cACP,IAAK,4CACD,IAAIzgB,IAAYA,EAAQ6W,SAAU,OAClC1e,EAAKuS,WAAW,WAAY,CAC1BzK,QAAS,SACTC,KAAM,CAAC,aAAaF,EAAQ6W,SAAQ,mBAUxC0J,EAAA/pB,UAAAiqB,YAAR,WAAA,IAAAtoB,EAAA7B,KAKEA,KAAKmJ,MAAMmhB,SAASriB,UAAS,SAAC7C,GAExBA,EAAOrD,IAAI,MAEbF,EAAK2G,WAAWqhB,SAASzkB,EAAOrD,IAAI,MAAOqD,EAAOrD,IAAI,QAAQkG,UAAS,SAAEmb,GACvE,GAAIA,EAAK,CACPvhB,EAAK2G,WAAWuhB,YAAY3G,GAC5BA,EAAuB,kBAAGA,EAAImC,aAC1BnF,EAAoB,CAACjT,OAAQiW,GAC7BvhB,EAAK2G,WAAWmhB,gBAAwC,qBAAtBvkB,EAAOrD,IAAI,QAC/CF,EAAKkV,UAAU,uBAAwBqJ,MAK7Cve,EAAK2G,WAAWqhB,cAKdI,EAAA/pB,UAAAkqB,eAAR,SAAuB7V,GAAvB,IAAA1S,EAAA7B,KACEsH,QAAQqS,IAAI,mBACZ3Z,KAAKwI,WAAWohB,cAAcrV,GAActM,UAAS,SAAElC,GACjDA,GACFlE,EAAK2G,WAAWihB,cAAc1jB,GAE5BwO,GACF1S,EAAKkV,UAAU,aAAcxC,MAKrC0V,GAlIsCjW,EAAAA,cCEtC,IAAauW,GAAuB,CAClC1iB,SAAU,mBACVH,QAAS,CACP,CAAEiE,GAAI,gBAAiBuL,eAAe,GACtC,CAAEvL,GAAI,6BACN,CAAEA,GAAI,qBACN,CAAEA,GAAI,oBAERlD,SAAU0gB,GACVzgB,SAAUuhB,GACV3hB,mBAAoB6O,GACpB5O,qBAAsB6O,GACtBjS,QAAS,mBCFT,SAAAqlB,EACUvhB,EACAE,EACAJ,EACAuO,EACAoS,EACA1gB,EACAE,GAPV,IAAArH,EASE8R,EAAA/S,KAAAZ,KAAMsX,EAAqBvV,IAAI,yBAA2BH,KAAO5B,YARzD6B,EAAAoH,OAAAA,EACApH,EAAAsH,MAAAA,EACAtH,EAAAkH,cAAAA,EACAlH,EAAAyV,qBAAAA,EACAzV,EAAA6nB,cAAAA,EACA7nB,EAAAmH,UAAAA,EACAnH,EAAAqH,aAAAA,IA6BZ,OArC6CL,EAAAA,EAAAA,GAkBjC2hB,EAAAtqB,UAAA4H,YAAV,WACE,MAAO,CACLiB,cAAe/I,KAAK+I,cACpBC,UAAWhJ,KAAKgJ,UAChBC,OAAQjJ,KAAKiJ,OACbE,MAAOnJ,KAAKmJ,MACZD,aAAclJ,KAAKkJ,aACnBwgB,cAAe1pB,KAAK0pB,cACpBvkB,QAASnF,KAAK4B,OAAOuD,SAAW,KAIpCqlB,EAAAtqB,UAAAqX,SAAA,WACEvX,KAAK+H,UAGPyiB,EAAAtqB,UAAAsX,YAAA,WACExX,KAAK2I,iCAvCR8O,EAAAA,UAASnV,KAAA,CAAC,CACToV,SAAU,mBACVC,SAAA,6tRAXOC,EAAAA,cAAQC,EAAAA,sBAGRlW,SACAc,SAGAsE,SAFApE,SAJAmV,EAAAA,SAiDT0S,GArC6C/iB,sBCV7C,SAAAgjB,IAAA,IAAA5oB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YAKU6B,EAAAmQ,UAAmB,KACnBnQ,EAAAoiB,aAAe,GACfpiB,EAAA6oB,YAAmB,GAInB7oB,EAAAwa,WAAoB,KAEpBxa,EAAA8oB,yBAAmC,EACnC9oB,EAAA+oB,qBAAwC,IAAIxhB,EAAAA,QAG7CvH,EAAA0a,gBAAyB,GACzB1a,EAAAgpB,cAAwB,KAGvBhpB,EAAA6a,aAAoB,KAEpB7a,EAAA8a,qBAA+B,EAM/B9a,EAAAya,kBAAyB,GAGzBza,EAAAipB,iBAA2B,EAC3BjpB,EAAA2a,YAAmB,KACpB3a,EAAA4a,mBAA0B,KAC1B5a,EAAAkpB,qBAA+B,EAC/BlpB,EAAAmpB,gBAAiB,EACjBnpB,EAAA8nB,gBAAiB,EA4BjB9nB,EAAAopB,gBAAe,SAAItf,EAAI3F,EAAMb,GAC9BA,GACFtD,EAAKwH,IAAIsC,GAAIqe,cAAc7kB,GAE7BtD,EAAKwH,IAAIsC,GAAIpI,OAAOyC,MAsWxB,OA3aoC6C,EAAAA,EAAAA,GAuClC4hB,EAAAvqB,UAAA6H,OAAA,SAAOe,OAAE4gB,EAAA5gB,EAAA4gB,cAAe1gB,EAAAF,EAAAE,UAAWD,EAAAD,EAAAC,cAAemB,EAAApB,EAAAoB,MAChDlK,KAAK0pB,cAAgBA,EACrB1pB,KAAK+I,cAAgBA,EACrB/I,KAAKgS,UAAY,GACjBhS,KAAK8qB,gBAAkBzI,OAAO6I,WAC9BlrB,KAAKgJ,UAAYA,EACjBhJ,KAAKkK,MAAQA,EACblK,KAAK2pB,iBAAiB3pB,KAAK+I,cAAchH,IAAI,qBAAsB/B,KAAK+I,cAAchH,IAAI,oBAAiC,YAE3H/B,KAAKqJ,IAAI,WAAW9F,OAAOvD,KAAK+I,cAAchH,IAAI,eAAe,aACjE/B,KAAKqJ,IAAI,2BAA2B9F,OAAOvD,KAAK+I,cAAchH,IAAI,eAAe,gBAEjF/B,KAAKgJ,UAAUzF,OAAO,YAAa,sBACnCvD,KAAKgJ,UAAUzF,OAAO,YAAa,4BACnCvD,KAAKgJ,UAAUtF,aAAa,aAAc,WAE1C1D,KAAKmrB,8BAGAV,EAAAvqB,UAAAkrB,aAAP,SAAoB7lB,EAAOH,GACzB,OAAOpF,KAAK0pB,cAAczkB,SAASM,EAAO,CACxC4B,QAAO,SAAGzF,GAAU,OAAA4F,QAAQ5F,MAAMA,IAClC0D,OAAMA,KAWVqlB,EAAAvqB,UAAAmrB,qBAAA,WACE,OAAOrrB,KAAK0pB,cAAczkB,SAAS,eAAgB,CACjDkC,QAAO,SAAGzF,GAAU,OAAA4F,QAAQ5F,MAAMA,OAItC+oB,EAAAvqB,UAAAorB,oBAAA,SAAoBvlB,GAApB,IAAAlE,EAAA7B,KACE+F,EAAS+Z,aAAa1d,QAAO,SAAEmpB,OACvBC,EAAgB3pB,EAAKkH,cAAchH,IAAI,eAAewpB,EAAIpL,UAAUnc,KAAKiH,WAC3EugB,GACF3pB,EAAKmQ,UAAUxQ,KAAIpB,EAAA,GACdmrB,EAAIpL,UACJqL,EAAa,CAChBhL,SAAS,OAGfxgB,KAAKqJ,IAAI,0BAA0B9F,OAAO,CACxCyO,UAAWhS,KAAKgS,UAChBiS,aAAcjkB,KAAKikB,eAErBjkB,KAAKqJ,IAAI,mBAAmB2gB,cAAc,CACxC1d,QAAS,OACT4T,WAAYlgB,KAAK+I,cAAchH,IAAI,eACnCyb,kBAAmB,uBACnBN,YAAa,2BAEfld,KAAKyrB,8BAA8B1lB,IAGrC0kB,EAAAvqB,UAAAurB,8BAAA,SAA8B1lB,GAC5B,GAAKA,GAAaA,EAAS2lB,gBAA3B,KAGIC,EAAa5lB,EAAS2lB,gBAAgBxa,WAC1C,GAAIya,EAAa,EAAG,CAElB,QADIC,EAAgB,EACbD,EAAa,KAClBA,GAAc,IACdC,GAAiB,MAEfC,EAAmBF,EAAa,GAChCA,EAAa,GAAIE,EAAmB,KAAOF,EACtCA,EAAa,MAAKE,EAAmB,IAAMF,GAElD3rB,KAAK6qB,cADHe,EAAgB,EACGA,EAAgB,IAAMC,EAEtBF,EAAa,QAEpC3rB,KAAK6qB,cAAgB,KAEvB7qB,KAAKqJ,IAAI,qBAAqB2gB,cAAc,CAC1C1d,QAAS,OACT1K,OAAQ5B,KAAK+I,gBAGf/I,KAAKqJ,IAAI,qBAAqB9F,OAAOwC,EAAS2lB,mBAGhDjB,EAAAvqB,UAAAwhB,qBAAA,SAAqBvU,EAAgBzD,GACnC,OAAQyD,GACN,IAAK,SACH,IAAKzD,EAAS,WACRiY,EAAWjY,EAAQgX,SACzB,IAAKiB,EAAU,WACXC,EAAS,KACT5hB,KAAK0c,eACP1c,KAAK0c,aAAamF,UAAU,KAAKC,KAAI,SAACviB,GAChCA,EAAEoM,KAAOgW,IAAUC,EAASriB,KAE9BqiB,GAAQ5hB,KAAK+hB,iBAAiBH,MAQnC6I,EAAAvqB,UAAA6hB,iBAAP,SAAwB/D,GACtB,OAAIA,IACGhe,KAAKuc,gBAAgB5B,SAASqD,IAC7Bhe,KAAKuc,gBAAgB5b,OAASX,KAAK2c,sBACrC3c,KAAKgrB,eAAgD,GAA/BhrB,KAAKuc,gBAAgB5b,OAC3CX,KAAKuc,gBAAgB/a,KAAKwc,IACnB,GAIN,MAGFyM,EAAAvqB,UAAA4rB,mBAAP,SAA0BpiB,GACxB,GAAIA,GAAWA,EAAQsU,SACrBhe,KAAKuc,gBAAkBvc,KAAKuc,gBAAgBhO,OAAM,SAC/ChP,GAAM,OAAAA,EAAEoM,KAAOjC,EAAQsU,OAAOrS,KAC7BjC,EAAQsU,OAAOkB,cAEjB,OADAxV,EAAQsU,OAAOkB,cAAe,EACvBlf,KAAK+rB,iBAKXtB,EAAAvqB,UAAA8rB,iBAAP,SAAwBjmB,GAAxB,IAAAlE,EAAA7B,KAQE,MAPoB,CAClBqR,OAAO,EACPsO,eAAc,SAAGsM,GAAe,OAAApqB,EAAK6a,aAAeuP,GACpDja,UAAWhS,KAAKgS,UAChB7E,OAAQpH,EACRwW,gBAAiBvc,KAAKuc,kBAKlBkO,EAAAvqB,UAAA6rB,cAAR,WAAA,IAAAlqB,EAAA7B,KACMksB,EAAsB,GAC1B,GAAIlsB,KAAKsc,kBAAmB,KACtB6P,EAAInsB,KAAK+I,cAAchH,IAAI,eAC3BqqB,EAAgB,CAClBC,QAAQ,EACRC,QAAQ,EACRC,UAAU,EACVC,eAAe,GAEjBxsB,KAAKuc,gBAAgBna,QAAO,SAAEqqB,OAEHC,EAAKxhB,EAD1ByhB,EAAIF,EAAGvhB,MAIXkhB,GAHyBM,EAGOP,EAHFjhB,EAGKyhB,EAF1BntB,OAAO2C,KAAKuqB,GAAKE,KAAI,SAAC5qB,GAAO,OAAA0qB,EAAI1qB,GAAKkJ,MAAMC,MAAQD,OAEpB,MACrCqV,EAAW1e,EAAKya,kBAAkBmQ,EAAG9gB,IACrC4U,GACF2L,EAAoB1qB,KAAK+e,KAE7BvgB,KAAKikB,aAAemI,EACpBpsB,KAAKqJ,IAAI,0BAA0B9F,OAAO,CACxCyO,UAAWhS,KAAKgS,UAChBiS,aAAcjkB,KAAKikB,eAGvB,OAAOjkB,KAAK0pB,cAAczkB,SAAS,eAAgB,CACjDkC,QAAO,SAAGzF,GAAU,OAAA4F,QAAQ5F,MAAMA,IAClC0D,OAAQ,CACN8mB,oBAAmBA,EACnBR,gBAAiB,CAAEjZ,OAAQ,EAAGE,MAAO3S,KAAK+I,cAAchH,IAAI,eAAe,sBAK1E0oB,EAAAvqB,UAAA2sB,cAAP,SAAqB9mB,EAAU+mB,GACxBA,GACH9sB,KAAKyrB,8BAA8B1lB,IAIhC0kB,EAAAvqB,UAAA6sB,mBAAP,SAA0B/mB,GACxBhG,KAAKqc,WAAarW,EAAKqW,WACvBrc,KAAKsc,kBAAoBtW,EAAKiiB,aAGzBwC,EAAAvqB,UAAA8sB,WAAP,SAAkBF,GACXA,GACH9sB,KAAKitB,kBAITxC,EAAAvqB,UAAA6c,kCAAA,WAAA,IAAAlb,EAAA7B,KAUE,OATaA,KAAKqc,WAAW9N,OAAM,SAChCyP,GACC,IAAK,IAAIxd,EAAI,EAAGA,EAAIqB,EAAKmQ,UAAUrR,OAAQH,IACzC,GAAIwd,EAAOS,OAAO4B,aAAa1U,KAAO9J,EAAKmQ,UAAUxR,GAAGwD,KAAK2H,KACtD9J,EAAKmQ,UAAUxR,GAAGggB,QAAW,OAAO,EAE7C,OAAO,KAMbiK,EAAAvqB,UAAAgtB,wBAAA,SAAwBC,OAClBzjB,EAAkByjB,EAAOvf,aACzBnM,EAAgB0rB,EAAO1rB,MAE3BzB,KAAK0qB,YAAYhhB,GAAWjI,GAG9BgpB,EAAAvqB,UAAAktB,uBAAA,SAAuBC,OACjB3jB,EAAkB2jB,EAAMzf,aAER5N,KAAK0qB,YAAYhhB,IAGvC+gB,EAAAvqB,UAAAotB,uBAAA,SAAuBvhB,GAAvB,IAAAlK,EAAA7B,KACM6sB,GAAgB,EAChBU,EAAgBvtB,KAAKgS,UAAUzD,OAAM,SAACkW,GAAK,OAAAA,EAAEjE,UAAS7f,OAAS,EA8BnE,GA7BAX,KAAKgS,UAAU5P,QAAO,SAACqiB,GACjBA,EAAEzgB,KAAK2H,KAAOI,IAAwB,IAAb0Y,EAAEN,SAI3BM,EAAEzgB,KAAK2H,KAAOI,EAEZ0Y,EAAEjE,SAAW+M,GAAiB,GAChC9I,EAAEjE,SAAU,EACZiE,EAAEN,QAAS,EACX0I,GAAgB,IAEhBpI,EAAEjE,SAAU,EACZiE,EAAEN,QAAS,EACX0I,GAAgB,GAII,IAAlBU,GAAuB9I,EAAEjE,QAC3BiE,EAAEN,QAAS,EAEXM,EAAEN,QAAS,KAIjBnkB,KAAKqJ,IAAI,0BAA0B9F,OAAO,CACxCyO,UAAWhS,KAAKgS,UAChBiS,aAAcjkB,KAAKikB,eAEjB4I,EAAe,KACbW,EAAmB,GAIvB,GAHAxtB,KAAKgS,UAAU5P,QAAO,SAAEqrB,GACjBA,EAAGjN,SAASgN,EAAiBhsB,KAAKisB,EAAGzpB,KAAK2H,MAE7C6hB,EAAkB,KAChBE,EAA0B1tB,KAAKuc,gBAAgBhO,OAAM,SAAEyP,GAEzD,QADIqC,EAAe,GACV7f,EAAI,EAAGA,EAAIqB,EAAKwa,WAAW1b,OAAQH,IAC1C,GAAIqB,EAAKwa,WAAW7b,GAAGmL,KAAOqS,EAAOrS,GAAI,CACvC0U,EAAexe,EAAKwa,WAAW7b,GAAGie,OAAO4B,aAAa1U,GACtD,MAGJ,OAAI6hB,EAAiB7S,SAAS0F,KAG5BqN,EAAwB/sB,QAAUX,KAAKuc,gBAAgB5b,SACzDX,KAAKuc,gBAAkBmR,GAG3B1tB,KAAKqc,WAAWja,QAAO,SAAE4b,GACvBA,EAAOxU,UAAW,EAClB,IAAK,IAAIhJ,EAAI,EAAGA,EAAIqB,EAAK0a,gBAAgB5b,OAAQH,IAC3CqB,EAAK0a,gBAAgB/b,GAAGmL,KAAOqS,EAAOrS,KAAIqS,EAAOxU,UAAW,KAGpExJ,KAAKqJ,IAAI,mBAAmB9F,OAAOvD,KAAKgsB,iBAAiB,SAI7DvB,EAAAvqB,UAAA+sB,eAAA,WAAA,IAAAprB,EAAA7B,KACM2tB,EAAW,GACf3tB,KAAKuc,gBAAgBna,QAAO,SAAEwrB,GAE5B,QADI1gB,EAAQ,GACH1M,EAAI,EAAGA,EAAIqB,EAAKwa,WAAW1b,OAAQH,IAC1C,GAAIqB,EAAKwa,WAAW7b,GAAGmL,KAAOiiB,EAAQjiB,GAAI,CACxCuB,EAAQrL,EAAKwa,WAAW7b,GAAGie,OAAOvR,MAClCygB,EAASnsB,KAAK,CACZ0L,MAAKA,EAAES,KAAM,gBACbjE,QAASkkB,EAAQjiB,GACjBwC,QAAS,OAAStM,EAAKwa,WAAW7b,GAAGie,OAAO4B,aAAa1U,KAE3D,SAIN3L,KAAKqJ,IAAI,6BAA6B9F,OAAOoqB,IAG/ClD,EAAAvqB,UAAA2tB,aAAA,SAAankB,GACX,GAAKA,EAAL,KACMgX,EAAWhX,EAOjB,OANI1J,KAAK0c,cACP1c,KAAK0c,aAAamF,UAAU,KAAKC,KAAI,SAACviB,GAChCA,EAAEoM,KAAO+U,IAAUnhB,EAAE2f,cAAe,KAG5Clf,KAAKuc,gBAAkBvc,KAAKuc,gBAAgBhO,OAAM,SAAEhP,GAAM,OAAAA,EAAEoM,KAAOjC,IAC5D1J,KAAK+rB,kBAGdtB,EAAAvqB,UAAA4tB,aAAA,SAAarsB,GACXzB,KAAK4qB,qBAAqBtpB,KAAKG,IAGzBgpB,EAAAvqB,UAAA6tB,yBAAR,WAAA,IAAAlsB,EAAA7B,KACQua,EAAK3P,SAASqS,eAAe,uBACjC+Q,EAAU5L,EAAAA,UAAUxX,SAASqS,eAAe,uBAAwB,UAGtE6D,WAAU,WACRjf,EAAKosB,wBAAwB1T,IAC5B,KAGHyT,EAAQnoB,KACNqoB,EAAAA,aAAa,KACbjmB,UAAS,SAAEa,OAAE0D,EAAA1D,EAAA0D,OACb3K,EAAKosB,wBAAwBzhB,MAIzBie,EAAAvqB,UAAA+tB,wBAAR,SAAgCnlB,OAAEqlB,EAAArlB,EAAAqlB,UAAWC,EAAAtlB,EAAAslB,aAAcC,EAAAvlB,EAAAulB,aACzDruB,KAAK+qB,oBAAsBqD,EAAgBD,EAAYE,GAGjD5D,EAAAvqB,UAAAirB,2BAAR,WAAA,IAAAtpB,EAAA7B,KACEA,KAAKqJ,IAAI,wBAAwB2gB,cAAc,CAAEpoB,OAAQ5B,KAAK+I,cAAchH,IAAI,iBAChF/B,KAAK4qB,qBAAqB/kB,KACxBqoB,EAAAA,aAAa,MACbjmB,UAAS,SAACxG,GACNA,EACFI,EAAK6nB,cAAczkB,SAAS,eAAgB,CAC1CkC,QAAO,SAAGzF,GAAU,OAAA4F,QAAQ5F,MAAMA,IAClC0D,OAAQ,CACNuM,MAAOlQ,EACPiqB,gBAAiB,CAAEjZ,OAAQ,EAAGE,MAAO9Q,EAAKkH,cAAchH,IAAI,eAAe,qBAE5EkG,UAAS,SAAElC,GACZlE,EAAKwH,IAAI,wBAAwB9F,OAAOwC,GACnClE,EAAK8oB,yBAAyB9oB,EAAKysB,+BAG1CzsB,EAAKysB,gCAKH7D,EAAAvqB,UAAAouB,2BAAR,WAAA,IAAAzsB,EAAA7B,KACE,IAAKA,KAAKuuB,oBAAqB,KACvB5W,EAAW/M,SAASqS,eAAe,yCACzCtF,EAAS6W,MAAMvN,QAAU,QACzBjhB,KAAKuuB,oBAAsBvuB,KAAKkK,MAAM,qCAAsC,CAC1EgX,QAASvJ,EACT9J,QAAS,SACTuT,aAAa,EACbC,OAAO,EACPmC,MAAM,EACNC,SAAU,SACVnC,MAAO,eACPC,UAAW,eACXC,SAAU,OACVkC,SAAQ,WAAQ,OAAA7hB,EAAK8oB,yBAA0B,KAC9C,GAED3qB,KAAK2qB,wBACP3qB,KAAKuuB,oBAAoB3N,OAEzB5gB,KAAKuuB,oBAAoB9M,OAE3BzhB,KAAK2qB,yBAA2B3qB,KAAK2qB,yBAEzCF,GA3aoCrgB,EAAAA,kBCCpC,mBAAA,SAAAqkB,IAAA,IAAA5sB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YACU6B,EAAA+R,WAA2B,IAAIxK,EAAAA,UAqIzC,OAtIoCP,EAAAA,EAAAA,GAK3B4lB,EAAAvuB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,sBACHnC,EAAK2G,WAAWT,OAAO2B,GACvB7H,EAAK6sB,cACL7sB,EAAKkH,cAAgBW,EAAQX,cAC7B,MACF,IAAK,yBACHlH,EAAK+R,WAAWtS,UAOtBtB,KAAK6nB,aAAa5f,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,iBACHnC,EAAK2G,WAAWslB,aAAapkB,EAAQjI,OACrC,MACF,IAAK,+BACHI,EAAK2G,WAAW8kB,uBAAuB5jB,GACvC,MACF,IAAK,gCACH,GAAIA,EAAQjI,MAAO,KACb2D,EAAS,CACXuM,MAAOjI,EAAQjI,MACfktB,gBAAiBjlB,EAAQkE,aAAalI,QAAQ,UAAW,IACzDgmB,gBAAiB,CAEfjZ,OAAQ,EAAGE,MAAO9Q,EAAKkH,cAAchH,IAAI,eAAe,mBAG5DF,EAAK2G,WAAW4iB,aAAa,eAAgBhmB,GAAQ6C,UAAS,SAAClC,GAC7DlE,EAAKkV,UAAU,wBAAyB,CAAEhL,QAASrC,EAAS3D,SAAQA,IACpElE,EAAK2G,WAAWyiB,gBACd,0BACA,CAAEjpB,IAAK0H,EAAQjI,MAAOsE,SAAQA,GAC9B,CAAEnE,OAAQC,EAAKkH,kBAIrB,MACF,IAAK,+BACHlH,EAAK2G,WAAW4kB,uBAAuB1jB,GACvC,MACF,IAAK,6CACH7H,EAAK2G,WAAWkZ,qBAAqB,QAAShY,GAC9C,MACF,IAAK,4CACH,IAAKA,IAAYA,EAAQ6W,SAAU,OACnC1e,EAAKuS,WAAW,WAAY,CAC1BzK,QAAS,SACTC,KAAM,CAAC,aAAaF,EAAQ6W,SAAQ,eAEtC,MACF,IAAK,8CACH7W,EAAQgT,aAAe7a,EAAK2G,WAAWkU,aACvC7a,EAAKkV,UAAU,8BAA+BrN,GAC9C,MACF,IAAK,wBACoB,WAAnBA,EAAQyD,OACNzD,EAAQsU,SACVnc,EAAK2G,WAAWukB,mBAAmBrjB,GAC/B7H,EAAK2G,WAAWuZ,iBAAiBrY,EAAQsU,SAC3Cnc,EAAK2G,WAAWujB,gBAAgB9jB,UAAS,SAAElC,GACrCA,IAEFlE,EAAKkV,UAAU,uBAAwBlV,EAAK2G,WAAWwjB,iBAAiBjmB,IACxElE,EAAK2G,WAAWqkB,cAAc9mB,OAKV,UAAnB2D,EAAQyD,SACjBtL,EAAK2G,WAAWukB,mBAAmBrjB,GACnC7H,EAAK2G,WAAWsjB,mBAAmB,CACjCtJ,cAAe9Y,EAAQ8Y,cACvBxE,OAAQtU,EAAQsU,SACf/V,UAAS,SAAElC,GACRA,IACFlE,EAAKkV,UAAU,uBAAwBlV,EAAK2G,WAAWwjB,iBAAiBjmB,IACxElE,EAAK2G,WAAWqkB,cAAc9mB,OAIpC,MACF,IAAK,kCACHlE,EAAK2G,WAAWukB,mBAAmBrjB,GACnC7H,EAAK2G,WAAWwkB,iBACV4B,EAAa/sB,EAAK2G,WACxBsY,WAAU,WACR8N,EAAW5D,gBAAiB,GAC3B,KACH,MAKF,IAAK,kCACHnpB,EAAK2G,WAAWqlB,aAAankB,GAASzB,UAAS,SAAElC,GAC/ClE,EAAKkV,UAAU,uBAAwBlV,EAAK2G,WAAWwjB,iBAAiBjmB,IACxElE,EAAK2G,WAAWqkB,cAAc9mB,GAC9BlE,EAAK2G,WAAWykB,uBASlBwB,EAAAvuB,UAAAwuB,YAAR,WAAA,IAAA7sB,EAAA7B,KACEA,KAAKwI,WAAW6iB,uBAAuBpjB,UAAS,SAAElC,GAChD,GAAIA,IACFlE,EAAK2G,WAAW8iB,oBAAoBvlB,GAC/BlE,EAAK2G,WAAWmhB,gBAAiB,KAChCnH,EAAgB,CAClB7C,eAAc,SAAGsM,GAAe,OAAApqB,EAAK2G,WAAWkU,aAAeuP,GAC/D9e,OAAQpH,EACRsL,OAAO,EACPW,UAAWnQ,EAAK2G,WAAWwJ,WAE7BnQ,EAAKkV,UAAU,uBAAwByL,OAKjDiM,GAtIoCza,EAAAA,cCApC,IAAa6a,GAAqB,CAChChnB,SAAU,iBACVH,QAAS,CAAC,CACRiE,GAAI,WACH,CACDA,GAAI,2BACH,CACDA,GAAI,mBACH,CACDA,GAAI,0BACH,CACDA,GAAI,6BACH,CACDA,GAAI,wBACH,CACDA,GAAI,qBACH,CACDA,GAAI,4BAENlD,SAAUgiB,GACV/hB,SAAU+lB,GACVnmB,mBAAoB6O,GACpB5O,qBAAsB6O,GACtBjS,QAAS,mBCbT,SAAA2pB,EACExX,EACQrO,EACAF,EACA2gB,EACA1gB,GALV,IAAAnH,EAOE8R,EAAA/S,KAAAZ,KAAMsX,EAAqBvV,IAAI,uBAAyBH,KAAO5B,YALvD6B,EAAAoH,OAAAA,EACApH,EAAAkH,cAAAA,EACAlH,EAAA6nB,cAAAA,EACA7nB,EAAAmH,UAAAA,IAuBZ,OA7B2CH,EAAAA,EAAAA,GAW/BimB,EAAA5uB,UAAA4H,YAAV,WACE,MAAO,CACLiB,cAAe/I,KAAK+I,cACpBC,UAAWhJ,KAAKgJ,UAChBC,OAAQjJ,KAAKiJ,OACbygB,cAAe1pB,KAAK0pB,cACpBvkB,QAASnF,KAAK4B,OAAOuD,SAAW,GAChC+E,MAAOA,IAIX4kB,EAAA5uB,UAAAqX,SAAA,WACEvX,KAAK+H,UAGP+mB,EAAA5uB,UAAAsX,YAAA,WACExX,KAAK2I,iCA/BR8O,EAAAA,UAASnV,KAAA,CAAC,CACPoV,SAAU,iBACVC,SAAA,swLARKlV,SAHAmV,EAAAA,cAEAjW,SAIAoF,SAFApE,KAsCTmsB,GA7B2CrnB,sBCZ3C,SAAAsnB,IAAA,IAAAltB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YAUU6B,EAAAwa,WAAoB,KACrBxa,EAAA0a,gBAAyB,KA8NlC,OAzOsC1T,EAAAA,EAAAA,GA+BpCkmB,EAAA7uB,UAAA6H,OAAA,SAAOe,OAACC,EAAAD,EAAAC,cAAeC,EAAAF,EAAAE,UAAWC,EAAAH,EAAAG,OAAQ9D,EAAA2D,EAAA3D,QAAS+D,EAAAJ,EAAAI,aAAcwgB,EAAA5gB,EAAA4gB,cAC/D1pB,KAAK+I,cAAgBA,EACrB/I,KAAKgJ,UAAYA,EACjBhJ,KAAKiJ,OAASA,EACdjJ,KAAKkJ,aAAeA,EACpBlJ,KAAK0pB,cAAgBA,EACrB1pB,KAAKmF,QAAUA,EACfnF,KAAKgvB,kBAAmB,EACxBhvB,KAAKivB,wBAA0BjvB,KAAK+I,cAAchH,IAAI,iBAAiB,gBAAuB,MAC9F/B,KAAKkvB,yBAA2BlvB,KAAK+I,cAAchH,IAAI,iBAAiB,iBAAwB,MAChG/B,KAAKmvB,qBAAuBnvB,KAAK+I,cAAchH,IAAI,iBAA2B,SAAS,MACvF/B,KAAKovB,iBAAkB,EACvBpvB,KAAK2pB,iBAAiB3pB,KAAK+I,cAAchH,IAAI,qBAAsB/B,KAAK+I,cAAchH,IAAI,oBAAiC,YAE3H/B,KAAKgJ,UAAUzF,OAAO,YAAa,4BACnCvD,KAAKgJ,UAAUzF,OAAO,YAAa,kCACnCvD,KAAKgJ,UAAUtF,aAAa,aAAc,kBAG5CqrB,EAAA7uB,UAAA0pB,cAAA,SAAeje,GACb,OAAO3L,KAAK0pB,cAAczkB,SAAS,UAAW,CAC5CkC,QAAO,SAAGzF,GAAU,OAAA4F,QAAQ5F,MAAMA,IAClC0D,OAAQ,CAAEiqB,OAAQ1jB,MAItBojB,EAAA7uB,UAAAovB,iBAAA,SAAkBtpB,OACZqP,EAAS,CACXiP,SAAU,oBACVjW,KAAOrI,EAAY,MACnB6P,UAAW,qBACX1H,QAAS,cACTzE,QAAS,UAEX1J,KAAKqJ,IAAI,qBAAqB9F,OAAO8R,IAGvC0Z,EAAA7uB,UAAA2pB,SAAA,SAAUle,GACR,GAAKA,EAAK,KACF4jB,EAAkBvvB,KAAK+I,cAAchH,IAAI,iBAAiB,iBAAiB,qBACjF,OAAQ/B,KAAK0pB,cAAczkB,SAAS,iBAAkB,CACpDkC,QAAO,SAAGzF,GAAU,OAAA4F,QAAQ5F,MAAMA,IAClC0D,OAAQ,CAAEoqB,OAAQ7jB,EAAI4jB,gBAAiBA,KAIzCvvB,KAAKgD,UAAY,oBACjBhD,KAAKyvB,aAAe,CAClB,CACEzrB,KAAM,OACN0W,MAAO,oBACPwG,QAAS,k6BAEX,CACEld,KAAM,OACN0W,MAAO,iBACPwG,QAAS,m6BAQflhB,KAAKqJ,IAAI,yBAAyB9F,OAHf,CACjB+F,MAAO,MAKXylB,EAAA7uB,UAAA6pB,YAAA,SAAYhkB,GAAZ,IAAAlE,EAAA7B,KACI,GAAG+F,EAAS,CACVuB,QAAQqS,IAAK,qBACbrS,QAAQqS,IAAI5T,GACZ/F,KAAKyvB,aAAe,OAChBvO,EAAU,GAcd,GAXFlhB,KAAKqJ,IAAI,mBAAmB2gB,cAAc,CACxC1d,QAAS,SACT4T,WAAYlgB,KAAK+I,cAAchH,IAAI,eACnCyb,kBAAmB,uBACnBN,YAAa,2BAGRnX,EAASsI,OACZ6S,EAAiB,QAAInb,EAASsI,MAEhCrO,KAAKyvB,aAAajuB,KAAK0f,GAClBnb,EAASyU,MAAQ,KACdkV,EAAU,CAAC,CAAC1rB,KAAM,QAAS2rB,IAAK5pB,EAASyU,MAAOoV,cAAc,IAC/D5vB,KAAK6vB,mBASR7vB,KAAK6vB,mBAAmBvM,KAAKoM,GAR7B1vB,KAAKqJ,IAAI,mBAAmB9F,OAAO,CACjCusB,SAAU,uBACVC,WAAU,SAAIC,GACZnuB,EAAKguB,mBAAqBG,EAC1BA,EAAO1M,KAAKoM,UAQhBO,EAAW,CACbtiB,KAAM5H,EAAS0K,KAAK9C,KACpB+M,MAAO,CACLwV,KAAM,CACJ7hB,KAAMtI,EAAS2U,MACfvM,QAAS,SAGbgiB,MAAOpqB,EAASqqB,SAChB9U,QAAS,IAGXtb,KAAKqJ,IAAI,yBAAyB9F,OAAO0sB,OAGrCI,EAAQ,CAAEza,MAAO,IAErB5V,KAAKswB,YAAiC,MAAnBvqB,EAAS6J,OACtB5P,KAAKswB,aACTvqB,EAAS6J,OAAOxN,QAAO,SAAC8Q,OAClB5J,EAAQ,GACZ4J,EAAMtD,OAAOxN,QAAO,SAACqO,GACnBnH,EAAM9H,KAAM,CAAE0L,MAAOuD,EAAKzO,IAAKP,MAAOgP,EAAKhP,UAG7C4uB,EAAMza,MAAMpU,KACV,CACEkZ,MAAOxH,EAAMhG,MACb5D,MAAOA,MAKjBtJ,KAAKqJ,IAAI,sBAAsB9F,OAAO8sB,OAGhCE,EAAc,CAChBjnB,MAAO,IAGTvD,EAAS7C,YAAYd,QAAO,SAACouB,GAC3BD,EAAYjnB,MAAM9H,KAAK,CACrB0L,MAAOsjB,EAAQtjB,MACfxD,QAAS8mB,EAAQ3hB,SAGrB7O,KAAKqJ,IAAI,yBAAyB9F,OAAOgtB,GAYtCxqB,EAASuD,OACZtJ,KAAKovB,iBAAkB,EACvBpvB,KAAKqJ,IAAI,qBAAqB2gB,cAAc,CAAE1d,QAAS,SAAU1K,OAAQ5B,KAAK+I,gBAC9E/I,KAAKqJ,IAAI,qBAAqB9F,OAAOwC,KAErC/F,KAAKovB,iBAAkB,EACvBpvB,KAAKqJ,IAAI,qBAAqB9F,OAAO,QAI3CwrB,EAAA7uB,UAAAuwB,gBAAA,WACEzwB,KAAKgvB,kBAAoBhvB,KAAKgvB,kBAGhCD,EAAA7uB,UAAA2f,6BAAA,SAA8B9Z,EAAesL,GAC3C,GAAMtL,GAAaA,EAASqa,kBAA5B,CACApgB,KAAKqc,WAAa,GAElB,IAAM,IAAI7b,EAAI,EAAGA,EAAIuF,EAASqa,kBAAkBzf,OAAQH,IAAK,KAErD0K,EAAQlL,KAAK+I,cAAchH,IAAI,eAAegE,EAASqa,kBAAkB5f,GAAGie,OAAO4B,aAAapV,WAAajL,KAAK+I,cAAchH,IAAI,eAAegE,EAASqa,kBAAkB5f,GAAGie,OAAO4B,aAAapV,WAAkB,MAAO,IAAI,GAExOjL,KAAKqc,WAAW7a,KAAIpB,EAAA,CAEhBuL,GAAI3L,KAAKsgB,0BAA2Bva,EAASqa,kBAAkB5f,GAAGie,OAAO9S,KACtE5F,EAASqa,kBAAkB5f,GAAE,CAChC0K,MAAOA,KAGblL,KAAKqJ,IAAI,0BAA0B9F,OAAO,CACxC2Z,YAAa,yBACbE,MAAOiF,OAAOqO,WAAa,IAC3B5T,QAAS9c,KAAKqc,WACdhL,MAASA,IAAgB,MAIrB0d,EAAA7uB,UAAAogB,0BAAR,SAAmCC,GACjC,OAAKA,EACI,KAAOA,EAAS7a,QAAQ,KAAM,KADhB,MAK3BqpB,GAzOsC3kB,EAAAA,qCCGtC,SAAAumB,IAAA,IAAA9uB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YACU6B,EAAA+R,WAA2B,IAAIxK,EAAAA,UA8EzC,OA/EsCP,EAAAA,EAAAA,GAK7B8nB,EAAAzwB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,wBACHnC,EAAK2G,WAAWT,OAAO2B,GACvB7H,EAAKkH,cAAgBW,EAAQX,cAC7BlH,EAAKsH,MAAQO,EAAQP,UACjBynB,EAAU/uB,EAAKsH,MAAM+gB,SAAS9kB,OAAOuG,IAAM,GAC/C9J,EAAKsoB,cACLtoB,EAAKuoB,eAAewG,GACpB,MAEF,IAAK,2BACH/uB,EAAK+R,WAAWtS,UAQtBtB,KAAK6nB,aAAa5f,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,gBACE0F,GACH7H,EAAKuS,WAAW,WAAY,CAACxK,KAAM,CAAC/H,EAAKkH,cAAchH,IAAI,SAAS8uB,eAAiBnnB,GAAUC,QAAS,WAE1G,MACF,IAAK,0BAA2B9H,EAAK2G,WAAWioB,kBAChD,MACA,IAAK,4CACH,IAAI/mB,IAAYA,EAAQ6W,SAAU,OAClC1e,EAAKuS,WAAW,WAAY,CAC1BzK,QAAS,SACTC,KAAM,CAAC,aAAaF,EAAQ6W,SAAQ,mBAQtCoQ,EAAAzwB,UAAAiqB,YAAR,WAAA,IAAAtoB,EAAA7B,KACEA,KAAKmJ,MAAMmhB,SAASriB,UAAS,SAAC7C,GACxBA,EAAOrD,IAAI,MACdF,EAAK2G,WAAWqhB,SAASzkB,EAAOrD,IAAI,OAAOkG,UAAS,SAAElC,GACpD,GAAKA,IACHlE,EAAK2G,WAAWuhB,YAAYhkB,GACvBA,EAASqa,mBAAmB,CAC/Bve,EAAK2G,WAAWsoB,YAAa,MACzB1Q,EAAoB,CAACjT,OAAQpH,EAAUqa,kBAAmBra,EAASqa,mBACnEve,EAAK2G,WAAWmhB,gBAClB9nB,EAAKkV,UAAU,uBAAwBqJ,MAM9Cve,EAAK2G,WAAWqhB,cAKd8G,EAAAzwB,UAAAkqB,eAAR,SAAwB7V,GAAxB,IAAA1S,EAAA7B,KACEA,KAAKwI,WAAWohB,cAAc,cAAc3hB,UAAS,SAAElC,GACjDA,IACFlE,EAAK2G,WAAW8mB,iBAAiBvpB,GACjClE,EAAKkV,UAAU,qBAAsBhR,IAElCwO,GACH1S,EAAKkV,UAAU,aAAcxC,MAIrCoc,GA/EsC3c,EAAAA,cCAtC,IAAa+c,GAA2B,CACtClpB,SAAU,mBAKVH,QAAS,CACN,CAAEiE,GAAI,qBACN,CAAEA,GAAI,WACN,CAAEA,GAAI,yBACN,CAAEA,GAAI,sBACN,CAAEA,GAAI,mBACN,CAAEA,GAAI,yBACN,CAAEA,GAAI,mBACN,CAAEA,GAAI,sBAETlD,SAAUsmB,GACVrmB,SAAUioB,GACVroB,mBAAoB6O,GACpB5O,qBAAsB6O,GACtBjS,QAAS,mBCTT,SAAA6rB,EACU/nB,EACAE,EACAJ,EACAuO,EACAtO,EACAE,EACAwgB,GAPV,IAAA7nB,EAUE8R,EAAA/S,KAAAZ,KAAMsX,EAAqBvV,IAAI,6BAA+BH,KAAO5B,YAT7D6B,EAAAoH,OAAAA,EACApH,EAAAsH,MAAAA,EACAtH,EAAAkH,cAAAA,EACAlH,EAAAyV,qBAAAA,EACAzV,EAAAmH,UAAAA,EACAnH,EAAAqH,aAAAA,EACArH,EAAA6nB,cAAAA,IA8BZ,OAtC6C7gB,EAAAA,EAAAA,GAmBjCmoB,EAAA9wB,UAAA4H,YAAV,WACE,MAAO,CACLiB,cAAe/I,KAAK+I,cACpBC,UAAWhJ,KAAKgJ,UAChBC,OAAQjJ,KAAKiJ,OACbE,MAAOnJ,KAAKmJ,MACZD,aAAclJ,KAAKkJ,aACnBwgB,cAAe1pB,KAAK0pB,cACpBvkB,QAASnF,KAAK4B,OAAOuD,SAAW,KAIpC6rB,EAAA9wB,UAAAqX,SAAA,WACEvX,KAAK+H,UAGPipB,EAAA9wB,UAAAsX,YAAA,WACExX,KAAK2I,iCAzCR8O,EAAAA,UAASnV,KAAA,CAAC,CACToV,SAAU,mBACVC,SAAA,2rHAXOC,EAAAA,cAAQC,EAAAA,sBAGRlW,SACAc,SACAE,SAJAmV,EAAAA,aAMA/Q,KA6CTiqB,GAtC6CvpB,sBCb7C,SAAAwpB,mDAIA,OAJqCpoB,EAAAA,EAAAA,GACnCooB,EAAA/wB,UAAA6H,OAAA,SAAO2B,KAGTunB,GAJqC7mB,EAAAA,iCCArC,SAAA8mB,mDAYA,OAZqCroB,EAAAA,EAAAA,GAE5BqoB,EAAAhxB,UAAA2T,OAAP,aAUFqd,GAZqCld,EAAAA,cCGxBmd,GAAsB,CACjCtpB,SAAU,kBACVH,QAAS,GACTe,SAAUwoB,GACVvoB,SAAUwoB,GACV5oB,mBAAoB6O,GACpB5O,qBAAsB6O,GACtB6R,cAAe,mBCHf,SAAAmI,WAEEzd,EAAA/S,KAAAZ,KAAM4B,KAAO5B,KAWjB,OAd4C6I,EAAAA,EAAAA,GAM1CuoB,EAAAlxB,UAAAqX,SAAA,WACEvX,KAAK+H,UAGPqpB,EAAAlxB,UAAAsX,YAAA,WACExX,KAAK2I,iCAfR8O,EAAAA,UAASnV,KAAA,CAAC,CACToV,SAAU,kBACVC,SAAA,0GAgBFyZ,GAd4C3pB,GCR5C4pB,GAAe,CACbngB,WAAY,EACZH,OAAQ,CAAC,CACPpF,GAAI,QACJ3H,KAAM,SACL,CACD2H,GAAI,YACJ3H,KAAM,QACNgC,KAAM,CAAC,CACLvE,MAAO,IACPyL,MAAO,uCAER,CACDvB,GAAI,cACJ3H,KAAM,QACNgC,KAAM,IACL,CACD2F,GAAI,eACJ3H,KAAM,QACN6O,SAAU,KACVF,MAAO,GACPN,MAAO,QACPrM,KAAM,IACL,CACD2F,GAAI,gBACJ3H,KAAM,SACL,CACD2H,GAAI,eACJ3H,KAAM,QACN8O,SAAU,CAAC,QAAS,eACpB9M,KAAM,IACL,CACD2F,GAAI,YACJ3H,KAAM,QACNgC,KAAM,IACL,CACD2F,GAAI,UACJ3H,KAAM,QACNgC,KAAM,KAER4J,OAAQ,CAAC,CACPkC,OAAQ,CAAC,CACP9N,KAAM,OACN+H,QAAS,QACT2B,YAAa,WAEbrB,aAAc,CACZilB,MAAO,IACPC,SAAU,EACV7kB,SAAU,CAAC,CACT1K,IAAK,eACL6Q,SAAU,WAGb,CACD7O,KAAM,WACN+H,QAAS,YACTM,aAAc,CACZK,SAAU,CAAC,CACT1K,IAAK,YACL6Q,SAAU,QAGb,CACD7O,KAAM,OACN+H,QAAS,cACTM,aAAc,CACZpG,SAAS,EACTyG,SAAU,CAAC,CACT1K,IAAK,oBACL6Q,SAAU,UAIf,CACDwC,OAAQ,CACNnI,MAAO,gBACPiB,QAAS,iBAEX2D,OAAQ,CAAC,CACP9N,KAAM,WACN+H,QAAS,eACTM,aAAc,CACZpG,SAAS,EACTqG,QAAS,WACTE,OAAQ,eACRE,SAAU,CAAC,CACT1K,IAAK,cACL6Q,SAAU,QAGb,CACD7O,KAAM,OACN+H,QAAS,gBACT2B,YAAa,eAEbrB,aAAc,CACZilB,MAAO,IACPC,SAAU,EACVjlB,QAAS,WACTE,OAAQ,eACRE,SAAU,CAAC,CACT1K,IAAK,QACL6Q,SAAU,WAGb,CACD7O,KAAM,OACN+H,QAAS,eACTM,aAAc,CACZsG,MAAO,GACPjG,SAAU,CAAC,CACT1K,IAAK,YACL6Q,SAAU,UAIf,CACDwC,OAAQ,CACNnI,MAAO,OACPiB,QAAS,cAEX2D,OAAQ,CAAC,CACP9N,KAAM,SACN+H,QAAS,YACTmB,MAAO,MACPb,aAAc,CACZK,SAAU,CAAC,CACT1K,IAAK,mBACL6Q,SAAU,SAGb,CACD7O,KAAM,SACN+H,QAAS,UACTmB,MAAO,KACPb,aAAc,CACZK,SAAU,CAAC,CACT1K,IAAK,iBACL6Q,SAAU,YAKlB9C,QAAS,CACPsC,MAAO,CACLrO,KAAM,QACNhC,IAAK,SACLuQ,UAAW,QAEb3C,OAAQ,CACN8K,MAAO,CACL8W,WAAW,EACX7e,MAAO,KAGXrJ,MAAO,IAETiI,KAAM,CAAEkB,OAAQ,EAAGE,MAAO,KCnItB8e,GAAS,SAAI9lB,EAAIoF,GACrB,OAAOA,EAAOxC,OAAM,SAACkW,GAAK,OAAAA,EAAE9Y,KAAOA,IAAI,IAGnC+lB,GAAkB,SAAIxR,GAC1B,OAAO1gB,OAAO2C,KAAK+d,GAAYpa,IAAG,SAAC9D,OAC3BJ,EAASse,EAAWle,GAC1B,MAAO,CACLP,MAAOO,EACPkL,MAAOtL,EAAOsL,MACde,QAASsN,KAAKC,MAAsB,IAAhBD,KAAKoW,UAGzBxsB,QAAS,CACPwI,KAAM/L,EAAO+L,KACbQ,QAAS,SAASnM,OAMpB4vB,GAAmB,SAAI1R,GAC3B,OAAO1gB,OAAO2C,KAAK+d,GAAYpa,IAAG,SAAC9D,GAEjC,MAAO,CACLP,MAAOO,EACPkL,MAHagT,EAAWle,GAGVkL,UAKd2kB,GAAgB,WACpB,MAAO,CAAC,OAAQ,OAAQ,OAAQ,QAAQ/rB,IAAG,SAAC9D,GAC1C,MAAO,CACLP,MAAOO,EACPkL,MAAOlL,MAKP8vB,GAAc,WAClB,MAAO,CAAC,OAAQ,OAAQ,OAAQ,QAAQhsB,IAAG,SAAC9D,GAC1C,MAAO,CACLP,MAAOO,EACPkL,MAAOlL,MAKP+vB,GAAmB,eACjBC,EAAQ,CAAC,SAAU,SAAU,WAAY,SAAU,UAGzD,MAFc,CAAC,SAAU,OAAQ,SAAU,gBAAiB,oBAE/ClsB,IAAG,SAAE9D,EAAKgL,OACfE,EAAQlL,EAAI0D,QAAQ,IAAK,KAC/B,MAAO,CACLjE,MAAOO,EACPkL,MAAOA,EACPe,QAASsN,KAAKC,MAAsB,IAAhBD,KAAKoW,UACzB7e,SAAU,CACR4H,MAAOxN,EACP+kB,cAAeD,EAAMhlB,QCjFvBklB,GAAkB,mBAExBC,GAAA,SAAAxe,GAAA,SAAAwe,IAAA,IAAAtwB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YAUS6B,EAAAiY,YAAmB,EACnBjY,EAAAsY,SAAmB,GAInBtY,EAAAuwB,aAAuB,aACvBvwB,EAAAwwB,eAAsB,CAAC,CAC5B5wB,MAAO,YACPyL,MAAO,4BACN,CACDzL,MAAO,WACPyL,MAAO,4BA0DFrL,EAAAywB,iBAAgB,WAAS,OAAAJ,MAmElC,OAlJsCrpB,EAAAA,EAAAA,GAoCpCspB,EAAAjyB,UAAA6H,OAAA,SAAOe,GAAP,IAAAjH,EAAA7B,KAAQ+I,EAAAD,EAAAC,cAAeC,EAAAF,EAAAE,UAAW7D,EAAA2D,EAAA3D,QAASukB,EAAA5gB,EAAA4gB,cAAehlB,EAAAoE,EAAApE,OACxD1E,KAAK+I,cAAgBA,EACrB/I,KAAKgJ,UAAYA,EACjBhJ,KAAK0pB,cAAgBA,EACrB1pB,KAAK0E,OAASA,EACd1E,KAAKmF,QAAUA,EAEfnF,KAAKgD,UAAYhD,KAAK+I,cAAchH,IAAI,iBAAiB2Y,MAErD1a,KAAK0E,OAAO+O,MAAMye,KAAkBlyB,KAAK0E,OAAO8O,IAAI0e,GAAiBb,IACzErxB,KAAK+U,YAAc/U,KAAK0E,OAAO+O,MAAMye,IAErClyB,KAAKuyB,mBAAmBtqB,UAAS,WAC/BpG,EAAKwH,IAAI,kBAAkB9F,OAAO,CAAEwR,YAAalT,EAAKkT,iBAI1Dod,EAAAjyB,UAAAsyB,gBAAA,SAAgB9oB,GACR,IAAAZ,EAAAhI,EAAA4I,EAAA4E,MAAA,KAAA,GAAC8D,EAAAtJ,EAAA,GAASyJ,EAAAzJ,EAAA,GAEhB9I,KAAK+U,YAAY5C,uBAAuBC,GACxCpS,KAAK+U,YAAYzC,yBAAyBC,IAG5C4f,EAAAjyB,UAAAuyB,mBAAA,SAAmB/oB,OACX6H,EAAO7H,EAAQhE,QAAQ,QAAS,IACtC,OAAO1F,KAAK0yB,kBAAkBnhB,IAGhC4gB,EAAAjyB,UAAAyyB,uBAAA,SAAuBjpB,OACf6H,EAAO7H,EAAQhE,QAAQ,QAAS,IACtC1F,KAAK0yB,kBAAkBnhB,IAGzB4gB,EAAAjyB,UAAA0yB,qBAAA,SAAqBlpB,GACnB1J,KAAKma,SAAWzQ,EAChB1J,KAAK+U,YAAYrC,mBAAmBhJ,GAGpC1J,KAAK8Z,YAAc,EACnB9Z,KAAK+U,YAAYvC,oBAAoB,IAKhC2f,EAAAjyB,UAAAqyB,iBAAP,WAAA,IAAA1wB,EAAA7B,KAGQkgB,EAAalgB,KAAK+I,cAAchH,IAAI,eAWpC8U,EAAgB7W,KAAK+U,YAAYzD,mBAOvC,OAL4BtR,KAAK0pB,cAAczkB,SAAS,mBAAoB,CAC1EkC,QAAO,SAAEzF,GAAS,OAAA4F,QAAQ5F,MAAMA,IAChC0D,OAAQ,CAAEmb,SAAU,sBAGK1a,KACzBgtB,EAAAA,eDhHN,SAEgBztB,EAAQ8a,GACtB9a,EAAO8L,WAAaqK,KAAKC,MAAsB,IAAhBD,KAAKoW,UAEpCrqB,QAAQqS,IAAI,qCAAmCvU,GAEzC,IAAA2L,EAAA3L,EAAA2L,OAiBN,OAdA0gB,GAAU,cAAe1gB,GAAQ/K,KAAO0rB,GAAmBxR,GAG3DuR,GAAU,eAAgB1gB,GAAQ/K,KAAO4rB,GAAoB1R,GAG7DuR,GAAU,eAAgB1gB,GAAQ/K,KAAO+rB,KAGzCN,GAAU,YAAa1gB,GAAQ/K,KAAO6rB,KAGtCJ,GAAU,UAAW1gB,GAAQ/K,KAAO8rB,KAE7BvnB,EAAAA,GAAGnF,GCwFS0tB,CAAmBjc,EAAeqJ,IACjD1V,EAAAA,IAAG,SAAE1B,OAAA8J,EAAA9R,EAAAgI,EAAA,GAACiqB,EAAAngB,EAAA,GAAiBogB,EAAApgB,EAAA,GACrB/Q,EAAKqP,WAAa8hB,EAAe9hB,eAC7B+hB,EAAoB,EAErBpxB,EAAKqP,WAAa,EACnB+hB,EAAoB,EACQ,IAApBpxB,EAAKqP,aACb+hB,EAAoB,GAEtBpxB,EAAKqxB,aAAerxB,EAAKkH,cAAchH,IAAI,iBAAiBgO,QAAQkjB,GAEpEpxB,EAAKkT,YAAYjE,aAAakiB,EAAejiB,QAC7ClP,EAAKkT,YAAY9D,iBAAiB+hB,EAAe9hB,YAEjDrP,EAAKwH,IAAI,qBAAqB2gB,cAAc,CAC1C1d,QAAS,SACT1K,OAAQC,EAAKkH,cAGbwI,KAAM1P,EAAKiY,YACXI,KAAMrY,EAAKsY,WAGbtY,EAAKwH,IAAI,qBAAqB9F,OAAO,CAAE+F,MAAOypB,EAAgBzpB,YAK5D6oB,EAAAjyB,UAAAwyB,kBAAR,SAA0BnhB,GACxB,IAAIA,IAASvR,KAAK8Z,YAAa,OAAOvP,EAAAA,IAAG,GAEzCvK,KAAK8Z,aAAevI,MAIhBoB,EAFiB3S,KAAK+U,YAAYlJ,YACV0F,KACxBoB,MACFwgB,GAAanzB,KAAK8Z,YAAc,GAAKnH,EAIvC,OAFA3S,KAAK+U,YAAYvC,oBAAoB2gB,GAE9B5oB,EAAAA,IAAG,IAEd4nB,EAlJA,CAAsC/nB,EAAAA,qCCLtC,SAAAgpB,IAAA,IAAAvxB,EAAA,OAAA8R,GAAAA,EAAA9S,MAAAb,KAAAU,YAAAV,YACU6B,EAAAwxB,cAA8B,IAAIjqB,EAAAA,UA0D5C,OA3DsCP,EAAAA,EAAAA,GAG7BuqB,EAAAlzB,UAAA2T,OAAP,WAAA,IAAAhS,EAAA7B,KACEA,KAAK8T,aAAa7L,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,wBACHnC,EAAK2G,WAAWT,OAAO2B,GACvB7H,EAAKyxB,wBACL,MAEF,IAAK,iCACHzxB,EAAK2G,WAAWgqB,gBAAgB9oB,GAChC7H,EAAKwxB,cAAc/xB,UAQzBtB,KAAK6nB,aAAa5f,UAAS,SAAEa,OAAE9E,EAAA8E,EAAA9E,KAAM0F,EAAAZ,EAAAY,QACnC,OAAQ1F,GACN,IAAK,8BACHnC,EAAKwxB,cAAc/xB,OACnB,MAEF,IAAK,+BACHO,EAAK2G,WAAWiqB,mBAAmB/oB,GAASzB,UAAS,SAACsrB,GACjDA,GAAS1xB,EAAKwxB,cAAc/xB,SAEjC,MAEF,IAAK,2BACHO,EAAK2G,WAAWoqB,qBAAqBlpB,GACrC7H,EAAKwxB,cAAc/xB,OACnB,MAEF,IAAK,yBACDO,EAAK2G,WAAWmqB,uBAAuBjpB,GAASzB,UAAS,SAACsrB,GACrDA,GAAS1xB,EAAKwxB,cAAc/xB,aAUnC8xB,EAAAlzB,UAAAozB,sBAAR,WAAA,IAAAzxB,EAAA7B,KACEA,KAAKqzB,cAAcxtB,KACjBqoB,EAAAA,aAAa,MACbjmB,UAAS,WACTpG,EAAK2G,WAAW+pB,mBAAmBtqB,UAAS,WAC1CpG,EAAKuS,WAAW,iBAAkBvS,EAAK2G,WAAW8pB,yBAI1Dc,GA3DsCpf,EAAAA,cCGtC,IAAawf,GAAuB,CAClC3rB,SAAU,mBAKVH,QAAS,CACP,CAAEiE,GAAI,iBAAkBnD,WAAYwM,EAAiB9M,aAAcyO,GACnE,CAAEhL,GAAI,qBACN,CAAEA,GAAI,wBAAyBuL,eAAe,IAEhDzO,SAAU0pB,GACVzpB,SAAU0qB,GACV9qB,mBAAoB6O,GACpB5O,qBAAsB6O,GACtBjS,QAAS,mBCLT,SAAAsuB,EACU1qB,EACAuO,EACAtO,EACA0gB,EACAhlB,GALV,IAAA7C,EAQE8R,EAAA/S,KAAAZ,KAAMsX,EAAqBvV,IAAI,yBAA2BH,KAAO5B,YAPzD6B,EAAAkH,cAAAA,EACAlH,EAAAyV,qBAAAA,EACAzV,EAAAmH,UAAAA,EACAnH,EAAA6nB,cAAAA,EACA7nB,EAAA6C,OAAAA,IA4BZ,OAlC6CmE,EAAAA,EAAAA,GAiBjC4qB,EAAAvzB,UAAA4H,YAAV,WACE,MAAO,CACLiB,cAAe/I,KAAK+I,cACpBC,UAAWhJ,KAAKgJ,UAChB0gB,cAAe1pB,KAAK0pB,cACpBhlB,OAAQ1E,KAAK0E,OACbS,QAASnF,KAAK4B,OAAOuD,SAAW,KAIpCsuB,EAAAvzB,UAAAqX,SAAA,WACEvX,KAAK+H,UAGP0rB,EAAAvzB,UAAAsX,YAAA,WACExX,KAAK2I,iCArCR8O,EAAAA,UAASnV,KAAA,CAAC,CACToV,SAAU,mBACVC,SAAA,2yFAVAhW,SACAc,SACAE,SAEAoE,SADAuM,KA4CFmgB,GAlC6ChsB,qBCV7C,SAAAisB,KAaA,OAHEA,EAAAxzB,UAAAyzB,QAAA,SAAQ3vB,EAAM0F,GACZ1J,KAAKsY,KAAKtU,EAAM0F,wBAXnB+N,EAAAA,UAASnV,KAAA,CAAC,CACToV,SAAU,0BACVC,SAAA,stDAGCa,EAAAA,oBACAA,EAAAA,yBACAA,EAAAA,uBACAA,EAAAA,SAKHkb,SCJMjb,GAAa,CACjByQ,GACAsB,GACAsE,GACAkC,GACAI,GACAqC,GACAC,IAIFE,GAAA,WAAA,SAAAA,KAU6C,2BAV5C7a,EAAAA,SAAQzW,KAAA,CAAC,CACR0W,aAAcP,GACdQ,QAAS,CACPC,EAAAA,aACAE,EAAAA,sBACAV,IAEF5T,UAAW,GACXuU,QAASZ,OAEkCmb,EAV7C,GC1BAC,GAAA,WAKA,SAAAA,KAUsC,2BAVrC9a,EAAAA,SAAQzW,KAAA,CAAC,CACR2W,QAAS,CACPC,EAAAA,cAEFpU,UAAW,GACXuU,QAAS,CACPX,GACAkb,QAGkCC,EAftC","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { Injectable, Inject } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ConfigurationService {\n  private defaults: any = {};\n\n  constructor(@Inject('config') private config: any){\n    if(this.config.global){\n      Object.keys(this.config.global).forEach(key => {\n        this.set(key, this.config.global[key]);\n      });\n    }\n  }\n\n  public get = (key) => this.defaults[key];\n  public set = (key, value) => this.defaults[key] = value;\n}","import { Injectable, Inject } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LayoutsConfigurationService {\n  private defaults: any = {};\n\n  constructor(@Inject('config') private config: any){\n    if(this.config.layouts){\n      Object.keys(this.config.layouts).forEach(key => {\n        this.set(key, this.config.layouts[key]);\n      });\n    }\n  }\n\n  public get = (key) => this.defaults[key];\n  public set = (key, value) => this.defaults[key] = value;\n}","import { Injectable } from '@angular/core';\nimport { ReplaySubject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MainStateService {\n  // custom streams\n  private custom: any = {};\n  \n  // default streams\n  private default: {\n    headTitle: ReplaySubject<any>,\n    pageTitle: ReplaySubject<any>,\n    subnav: ReplaySubject<any>,\n    breadcrumbs: ReplaySubject<any>,\n    filters: ReplaySubject<any>,\n  } = {\n    headTitle: new ReplaySubject(),\n    pageTitle: new ReplaySubject(),\n    subnav: new ReplaySubject(),\n    breadcrumbs: new ReplaySubject(),\n    filters: new ReplaySubject(),\n  };\n\n  public get$ = (key: string) => this._get('default', key);\n  public getCustom$ = (key: string) => this._get('custom', key);\n\n  public update = (key: string, newValue: any) => this._update('default', key, newValue);\n  public updateCustom = (key: string, newValue: any) => this._update('custom', key, newValue);\n\n  public has = (key: string) => !!this.default[key];\n  public hasCustom = (key: string) => !!this.custom[key];\n\n  public addCustom(key: string, stream$: ReplaySubject<any>){\n    if(this.custom[key]) throw Error(`custom stream ${key} exists!`);\n\n    this.custom[key] = stream$;\n  }\n\n  private _update(type: string, key: string, newValue: any){\n    if(!this[type]) throw Error(`${type} stream group does not exists!`);\n    if(!this[type][key]) throw Error(`${type} stream ${key} does not exists!`);\n    \n    this[type][key].next(newValue);\n  }\n\n  private _get(type: string, key: string){\n    if(!this[type]) throw Error(`${type} stream group does not exists!`);\n    if(!this[type][key]) throw Error(`${type} stream ${key} does not exists!`);\n    \n    return this[type][key];\n  }\n\n}","export const ApolloProviderConfig = {\n  'getLastPosts': {\n    queryName: 'getLastPosts',\n    queryBody: `\n      {\n        getLastPosts(__PARAMS__) {\n          id\n          title\n        }\n      }\n    `\n  },\n\n  'getTree': {\n    queryName: 'getTreeOfItems',\n    queryBody: `\n    {\n      getTreeOfItems(treeId: \"patrimonioId\" ) {\n        id\n        label\n        icon\n        branches {\n          label\n          id\n          icon\n          img\n          branches {\n            label\n            id\n            icon\n            img\n            branches {\n              label\n              id\n              icon\n              img\n            }\n          }\n        }\n      }\n    }\n    `\n  },\n  'globalFilter': {\n    queryName: 'globalFilter',\n    queryBody: `{\n      globalFilter(__PARAMS__){\n        entitiesData {\n          countData {\n            type {\n              id\n              label\n              configKey\n            }\n            count\n          }\n          entitiesCountData {\n            entity {\n              id\n              label\n              typeOfEntity {\n                id\n              }\n            }\n            count\n          }\n        }\n        itemsPagination {\n          totalCount\n          items {\n            item {\n              id\n              label\n              info {\n                key\n                value\n              }\n            }\n            thumbnail\n            relatedTOEData {\n              type {\n                id\n                label\n                configKey\n              }\n              count\n            }\n          }\n        }\n      }\n    }`\n  },\n  'getEntityDetails': {\n    queryName: 'getEntityDetails',\n    queryBody: `{\n      getEntityDetails(__PARAMS__){\n        overviewTab\n        entity {\n          label\n          id\n          typeOfEntity {\n            configKey\n          }\n        }\n        fieldsTab {\n          label\n          fields {\n            key\n            value\n          }\n        }\n        entities {\n          entity {\n            id\n            label\n            typeOfEntity {\n              configKey\n            }\n          }\n          count\n        }\n        extraTab\n        wikiTab {\n          text\n          url\n        }\n        items {\n          breadcrumbs {\n            link\n            label\n          }\n          item {\n            id\n            label\n            info {\n              key\n              value\n            }\n          }\n          thumbnail\n          relatedTOEData {\n            type {\n              id\n              configKey\n            }\n            count\n          }\n        }\n      }\n    }\n    `\n  },\n  'getItemDetails': {\n    queryName: 'getItemDetails',\n    queryBody: `{\n        getItemDetails(__PARAMS__){\n          title\n          text\n          subTitle\n          image\n           item {\n            id\n            icon\n          }\n          items {\n            thumbnail\n              item {\n                label\n                icon\n                info {\n                  key\n                  value\n                }\n              }\n            relatedTOEData {\n              count\n              type {\n                label\n                configKey\n              }\n            }\n          }\n          connectedEntities {\n            count\n            entity{\n             id\n            label\n              typeOfEntity {\n                id\n                label\n                configKey\n              }\n            }\n          }\n          fields {\n            id\n            label\n            fields {\n              id\n              key\n              value\n            }\n          }\n          breadcrumbs {\n            label\n            link\n          }\n        }\n      }`\n  },\n  'autoComplete': {\n    queryName: 'autoComplete',\n    queryBody: `{\n      autoComplete(__PARAMS__){\n        totalCount\n        items {\n          item {\n            id\n            label\n            info {\n              key\n              value\n            }\n            icon\n          }\n          thumbnail\n          typeOfEntity {\n            id\n            configKey\n          }\n        }\n      }\n    }`\n  },\n  'search': {\n    queryName: 'search',\n    queryBody: `{\n      search(__PARAMS__){\n        totalCount\n        facets\n        filters\n        results\n        page\n      }\n    }`\n  }\n};\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http'\nimport { ApolloProviderConfig } from './config';\nimport { ConfigurationService } from '../../configuration.service';\nimport { ICommunicationProvider } from '../communication-provider.interface';\nimport { map } from 'rxjs/operators';\nimport { Observable } from 'rxjs';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ApolloProvider implements ICommunicationProvider {\n  private providerConfig: any;\n\n  constructor(\n    private config: ConfigurationService,\n    private http: HttpClient,\n  ) {\n    try {\n      this.providerConfig = this.config.get('communication').providers.apollo;\n    } catch(err) {\n      throw Error('No config found for apollo provider!');\n    }\n  }\n\n  request$(requestId, options){\n    const { params, method, httpOptions } = options;\n    let query = ApolloProviderConfig[requestId];\n\n    if(this.providerConfig.config && this.providerConfig.config[requestId]){\n      query = this.providerConfig.config[requestId];\n    }\n\n    query = query || {};\n    let { queryName, queryBody } = query;\n\n    // config query control\n    if(!queryName || !queryBody) throw Error(`No config found for requestId \"${requestId}\"`);\n\n    if(params){\n      let paramsStr = this.makeParamsStr(params);\n      queryBody = queryBody.replace('__PARAMS__', paramsStr);\n    } else {\n      queryBody = queryBody.replace('(__PARAMS__)', '');\n    }\n\n    let source$: Observable<any>;\n\n    if(method && method === 'GET'){\n      source$ = this.http.get(this.providerConfig.baseUrl);\n    } else {\n      source$ = this.http.post(this.providerConfig.baseUrl, { query: queryBody }, httpOptions);  \n    }\n\n    return source$.pipe(\n      map((response: any) => response.data[queryName])\n    );\n  }\n\n  private makeParamsStr(params){\n    let paramsStr = [];\n    Object.keys(params).forEach(key => {\n      if(Array.isArray(params[key])){\n        let arrStr = [];\n        params[key].forEach( val => {\n          if(typeof(val)==='object'){\n            let subParamsStr = this.makeParamsStr(val);\n            arrStr.push(`{ ${subParamsStr} }`);\n          } else {\n            if(!isNaN(val)) arrStr.push(`${val}`);\n            else arrStr.push(`\"${val}\"`)\n          }\n        });\n        paramsStr.push(`${key}: [${arrStr.join(',')}]`);\n      } else if( typeof(params[key])==='object' && params[key] ){\n          let subParamsStr = this.makeParamsStr(params[key]);\n          paramsStr.push(`${key}: { ${subParamsStr} }`);\n      } else if( typeof(params[key])==='string' && key.indexOf('$') === 0){\n        paramsStr.push(`${key.replace('$', '')}: ${params[key]}`);\n      } else {\n        if(!isNaN(params[key])) paramsStr.push(`${key}: ${params[key]}`);\n        else paramsStr.push(`${key}: \"${params[key]}\"`);\n      }\n    });\n    return paramsStr.join(' ');\n  }\n\n}\n","export const RestProviderConfig = {\n  'getLastPosts': 'posts', \n};","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http'\nimport { RestProviderConfig } from './config';\nimport { ConfigurationService } from '../../configuration.service';\nimport { ICommunicationProvider } from '../communication-provider.interface';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RestProvider implements ICommunicationProvider {\n  private providerConfig: any;\n\n  constructor(\n    private config: ConfigurationService,\n    private http: HttpClient,\n  ) {\n    try {\n      this.providerConfig = this.config.get('communication').providers.rest;\n    } catch(err) {\n      throw Error('No config found for rest provider!');\n    }\n  }\n\n  request$(requestId, options: any = {}){\n    let { params, method, httpOptions } = options;\n    let point = RestProviderConfig[requestId];\n\n    // default method\n    if(!method) method = this.providerConfig.defaultMethod || 'GET';\n\n    if(this.providerConfig.config && this.providerConfig.config[requestId]){\n      point = this.providerConfig.config[requestId];\n    }\n\n    // config point control\n    if(!point) throw Error(`No config found for requestId \"${requestId}\"`);\n\n    if(method === 'POST' || method === 'PUT'){\n      return this.http[method.toLowerCase()](this.providerConfig.baseUrl + point, params, httpOptions);\n    } else if(method === 'GET' || method === 'DELETE'){\n      return this.http[method.toLowerCase()](this.providerConfig.baseUrl + point, httpOptions);\n    } else {\n      throw Error(`Rest method ${method} not supported`);\n    }\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { ConfigurationService } from './configuration.service';\nimport { ApolloProvider } from './communication-providers/apollo/apollo.provider';\nimport { RestProvider } from './communication-providers/rest/rest.provider';\nimport { catchError } from 'rxjs/operators';\nimport { Observable, empty } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CommunicationService {\n  private defaultProvider: string;\n  private communicationConfig: any;\n\n  constructor(\n    private config: ConfigurationService,\n    private apollo: ApolloProvider,\n    private rest: RestProvider,\n  ){\n    try {\n      this.communicationConfig = this.config.get('communication');\n      this.defaultProvider = this.communicationConfig.defaultProvider;\n    } catch(err) {\n      throw Error('No communications.defaultProvider setted in config');\n    }\n  }\n\n  request$(requestId, options: any = {}, provider?){\n    provider = provider || this.defaultProvider;\n    if(!this[provider]) throw Error(`There is no ${provider} provider`);\n\n    const { onError } = options;\n    return this[provider].request$(requestId, options)\n      .pipe(\n        catchError((error) => this.handleError(error, onError))\n      );\n  }\n\n  handleError(error, onError): Observable<any> {\n    if(onError){\n      onError(error);\n    } else {\n      console.warn('No error handler for communication request', error);\n    }\n\n    return empty();\n  }\n}","import { LayoutBuilder } from '@n7-frontend/core';\n\nexport abstract class AbstractLayout {\n  protected config: any;\n  protected widgets: any[]; \n  public lb: any;\n  \n  constructor(config: any){\n    this.config = config;\n    this.widgets = this.config.widgets; \n    this.lb = new LayoutBuilder(this.config.layoutId);\n  }\n\n  protected initPayload(): any {};\n\n  protected onInit(){\n    // on ready\n    this.lb.ready$.subscribe(() => {\n      this.lb.eventHandler.emitInner('init', this.initPayload());\n    });\n\n    this.lb.init({\n      widgetsConfig: this.widgets,\n      widgetsDataSources: this.config.widgetsDataSources,\n      widgetsEventHandlers: this.config.widgetsEventHandlers,\n      dataSource: new this.config.layoutDS(),\n      eventHandler: new this.config.layoutEH(),\n    });\n  }\n\n  protected onDestroy(){\n    this.lb.eventHandler.emitInner('destroy');\n  }\n}","import { LayoutDataSource } from '@n7-frontend/core';\nimport tippy from 'tippy.js';\nimport { Subject } from 'rxjs';\n\nexport class MainLayoutDS extends LayoutDataSource {\n  protected configuration: any;\n  protected mainState: any;\n  protected router: any;\n  protected route: any;\n  protected titleService: any;\n\n  public options: any;\n  public pageTitle: string;\n\n  onInit({ configuration, mainState, router, options, titleService, route }){\n    this.configuration = configuration;\n    this.mainState = mainState;\n    this.router = router;\n    this.route = route;\n    this.titleService = titleService;\n    this.options = options;\n    this.mainState.addCustom('currentNav', new Subject());\n\n    // update header\n    this.one('header').update({\"items\": this.configuration.get('header')});\n\n    // main state updates\n    this.mainState.get$('headTitle').subscribe(val => this.titleService.setTitle(val));\n    this.mainState.get$('pageTitle').subscribe(val => this.pageTitle = val);\n    this.mainState.get$('subnav').subscribe(val => this.one('subnav').update(val));\n    this.mainState.get$('breadcrumbs').subscribe(val => this.one('breadcrumbs').update(val));\n\n    this.mainState.getCustom$('currentNav').subscribe(val => this.one('header').update({\"items\": this.configuration.get('header'), 'selected': val}));\n\n    // mainState test\n    /* this.mainState.addCustom('customNav', new Subject());\n    this.mainState.get$('pageTitle').subscribe(val => console.log('pageTitle', val));\n    this.mainState.getCustom$('customNav').subscribe(val => console.log('customNav', val));\n\n    this.mainState.update('pageTitle', 'hola');\n    this.mainState.updateCustom('customNav', {'hello': 'mundo!'});\n\n    setTimeout(() => {\n      this.mainState.update('pageTitle', 'chao');\n      this.mainState.updateCustom('customNav', {'hello': 'world!'});\n      console.log('has', {\n        'pageSubTitle' : this.mainState.has('pageSubTitle'),\n        'customNav' : this.mainState.hasCustom('customNav'),\n        'customNavs' : this.mainState.has('customNavs'),\n      });\n    }, 5000); */\n  }\n\n  onNavigate(payload){\n    // router navigation\n    if(payload.handler === 'router'){\n      const { path, queryParams } = payload;\n\n      // path control\n      if(!path) throw Error('onNavigate: no path for router navigate');\n\n      if(queryParams){\n        this.router.navigate(path, {\n          relativeTo: this.route,\n          queryParams: queryParams,\n          queryParamsHandling: 'merge'\n        });\n      } else {\n        this.router.navigate(path);\n      }\n\n      // on change\n      this._onRouterNavigate();\n    }\n  }\n\n  private _onRouterNavigate(){\n    // hide tippy\n    tippy.hideAll();\n  }\n}","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { tap, catchError } from 'rxjs/operators';\nimport { ConfigurationService } from './configuration.service';\nimport { of } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class JsonConfigService {\n  constructor(\n    private http: HttpClient,\n    private config: ConfigurationService,\n  ){}\n\n  load(path): Promise<any> {\n    return this.http.get(path).pipe(\n      catchError((error) => of({})),\n      tap(response => this._handleResponse(response))\n    ).toPromise();\n  }\n\n  private _handleResponse(response){\n    if(response){\n      Object.keys(response).forEach(key => this.config.set(key, response[key]));\n\n      // config keys colors\n      if(response['config-keys']){\n        const headTag = document.querySelector('head'),\n          styleElement = document.createElement('style');\n\n        let styles = [];\n\n        Object.keys(response['config-keys']).forEach(key => {\n          const configKey = response['config-keys'][key] || {};\n          \n          if(configKey.color && configKey.color.hex){\n            // add css class\n            styles.push(`--color-${key}: ${configKey.color.hex};`);\n          }\n        });\n\n        if(styles.length){\n          styles.unshift(':root {');\n          styles.push('}');\n          styleElement.appendChild(document.createTextNode(styles.join('\\n')));\n          headTag.appendChild(styleElement);\n        }\n\n      }\n    }\n  }\n}","interface IFacetInputData {\n  value: string | number;\n  label: string;\n  counter: number;\n  hidden?: boolean;\n  options?: any;\n}\n\nexport abstract class FacetInput {\n  static index: number = 0;\n\n  private id: string;\n  protected config: any;\n  protected output: any;\n  protected data: IFacetInputData[];\n\n  constructor(config){\n    this.config = config;\n    this._setId();\n    \n    FacetInput.index++;\n  }\n\n  public abstract setActive(facetValue: any): void;\n  protected abstract transform(): any;\n  \n  public update = () => this.output = this.transform();\n  public getId = () => this.id;\n  public getData = () => this.data;\n  public getConfig = () => this.config;\n  public getFacetId = () => this.config.facetId;\n  public getInputIndex = () => this.config.inputIndex;\n  public getSectionIndex = () => this.config.sectionIndex;\n  public getContext = () => this.config.filterConfig.context || 'external';\n  public getTarget = () => this.config.filterConfig.target || null;\n  public getSearchIn = () => this.config.filterConfig.searchIn || null;\n  public getType = () => this.config.type;\n  public getOutput = () => this.output;\n  \n  public setData = (newData: IFacetInputData[]) => this.data = newData;\n  private _setId() {\n    this.id = `facet-input-${this.getType()}-${FacetInput.index}`;\n  };\n}","import { FacetInput } from './facet-input';\n\nexport class FacetInputCheckbox extends FacetInput {\n\n  protected transform(){\n    const facetId = this.getFacetId();\n  \n    return this.data.map(({ label, value }, index) => {\n      // normalize value\n      value = '' + value;\n\n      return {\n        type: 'checkbox', \n        id: this.getId() + '-' + index, \n        label: label, \n        payload: {\n          facetId,\n          source: 'input-checkbox',\n          value\n        }, \n        _meta: { facetId, value } \n      }\n    });\n  }\n\n  public setActive(facetValue){\n    const { isArray } = this.config.filterConfig;\n    \n    this.output.forEach(config => {\n      if(isArray && Array.isArray(facetValue) && facetValue.indexOf(config._meta.value) !== -1){\n        config.checked = true;\n      } else if(facetValue === config._meta.value) {\n        config.checked = true;\n      } else {\n        config.checked = false;\n      }\n    });\n  }\n  \n}","import { FacetInput } from './facet-input';\n\nexport class FacetInputText extends FacetInput {\n\n  protected transform(){\n    const facetId = this.getFacetId();\n  \n    const payload = {\n      facetId,\n      source: 'input-text'\n    };\n\n    return { \n      type: 'text',\n      id: this.getId(),\n      label: this.config.label,\n      disabled: this.config.disabled,\n      placeholder: this.config.placeholder,\n      icon: this.config.icon,\n      inputPayload: {\n        ...payload,\n        trigger: 'input'\n      },\n      enterPayload: {\n        ...payload,\n        trigger: 'enter'\n      },\n      iconPayload: {\n        ...payload,\n        trigger: 'icon'\n      },\n      _meta: { facetId }\n    };\n  }\n\n  public setActive(facetValue){\n    this.output.value = facetValue || null;\n  }\n  \n}","import { FacetInput } from './facet-input';\n\nexport class FacetInputLink extends FacetInput {\n  private facetValue: string | string[];\n\n  protected transform(){\n    const facetId = this.getFacetId();\n  \n    return this.data.map(({ label, value, counter, hidden, options }) => {\n      // normalize value\n      value = '' + value;\n      options = options || {};\n\n      let classes = [];\n      if(options.classes) classes.push(options.classes);\n      if(hidden) classes.push('is-hidden');\n      if(this._isActive(this.facetValue, value)) classes.push('is-active');\n\n      return { \n        type: 'link', \n        id: this.getId(), \n        text: label, \n        counter, \n        payload: {\n          facetId,\n          source: 'input-link',\n          value\n        },\n        icon: options.icon || null,\n        classes: classes.join(' '),\n        _meta: { facetId, value } \n      };\n    });\n  }\n\n  public setActive(facetValue){\n    this.output.forEach(config => {\n      let classes = config.classes ? config.classes.split(' ') : [],\n        isActive = this._isActive(facetValue, config._meta.value);\n      if(!isActive){\n        classes = classes.filter(className => className !== 'is-active');\n      } else if(classes.indexOf('is-active') === -1) {\n        classes.push('is-active');\n      }\n      config.classes = classes.join(' ');\n    });\n  }\n  \n  private _isActive(facetValue, value){\n    this.facetValue = facetValue;\n\n    return (\n      (Array.isArray(facetValue) && facetValue.indexOf(value) !== -1) || \n      (facetValue === value)\n    );\n  }\n}","import { FacetInput } from './facet-input';\n\nexport class FacetInputSelect extends FacetInput {\n\n  protected transform(){\n    const facetId = this.getFacetId();\n\n    return { \n      type: 'select',\n      id: this.getId(),\n      label: this.config.label,\n      disabled: this.config.disabled,\n      options: this.data.map(({ value, label }) => ({\n        // normalize value\n        value: '' + value, \n        label\n      })),\n      payload: {\n        facetId,\n        source: 'input-select',\n      },\n      _meta: { facetId }\n    };\n  }\n\n  public setActive(facetValue){\n    this.output.options\n      .filter(option => option.value === facetValue)\n      .forEach(option => option.selected = true);\n  }\n  \n}","import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport { \n  FacetInput, \n  FacetInputCheckbox,\n  FacetInputText,\n  FacetInputLink,\n  FacetInputSelect,\n} from '../models';\n\nexport type FilterOperators = '=' | '>' | '<' | '>=' | '<=' | '<>' | 'LIKE';\nexport type FacetTypes = 'value' | 'range';\nexport type FacetOperators = 'OR' | 'AND';\n\nconst INPUTS_MAP = {\n  'checkbox': FacetInputCheckbox,\n  'text': FacetInputText,\n  'link': FacetInputLink,\n  'select': FacetInputSelect,\n};\n\nexport interface ISearchConfig {\n  totalCount: number;\n  facets: any;\n  page: any;\n  results: any;\n  fields: any;\n}\n\nexport interface IFacet {\n  id: string,\n  type: FacetTypes;\n  operator: FacetOperators;\n  data?: any;\n}\n\nexport interface IFilter {\n  facetId: string;\n  value: number | string | (number | string)[] | null;\n  searchIn: Array<{\n    key: string;  \n    operator?: FilterOperators;\n  }>;  \n  isArray?: boolean;\n  context?: 'internal' | 'external';\n  target?: string;\n}\n\nexport class SearchModel {\n  private _id: string;\n  private _filters: IFilter[] = [];\n  private _facets: IFacet[] = [];\n  private _inputs: FacetInput[] = [];\n  private _page: any;\n  private _totalCount: number | null;\n  private _config: ISearchConfig;\n  private _results$: Subject<any[]> = new Subject();\n\n  constructor(id: string, config: ISearchConfig){\n    this._id = id;\n    this._config = config;\n\n    this._setFilters();\n    this._setFacets();\n    this._setPage();\n    this._setInputs();\n    this._setInputsData();\n    this._setTotalCount();\n  }\n\n  public getId = () => this._id;\n  public getFilters = () => this._filters;\n  public getFacets = () => this._facets;\n  public getInputs = () => this._inputs;\n  public getConfig = () => this._config;\n  public getTotalCount = () => this._totalCount;\n  public getFields = () => this._config.fields;\n  public getResults$ = () => this._results$;\n\n  public setResults = (results) => this._results$.next(results);\n  \n  public updateFilter(facetId, value, remove?: boolean) {\n    const selectedFilters = this.getFiltersByFacetId(facetId);\n    selectedFilters.forEach(filter => {\n      if(Array.isArray(filter.value) && remove){\n        filter.value = filter.value.filter(item => item !== value);\n      } else if(Array.isArray(filter.value) && filter.value.indexOf(value) === -1){\n        filter.value.push(value);\n      } else {\n        filter.value = !remove ? value : null;\n      }\n    });\n  }\n\n  public updateFiltersFromQueryParams(queryParams) {\n    Object.keys(queryParams).forEach(facetId => {\n      const selectedFilters = this.getFiltersByFacetId(facetId),\n        value = queryParams[facetId];\n\n      selectedFilters.forEach(filter => {\n        filter.value = filter.isArray ? value.split(',') : value;\n      });\n    });\n  }\n\n  public updateInputsFromFilters(){\n    this._filters.forEach(({ facetId, value }) => {\n      this.getInputByFacetId(facetId).setActive(value);\n    });\n  }\n\n  public updateFacets(facets) {\n    facets.forEach(({ id, data }) => this.updateFacet(id, data));\n    this._setInputsData();\n  }\n\n  public updateTotalCount(totalCount) {\n    this._totalCount = totalCount;\n  }\n\n  public updateFacet(facetId, data) {\n    let selectedFacets = this._facets.filter(facet => facet.id === facetId);\n    if(!selectedFacets.length){\n      throw Error(`Facet with id \"${facetId}\" does not exists`);\n    }\n\n    selectedFacets.forEach(facet => facet.data = data);\n  }\n\n  public reset(){\n    this._filters.forEach(filter => filter.value = null);\n  }\n\n  public getRequestParams(){\n    return {\n      facets: this._facets,\n      page: this._page,\n      results: this._config.results,\n      filters: this._filters\n        .filter(filter => filter.context !== 'internal')\n        .map(({ facetId, value, searchIn }) => ({ facetId, value, searchIn }))\n    }\n  }\n\n  public getInternalFilters(){\n    return this._filters\n        .filter(filter => { \n          return (filter.context === 'internal') && (\n            (Array.isArray(filter.value) && filter.value.length) || \n            (!Array.isArray(filter.value) && filter.value)\n          );\n        })\n        .map(({ facetId, value, searchIn }) => ({ facetId, value, searchIn }));\n  }\n\n  public filtersAsQueryParams(filters){\n    let queryParams: any = {};\n    filters.forEach(filter => queryParams[filter.facetId] = Array.isArray(filter.value) ? filter.value.join(',') : filter.value);\n\n    return queryParams;\n  }\n\n  public getFiltersByFacetId(facetId: string){\n    return this._filters.filter(filter => filter.facetId === facetId);\n  }\n\n  public getInputByFacetId(facetId: string){\n    return this._inputs.filter(input => input.getFacetId() === facetId)[0];\n  }\n\n  public setInputData(facetId, data){\n    this.getInputByFacetId(facetId).setData(data);\n  }\n\n  public filterTarget(target){\n    const inputs = this._inputs.filter(input => input.getTarget() === target),\n      targetInput = this.getInputByFacetId(target),\n      facet = this._facets.filter(facet => facet.id === target)[0],\n      facetData = facet.data;\n\n    let searchIns = [];\n    inputs.forEach(input => {\n      const filter = this.getFiltersByFacetId(input.getFacetId())[0],\n        searchIn = input.getSearchIn(),\n        value = filter.value;\n\n      searchIns.push([searchIn, value]);\n    });\n\n    // filter\n    facetData.forEach(item => this._filterData(searchIns, item))\n\n    // update\n    targetInput.setData(facetData);\n    targetInput.update();\n  }\n\n  public setSearchConfigOrderBy(orderBy){\n    this._config.results.order.type = orderBy;\n  }\n\n  public setSearchConfigDirection(direction){\n    this._config.results.order.direction = direction;\n  }\n\n  public setPageConfigOffset(offset){\n    this._config.page.offset = offset;\n  }\n\n  public setPageConfigLimit(limit){\n    this._config.page.limit = limit;\n  }\n\n  private _filterData(searchIns, item){\n    searchIns.forEach(([searchIn, value]) => {\n      searchIn.forEach(({ key, operator }) => {\n        switch(operator){\n          // '=' EQUALS\n          case '=':\n            if(Array.isArray(value)){\n              item.hidden = !(!value.length || value.indexOf(item.metadata[key]) !== -1);\n            } else {\n              item.hidden = !(value && value === item.metadata[key]);\n            }\n            break;\n          // '>' GREATER THAN\n          case '>':\n            if(!Array.isArray(value)){\n              item.hidden = !(value && value > item.metadata[key]);\n            } \n            break;\n          // '<' LESS THAN\n          case '<': \n            if(!Array.isArray(value)){\n              item.hidden = !(value && value < item.metadata[key]);\n            } \n            break;\n          // '>=' GREATER OR EQUALS\n          case '>=': \n            if(!Array.isArray(value)){\n              item.hidden = !(value && value >= item.metadata[key]);\n            } \n            break;\n          // '<=' LESS OR EQUALS\n          case '<=': \n            if(!Array.isArray(value)){\n              item.hidden = !(value && value <= item.metadata[key]);\n            } \n            break;\n          // '<>' NOT EQUAL\n          case '<>': \n            if(!Array.isArray(value)){\n              item.hidden = !(value && value !== item.metadata[key]);\n            } \n            break;\n          //  'LIKE'\n          case 'LIKE':\n            if(\n              value && \n              item.metadata[key] && \n              typeof value === 'string' && \n              typeof item.metadata[key] === 'string'\n            ){\n              const haystack = item.metadata[key].toLowerCase(),\n                needle = value.toLocaleLowerCase(); \n                \n              item.hidden = !(haystack.indexOf(needle) !== -1);\n            }  \n            break;\n          default:\n            console.warn(`SearchIn: operator ${operator} not supported`);\n            break;\n        }\n      })\n    });\n  }\n\n  private _setFilters(){\n    this._config.fields.forEach(field => {\n      field.inputs.forEach(input => this._filters.push({ \n        ...input.filterConfig,\n        facetId: input.facetId,\n        value: input.filterConfig.isArray ? [] : null\n      }));\n    });\n  }\n\n  private _setFacets(){\n    this._facets = this._config.facets;\n  }\n\n  private _setPage(){\n    this._page = this._config.page;\n  }\n\n  private _setTotalCount(){\n    this._totalCount = this._config.totalCount;\n  }\n\n  private _setInputs(){\n    this._config.fields.forEach((sectionConfig, sectionIndex) => {\n      sectionConfig.inputs.forEach((inputConfig, inputIndex) => {\n        const inputModel = INPUTS_MAP[inputConfig.type];\n        if(!inputModel) throw Error(`Input type ${inputConfig.type} not supported`);\n\n        this._inputs.push(new inputModel({ ...inputConfig, inputIndex, sectionIndex }));\n      })\n    });\n  }\n\n  private _setInputsData(){\n    this._facets.forEach(facet => this.setInputData(facet.id, facet.data));\n  }\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SearchService {\n  private _models: any = {};\n  static queryParams: any = null;\n\n  public add(id: string, config: ISearchConfig){\n    if(this._models[id]) throw Error(`Search model \"${id}\" already exists!`);\n\n    this._models[id] = new SearchModel(id, config);\n  }\n\n  public model(id: string): SearchModel {\n    return this._models[id] || null;\n  }\n}","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\nimport { takeUntil, first, filter, delay } from 'rxjs/operators';\nimport { SearchService } from '../../services';\n\nexport class MainLayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n  private route: any;\n  private router: any;\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type) {\n        case 'main-layout.init':\n          this.dataSource.onInit(payload);\n\n          this.route = payload.route;\n          this.router = payload.router;\n\n          this._listenRouterChanges();\n          break;\n\n        case 'main-layout.destroy':\n            this.destroyed$.next();\n            break;\n\n        default:\n            break;\n      }\n    });\n\n    // listen to global events\n    EventHandler.globalEvents$.pipe(\n      takeUntil(this.destroyed$)\n    ).subscribe(({type, payload}) => {\n      switch(type){\n        case 'global.navigate':\n          this.dataSource.onNavigate(payload);\n          break;\n          \n        default: \n          break;\n      }\n    });\n  }\n\n  private _listenRouterChanges(){\n    this.route.queryParams.pipe(\n      filter(params => {\n        if(Object.keys(params).length) return true;\n        return false;\n      }),\n      first(),\n    ).subscribe(params => {\n      this.emitGlobal('queryparams', params);\n\n      // to use in searchs\n      SearchService.queryParams = params;\n    });\n  } \n  \n}","import { DataSource } from '@n7-frontend/core';\n\nexport class HeaderDS extends DataSource {\n  protected transform(data) {\n\n    if (data.selected) {\n      this.selectNavItem(data.selected);\n    }\n\n    return data.items;\n  }\n\n  public selectNavItem(selectedItem) {\n    this.output.nav.items.forEach( item => {\n      item.classes = \"\";\n      if ( item.payload == selectedItem ){\n        item.classes = \"is-current\";\n      }\n    })\n    this.update({'items': this.output});\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class SubnavDS extends DataSource {\n\n  protected transform(data) {\n    return {\n      classes: 'main-subnav',\n      items: data\n    }\n  }\n\n  setActive(id){\n    this.output.items.forEach(item => {\n      if(item._meta.id === id){\n        item.classes = 'is-current';\n        item._meta.isActive = true;\n      } else {\n        item.classes = '';\n        item._meta.isActive = false;\n      }\n    });\n  }\n\n  getActive(){\n    return this.output.items.filter(item => item._meta.isActive)[0] || null;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\nimport { IBreadcrumbsData } from '@n7-frontend/components';\n\nexport class BreadcrumbsDS extends DataSource {\n  protected transform(data): IBreadcrumbsData | null {\n    return data;\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class FacetsDS extends DataSource {\n  public searchModel: any;\n\n  protected transform({ fields }) {\n\n    const { searchModel } = this.options;\n    this.searchModel = searchModel;\n\n    return fields;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\nimport { SearchModel, SearchService } from '../services/search.service';\n\nconst HEADER_ICON_OPEN = 'n7-icon-angle-down';\nconst HEADER_ICON_CLOSE = 'n7-icon-angle-right';\n\nexport class FacetsWrapperDS extends DataSource {\n  public searchModel: SearchModel;\n\n  protected transform(data) {\n\n    if(!this.searchModel) {\n      this.searchModel = data.searchModel;\n    }\n\n    const id = this.searchModel.getId(),\n      fields = this.searchModel.getFields();\n    \n    let groups = [];\n\n    fields.forEach((fieldConfig, fieldIndex) => {\n      const groupId = `group-${id}-${fieldIndex}`;\n      \n      // header config\n      const header = this._headerConfig(fieldConfig.header, groupId);\n\n      // inputs config\n      let sections = [];\n      this.searchModel.getInputs()\n        .filter(input => input.getSectionIndex() === fieldIndex)\n        .map(input => {\n          input.update();\n          return {\n            facetId: input.getFacetId(),\n            type: input.getType(),\n            output: input.getOutput()\n          }\n        })\n        .forEach(({ type, output, facetId }) => {\n          sections.push({ \n            classes: this._getSectionClasses(type),\n            inputs: Array.isArray(output) ? output : [output],\n            _meta: {\n              facetId\n            }\n          });\n        });\n\n      groups.push({ \n        header,\n        facet: { sections },\n        classes: `n7-facets-wrapper__${groupId}`,\n        isOpen: true, \n        _meta: {\n          groupId\n        }\n      })\n    });\n\n    // query params control\n    if(SearchService.queryParams){\n      this.searchModel.updateFiltersFromQueryParams(SearchService.queryParams);\n      this.searchModel.updateInputsFromFilters();\n\n      // reset queryparams\n      SearchService.queryParams = null;\n    }\n\n    return { \n      groups, \n      classes: `n7-facets-wrapper__${this.searchModel.getId()}` \n    };\n  }\n\n  public toggleGroup({ eventPayload }){\n    this.output.groups.forEach(group => {\n      if(group._meta.groupId === eventPayload.groupId) {\n        group.isOpen = !group.isOpen;\n        group.header.iconRight = group.isOpen ? HEADER_ICON_OPEN : HEADER_ICON_CLOSE;\n      }\n    });\n  }\n  \n  public onFacetChange({ eventPayload }){\n    const { facetId, source, trigger } = eventPayload.inputPayload,\n      filter = this.searchModel.getFiltersByFacetId(facetId)[0] || {},\n      filterValue = filter['value'];\n\n    let remove: boolean = false,\n      value: any = eventPayload.inputPayload.value || eventPayload.value;\n\n    // normalize\n    value = '' + value;\n      \n    // remove control\n    if(Array.isArray(filterValue)){\n      remove = filterValue.indexOf(value) !== -1;\n    } else {\n      remove = filterValue === value;\n    }\n\n    // input text control\n    // TODO: gestire i casi enter / icon click nel input text\n    if(source === 'input-text' && ['enter', 'icon'].indexOf(trigger) !== -1) return;\n\n    this.searchModel.updateFilter(facetId, value, remove);\n    this.searchModel.updateInputsFromFilters();\n  }\n\n  public updateFilteredTarget(target){\n    const input = this.searchModel.getInputByFacetId(target);\n    this.output.groups\n      .map(group => group.facet)\n      .map(facet => facet.sections)\n      .map(sections => {\n        sections.forEach(section => {\n          if(section._meta.facetId === target){\n            const inputOutput = input.getOutput();\n            section.inputs = Array.isArray(inputOutput) ? inputOutput : [inputOutput];\n          }\n        });\n      });\n  }\n\n  public updateInputLinks(){\n    const linksFacetIds = this.searchModel.getInputs()\n      .filter(input => input.getType() === 'link')\n      .map(input => input.getFacetId());\n\n    this.output.groups\n      .map(group => group.facet)\n      .map(facet => facet.sections)\n      .map(sections => {\n        sections.forEach(section => {\n          if(linksFacetIds.indexOf(section._meta.facetId) !== -1){\n            const input = this.searchModel.getInputByFacetId(section._meta.facetId);\n            input.update();\n            const inputOutput = input.getOutput();\n            section.inputs = Array.isArray(inputOutput) ? inputOutput : [inputOutput];\n          }\n        });\n      });\n  }\n\n  public getRequestParams = () => this.searchModel.getRequestParams();\n  public filtersAsQueryParams = (filters) => this.searchModel.filtersAsQueryParams(filters);\n  public updateFiltersFromQueryParams = (queryParams) => this.searchModel.updateFiltersFromQueryParams(queryParams);\n  public getInputByFacetId = (facetId) => this.searchModel.getInputByFacetId(facetId);\n  public filterTarget = (target) => this.searchModel.filterTarget(target);\n\n  public updateInputsFromFilters(){\n    this.searchModel.updateInputsFromFilters();\n  }\n\n  private _getSectionClasses(type){\n    const classesMap = {\n      'text': 'text',\n      'checkbox': 'checkboxes',\n      'link': 'links',\n      'select': 'select'\n    };\n\n    return `n7-facet__section-input-${classesMap[type]}`;\n  }\n\n  private _headerConfig(header, groupId){\n    return header ? {\n      text: header.label,\n      iconRight: HEADER_ICON_OPEN,\n      classes: header.classes,\n      payload: {\n        source: 'group-header',\n        id: `${groupId}-header`,\n        groupId: groupId\n      },\n      _meta: {\n        id: `${groupId}-header`\n      }\n    }: null;\n  }\n\n}","import { DataSource } from '@n7-frontend/core';\nimport { FOOTER_MOCK } from \"@n7-frontend/components\";\n\nexport class FooterDS extends DataSource {\n  protected transform(data) {\n    return FOOTER_MOCK;\n  }\n}\n","import { EventHandler } from '@n7-frontend/core';\n\nexport class HeaderEH extends EventHandler {\n\n  public listen(){\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case 'header.click':\n          // navigate control\n          // if(payload.source === 'navigate'){\n          this.dataSource.selectNavItem(payload);\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [payload]\n          });\n          // }\n          // global signal\n          // this.emitGlobal(type, payload);\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n\n}\n","import { EventHandler } from '@n7-frontend/core';\n\nexport class SubnavEH extends EventHandler {\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case 'subnav.click':\n          // navigate control\n          if(payload.source === 'navigate'){\n            this.emitGlobal('navigate', payload);\n          }\n\n          // global signal\n          this.emitGlobal(type, payload);\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class BreadcrumbsEH extends EventHandler {\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case 'breadcrumbs.click':\n          // navigate control\n          if(payload.source === 'navigate'){\n            this.emitGlobal('navigate', payload);\n          }\n\n          // global signal\n          this.emitGlobal(type, payload);\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class FacetsEH extends EventHandler {\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        // TODO\n        default:\n          break;\n      }\n    });\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class FacetsWrapperEH extends EventHandler {\n  private _facetsChanged: boolean = false;\n\n  public listen() {\n    // listen to inner (widget) events\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case 'facets-wrapper.facet':\n          const { facetId } = payload.eventPayload.inputPayload,\n            input = this.dataSource.getInputByFacetId(facetId),\n            context = input.getContext();\n          this._facetsChanged = true;\n\n          // update\n          this.dataSource.onFacetChange(payload);\n\n          // internal\n          if(context === 'internal'){\n            this.dataSource.filterTarget(input.getTarget());\n            this.dataSource.updateFilteredTarget(input.getTarget());\n\n            // external\n          } else {\n            const requestParams = this.dataSource.getRequestParams(),\n              queryParams = this.dataSource.filtersAsQueryParams(requestParams.filters);\n\n            Object.keys(queryParams).forEach(key => queryParams[key] = queryParams[key] || null);\n            \n            // signal\n            this.emitOuter('facetschange');\n\n            // router signal\n            this.emitGlobal('navigate', {\n              handler: 'router',\n              path: [],\n              queryParams\n            });\n          }\n\n          break;\n\n        case 'facets-wrapper.facetheader':\n          this.dataSource.toggleGroup(payload);\n          break;\n\n        default: \n          break;\n      }\n    });\n\n    // listen to global events\n    EventHandler.globalEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case 'global.searchresponse':\n          if(this.dataSource.searchModel.getId() === payload){\n            this.dataSource.updateInputLinks();\n          }\n          break;\n\n        default: \n          break;\n      }\n    });\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class FooterEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        default:\n          console.warn('unhandled inner event of type', type)\n          break;\n      }\n    });\n  }\n\n}\n","import { MainLayoutDS } from './main-layout.ds';\nimport { MainLayoutEH } from './main-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const MainLayoutConfig = {\n  layoutId: 'main-layout',\n  widgets: [{\n    id: 'header'\n  }, {\n    id: 'subnav'\n  }, {\n    id: 'breadcrumbs'\n  }, {\n    id: 'footer',\n    hasStaticData: true\n  }],\n  layoutDS: MainLayoutDS,\n  layoutEH: MainLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { Title } from '@angular/platform-browser';\nimport { AbstractLayout } from '../../models/abstract-layout'\nimport { ConfigurationService } from '../../services/configuration.service';\nimport { LayoutsConfigurationService } from '../../services/layouts-configuration.service';\nimport { MainStateService } from '../../services/main-state.service';\nimport { MainLayoutConfig as config } from './main-layout.config';\n\n@Component({\n    selector: 'main-layout',\n    templateUrl: './main-layout.html'\n})\nexport class MainLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private configuration: ConfigurationService,\n    private layoutsConfiguration: LayoutsConfigurationService,\n    private mainState: MainStateService,\n    private titleService: Title\n  ){\n    super(layoutsConfiguration.get('MainLayoutConfig') || config);\n  }\n\n  protected initPayload(){\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      router: this.router,\n      route: this.route,\n      titleService: this.titleService,\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit(){\n    this.onInit();\n  }\n\n  ngOnDestroy(){\n    this.onDestroy();\n  }\n}\n","import { LayoutDataSource } from '@n7-frontend/core';\n\nexport class Page404LayoutDS extends LayoutDataSource {\n  public options: any;\n\n  onInit({ options }){\n    this.options = options;\n  }\n}","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\n\nexport class Page404LayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type) {\n        case 'n7-page404-layout.init':\n          this.dataSource.onInit(payload);\n          break;\n\n        case 'n7-page404-layout.destroy':\n            this.destroyed$.next();\n            break;\n\n        default:\n            break;\n      }\n    });\n\n    // listen to global events\n    /* EventHandler.globalEvents$.pipe(\n      takeUntil(this.destroyed$)\n    ).subscribe(({type, payload}) => {\n      switch(type){\n        case 'global.navigate':\n          this.dataSource.onNavigate(payload);\n          break;\n          \n        default: \n          break;\n      }\n    }); */\n  }\n  \n}","import { Page404LayoutDS } from './page404-layout.ds';\nimport { Page404LayoutEH } from './page404-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const Page404LayoutConfig = {\n  layoutId: 'n7-page404-layout',\n  widgets: [],\n  layoutDS: Page404LayoutDS,\n  layoutEH: Page404LayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\n// import { Router } from '@angular/router';\nimport { AbstractLayout } from '../../models/abstract-layout'\n// import { ConfigurationService } from '../../services/configuration.service';\nimport { LayoutsConfigurationService } from '../../services/layouts-configuration.service';\n// import { MainStateService } from '../../services/main-state.service';\nimport { Page404LayoutConfig as config } from './page404-layout.config';\n\n@Component({\n    selector: 'n7-page404-layout',\n    templateUrl: './page404-layout.html'\n})\nexport class Page404LayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    // private router: Router,\n    // private configuration: ConfigurationService,\n    layoutsConfiguration: LayoutsConfigurationService,\n    // private mainState: MainStateService,\n  ){\n    super(layoutsConfiguration.get('Page404LayoutConfig') || config);\n  }\n\n  protected initPayload(){\n    return {\n      // configuration: this.configuration,\n      // mainState: this.mainState,\n      // router: this.router,\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit(){\n    this.onInit();\n  }\n\n  ngOnDestroy(){\n    this.onDestroy();\n  }\n}\n","import { Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'n7-facets-wrapper',\n  templateUrl: './facets-wrapper.html',\n})\nexport class FacetsWrapperComponent {\n  @Input() data: any;\n  @Input() emit: any;\n\n  headerEmit(eventType, eventPayload){\n    if(!this.emit) return;\n\n    this.emit('facetheader', { eventType, eventPayload });\n  }\n\n  facetEmit(eventType, eventPayload){\n    if(!this.emit) return;\n\n    this.emit('facet', { eventType, eventPayload });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { ModuleWithProviders } from '@angular/compiler/src/core';\nimport { DvComponentsLibModule } from '@n7-frontend/components';\n\n// services\nimport { ConfigurationService } from './services/configuration.service';\nimport { LayoutsConfigurationService } from './services/layouts-configuration.service';\nimport { MainStateService } from './services/main-state.service';\nimport { CommunicationService } from './services/communication.service';\nimport { ApolloProvider } from './services/communication-providers/apollo/apollo.provider';\n\n// layouts\nimport { MainLayoutComponent } from './layouts/main-layout/main-layout';\nimport { Page404LayoutComponent } from './layouts/page404-layout/page404-layout';\nimport { FacetsWrapperComponent } from './components/facets-wrapper/facets-wrapper';\n\nconst COMPONENTS = [\n  MainLayoutComponent,\n  Page404LayoutComponent,\n  FacetsWrapperComponent,\n];\n\n@NgModule({\n  declarations: COMPONENTS,\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    DvComponentsLibModule\n  ],\n  providers: [],\n  exports: COMPONENTS\n})\nexport class N7BoilerplateCommonModule {\n  static forRoot(config: any): ModuleWithProviders {\n    return {\n      ngModule: N7BoilerplateCommonModule,\n      providers: [\n        MainStateService, \n        ConfigurationService, \n        LayoutsConfigurationService, \n        CommunicationService, \n        ApolloProvider, \n        { provide: 'config', useValue: config }\n      ]\n    }\n  }\n}\n","import { LayoutDataSource } from '@n7-frontend/core';\n\nexport class AwAboutLayoutDS extends LayoutDataSource {\n  onInit(payload){\n    // TODO\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwAboutLayoutEH extends EventHandler {\n  \n  public listen() {\n    /* this.innerEvents$.subscribe(({ type, payload }) => {\n      \n    }); */\n    \n    /* this.outerEvents$.subscribe(({ type, payload }) => {\n      \n    }); */\n  }\n\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwLinkedObjectsDS extends DataSource {\n\n  public currentPage: number\n  public totalPages: number\n  public pageSize: number\n  public context: string\n\n  protected transform(data) {\n    this.pageSize = this.options.size\n    this.currentPage = <number>this.options.page\n    this.totalPages = Math.floor(data.length / this.pageSize)\n    this.context = this.options.context\n    return this.unpackData(data)\n  }\n\n  public handleShowMoreClick = incomingData => {\n    /*\n      Called by button <Mostra Altri>, adds the incoming\n      data to the linked objects component.\n    */\n    console.log('showing more stuff')\n    // TODO\n  }\n\n  public makePagination = (totalPages, currentPage) => {\n    /*\n      Called by this.unpackData() when this.options.page is defined.\n      Returns the data for <n7-pagination> component.\n    */\n    let result = []\n    // always push the first page\n    result.push({\n      text: '1',\n      payload: 'page-1',\n      classes: currentPage == 1 ? 'is-active' : ''\n    })\n    for (let i = 1; i < totalPages; i++) {\n      result.push({ text: String(i + 1), payload: 'page-' + String(i + 1), classes: currentPage == i + 1 ? 'is-active' : '' })\n    }\n    return result\n  }\n\n  private unpackData = data => {\n    /*\n      Dynamically returns the data object for each HTML component\n      data: {\n        previews: [ breadcrumbs: { items[] }, classes, image, metadata, payload, title ],\n        pagination: { first, last, links, next, prev, select }\n      }\n    */\n    const\n      config = this.options.config, // app-config.json\n      totalCount = data.totalCount, // total amount of items available on backend\n      totalPages = this.totalPages, // calculated number of pages\n      page = this.currentPage,      // current page (if using pagination)\n      context = this.context,       // parent layout name\n      size = this.pageSize          // items per page (if using pagination)\n    var\n      d = data.items                // items to iterate over\n\n    if (config) {\n      var keys = config.get('config-keys')\n      // dynamic search for max-item-length\n      if (config.get(context + '-layout')) {\n        var lengthLimit = config.get(context + '-layout')['max-item-length']\n        var resultsLimit = config.get(context + '-layout')['results-limit']\n      }\n    }\n    // resize data\n    if (size && page) {\n      d = d.slice(page * size - size, page * size)\n    } else if (size) {\n      d = d.slice(0, size)\n    }\n\n    var result = []\n    d.forEach(el => {\n      let item = {\n        image: el.thumbnail,\n        title:\n          // if there is a max string length in config, use it\n          lengthLimit && el.item.label.length > lengthLimit ?\n            el.item.label.slice(0, lengthLimit) + '...' : el.item.label,\n        payload: el.item.id,\n        classes: ['entita', 'search'].includes(context) ? 'is-fullwidth' : '',\n        metadata: [\n          {\n            classes: 'n7-objects__metadata-artist',\n            items: el.item.info.map(({ value, key }) => ({\n              label: key === 'author' ? 'Artista' : null,\n              value\n            }))\n          },\n          {\n            classes: 'n7-objects__metadata-linked',\n            items: el.relatedTOEData.map(toe => {\n              return { // Persone: 6, Organizz: 12, Luoghi: 2, Concetti: 32\n                value: toe.count,\n                // icon: 'n7-icon-bell' // TODO: link icon to config key\n                icon: keys[toe.type.configKey].icon,\n                classes: 'color-' + toe.type.configKey\n              }\n            })\n          }\n        ]\n      };\n      if (el.breadcrumbs) {\n        item['breadcrumbs'] = { // n7-breadcrumbs uses this as it's own data\n          items: el.breadcrumbs.map(crumb => {\n            return {\n              label: crumb.label,\n              payload: crumb.link,\n            }\n          })\n        };\n      }\n      result.push(item);\n    });\n    if (page) { // if I'm on a page, render pagination data.\n      let sizeOptions = [10, 25, 50]\n      return {\n        pagination: {\n          first: { payload: `goto-${1}`, classes: page == 1 ? 'is-disabled' : '' },\n          prev: { payload: `goto-${page - 1}`, classes: page == 1 ? 'is-disabled' : '' },\n          next: { payload: `goto-${page + 1}`, classes: page == totalPages ? 'is-disabled' : '' },\n          last: { payload: `goto-${totalPages}`, classes: page == totalPages ? 'is-disabled' : '' },\n          links: this.makePagination(totalPages, page),\n          select: {\n            label: 'Numero di risultati',\n            options: sizeOptions.map(o => {\n              return {\n                text: o,\n                selected: o == size,\n                // disables options greater than total items\n                // disabled: o > totalPages*size\n              }\n            }),\n            payload: 'select-size'\n          }\n        },\n        previews: result\n      }\n    }\n    if (context === 'home') {\n      return {\n        result,\n        actions:\n          [\n            { label: 'Mostra Tutti (' + totalCount + ')' },\n            lengthLimit ?\n              { label: 'Mostra Altri (' + resultsLimit + ')' } :\n              null,\n          ]\n      }\n    }\n    console.log('linked objects result', result)\n    return result;\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwAutocompleteWrapperDS extends DataSource {\n\n  protected transform(data) {\n    const { key, response } = data\n    const regex = new RegExp('(.*?)' + key + '(.*)', 'i') // 'i' = case insensitive\n    const suggestion = []\n    const config = this.options.config\n    const maxLength = config.get('home-layout')['max-item-length'] / 2\n\n    response.items.forEach(el => {\n      // divide prefix and suffix\n      let match = regex.exec(el.item.label)\n      if (match) {\n        let prefix = match[1]\n        let suffix = match[2]\n        // string manipulation\n        if (maxLength && (prefix.length > maxLength)) {\n          prefix = '...' + prefix.slice(prefix.length - maxLength, prefix.length)\n        }\n        if (maxLength && (suffix.length > maxLength)) {\n          suffix = suffix.slice(0, maxLength) + '...'\n        }\n        suggestion.push({\n          match: match.input.slice(match[1].length, match[1].length + key.length),\n          prefix,\n          suffix,\n          payload: el.item.id\n        })\n      }\n    });\n    return { suggestion }\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport { BUBBLECHART_MOCK } from '@n7-frontend/components';\nimport tippy from 'tippy.js';\nimport { fromEvent, interval } from 'rxjs';\nimport { debounce, debounceTime } from 'rxjs/operators';\n\nexport class AwBubbleChartDS extends DataSource {\n\n  private thresholdShowTitle:number = 50;\n  private thresholdShowValue:number = 60;\n  public configuration: any;\n  private allBubbles: any[] = null;\n  private entityBubbleIdMap: any = {};\n  public selectedBubbles: any[] = [];\n  private facetData: any[] = null;\n  private bubblePopup: any = null;\n  public currentHoverEntity: any = null;\n  private _bubbleChart: any = null;\n  private maxBubblesSelectable:number = 3;\n  private tippy;\n  private windowResizeSet = false;\n\n  protected transform(data){\n    if ( !data ){ return null; }\n\n    this.destroyTooltip();\n\n    this.facetData = data.facetData ? data.facetData : [];\n    this.tippy = tippy;\n\n    data.bubbles = this.filterBubblesBasedOnFacetsEnabled();\n    let bubbleCointainer = document.getElementById(this.options.containerId);\n    const cWidth = data.width ? data.width : bubbleCointainer.offsetWidth;\n\n    // TODO: think of a good way to pass/compute cHeight\n    const cHeight = 700; // bubbleCointainer.offsetHeight\n    const containerSize = cWidth * cHeight;\n\n    let bubblesData = {\n      containerId: this.options.bubbleContainerId,\n      containerWidth : cWidth,\n      containerHeight : cHeight,\n      isForceSimulationEnabled: true,\n      maxBubblesSelected:3\n    };\n\n    bubblesData['bubblesData'] = [];\n\n    let maxBubbleCount = -1;\n    let minBubbleCount = -1;\n    let numOfBubbles = 0;\n    let totalCount = 0;\n    let numOfSelectedBubbles = 0;\n\n    data.bubbles.forEach( bubble => {\n      if ( maxBubbleCount < bubble.count ) maxBubbleCount = bubble.count;\n      if ( minBubbleCount < 0 || minBubbleCount>bubble.count ) minBubbleCount = bubble.count;\n      numOfBubbles++;\n      totalCount += bubble.count;\n      if(bubble.selected) numOfSelectedBubbles++;\n    });\n\n    data.bubbles.forEach( bubble => {\n      let bId = bubble.id;\n      let bubblePercentage = ( bubble.count - (minBubbleCount/3) )/( (maxBubbleCount*3) - (minBubbleCount/3) );\n      let bubbleRadius = (Math.log(containerSize)/10)*(bubblePercentage*3)*(70-Math.sqrt(numOfBubbles));\n      let bubbleData = {\n        id: bId,\n        texts: [\n          {\n            id:bId+\"_label0\",\n            label: (d) => { if(d.radius<this.thresholdShowTitle) return null; return bubble.entity.label },\n            x_function: (d) => d.x,\n            y_function: (d) => {\n              let mNum = (d.radius/9);\n              if(d.radius<this.thresholdShowValue) mNum=0;\n              return d.y-mNum;\n            },\n            \"user_select\":\"none\",\n            fontSize_function: (d) => d.radius/5,\n            color: \"white\",\n            \"classes\":\"\"\n          },\n          {\n            id:bId+\"_label1\",\n            label: (d) => { if(d.radius<this.thresholdShowValue) return null; return bubble.count },\n            x_function: (d) => d.x,\n            y_function: (d) => d.y+(d.radius/9),\n            \"user_select\":\"none\",\n            fontSize_function: (d) => d.radius/6,\n            color: \"white\",\n            \"classes\":\"\"\n        }\n        ],\n        x: cWidth/2+50,\n        y: cHeight/2+50,\n        \"radius\": bubbleRadius,\n        color:bubble.color,\n        hasCloseIcon: ( bubble.selected ? bubble.selected : false ),\n        payload:{\n          id: bId\n        },\n      };\n\n      bubblesData['bubblesData'].push(bubbleData);\n    });\n\n\n    bubblesData['forceSimulationData'] = {\n      xPull: cWidth/2,\n      xPullStrength: -0.01,\n      yPull: cHeight/2,\n      yPullStrength: -0.01,\n      collisionStrengh: 0.99,\n      collisionIterations: 1,\n      velocityDecay: 0.65\n    }\n\n    if(data.reset) bubblesData['reset'] = data.reset;\n\n    if(data.setUpdateReference) bubblesData['setUpdateReference'] = data.setUpdateReference;\n    if(data.setBubbleChart) bubblesData['setBubbleChart'] = data.setBubbleChart;\n\n    this.setWindowResize();\n\n    return bubblesData;\n  }\n\n  setAllBubblesFromApolloQuery(data: any, reset?: boolean ) {\n    const response = data.source;\n   // if ( !response || !response.entitiesData ) {return; }\n    this.allBubbles = [];\n\n    if ( data.selectedBubbles ) {\n      this.selectedBubbles = data.selectedBubbles;\n    }\n\n    if( response.entitiesData ) {\n      for (let i = 0 ; i < response.entitiesData.length; i++) {\n\n        let currentToE = response.entitiesData[i];\n\n        for ( var j = 0; j < currentToE.entitiesCountData.length; j++) {\n          this.allBubbles.push(\n            {\n              ...currentToE.entitiesCountData[j],\n              color: this.options.configKeys[currentToE.countData.type.configKey]['color']['hex']\n            });\n        }\n      }\n    }\n    else {\n      for ( let i = 0; i < response.connectedEntities.length; i++ ){\n        const color = this.options.configKeys ?\n          this.options.configKeys[response.connectedEntities[i].entity.typeOfEntity.configKey] ? this.options.configKeys[response.connectedEntities[i].entity.typeOfEntity.configKey]['color']['hex'] : \"\" :\n          null;\n        this.allBubbles.push(\n          {\n            id: this.convertEntityIdToBubbleId( response.connectedEntities[i].entity.id ),\n            ...response.connectedEntities[i],\n            color: color\n          });\n      }\n    }\n\n    this.entityBubbleIdMap = {};\n    this.allBubbles.forEach( (bubble) => {\n      // d3/svg does not allow Number as beginning of ID.\n      // d3/svg does not allow '-' as part of ID.\n      bubble.id = this.convertEntityIdToBubbleId(bubble.entity.id);\n      this.entityBubbleIdMap[bubble.id] = bubble.entity.id;\n      return bubble;\n    });\n    this.allBubbles.forEach( (bubble) => {\n      bubble.selected = false;\n      for( var i = 0; i < this.selectedBubbles.length; i++ ){\n        if ( this.selectedBubbles[i].id === bubble.id ) {\n          bubble.selected = true;\n        }\n      }\n    });\n\n    this.update(data);\n  }\n\n  private convertEntityIdToBubbleId(entityId: string): string {\n    if ( !entityId ) { return null; }\n    return ( 'B_' + entityId.replace(/-/g, '_') );\n  }\n\n  filterBubblesBasedOnFacetsEnabled() {\n    let result = this.allBubbles.filter(\n      (bubble) => {\n        for ( var i = 0; i < this.facetData.length; i++ ){\n          if ( bubble.entity.typeOfEntity.id === this.facetData[i].type.id ) {\n            if ( !this.facetData[i].enabled ) { return false; }\n          }\n        }\n        return true;\n      }\n    );\n    return result;\n  }\n\n  onBubbleMouseEnter(payload){\n    if ( !payload || !payload.bubble ) return;\n    const bubbleId = payload.bubble.id;\n    let hoverEntityId = this.entityBubbleIdMap[payload.bubble.id];\n    for (var i = 0; i < this.allBubbles.length; i++ ){\n      let bubble = this.allBubbles[i];\n      if ( bubble.entity.id===hoverEntityId ){\n        this.currentHoverEntity = bubble.entity;\n        this.currentHoverEntity.count = bubble.count;\n        break;\n      }\n    }\n    if(this.bubblePopup){\n      this.bubblePopup.hide();\n      this.bubblePopup.destroy();\n      this.bubblePopup = null;\n    }\n    setTimeout( () => {\n      let template = document.getElementById(\"bubble-popup-menu\");\n      let templateClone = template.cloneNode(true);\n      templateClone['style'].display = \"inline-block\";\n      this.bubblePopup = this.tippy(`#${bubbleId}`, {\n        content: templateClone,\n        allowHTML: true,\n        trigger: 'manual',\n        interactive: true,\n        arrow: true,\n        theme: 'light-border no-padding',\n        placement: 'top',\n        maxWidth: 500,\n        //onHidden: () => console.log('hidden'),\n      })[0];\n      setTimeout( () => { if(this.bubblePopup) this.bubblePopup.show() } , 800 );\n    });\n  }\n\n  destroyTooltip(){\n    if(this.bubblePopup){\n      this.bubblePopup.hide();\n      this.bubblePopup.destroy();\n      this.bubblePopup = null;\n    }\n  }\n\n  onBubbleTooltipClick(source:string, payload){\n    switch(source){\n      case 'select':\n        if(!payload) return;\n        const bubbleId = this.convertEntityIdToBubbleId(payload.entityId);\n        if(!bubbleId) return;\n        let bubble = null;\n        if(payload._bubbleChart){\n          payload._bubbleChart.selectAll(`g`).each( b => {\n            if(b.id===bubbleId) bubble=b;\n          });\n          if(bubble) return bubble;\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  public onBubbleSelected(bubble){\n    if(bubble){\n      if(!this.selectedBubbles.includes(bubble)){\n        if(this.selectedBubbles.length<this.maxBubblesSelectable){\n          this.selectedBubbles.push(bubble);\n          //return this.filterRequest();\n        }\n      }\n    }\n  }\n\n  public getBubbleFromId(id){\n    const bubbleId = this.convertEntityIdToBubbleId(id);\n    if(!bubbleId) return;\n    let bubble = null;\n    if(this._bubbleChart){\n      this._bubbleChart.selectAll(`g`).each( b => {\n        if(b.id===bubbleId) bubble=b;\n      });\n      if(bubble) return bubble;\n    }\n  }\n\n  getSelectedBubbles() {\n    return this.selectedBubbles;\n  }\n\n  getAllBubbles() {\n    return this.allBubbles;\n  }\n\n  getEntityIdMap() {\n    return this.entityBubbleIdMap;\n  }\n\n  setWindowResize() {\n    if( !this.windowResizeSet){\n      fromEvent( window , \"resize\" ).pipe(debounce(() => interval(200))).\n      subscribe( () => {\n        // only resets the bubbles if the window's width has changed\n        // (if the resize only effects the window's hight then the bubble chart\n        // doesn't get reset)\n          const container = document.getElementById(this.options.containerId);\n          let bubblePayload = {\n            width: container.offsetWidth,\n            reset: true\n          };\n          this.update(bubblePayload);\n        })\n        this.windowResizeSet = true;\n    }\n\n  }\n\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwHeroDS extends DataSource {\n  protected transform(data){\n    const { title, text, button, backgroundImage, input } = data;\n\n    return {\n      title,\n      text,\n      backgroundImage,\n      button: {\n        text: button.text,\n        payload: \"cerca\"\n      },\n      input: {\n        placeholder: input.placeholder,\n        payload: \"cerca-in-maxxi\"\n      }\n    };\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport { TABLE_MOCK } from '@n7-frontend/components';\n\nexport class AwTableDS extends DataSource {\n\n  protected transform(data){\n    return TABLE_MOCK;\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwHomeHeroPatrimonioDS extends DataSource {\n\n  protected transform(data) {\n    const { title, backgroundImage, image, text, button } = data;\n\n    return {\n      title,\n      backgroundImage,\n      image,\n      text,\n      button: {\n        text: button.text,\n        payload: \"naviga-patrimonio\"\n      }\n    };\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport { BUBBLECHART_MOCK } from '@n7-frontend/components';\n\nexport class AwHomeBubbleChartDS extends DataSource {\n\n  // threshold below which a bubble should not show its title\n  private thresholdShowTitle:number = 50;\n  // threshold below which a bubble should not show its number\n  private thresholdShowValue:number = 60;\n\n  protected transform(data){\n    if(!data) return null;\n    let bubbleCointainer = document.getElementById(\"bubble-chart-container\");\n    const cWidth = bubbleCointainer.offsetWidth;\n    // now the bubblechart's height is hardcoded to 700, not sure\n    // how it sould be actually set\n    // TODO: think of a good way to pass/compute cHeight\n    const cHeight = 700; // bubbleCointainer.offsetHeight\n\n    const containerSize = cWidth*cHeight;\n\n    // generic data of the bubble chart\n    let bubblesData = {\n      containerId: \"bubbleChartContainer\",\n      containerWidth : cWidth,\n      containerHeight : cHeight,\n      isForceSimulationEnabled: true,\n      maxBubblesSelected:3\n    };\n\n    // data about each single bubble (starts as [] and gets filled)\n    bubblesData['bubblesData'] = [];\n\n    // first loop over all the data's bubbles to gather various numbers, such\n    // as the maximum/minimum bubble value and number of selected bubbles\n    let maxBubbleValue=-1;\n    let minBubbleValue=-1;\n    let numOfBubbles=0;\n    let totalValues=0;\n    let numOfSelectedBubbles=0;\n    data.bubbles.forEach( bubble => {\n      if(maxBubbleValue<bubble.count) maxBubbleValue=bubble.count;\n      if(minBubbleValue<0 || minBubbleValue>bubble.count) minBubbleValue=bubble.count;\n      numOfBubbles++;\n      totalValues+=bubble.count;\n      if(bubble.selected) numOfSelectedBubbles++;\n    });\n\n    // second loop  over all the data's bubbles, for each bubble a corresponding object\n    // is created and addded to the bubblesData array\n    data.bubbles.forEach( bubble => {\n      let bId = bubble.id;\n      // here I compute the bubble's radius (could/should be improved), for it I compute a percentage of the bubble's value\n      // compared to all the bubbles and use that percentage to compute the bubble's radius\n      // Note : I also use the containerSize and the number of bubbles, ideally also the totValues and\n      //        numOfSelectedBubbles should be considered when computing the radius\n      //        (selected bubbles are in theory larger bubbles so taking that into account\n      //         could help for the radius computation)\n      // Note : the radius computation is very important, if the bubbles' radiuses are too big then\n      //        the bubbles will go one over the other and will not be able to move as they should, if\n      //        the rediuses are instead too small then the bubbles will be to small and conver only a\n      //        portion of the container\n      let bubblePercentage = ( bubble.count - (minBubbleValue/3) )/( (maxBubbleValue*3) - (minBubbleValue/3) );\n      //let bubbleRadius = 2*( ((containerSize/(numOfBubbles*(totalCount/600)))*bubblePercentage)/( Math.pow(numOfSelectedBubbles+1,1.8)) );\n      let bubbleRadius = (Math.log(containerSize)/10)*(bubblePercentage*3)*(70-Math.sqrt(numOfBubbles));\n\n      // creation of the bubbleData object\n      let bubbleData = {\n        id: bId,\n        texts: [\n          {\n            id:bId+\"_label0\",\n            label: (d) => { if(d.radius<this.thresholdShowTitle) return null; return bubble.entity.label },\n            x_function: (d) => d.x,\n            y_function: (d) => {\n              let mNum = (d.radius/9);\n              if(d.radius<this.thresholdShowValue) mNum=0;\n              return d.y-mNum;\n            },\n            \"user_select\":\"none\",\n            fontSize_function: (d) => d.radius/5,\n            color: \"white\",\n            \"classes\":\"\"\n          },\n          {\n            id:bId+\"_label1\",\n            label: (d) => { if(d.radius<this.thresholdShowValue) return null; return bubble.count },\n            x_function: (d) => d.x,\n            y_function: (d) => d.y+(d.radius/9),\n            \"user_select\":\"none\",\n            fontSize_function: (d) => d.radius/6,\n            color: \"white\",\n            \"classes\":\"\"\n        }\n        ],\n        x: cWidth/2+50,\n        y: cHeight/2+50,\n        \"radius\": bubbleRadius,\n        color:bubble.color,\n        hasCloseIcon: ( bubble.selected ? bubble.selected : false ),\n        payload:{\n          id: bId\n        },\n      };\n\n      bubblesData['bubblesData'].push(bubbleData);\n    });\n\n    // force simulation's parameters for the bubble chart\n    bubblesData['forceSimulationData'] = {\n      xPull: cWidth/2,\n      xPullStrength: -0.01,\n      yPull: cHeight/2,\n      yPullStrength: -0.01,\n      collisionStrengh: 0.99,\n      collisionIterations: 1,\n      velocityDecay: 0.65\n    }\n\n    if(data.reset) bubblesData['reset'] = data.reset;\n    if(data.setUpdateReference) bubblesData['setUpdateReference'] = data.setUpdateReference;\n    if(data.setBubbleChart) bubblesData['setBubbleChart'] = data.setBubbleChart;\n\n    return bubblesData;\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport tippy from \"tippy.js\";\n\nexport class AwHomeFacetsWrapperDS extends DataSource {\n\n  private autoComplete = {}\n\n  protected transform({ facetData, lockedFacets }) {\n    var headers: any[] = [];\n    var inputs: any[] = [];\n\n    facetData.forEach(facet => {\n      /*\n       For each facet on back-end, push a header-component\n       and a facet-component (search input only) to each array.\n       */\n      if (lockedFacets[facet.type.id.replace('toe-', '')]) {\n        // if bubble chart say lock this facet, lock it\n        facet.locked = true\n      } else {\n        facet.locked = false\n      }\n      let headerClasses = [];\n      let iconClasses = [facet.icon];\n      if (!facet.enabled) headerClasses.push('is-disabled');\n      if (facet.type.configKey) {\n        headerClasses.push(`color-${facet.type.configKey}`);\n        iconClasses.push(`color-${facet.type.configKey}`);\n      }\n      // make array of headers data\n      headers.push({\n        iconLeft: iconClasses.join(' '),\n        text: facet.label,\n        additionalText: facet.count,\n        iconRight: (facet.enabled ? 'n7-icon-eye' : 'n7-icon-eye-slash'),\n        classes: headerClasses.join(' ') + (\n          facet.locked ? ' is-blocked' : (\n            // if every other facet is disabled â Lock this facet\n            facetData.every(f => {\n              return !f.enabled || (f.type.id === facet.type.id)\n            }) ? ' is-blocked' : ' not-blocked')),\n        payload: facet.type.id,\n      });\n      // make array of inputs data\n      inputs.push({\n        sections: [{\n          inputs: [{\n            type: 'text',\n            placeholder: facet['input-placeholder'],\n            icon: 'n7-icon-search',\n            disabled: !facet.enabled,\n            inputPayload: String(facet.type.id) + '-search',\n            iconPayload: String(facet.type.id) + '-search',\n            enterPayload: String(facet.type.id) + '-search',\n            classes: String(facet.type.id) + '-search',\n          }]\n        }]\n      });\n    });\n    // zipping arrays to render widgets with separate data (see home-layout.html)\n    var widgetData: any[] = []\n    headers.map((h, i) => {\n      widgetData.push({ header: h, input: inputs[i] })\n    });\n    return widgetData\n  }\n\n  public tippyMaker = (res, id) => {\n    // create data for this facet\n    if (!this.autoComplete[id]) {\n      this.autoComplete[id] = {\n        // data: [],         // array of suggestions\n        template: undefined,\n        tippy: undefined, // tippy data / config\n        open: true,       // show or hide tippy\n      }\n      const ac = this.autoComplete[id]\n      if (!ac.tippy) {\n        const target = '.' + id; // target the correct this.autoComplete[id] input class\n        ac.tippy = tippy(target, {\n          content: '<span>Loading results</span>',\n          trigger: 'manual',\n          interactive: true,\n          arrow: false,\n          flip: false,\n          appendTo: 'parent',\n          theme: 'light-border aw-home__facet-tippy',\n          placement: 'bottom-start',\n          maxWidth: '100%',\n          onHidden: () => {\n            ac.open = false;\n          },\n          onShow: () => {\n            let node = document.getElementsByClassName('aw-simple-autocomplete__' + id.replace('-search', ''))[0]\n            // after I use this node, it becomes undefined\n            if (node) { // if I have the node, don't try to get it again\n              node.setAttribute('style', 'display: block');\n              ac.tippy.setContent(node);\n            }\n          },\n        })[0];\n      }\n    }\n\n    let ac = this.autoComplete[id]\n    if (res.totalCount > 0) {\n      ac.tippy.show()\n    } else {\n      ac.tippy.hide()\n    }\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwHomeItemTagsWrapperDS extends DataSource {\n\n  protected transform(data) {\n    return data;\n  }\n}","import { DataSource } from '@n7-frontend/core';\nimport { ADVANCED_AUTOCOMPLETE_MOCK } from '@n7-frontend/components';\n\nexport class AwHomeAutocompleteDS extends DataSource {\n\n  protected transform(data){\n\n    const { items, totalCount } = data,\n          { config } = this.options;\n\n    let itemIds = [],\n      groups = {};\n\n    items.forEach(({ item, typeOfEntity }) => {\n      if(!groups[typeOfEntity.id]) {\n        const { label, icon } = config[typeOfEntity.configKey];\n        groups[typeOfEntity.id] = {\n          title: label,\n          icon,\n          classes: `color-${typeOfEntity.configKey}`,\n          items: [],\n        };\n      }\n\n      if(itemIds.indexOf(item.id) === -1){\n        let metaDataValue: string = '';\n        item.info.forEach(infoData => {\n          if(infoData.key === 'author') metaDataValue = `di ${infoData.value}`;\n        });\n        groups[typeOfEntity.id].items.push({\n          label: item.label, \n          value: metaDataValue, \n          payload: { \n            source: 'item',\n            id: item.id \n          }\n        });\n      }\n    });\n\n    const results = Object.keys(groups).map(key => ({ group: {...groups[key]} }));\n    return { \n      results,\n      actions: {\n        showMore: {\n          text: `Visualizza tutti i ${totalCount} risultati`,\n          payload: { \n            source: 'showMore' \n          }\n        }\n      },\n      fallback: 'Spiacenti, non Ã¨ stato trovato nessun risultato. <br> Riprova con una nuova ricerca.'\n    };\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwEntitaNavDS extends DataSource {\n\n  protected transform( param ){\n    if (!param) return;\n\n    const data = param.data\n    const selected = param.selected\n    const navigation = { items: [], payload: 'entita-nav' }\n\n    navigation.items.push({\n      text: 'OVERVIEW',\n      payload: 'overview',\n      classes: selected == 'overview' ? 'is-selected' : ''\n    })\n    if (data.fieldsTab) {\n      navigation.items.push({\n        text: 'CAMPI',\n        payload: 'campi',\n        classes: selected == 'campi' ? 'is-selected' : ''\n      })\n    }\n    if (data.items) {\n      navigation.items.push({\n        text: 'OGGETTI-COLLEGATI',\n        payload: 'oggetti-collegati',\n        classes: selected == 'oggetti-collegati' ? 'is-selected' : ''\n      })    }\n    if (data.entities && this.options['bubblesEnabled']) {\n      navigation.items.push({\n        text: 'ENTITÃ COLLEGATE',\n        payload: 'entita-collegate',\n        classes: selected == 'entita-collegate' ? 'is-selected' : ''\n      })    }\n    if (data.extraTab) {\n      navigation.items.push({\n        text: 'MAXXI',\n        payload: 'maxxi',\n        classes: selected == 'maxxi' ? 'is-selected' : ''\n      })    }\n    if (data.wikiTab) {\n      navigation.items.push({\n        text: 'WIKIPEDIA',\n        payload: 'wiki',\n        classes: selected == 'wiki' ? 'is-selected' : ''\n      })    }\n    return navigation\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwEntitaMetadataViewerDS extends DataSource {\n\n  protected transform(data){\n    /*\n      // console.log('metadata options: ', this.options);\n      - - -\n      Access and use this.options if the rendering \n      changes based on context.\n    */\n   \n    return {\n      group: AwEntitaMetadataViewerDS.unpackFields(data),\n    }\n  }\n\n  static unpackFields( fields ) {\n    /*\n      Recursive unpacking for rendering res.fields\n      - - -\n      This function transforms the response object tree\n      into an array, usable by metadata-viewer-component\n    */\n    var extracted = []     // holds transformed object\n    if (!fields) return [] // if is empty â quit\n    for ( let i = 0; i < fields.length; i++ ) {\n      var thisField = fields[i]     // rename current field\n      var title = thisField.label   // field title\n      var label = thisField.key     // item label\n      var value = thisField.value   // item value\n      var group = thisField.fields  // child group\n      var temp:any = {}             // temporary object\n\n      if (title) { // if there is a title, use it\n        temp.title = title\n      } if (label && value) { // if there are a lable and value, use them\n        temp.label = label\n        temp.value = value\n      } if (group) { // if there is a child group\n        if (group[0].key) { // if this group has a tuple of (label, value)\n          temp.items = AwEntitaMetadataViewerDS.unpackFields(group) // make items array\n        } else {\n          temp.group = AwEntitaMetadataViewerDS.unpackFields(group) // make child group array\n        }\n      }\n      extracted.push(temp) // add this object to the new array\n    }\n    return extracted\n  }\n\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwTreeDS extends DataSource {\n\n  public currentItem: string;\n\n  toggleNav() {\n\n  }\n\n  protected transform(data) {\n    return data;\n  }\n\n  updateTree(data, parents, id){\n    if ( !data ) {\n      data = this.output;\n    }\n    data.items.forEach( (it) => {\n      const classes = it['classes'];\n      if( it['_meta'] == id ) {\n        if ( classes.indexOf('is-expanded') > -1 ) {\n          it['classes'] = classes.replace(/is-expanded/g, 'is-collapsed');\n          if ( it['toggle'] ){\n            it['toggle']['icon'] = 'n7-icon-angle-right';\n          }\n        } else {\n          it['classes'] = classes.replace(/is-collapsed/g, 'is-expanded');\n          if ( it['toggle'] ){\n            it['toggle']['icon'] = 'n7-icon-angle-down';\n          }\n        }\n      } else if ( parents.indexOf( it['_meta'] ) >= 0 ) {\n          it['classes'] = classes + ' is-expanded';\n      }\n      if( typeof it['items'] != 'undefined' && it['items'].length > 0 ) {\n        this.updateTree(it, parents, id);\n      }\n    });\n    this.update(data);\n  }\n\n  selectTreeItem(id, data){\n    if ( !data ) {\n      data = this.output;\n    }\n\n    data.items.forEach( (it) => {\n        if ( it['_meta'] == id && it['classes'].indexOf('is-active') < 0 ) {\n            it['classes'] = it['classes'] + ' is-active';\n            this.currentItem = it;\n        } else {\n          const classes = it['classes'];\n          it['classes'] = classes.replace(\"is-active\", \"\");\n        }\n        if( typeof it['items'] != \"undefined\" && it['items'].length > 0 ) {\n          this.selectTreeItem(id, it);\n        }\n    });\n    this.update(data);\n  }\n\n  toggleSidebar() {\n    let sidebarData = this.output;\n    if ( sidebarData.classes == \"is-expanded\" ) {\n      sidebarData.classes = \"is-collapsed\";\n    } else {\n        sidebarData.classes = \"is-expanded\";\n    }\n    this.update(sidebarData);\n  }\n\n  private parseData(data) {\n    let treeObj = {\n      items: []\n    };\n    if( data['branches']) {\n      data['branches'].forEach( item => {\n        treeObj['items'].push( this.parseTree(item, false, []) );\n      });\n    }\n    this.update(treeObj);\n  }\n\n  private parseTree(data, toggle, parents) {\n    var currParents = [...parents];\n    let treeItem = {};\n    const showToggle =  toggle && data['branches'] != null;\n    if( showToggle ){\n      treeItem['toggle'] = {\n        icon: 'n7-icon-angle-right',\n        payload: {\n            source: \"toggle\",\n            id: data['id'],\n            parents: currParents,\n          }\n      }\n    }\n    Object.keys(data).forEach( key => {\n    if( key != \"branches\" ) {\n      switch (key) {\n        case \"label\": treeItem['text'] = data[key]; break;\n        case \"img\" : treeItem['img'] = data[key]; break;\n        case \"icon\" :\n            if (showToggle && data[key] != null){\n              treeItem['toggle']['icon'] = data[key];\n            } else {\n              treeItem['icon'] = data[key];\n            }\n            break;\n        case \"id\" :\n            treeItem['_meta'] =  data[key];\n            treeItem['payload'] = {\n              source: \"menuItem\",\n              id: data['id']\n            };\n            break;\n        default :  data[key]; break;\n      }\n      treeItem['classes'] = 'is-collapsed';\n    }\n    else if( data['branches'] != null ) {\n      currParents.push(data['id']);\n\n      /*Handle cases with menu item with children but without toggle*/\n      if( !toggle ) {\n        treeItem['payload']['source'] = \"ToggleMenuItem\";\n        treeItem['payload']['parents'] = currParents;\n      }\n\n      treeItem['items'] = [];\n      data[key].forEach( item => {\n        treeItem['items'].push( this.parseTree(item, true, currParents) );\n      })\n    }\n    })\n    return treeItem;\n  }\n\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSidebarHeaderDS extends DataSource {\n\n  protected transform(data) {\n    return data;\n  }\n\n  toggleSidebar() {\n      let sidebarData = this.output;\n      if ( sidebarData.classes == 'is-expanded' ) {\n        sidebarData.classes = 'is-collapsed';\n        sidebarData.iconRight = 'n7-icon-tree-icon';\n\n      } else {\n        sidebarData.classes = 'is-expanded';\n        sidebarData.iconRight = 'n7-icon-angle-left';\n    }\n    this.update(sidebarData);\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSchedaBreadcrumbsDS extends DataSource {\n\n  protected transform(data) {  \n    return data;\n  }\n\n  toggleSidebar() {\n      let sidebarData = this.output;    \n      if ( sidebarData.classes == \"is-expanded\" ) {\n        sidebarData.classes = \"is-collapsed\";\n    } else {\n        sidebarData.classes = \"is-expanded\";\n    }\n    this.update(sidebarData);\n  }\n}","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSchedaMetadataDS extends DataSource {\n\n  protected transform(data) {\n    return data;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSchedaImageDS extends DataSource {\n\n  protected transform(data) {\n    return data;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSchedaInnerTitleDS extends DataSource {\n\n  protected transform(data) {\n    return data;\n  }\n}\n","import { DataSource } from '@n7-frontend/core';\n\nexport class AwSearchLayoutTabsDS extends DataSource {\n  private selected: string = 'list';\n\n  protected transform(data){\n    return { \n      items: [{\n        text: 'LISTA', \n        payload: 'list',\n        classes: this.selected === 'list' ? 'is-selected' : ''\n      }, {\n        text: 'GRAFICO', \n        payload: 'chart',\n        classes: this.selected === 'chart' ? 'is-selected' : ''\n      }, {\n        text: 'TIMELINE', \n        payload: 'timeline',\n        classes: this.selected === 'timeline' ? 'is-selected' : ''\n      }] \n    }\n  }\n\n  public setSelected(tabId){\n    this.selected = tabId;\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwLinkedObjectsEH extends EventHandler {\n\n  public listen() {\n\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-linked-objects.click':\n          if (payload.startsWith('page')) {\n            // pagination routing is handled by the parent layout\n            this.emitOuter('pagination', payload)\n          } else if (payload.startsWith('goto')) {\n            let targetPage = Number(payload.replace('goto-', ''))\n            // kill impossible page navigations\n            if ( targetPage > this.dataSource.totalPages ) return;\n            else if ( targetPage < 1 || targetPage === this.dataSource.currentPage ) return;\n            else this.emitOuter('goto', payload)\n          } else {\n            // navigate to the patrimonio page of this item\n            this.emitGlobal('navigate', {\n              handler: 'router',\n              path: [`aw/patrimonio/${payload}`]\n            });\n          }\n          break;\n        case 'aw-linked-objects.change':\n          this.emitOuter('change', Number(payload.value))\n          break;\n          default:\n            console.warn('unhandled event type: ', type, ' with payload: ', payload)\n            break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-home-layout.viewmore':\n          // this.dataSource.handleShowMoreClick()\n          console.log('current page: ', this.dataSource.currentPage)\n          break;\n        default:\n          break;\n      }\n    })\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwAutocompleteWrapperEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({type, payload}) => {\n      switch(type) {\n        // case 'your-event.click':\n        //   // do something\n        //   break;\n        default:\n          console.warn('unhandled event of type:', type)\n          break;\n      }\n    });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwBubbleChartEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(event => {\n      switch (event.type) {\n        case 'aw-bubble-chart.init':\n          break;\n        case 'aw-bubble-chart.click':\n          event.payload.entityIdmap = this.dataSource.getEntityIdMap();\n          event.payload.allBubbles = this.dataSource.getAllBubbles();\n          this.emitOuter('click', event.payload);\n          break;\n        case 'aw-bubble-chart.mouse_enter':\n          const currBubble = this.dataSource.onBubbleMouseEnter(\n            {\n              bubblePayload:event.payload.bubblePayload,\n              bubble:event.payload.bubble\n            });\n          event.payload.currBubble = currBubble;\n          this.emitOuter('mouse_enter', event.payload);\n          break;\n        case 'aw-bubble-chart.mouse_leave':\n         /*   this.dataSource.onBubbleMouseLeave(\n              {\n                bubblePayload:event.payload.bubblePayload,\n                bubble:event.payload.bubble\n              });*/\n          this.emitOuter('mouse_leave', event.payload);\n          break;\n          case \"aw-bubble-chart.bubble-tooltip-close-click\":\n            this.emitOuter('bubble-tooltip-close-click', event.payload);\n            break;\n        case \"aw-bubble-chart.bubble-tooltip-goto-click\":\n          this.emitOuter('bubble-tooltip-goto-click', event.payload);\n            break;\n        case \"aw-bubble-chart.bubble-tooltip-select-click\":\n          this.emitOuter('bubble-tooltip-select-click', event.payload);\n            break;\n        default:\n          console.warn('unhandled inner event of type', event.type)\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case \"aw-home-layout.bubble-tooltip-select-click\":\n              let selectData = {\n                'bubble': this.dataSource.onBubbleTooltipClick('select',payload),\n                'entityIdmap': this.dataSource.getEntityIdMap(),\n                'allBubbles': this.dataSource.getAllBubbles(),\n                'source': 'bubble'\n              };\n              this.emitOuter('click', selectData);\n              break;\n        case 'aw-home-layout.bubble-filter':\n          this.emitOuter('bubble-filtered',\n          {\n            'allBubbles': this.dataSource.getAllBubbles(),\n            'selected': this.dataSource.getSelectedBubbles()\n          });\n          break;\n        case 'aw-scheda-layout.filterbubbleresponse':\n        case 'aw-entita-layout.filterbubbleresponse':\n        case 'aw-home-layout.filterbubbleresponse':\n          if( payload.source ){\n            this.dataSource.setAllBubblesFromApolloQuery(payload);\n            this.emitOuter('bubble-filtered',\n            {\n              'allBubbles': this.dataSource.getAllBubbles(),\n              'selected': this.dataSource.getSelectedBubbles(),\n              'entityIdmap': this.dataSource.getEntityIdMap()\n            });\n          } else {\n            this.dataSource.update(payload);\n          }\n          break;\n      }\n    });\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHeroEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-hero.click':\n          // TODO\n          break;\n\n        case 'aw-hero.change':\n          this.emitOuter('change', payload);\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHomeBubbleChartEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(event => {\n      switch (event.type) {\n        case 'aw-home-bubble-chart.click':\n          this.emitOuter('click',event.payload);\n          break;\n        case 'aw-home-bubble-chart.mouse_enter':\n          this.emitOuter('mouse_enter',event.payload);\n          break;\n        case 'aw-home-bubble-chart.mouse_leave':\n          this.emitOuter('mouse_leave',event.payload);\n          break;\n        default:\n          break;\n      }\n    });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHomeFacetsWrapperEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        // toggle visibility from facet header\n        case 'aw-home-facets-wrapper.click':\n          this.emitOuter('click', payload);\n          break;\n        // change search input text\n        case 'aw-home-facets-wrapper.change':\n          this.emitOuter('change', payload);\n          break;\n        // press return while typing in search\n        case 'aw-home-facets-wrapper.enter':\n          this.emitOuter('enter', payload);\n        default:\n          console.warn('unhandled inner event of type:', type)\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-home-layout.facetswrapperresponse':\n          this.dataSource.tippyMaker(payload.response, payload.facetId.inputPayload)\n          break;\n        case 'aw-home-layout.filterbubbleresponse':\n          // console.log({type, payload})\n          break;\n        default:\n          // console.warn('unhandled outer event of type', type)\n          // silent ignore\n          break;\n      }\n    });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHomeHeroPatrimonioEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-home-hero-patrimonio.click':\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: ['aw/patrimonio']\n          });\n          break;\n        default:\n          break;\n      }\n    });\n    /*\n    this.outerEvents$.subscribe(event => {\n      \n    });\n    */\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHomeItemTagsWrapperEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe( (event) => {\n      switch(event.type){\n        case \"aw-home-item-tags-wrapper.click\":\n          this.emitOuter('click',event.payload);\n          break;\n        default:\n          break;\n      }\n    });\n    /* this.outerEvents$.subscribe(event => {\n    \n    }); */\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwHomeAutocompleteEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch(type){\n        case \"aw-home-autocomplete.click\":\n          if(payload && payload.source === 'item') this.emitOuter('click', payload);\n          break;\n          \n        default:\n          break;\n      }\n    });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwEntitaNavEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({type, payload}) => {\n      switch(type) {\n        case 'aw-entita-nav.click':\n          this.emitOuter('click', payload)\n          break;\n        default:\n          console.warn('unhandled event type')\n          break;\n      }\n    });\n    /*\n\n    this.outerEvents$.subscribe(event => {\n      \n    });\n    */\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwSchedaSidebarEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {   \n      if( type == 'aw-sidebar-header.click'){\n        this.dataSource.toggleSidebar();\n        this.emitOuter(type, payload);\n      }\n    });\n\n    /* this.outerEvents$.subscribe(event => {\n    \n    }); */\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwSidebarHeaderEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {   \n      if( type == 'aw-sidebar-header.click'){\n        this.dataSource.toggleSidebar();\n        this.emitOuter('click', payload);\n      }\n    });\n\n    /* this.outerEvents$.subscribe(event => {\n    \n    }); */\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwTreeEH extends EventHandler {\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      if(payload && typeof payload.source != 'undefined'){\n        switch ( payload.source ) {\n          case 'toggle':         this.dataSource.updateTree( null, payload.parents, payload.id ); break;\n          case 'ToggleMenuItem': this.dataSource.updateTree( null, payload.parents, payload.id ); //no break, I want to execute also the following instruction\n          case 'menuItem':       this.dataSource.selectTreeItem( payload.id );\n                                 this.emitOuter('click', payload.id);\n                                  break;\n        }\n      }\n    });\n\n     this.outerEvents$.subscribe(({ type, payload }) => {\n        switch( type ){\n          case 'aw-sidebar-header.click': this.dataSource.toggleSidebar(); break;\n          case 'aw-scheda-layout.selectItem':\n            this.dataSource.selectTreeItem( payload );\n            this.dataSource.updateTree( null, this.dataSource.currentItem.payload.parents, payload ); break;\n          case 'aw-scheda-layout.navigationresponse':\n            this.dataSource.parseData(payload); break;\n          }\n      });\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwSearchLayoutTabsEH extends EventHandler {\n\n  public listen() {\n    // TODO\n  }\n\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwTableEH extends EventHandler {\n\n  public listen() {\n    /*\n    this.innerEvents$.subscribe(event => {\n      \n    });\n\n    this.outerEvents$.subscribe(event => {\n      \n    });\n    */\n  }\n\n}","import { AwAboutLayoutDS } from './about-layout.ds';\nimport { AwAboutLayoutEH } from './about-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const AwAboutLayoutConfig = {\n  layoutId: 'aw-about-layout',\n  widgets: [],\n  layoutDS: AwAboutLayoutDS,\n  layoutEH: AwAboutLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  layoutOptions: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { AbstractLayout } from '../../../common/models/abstract-layout';\nimport { AwAboutLayoutConfig as config } from './about-layout.config';\n\n@Component({\n  selector: 'aw-about-layout',\n  templateUrl: './about-layout.html'\n})\nexport class AwAboutLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n  ){\n    super(config);\n  }\n\n  ngOnInit(){\n    this.onInit();\n  }\n\n  ngOnDestroy(){\n    this.onDestroy();\n  }\n\n}","import { LayoutDataSource } from '@n7-frontend/core';\n\nexport class AwEntitaLayoutDS extends LayoutDataSource {\n  protected configuration: any;\n  protected mainState: any;\n  protected router: any;\n  protected titleService: any;\n\n  public options: any;\n  public pageTitle: string;\n\n  public myResponse: any = {}; // backend response object\n  public selectedTab: string; // selected nav item\n  public navHeader: any = {}; // nav-header (custom) data\n  public currentId: string; // selected entity (url param)\n  public currentPage: any; // pagination value (url param)\n  public pageSize: number = 10; // linked objects page size\n  public bubblesEnabled: boolean;\n\n  private communication: any;\n\n  onInit({ configuration, mainState, router, options, titleService, communication }) {\n    this.communication = communication;\n    this.configuration = configuration;\n    this.mainState = mainState;\n    this.options = options;\n    this.router = router;\n    this.titleService = titleService;\n    this.bubblesEnabled = this.configuration.get('features-enabled') ? this.configuration.get('features-enabled')['bubblechart'] : false;\n\n  }\n\n  getNavigation(id) {\n    /*\n      Requests data from communication provider\n     */\n    return this.communication.request$('getEntityDetails', {\n      onError: (error) => console.error(error),\n      params: { entityId: id }\n    })\n  }\n\n  handleNavUpdate = tab => {\n    /*\n      Updates selected tab on tab change\n    */\n    this.selectedTab = tab\n    this.updateWidgets(this.myResponse)\n  }\n\n  updateWidgets(data) {\n    /*\n      Updates the widgets on this layout, based on route\n    */\n    const selected = this.selectedTab\n    this.one('aw-entita-nav').update({ data, selected })\n  }\n\n  loadItem(id, tab) {\n    /*\n      Loads the data for the selected nav item, into the adjacent text block.\n    */\n    if (id && tab) {\n      this.currentId = id // store selected item from url\n      this.selectedTab = tab // store selected tab from url\n      return this.communication.request$('getEntityDetails', {\n        onError: error => console.error(error),\n        params: { entityId: id }\n      })\n    }\n    else {\n      this.pageTitle = 'EntitÃ  Test'\n    }\n  }\n\n  loadContent(res) {\n    console.log('Apollo responded with: ', { res })\n    this.myResponse = res\n    this.navHeader = { // always render nav header\n      icon: this.configuration.get('config-keys')[this.myResponse.entity.typeOfEntity.configKey].icon,\n      text: this.myResponse.entity.label,\n      color: this.myResponse.entity.typeOfEntity.configKey\n    }\n\n    this.one('aw-entita-nav').updateOptions({bubblesEnabled: this.bubblesEnabled});\n\n    switch (this.selectedTab) { // make dynamic content depending on request\n      case 'overview': {\n        this.one('aw-bubble-chart').updateOptions({\n          context: 'scheda',\n          configKeys: this.configuration.get('config-keys'),\n          bubbleContainerId: 'overviewBubbleChartContainer',\n          containerId: 'bubble-chart-container-overview',\n        });\n        this.one('aw-entita-metadata-viewer').updateOptions({ context: this.selectedTab });\n        this.one('aw-entita-metadata-viewer').update(res.fieldsTab);\n        this.one('aw-linked-objects').updateOptions({ size: 3, config: this.configuration, context: 'entita' })\n        this.one('aw-linked-objects').update(res);\n      } break;\n\n      case 'campi': {\n        this.one('aw-entita-metadata-viewer').updateOptions({ context: this.selectedTab });\n        this.one('aw-entita-metadata-viewer').update(res.fieldsTab);\n      } break;\n\n      case 'oggetti-collegati': {\n        this.one('aw-linked-objects').updateOptions({\n          context: this.selectedTab,\n          config: this.configuration,\n          page: this.currentPage,\n          size: this.pageSize,\n        })\n        this.one('aw-linked-objects').update(res);\n      } break;\n\n      case 'entita-collegate': {\n        this.one('aw-bubble-chart').updateOptions({\n          context: 'scheda',\n          configKeys: this.configuration.get('config-keys'),\n          bubbleContainerId: 'bubbleChartContainer',\n          containerId: 'bubble-chart-container',\n        });\n      } break;\n\n      case 'maxxi': {\n        // maxxi\n      } break;\n\n      case 'wiki': {\n        // wiki\n      } break;\n\n      default:\n        // the url is aw/entita/something/ ??? â unknown\n        console.warn('Unhandled navigation page');\n        break;\n    }\n  }\n}","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\n\nexport class AwEntitaLayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n  private configuration: any;\n  private route: any;\n  private entityId: string;\n  // private selectedTab: string;\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-entita-layout.init':\n          this.dataSource.onInit(payload);\n          this.configuration = payload.configuration;\n          this.route = payload.route;\n          this.entityId = this.route.snapshot.params.id || \"\";\n          this.dataSource.currentPage = this.route.snapshot.params.page || '';\n          this.listenRoute();\n          this.loadNavigation(this.entityId);\n          break;\n\n        case 'aw-entita-layout.destroy':\n          this.destroyed$.next();\n          break;\n\n        case 'aw-entita-layout.showmore':\n          if (payload) {\n            this.emitGlobal('navigate', {\n              path: [\n                this.configuration.get(\"paths\").entitaBasePath\n                + '/' +\n                this.entityId\n                + '/' +\n                payload\n              ],\n              handler: 'router'\n            });\n          }\n          break;\n\n        default:\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-entita-nav.click':\n          if (payload) {\n            this.dataSource.selectedTab = payload;\n            this.dataSource.handleNavUpdate( payload )\n            this.emitGlobal('navigate', {\n              path: [\n                this.configuration.get(\"paths\").entitaBasePath\n                + '/' +\n                this.entityId\n                + '/' +\n                payload\n              ],\n              handler: 'router'\n            });\n          }\n          break\n        case 'aw-linked-objects.pagination':\n          this.dataSource.currentPage = payload.split('-')[1]\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [`aw/entita/${this.route.snapshot.params.id}/oggetti-collegati/${payload.split('-')[1]}`]\n          });\n          break\n        case 'aw-linked-objects.goto':\n          let targetPage = Number(payload.replace('goto-', ''))\n          // this.emitGlobal('navigate', {\n          //   handler: 'router',\n          //   path: [`aw/entita/${this.route.snapshot.params.id}/oggetti-collegati/${targetPage}`]\n          // });\n          break\n        case 'aw-linked-objects.change':\n          this.dataSource.pageSize = payload;\n          this.listenRoute() // reloads the page content with the new page size\n        case \"aw-bubble-chart.bubble-tooltip-goto-click\":\n            if(!payload || !payload.entityId) return;\n            this.emitGlobal('navigate', {\n              handler: 'router',\n              path: [`aw/entita/${payload.entityId}/overview`]\n            });\n          break;\n        default:\n          break;\n      }\n    })\n\n  }\n\n  private listenRoute() {\n    /**\n     * Listens to routing events of this layout.\n     */\n    // get URL parameters with angular's paramMap\n    this.route.paramMap.subscribe(params => {\n      // look for id\n      if (params.get('id')) {\n        // get item from response with id === id and return as promise\n        this.dataSource.loadItem(params.get('id'), params.get('tab')).subscribe((res) => {\n          if (res) {\n            this.dataSource.loadContent(res);\n            res['connectedEntities'] =res.entities\n            let connectedEntities = {source: res};\n            if (this.dataSource.bubblesEnabled && params.get('tab') === 'entita-collegate') {\n              this.emitOuter('filterbubbleresponse', connectedEntities);\n            }\n          }\n        });\n      } else {\n        this.dataSource.loadItem();\n      }\n    });\n  }\n\n  private loadNavigation(selectedItem) {\n    console.log('LOAD NAVIGATION')\n    this.dataSource.getNavigation(selectedItem).subscribe((response) => {\n      if (response) {\n        this.dataSource.updateWidgets(response);\n      }\n      if (selectedItem) {\n        this.emitOuter('selectItem', selectedItem);\n      }\n    });\n  }\n\n}","import { AwEntitaLayoutDS } from './entita-layout.ds';\nimport { AwEntitaLayoutEH } from './entita-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const AwEntitaLayoutConfig = {\n  layoutId: 'aw-entita-layout',\n  widgets: [ // array of components of this layout\n    { id: 'aw-entita-nav', hasStaticData: true},\n    { id: 'aw-entita-metadata-viewer' },\n    { id: 'aw-linked-objects'},\n    { id: 'aw-bubble-chart'},\n  ],\n  layoutDS: AwEntitaLayoutDS,\n  layoutEH: AwEntitaLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { Title } from '@angular/platform-browser';\nimport { AbstractLayout } from \"../../../common/models/abstract-layout\";\nimport { ConfigurationService } from '../../../common/services/configuration.service';\nimport { LayoutsConfigurationService } from '../../../common/services/layouts-configuration.service';\nimport { MainStateService } from '../../../common/services';\nimport { AwEntitaLayoutConfig as config } from './entita-layout.config';\nimport { CommunicationService } from '../../../common/services';\n\n@Component({\n  selector: 'aw-entita-layout',\n  templateUrl: './entita-layout.html'\n})\nexport class AwEntitaLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private configuration: ConfigurationService,\n    private layoutsConfiguration: LayoutsConfigurationService,\n    private communication: CommunicationService,\n    private mainState: MainStateService,\n    private titleService: Title\n  ) {\n    super(layoutsConfiguration.get('AwEntitaLayoutConfig') || config);\n  }\n\n  /*\n    Optional variables that can be accessed from the layout's logic.\n    If removed, they must also be removed from the layout's DataSource file,\n    and from this file imports.\n   */\n  protected initPayload() {\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      router: this.router,\n      route: this.route,\n      titleService: this.titleService,\n      communication: this.communication,\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit() {\n    this.onInit();\n  }\n\n  ngOnDestroy() {\n    this.onDestroy();\n  }\n}","import { LayoutDataSource } from '@n7-frontend/core';\nimport { fromEvent, Subject } from 'rxjs';\nimport { debounce, debounceTime } from 'rxjs/operators';\n\nexport class AwHomeLayoutDS extends LayoutDataSource {\n  private communication: any;\n  private mainState: any;\n  private tippy: any;\n  private configuration: any;\n  private facetData: any[] = null;\n  private lockedFacets = {};\n  private facetInputs: any = {};\n  // all the bubbles as they have been given by apollo\n  // (the objects in the allBubbles are not the same bubble objects\n  // present in the bubble chart)\n  private allBubbles: any[] = null;\n  private autocompletePopover: any;\n  private autocompletePopoverOpen: boolean = false;\n  private autocompleteChanged$: Subject<string> = new Subject();\n  // the bubbles currently selected (this are saved from the event handler's\n  // and correspond exactly to the bubblechart's bubble objects)\n  public selectedBubbles: any[] = [];\n  public numOfItemsStr: string = null;\n  // instance of the bubble chart (from which you can access all the various\n  // bubble objects)\n  private _bubbleChart: any = null;\n  // the maximum number of bubbles which can be selected at the same time\n  private maxBubblesSelectable: number = 3;\n  // entities have their own unique id, these ids are generic and are very flexible\n  // bubbles (as the bubble chart's objects) have unique ids but do not allow certain\n  // characters, so each bubble has its own id different from the id of the entity which\n  // the bubble represents (given an bubble's id called bubbleId you can obtain the\n  // respective entity's id with as: entityId = entityBubbleIdMap[bubbleId] )\n  private entityBubbleIdMap: any = {};\n  // widh of the window which is updated at each resize and it is used by the bubble\n  // chart to check if the width of the window has changed during the last resize\n  private lastWindowWidth: number = -1;\n  private bubblePopup: any = null;\n  public currentHoverEntity: any = null;\n  public hasScrollBackground: boolean = false;\n  public loadingBubbles = false;\n  public bubblesEnabled = false;\n\n  onInit({ communication, mainState, configuration, tippy }) {\n    this.communication = communication;\n    this.configuration = configuration;\n    this.facetData = [];\n    this.lastWindowWidth = window.outerWidth;\n    this.mainState = mainState;\n    this.tippy = tippy;\n    this.bubblesEnabled = this.configuration.get('features-enabled') ? this.configuration.get('features-enabled')['bubblechart'] : false;\n\n    this.one('aw-hero').update(this.configuration.get('home-layout')['top-hero']);\n    this.one('aw-home-hero-patrimonio').update(this.configuration.get('home-layout')['bottom-hero']);\n    // update streams\n    this.mainState.update('headTitle', 'Arianna Web > Home');\n    this.mainState.update('pageTitle', 'Arianna Web: Home Layout');\n    this.mainState.updateCustom('currentNav', 'aw/home');\n    // listen autocomplete changes\n    this._listenAutoCompleteChanges();\n  }\n\n  public makeRequest$(query, params) {\n    return this.communication.request$(query, {\n      onError: (error) => console.error(error),\n      params\n    });\n  }\n\n  public updateComponent = (id, data, options) => {\n    if (options) {\n      this.one(id).updateOptions(options)\n    }\n    this.one(id).update(data)\n  }\n\n  initialFilterRequest() {\n    return this.communication.request$('globalFilter', {\n      onError: (error) => console.error(error),\n    })\n  }\n\n  parseInitialRequest(response) {\n    response.entitiesData.forEach((ent) => {\n      const teoConfigData = this.configuration.get(\"config-keys\")[ent.countData.type.configKey];\n      if (teoConfigData)\n        this.facetData.push({\n          ...ent.countData,\n          ...teoConfigData,\n          enabled: true,\n        });\n    });\n    this.one('aw-home-facets-wrapper').update({\n      facetData: this.facetData,\n      lockedFacets: this.lockedFacets\n    });\n    this.one('aw-bubble-chart').updateOptions({\n      context: 'home',\n      configKeys: this.configuration.get(\"config-keys\"),\n      bubbleContainerId: 'bubbleChartContainer',\n      containerId: 'bubble-chart-container',\n    });\n    this.renderPreviewsFromApolloQuery(response);\n  }\n\n  renderPreviewsFromApolloQuery(response: any) {\n    if (!response || !response.itemsPagination) {\n      return\n    };\n    let numOfItems = response.itemsPagination.totalCount;\n    if (numOfItems > 0) {\n      let numOfThousand = 0;\n      while (numOfItems > 999) {\n        numOfItems -= 1000;\n        numOfThousand += 1;\n      }\n      let numOfItemsTmpStr = numOfItems + '';\n      if (numOfItems < 10) numOfItemsTmpStr = '00' + numOfItems;\n      else if (numOfItems < 100) numOfItemsTmpStr = '0' + numOfItems;\n      if (numOfThousand > 0)\n        this.numOfItemsStr = numOfThousand + '.' + numOfItemsTmpStr;\n      else\n        this.numOfItemsStr = numOfItems + '';\n    } else {\n      this.numOfItemsStr = null;\n    }\n    this.one('aw-linked-objects').updateOptions({\n      context: 'home',\n      config: this.configuration,\n      // page: 1,\n    })\n    this.one('aw-linked-objects').update(response.itemsPagination);\n  }\n\n  onBubbleTooltipClick(source: string, payload) {\n    switch (source) {\n      case 'select':\n        if (!payload) return;\n        const bubbleId = payload.bubbleId;\n        if (!bubbleId) return;\n        let bubble = null;\n        if (this._bubbleChart) {\n          this._bubbleChart.selectAll(`g`).each(b => {\n            if (b.id === bubbleId) bubble = b;\n          });\n          if (bubble) this.onBubbleSelected(bubble);\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  public onBubbleSelected(bubble) {\n    if (bubble) {\n      if (!this.selectedBubbles.includes(bubble)) {\n        if (this.selectedBubbles.length < this.maxBubblesSelectable) {\n          this.loadingBubbles = this.selectedBubbles.length == 0;\n          this.selectedBubbles.push(bubble);\n          return true;\n        }\n      }\n    }\n    return null;\n  }\n\n  public onBubbleDeselected(payload) {\n    if (payload && payload.bubble) {\n      this.selectedBubbles = this.selectedBubbles.filter(\n        (b) => b.id !== payload.bubble.id);\n      if (payload.bubble.hasCloseIcon) {\n        payload.bubble.hasCloseIcon = false;\n        return this.filterRequest();\n      }\n    }\n  }\n\n  public getBubblePayload(response) {\n    let bubblePayolad = {\n      reset: true,\n      setBubbleChart: (bubbleCref) => this._bubbleChart = bubbleCref,\n      facetData: this.facetData,\n      source: response,\n      selectedBubbles: this.selectedBubbles\n    };\n    return bubblePayolad;\n  }\n\n  private filterRequest() {\n    let selectedEntitiesIds = [];\n    if (this.entityBubbleIdMap) {\n      let k = this.configuration.get('config-keys')\n      let activeBubbles = {\n        places: false,\n        people: false,\n        concepts: false,\n        organizations: false,\n      }\n      this.selectedBubbles.forEach((sB) => {\n        let c = sB.color\n        let findTypeFromColor = (obj, color) => {\n          return Object.keys(obj).find(key => obj[key].color.hex === color)\n        }\n        activeBubbles[findTypeFromColor(k, c)] = true\n        let entityId = this.entityBubbleIdMap[sB.id];\n        if (entityId)\n          selectedEntitiesIds.push(entityId);\n      });\n      this.lockedFacets = activeBubbles\n      this.one('aw-home-facets-wrapper').update({\n        facetData: this.facetData,\n        lockedFacets: this.lockedFacets\n      });\n    }\n    return this.communication.request$('globalFilter', {\n      onError: (error) => console.error(error),\n      params: {\n        selectedEntitiesIds,\n        itemsPagination: { offset: 0, limit: this.configuration.get('home-layout')['results-limit'] }\n      },\n    })\n  }\n\n  public updateBubbles(response, onlyBubbles?: boolean) {\n    if (!onlyBubbles) {\n      this.renderPreviewsFromApolloQuery(response);\n    }\n  }\n\n  public updateBubbleFilter(data) {\n    this.allBubbles = data.allBubbles;\n    this.entityBubbleIdMap = data.entityIdmap;\n  }\n\n  public updateTags(onlyBubbles?: boolean) {\n    if (!onlyBubbles) {\n      this.renderItemTags();\n    }\n  }\n\n  filterBubblesBasedOnFacetsEnabled() {\n    let result = this.allBubbles.filter(\n      (bubble) => {\n        for (var i = 0; i < this.facetData.length; i++) {\n          if (bubble.entity.typeOfEntity.id === this.facetData[i].type.id)\n            if (!this.facetData[i].enabled) { return false; }\n        }\n        return true;\n      }\n    );\n    return result;\n  }\n\n  handleFacetSearchChange(change) {\n    var payload: string = change.inputPayload;\n    var value: string = change.value;\n    // store the entered text in facetInputs\n    this.facetInputs[payload] = value;\n  }\n\n  handleFacetSearchEnter(enter) {\n    var payload: string = enter.inputPayload;\n    // get the text entered in this input\n    var value: string = this.facetInputs[payload];\n  }\n\n  handleFacetHeaderClick(facetId) {\n    let updateBubbles = false;\n    let enabledFacets = this.facetData.filter(f => f.enabled).length - 1;\n    this.facetData.forEach(f => {\n      if (f.type.id === facetId && f.locked === true) {\n        // if user clicked on a locked facet, ignore it\n        return\n      }\n      if (f.type.id === facetId) {\n        // if this is the clicked facet\n        if (f.enabled && enabledFacets >= 1) {\n          f.enabled = false;\n          f.locked = false;\n          updateBubbles = true;\n        } else {\n          f.enabled = true;\n          f.locked = false;\n          updateBubbles = true;\n        }\n      } else {\n        // if this is another facet\n        if (enabledFacets === 1 && f.enabled) {\n          f.locked = true;\n        } else {\n          f.locked = false;\n        }\n      }\n    });\n    this.one('aw-home-facets-wrapper').update({\n      facetData: this.facetData,\n      lockedFacets: this.lockedFacets\n    });\n    if (updateBubbles) {\n      let disableFacetsIds = [];\n      this.facetData.forEach((fD) => {\n        if (!fD.enabled) disableFacetsIds.push(fD.type.id);\n      });\n      if (disableFacetsIds) {\n        let filteredSelectedBubbles = this.selectedBubbles.filter((bubble) => {\n          let typeOfEntity = \"\";\n          for (var i = 0; i < this.allBubbles.length; i++) {\n            if (this.allBubbles[i].id === bubble.id) {\n              typeOfEntity = this.allBubbles[i].entity.typeOfEntity.id;\n              break;\n            }\n          }\n          if (disableFacetsIds.includes(typeOfEntity)) return false;\n          return true;\n        });\n        if (filteredSelectedBubbles.length != this.selectedBubbles.length) {\n          this.selectedBubbles = filteredSelectedBubbles;\n        };\n      }\n      this.allBubbles.forEach((bubble) => {\n        bubble.selected = false;\n        for (var i = 0; i < this.selectedBubbles.length; i++) {\n          if (this.selectedBubbles[i].id === bubble.id) bubble.selected = true;\n        }\n      });\n      this.one('aw-bubble-chart').update(this.getBubblePayload(null));\n    }\n  }\n\n  renderItemTags() {\n    let tagsData = [];\n    this.selectedBubbles.forEach((sBubble) => {\n      let label = '';\n      for (var i = 0; i < this.allBubbles.length; i++) {\n        if (this.allBubbles[i].id === sBubble.id) {\n          label = this.allBubbles[i].entity.label;\n          tagsData.push({\n            label, icon: \"n7-icon-close\",\n            payload: sBubble.id,\n            classes: \"tag-\" + this.allBubbles[i].entity.typeOfEntity.id\n          });\n          break;\n        }\n      }\n    });\n    this.one('aw-home-item-tags-wrapper').update(tagsData);\n  }\n\n  onTagClicked(payload) {\n    if (!payload) return;\n    const bubbleId = payload;\n    if (this._bubbleChart) {\n      this._bubbleChart.selectAll(`g`).each(b => {\n        if (b.id === bubbleId) b.hasCloseIcon = false;\n      });\n    }\n    this.selectedBubbles = this.selectedBubbles.filter((b) => b.id !== payload);\n    return this.filterRequest();\n  }\n\n  onHeroChange(value) {\n    this.autocompleteChanged$.next(value);\n  }\n\n  private _scrollBackgroundControl() {\n    const el = document.getElementById('bubble-results-list'),\n      source$ = fromEvent(document.getElementById('bubble-results-list'), 'scroll');\n\n    // height control\n    setTimeout(() => {\n      this._setHasScrollBackground(el);\n    }, 500);\n\n    // scroll listen\n    source$.pipe(\n      debounceTime(50)\n    ).subscribe(({ target }: { target: any }) => {\n      this._setHasScrollBackground(target);\n    });\n  }\n\n  private _setHasScrollBackground({ scrollTop, scrollHeight, clientHeight }) {\n    this.hasScrollBackground = scrollHeight > (scrollTop + clientHeight);\n  }\n\n  private _listenAutoCompleteChanges() {\n    this.one('aw-home-autocomplete').updateOptions({ config: this.configuration.get('config-keys') });\n    this.autocompleteChanged$.pipe(\n      debounceTime(500)\n    ).subscribe(value => {\n      if (value) {\n        this.communication.request$('autoComplete', {\n          onError: (error) => console.error(error),\n          params: {\n            input: value,\n            itemsPagination: { offset: 0, limit: this.configuration.get('home-layout')['results-limit'] }\n          }\n        }).subscribe((response) => {\n          this.one('aw-home-autocomplete').update(response);\n          if (!this.autocompletePopoverOpen) this._toggleAutocompletePopover();\n        });\n      } else {\n        this._toggleAutocompletePopover();\n      }\n    });\n  }\n\n  private _toggleAutocompletePopover() {\n    if (!this.autocompletePopover) {\n      const template = document.getElementById('aw-home-advanced-autocomplete-popover');\n      template.style.display = 'block';\n      this.autocompletePopover = this.tippy('.aw-home__top-hero .n7-hero__input', {\n        content: template,\n        trigger: 'manual',\n        interactive: true,\n        arrow: false,\n        flip: false,\n        appendTo: 'parent',\n        theme: 'light-border',\n        placement: 'bottom-start',\n        maxWidth: '100%',\n        onHidden: () => this.autocompletePopoverOpen = false,\n      })[0];\n    }\n    if (this.autocompletePopoverOpen) {\n      this.autocompletePopover.hide();\n    } else {\n      this.autocompletePopover.show();\n    }\n    this.autocompletePopoverOpen = !this.autocompletePopoverOpen;\n  }\n}","import { EventHandler } from '@n7-frontend/core';\nimport { fromEvent, Subject, interval } from 'rxjs';\n// import { takeUntil } from 'rxjs/operators';\n// import { debounce, debounceTime } from 'rxjs/operators';\n\nexport class AwHomeLayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n  private configuration: any;\n  private route: any;\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-home-layout.init':\n          this.dataSource.onInit(payload);\n          this.loadFilters();\n          this.configuration = payload.configuration;\n          break;\n        case 'aw-home-layout.destroy':\n          this.destroyed$.next();\n          break;\n        default:\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-hero.change':\n          this.dataSource.onHeroChange(payload.value);\n          break;\n        case 'aw-home-facets-wrapper.click':\n          this.dataSource.handleFacetHeaderClick(payload);\n          break;\n        case 'aw-home-facets-wrapper.change':\n          if (payload.value) {\n            let params = {\n              input: payload.value,\n              typeOfConfigKey: payload.inputPayload.replace('-search', ''),\n              itemsPagination: {\n                // offset: 0, limit: this.configuration.get('home-layout')['results-limit']\n                offset: 0, limit: this.configuration.get('home-layout')['results-limit']\n              }\n            }\n            this.dataSource.makeRequest$('autoComplete', params).subscribe(response => {\n              this.emitOuter('facetswrapperresponse', { facetId: payload, response })\n              this.dataSource.updateComponent(\n                'aw-autocomplete-wrapper', // ID\n                { key: payload.value, response }, // DATA\n                { config: this.configuration } // OPTIONS\n              )\n            })\n          }\n          break;\n        case 'aw-home-facets-wrapper.enter':\n          this.dataSource.handleFacetSearchEnter(payload);\n          break;\n        case \"aw-bubble-chart.bubble-tooltip-close-click\":\n          this.dataSource.onBubbleTooltipClick('close', payload);\n          break;\n        case \"aw-bubble-chart.bubble-tooltip-goto-click\":\n          if (!payload || !payload.entityId) return;\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [`aw/entita/${payload.entityId}/overview`]\n          });\n          break;\n        case \"aw-bubble-chart.bubble-tooltip-select-click\":\n          payload._bubbleChart = this.dataSource._bubbleChart;\n          this.emitOuter('bubble-tooltip-select-click', payload);\n          break;\n        case 'aw-bubble-chart.click':\n          if (payload.source === 'bubble') {\n            if (payload.bubble) {\n              this.dataSource.updateBubbleFilter(payload);\n              if (this.dataSource.onBubbleSelected(payload.bubble)) {\n                this.dataSource.filterRequest().subscribe((response) => {\n                  if (response) {\n                    // console.log('filterRequest() returned: ', response)\n                    this.emitOuter('filterbubbleresponse', this.dataSource.getBubblePayload(response));\n                    this.dataSource.updateBubbles(response);\n                  }\n                });\n              }\n            }\n          } else if (payload.source === 'close') {\n            this.dataSource.updateBubbleFilter(payload);\n            this.dataSource.onBubbleDeselected({\n              bubblePayload: payload.bubblePayload,\n              bubble: payload.bubble\n            }).subscribe((response) => {\n              if (response) {\n                this.emitOuter('filterbubbleresponse', this.dataSource.getBubblePayload(response));\n                this.dataSource.updateBubbles(response);\n              }\n            });\n          }\n          break;\n        case 'aw-bubble-chart.bubble-filtered':\n          this.dataSource.updateBubbleFilter(payload);\n          this.dataSource.updateTags();\n          const dataSource = this.dataSource;\n          setTimeout(function () {\n            dataSource.loadingBubbles = false;\n          }, 500);\n          break;\n\n        /**\n         * Tags & Item Previews Event Handlers\n         */\n        case 'aw-home-item-tags-wrapper.click':\n          this.dataSource.onTagClicked(payload).subscribe((response) => {\n            this.emitOuter('filterbubbleresponse', this.dataSource.getBubblePayload(response));\n            this.dataSource.updateBubbles(response);\n            this.dataSource.renderItemTags();\n          });\n          break;\n        default:\n          break;\n      }\n    });\n  }\n\n  private loadFilters() {\n    this.dataSource.initialFilterRequest().subscribe((response) => {\n      if (response) {\n        this.dataSource.parseInitialRequest(response);\n        if ( this.dataSource.bubblesEnabled ) {\n          let bubblePayload = {\n            setBubbleChart: (bubbleCref) => this.dataSource._bubbleChart = bubbleCref,\n            source: response,\n            reset: false,\n            facetData: this.dataSource.facetData\n          };\n          this.emitOuter('filterbubbleresponse', bubblePayload);\n        }\n      }\n    });\n  }\n}","import { AwHomeLayoutDS } from './home-layout.ds';\nimport { AwHomeLayoutEH } from './home-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const AwHomeLayoutConfig = {\n  layoutId: 'aw-home-layout',\n  widgets: [{\n    id: 'aw-hero',\n  }, {\n    id: 'aw-home-hero-patrimonio',\n  }, {\n    id: 'aw-bubble-chart',\n  }, {\n    id: 'aw-home-facets-wrapper',\n  }, {\n    id: 'aw-home-item-tags-wrapper',\n  }, {\n    id: 'aw-home-autocomplete',\n  }, {\n    id: 'aw-linked-objects',\n  }, {\n    id: 'aw-autocomplete-wrapper',\n  }],\n  layoutDS: AwHomeLayoutDS,\n  layoutEH: AwHomeLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AbstractLayout } from '../../../common/models/abstract-layout'\nimport { ConfigurationService } from '../../../common/services/configuration.service';\nimport { LayoutsConfigurationService } from '../../../common/services/layouts-configuration.service';\nimport { MainStateService } from '../../../common/services/main-state.service';\nimport { AwHomeLayoutConfig as config } from './home-layout.config';\nimport { CommunicationService } from '../../../common/services';\nimport tippy from 'tippy.js';\n\n@Component({\n    selector: 'aw-home-layout',\n    templateUrl: './home-layout.html'\n})\nexport class AwHomeLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    layoutsConfiguration: LayoutsConfigurationService,\n    private router: Router,\n    private configuration: ConfigurationService,\n    private communication: CommunicationService,\n    private mainState: MainStateService,\n  ){\n    super(layoutsConfiguration.get('AwHomeLayoutConfig') || config);\n  }\n\n  protected initPayload(){\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      router: this.router,\n      communication: this.communication,\n      options: this.config.options || {},\n      tippy: tippy,\n    }\n  }\n\n  ngOnInit(){\n    this.onInit();\n  }\n\n  ngOnDestroy(){\n    this.onDestroy();\n  }\n}\n","import { LayoutDataSource } from '@n7-frontend/core';\n\nexport class AwSchedaLayoutDS extends LayoutDataSource {\n  /**\n  * If you are not using these variables (from your-layout.ts),\n  * remove them from here too.\n  */\n  private communication: any;\n  protected configuration: any;\n  protected mainState: any;\n  protected router: any;\n  protected titleService: any;\n  private allBubbles: any[] = null;\n  public selectedBubbles: any[] = [];\n\n  public options: any;\n  public pageTitle: string;\n  public hasBreadcrumb: boolean;\n  public contentParts: any;\n  public tree: any;\n  public sidebarCollapsed: boolean;\n  public bubbleChartSectionTitle: string;\n  public similarItemsSectionTitle: string;\n  public metadataSectionTitle: string;\n  public hasMetadata: boolean;\n  public hasBubbles: boolean;\n  public bubblesEnabled: boolean;\n  public hasSimilarItems: boolean;\n  public imageViewerIstance: any;\n  /**\n  * If you are not using these variables (from your-layout.ts),\n  * remove them from onInit() parameters and inside the function.\n  */\n  onInit({configuration, mainState, router, options, titleService, communication }) {\n    this.configuration = configuration;\n    this.mainState = mainState;\n    this.router = router;\n    this.titleService = titleService;\n    this.communication = communication;\n    this.options = options;\n    this.sidebarCollapsed = false;\n    this.bubbleChartSectionTitle = this.configuration.get('scheda-layout')['bubble-chart']['title'];\n    this.similarItemsSectionTitle = this.configuration.get('scheda-layout')['related-items']['title'];\n    this.metadataSectionTitle = this.configuration.get('scheda-layout')['metadata']['title'];\n    this.hasSimilarItems = false;\n    this.bubblesEnabled = this.configuration.get('features-enabled') ? this.configuration.get('features-enabled')['bubblechart'] : false;\n\n    this.mainState.update('headTitle', 'Arianna Web > Patrimonio');\n    this.mainState.update('pageTitle', 'Arianna Web: patrimonio Layout');\n    this.mainState.updateCustom('currentNav', 'aw/patrimonio');\n  }\n\n  getNavigation( id ) {\n    return this.communication.request$('getTree', {\n      onError: (error) => console.error(error),\n      params: { treeId: id }\n    })\n  }\n\n  updateNavigation( data ) {\n    let header = {\n      iconLeft: 'n7-icon-tree-icon',\n      text:  data['label'],\n      iconRight: 'n7-icon-angle-left',\n      classes: 'is-expanded',\n      payload: 'header'\n    };\n    this.one('aw-sidebar-header').update(header);\n  }\n\n  loadItem( id ) {\n    if ( id ) {\n      const maxSimilarItems = this.configuration.get('scheda-layout')['related-items']['max-related-items'];\n      return  this.communication.request$('getItemDetails', {\n        onError: (error) => console.error(error),\n        params: { itemId: id, maxSimilarItems: maxSimilarItems }\n      })\n    } else {\n      /* TODO: valori statici, da prendere da config */\n      this.pageTitle = 'Collezione d\\'Arte';\n      this.contentParts = [\n        {\n          type: 'text',\n          title: 'Collezione d\\'Arte',\n          content: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi gravida sagittis pulvinar. Etiam iaculis maximus metus, id tincidunt libero auctor et. Proin tempus turpis vel erat ultrices, id vestibulum ante cursus. Vestibulum lobortis, ante at eleifend consequat, massa libero bibendum justo, id fermentum magna odio ac nulla. Cras aliquet scelerisque malesuada. Mauris congue fermentum tristique. Nulla imperdiet accumsan dui, tristique lobortis metus eleifend non. Donec quis odio massa. Cras sit amet sem eu turpis molestie blandit vitae sed nibh. Pellentesque ornare enim nisl, et efficitur ante elementum a. Ut nec ex finibus, congue libero feugiat, aliquam ante. Cras sem neque, pellentesque eget mi at, auctor vulputate tellus. Sed aliquam mi a tortor ultricies interdum. Etiam tincidunt nunc commodo nulla porttitor semper. Etiam porta lacinia libero a mattis. Lorem ipsum dolor sit amet, consectetur adipiscing elit.'\n        },\n        {\n          type: 'text',\n          title: 'Centro Archivi',\n          content: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi gravida sagittis pulvinar. Etiam iaculis maximus metus, id tincidunt libero auctor et. Proin tempus turpis vel erat ultrices, id vestibulum ante cursus. Vestibulum lobortis, ante at eleifend consequat, massa libero bibendum justo, id fermentum magna odio ac nulla. Cras aliquet scelerisque malesuada. Mauris congue fermentum tristique. Nulla imperdiet accumsan dui, tristique lobortis metus eleifend non. Donec quis odio massa. Cras sit amet sem eu turpis molestie blandit vitae sed nibh. Pellentesque ornare enim nisl, et efficitur ante elementum a. Ut nec ex finibus, congue libero feugiat, aliquam ante. Cras sem neque, pellentesque eget mi at, auctor vulputate tellus. Sed aliquam mi a tortor ultricies interdum. Etiam tincidunt nunc commodo nulla porttitor semper. Etiam porta lacinia libero a mattis. Lorem ipsum dolor sit amet, consectetur adipiscing elit.'\n        }\n      ]\n    }\n     /*Breadcrumb section*/\n     let breadcrumbs = {\n      items: []\n    };\n    this.one('aw-scheda-breadcrumbs').update(breadcrumbs);\n  }\n\n  loadContent(response) {\n      if(response){\n        console.log( \"apollo response: \");\n        console.log(response);\n        this.contentParts = [];\n        let content = {};\n\n        /* Related Entities */\n      this.one('aw-bubble-chart').updateOptions({\n        context: 'scheda',\n        configKeys: this.configuration.get(\"config-keys\"),\n        bubbleContainerId: 'bubbleChartContainer',\n        containerId: 'bubble-chart-container',\n      });\n\n        if ( response.text ){\n          content['content'] = response.text;\n        }\n        this.contentParts.push(content);\n        if ( response.image ) {\n          const images =  [{type: 'image', url: response.image, buildPyramid: false}];\n          if( !this.imageViewerIstance ) {\n            this.one('aw-scheda-image').update({\n              viewerId: 'scheda-layout-viewer',\n              _setViewer : (viewer) => {\n                this.imageViewerIstance = viewer;\n                viewer.open(images);\n              },\n            });\n          } else {\n            this.imageViewerIstance.open(images);\n          }\n        }\n\n        let titleObj = {\n          icon: response.item.icon,\n          title: {\n            main: {\n              text: response.title,\n              classes: 'bold',\n            }\n          },\n          tools: response.subTitle,\n          actions: {}\n        };\n\n        this.one('aw-scheda-inner-title').update(titleObj);\n\n        /*Metadata section*/\n        let group = { group: [] };\n\n        this.hasMetadata = response.fields != null;\n        if (  this.hasMetadata ){\n          response.fields.forEach(field => {\n            let items = [];\n            field.fields.forEach(item => {\n              items.push( { label: item.key, value: item.value} )\n            });\n\n            group.group.push(\n              {\n                title: field.label,\n                items: items\n              }\n            );\n        });\n      }\n      this.one('aw-scheda-metadata').update(group);\n\n      /*Breadcrumb section*/\n        let breadcrumbs = {\n          items: []\n        };\n\n        response.breadcrumbs.forEach(element => {\n          breadcrumbs.items.push({\n            label: element.label,\n            payload: element.link\n          })\n        });\n        this.one('aw-scheda-breadcrumbs').update(breadcrumbs);\n      }\n\n      /*if ( response.connectedEntities ) {\n        this.hasBubbles = true;\n        this.setAllBubblesFromApolloQuery(response);\n      } else {\n        this.hasBubbles = false;\n        this.one('aw-scheda-bubble-chart').update(null);\n      }*/\n\n      /* Similar item */\n      if ( response.items ) {\n        this.hasSimilarItems = true;\n        this.one('aw-linked-objects').updateOptions({ context: 'scheda', config: this.configuration })\n        this.one('aw-linked-objects').update(response);\n      } else {\n        this.hasSimilarItems = false;\n        this.one('aw-linked-objects').update(null);\n      }\n  }\n\n  collapseSidebar() {\n    this.sidebarCollapsed = !this.sidebarCollapsed;\n  }\n\n  setAllBubblesFromApolloQuery( response: any, reset?: boolean ){\n    if ( !response || !response.connectedEntities ) { return; }\n    this.allBubbles = [];\n\n    for ( let i = 0; i < response.connectedEntities.length; i++ ){\n\n      const color = this.configuration.get('config-keys')[response.connectedEntities[i].entity.typeOfEntity.configKey] ? this.configuration.get('config-keys')[response.connectedEntities[i].entity.typeOfEntity.configKey]['color']['hex'] : \"\";\n\n      this.allBubbles.push(\n        {\n          id: this.convertEntityIdToBubbleId( response.connectedEntities[i].entity.id ),\n          ...response.connectedEntities[i],\n          color: color\n        });\n    }\n    this.one('aw-scheda-bubble-chart').update({\n      containerId: 'bubble-chart-container',\n      width: window.innerWidth / 1.8,\n      bubbles: this.allBubbles,\n      reset: ( reset ? reset : false )\n    });\n  }\n\n  private convertEntityIdToBubbleId( entityId: string ): string {\n    if( !entityId ) return null;\n    return ( 'B_' + entityId.replace(/-/g, '_') );\n  }\n\n\n}\n","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { resolveSanitizationFn } from '@angular/compiler/src/render3/view/template';\n\nexport class AwSchedaLayoutEH extends EventHandler {\n  private destroyed$: Subject<any> = new Subject();\n  private configuration: any;\n  private route: any;\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-scheda-layout.init':\n          this.dataSource.onInit(payload);\n          this.configuration = payload.configuration;\n          this.route = payload.route;\n          let paramId = this.route.snapshot.params.id || \"\";\n          this.listenRoute();\n          this.loadNavigation(paramId);\n          break;\n\n        case 'aw-scheda-layout.destroy':\n          this.destroyed$.next();\n          break;\n\n        default:\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-tree.click':\n          if ( payload ) {\n            this.emitGlobal('navigate', {path: [this.configuration.get('paths').schedaBasePath + payload], handler: 'router'});\n          }\n          break;\n        case 'aw-sidebar-header.click': this.dataSource.collapseSidebar();\n        break;\n        case \"aw-bubble-chart.bubble-tooltip-goto-click\":\n          if(!payload || !payload.entityId) return;\n          this.emitGlobal('navigate', {\n            handler: 'router',\n            path: [`aw/entita/${payload.entityId}/overview`]\n          });\n        break;\n\n      }\n    });\n  }\n\n  private listenRoute() {\n    this.route.paramMap.subscribe(params => {\n     if ( params.get('id') ) {\n       this.dataSource.loadItem(params.get('id')).subscribe((response) => {\n         if ( response ) {\n           this.dataSource.loadContent(response);\n           if ( response.connectedEntities ){\n             this.dataSource.hasBubbles = true;\n             let connectedEntities = {source: response, connectedEntities: response.connectedEntities};\n             if( this.dataSource.bubblesEnabled ){\n               this.emitOuter('filterbubbleresponse', connectedEntities);\n             }\n           }\n          }\n        });\n      } else {\n        this.dataSource.loadItem();\n      }\n    });\n  }\n\n  private loadNavigation( selectedItem ) {\n    this.dataSource.getNavigation('patrimonio').subscribe((response) => {\n      if( response ){\n        this.dataSource.updateNavigation(response);\n        this.emitOuter('navigationresponse', response);\n      }\n      if ( selectedItem ) {\n        this.emitOuter('selectItem', selectedItem);\n      }\n    });\n  }\n}","import { AwSchedaLayoutDS } from './scheda-layout.ds';\nimport { AwSchedaLayoutEH } from './scheda-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const AwPatrimonioLayoutConfig = {\n  layoutId: 'aw-scheda-layout',\n  /**\n   * Array of components you want to use\n   * in this leyout\n   */\n  widgets: [\n     { id: 'aw-sidebar-header'},\n     { id: 'aw-tree' },\n     { id: 'aw-scheda-breadcrumbs' },\n     { id: 'aw-scheda-metadata' },\n     { id: 'aw-scheda-image' },\n     { id: 'aw-scheda-inner-title' },\n     { id: 'aw-bubble-chart' },\n     { id: 'aw-linked-objects' }\n  ],\n  layoutDS: AwSchedaLayoutDS,\n  layoutEH: AwSchedaLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { Title } from '@angular/platform-browser';\nimport { AbstractLayout } from '../../../common/models/abstract-layout'\nimport { ConfigurationService } from '../../../common/services/configuration.service';\nimport { LayoutsConfigurationService } from '../../../common/services/layouts-configuration.service';\nimport { MainStateService } from '../../../common/services';\nimport { AwPatrimonioLayoutConfig as config } from './scheda-layout.config';\nimport { CommunicationService } from '../../../common/services';\n\n@Component({\n  selector: 'aw-scheda-layout',\n  templateUrl: './scheda-layout.html'\n})\n\nexport class AwSchedaLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private configuration: ConfigurationService,\n    private layoutsConfiguration: LayoutsConfigurationService,\n    private mainState: MainStateService,\n    private titleService: Title,\n    private communication: CommunicationService,\n\n  ) {\n    super(layoutsConfiguration.get('AwPatrimonioLayoutConfig') || config);\n  }\n\n  /**\n   * Optional variables that can be accessed from the layout's logic.\n   * If removed, they must also be removed from the layout's DataSource file,\n   * and from this file imports.\n   */\n  protected initPayload() {\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      router: this.router,\n      route: this.route,\n      titleService: this.titleService,\n      communication: this.communication,\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit() {\n    this.onInit();\n  }\n\n  ngOnDestroy() {\n    this.onDestroy();\n  }\n}","import { LayoutDataSource } from '@n7-frontend/core';\n\nexport class AwWorksLayoutDS extends LayoutDataSource {\n  onInit(payload){\n    // TODO\n  }\n}","import { EventHandler } from '@n7-frontend/core';\n\nexport class AwWorksLayoutEH extends EventHandler {\n  \n  public listen() {\n    /* this.innerEvents$.subscribe(({ type, payload }) => {\n      \n    }); */\n    \n    /* this.outerEvents$.subscribe(({ type, payload }) => {\n      \n    }); */\n  }\n\n}","import { AwWorksLayoutDS } from './works-layout.ds';\nimport { AwWorksLayoutEH } from './works-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\n\nexport const AwWorksLayoutConfig = {\n  layoutId: 'aw-works-layout',\n  widgets: [],\n  layoutDS: AwWorksLayoutDS,\n  layoutEH: AwWorksLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  layoutOptions: {\n    // TODO\n  }\n};","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { AbstractLayout } from '../../../common/models/abstract-layout';\nimport { AwWorksLayoutConfig as config } from './works-layout.config';\n\n@Component({\n  selector: 'aw-works-layout',\n  templateUrl: './works-layout.html'\n})\nexport class AwWorksLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n  ){\n    super(config);\n  }\n\n  ngOnInit(){\n    this.onInit();\n  }\n\n  ngOnDestroy(){\n    this.onDestroy();\n  }\n\n}","export default {\n  totalCount: 0,\n  facets: [{\n    id: 'query', \n    type: 'value'\n  }, {\n    id: 'query-all', \n    type: 'value',\n    data: [{\n      value: '1',\n      label: 'Cerca in tutti campi delle schede'\n    }]\n  }, {\n    id: 'query-links', \n    type: 'value',\n    data: []\n  }, {\n    id: 'entity-types',\n    type: 'value',\n    operator: 'OR',\n    limit: 10,\n    order: 'count', // count | text\n    data: []\n  }, {\n    id: 'entity-search', \n    type: 'value'\n  }, {\n    id: 'entity-links', \n    type: 'value',\n    metadata: ['title', 'entity-type'],\n    data: []\n  }, {\n    id: 'date-from', \n    type: 'value',\n    data: []\n  }, {\n    id: 'date-to', \n    type: 'value',\n    data: []\n  }],\n  fields: [{\n    inputs: [{\n      type: 'text',\n      facetId: 'query',\n      placeholder: 'Cerca...',\n      // icon: 'n7-icon-search',\n      filterConfig: {\n        delay: 500,\n        minChars: 3, \n        searchIn: [{\n          key: 'source.title',\n          operator: 'LIKE'\n        }]\n      } \n    }, {\n      type: 'checkbox',\n      facetId: 'query-all',\n      filterConfig: {\n        searchIn: [{\n          key: 'query-all',\n          operator: '='\n        }]\n      }\n    }, {\n      type: 'link',\n      facetId: 'query-links',\n      filterConfig: {\n        isArray: true,\n        searchIn: [{\n          key: 'source.entityType',\n          operator: '='\n        }]\n      } \n    }]\n  }, {\n    header: {\n      label: 'Relazione con',\n      classes: 'related-class'\n    },\n    inputs: [{\n      type: 'checkbox',\n      facetId: 'entity-types',\n      filterConfig: {\n        isArray: true,\n        context: 'internal',\n        target: 'entity-links',\n        searchIn: [{\n          key: 'entity-type',\n          operator: '='\n        }]\n      } \n    }, {\n      type: 'text',\n      facetId: 'entity-search',\n      placeholder: 'Cerca entitÃ ',\n      // icon: 'n7-icon-search',\n      filterConfig: {\n        delay: 500,\n        minChars: 3, \n        context: 'internal',\n        target: 'entity-links',\n        searchIn: [{\n          key: 'title',\n          operator: 'LIKE'\n        }]\n      } \n    }, {\n      type: 'link',\n      facetId: 'entity-links',\n      filterConfig: {\n        limit: 20,\n        searchIn: [{\n          key: 'source.id',\n          operator: '='\n        }]\n      } \n    }]\n  }, {\n    header: {\n      label: 'Data',\n      classes: 'date-class'\n    },\n    inputs: [{\n      type: 'select',\n      facetId: 'date-from',\n      label: 'Dal',\n      filterConfig: {\n        searchIn: [{\n          key: 'source.dateStart',\n          operator: '>='\n        }]\n      } \n    }, {\n      type: 'select',\n      facetId: 'date-to',\n      label: 'Al',\n      filterConfig: {\n        searchIn: [{\n          key: 'source.dateEnd',\n          operator: '<='\n        }]\n      } \n    }]\n  }],\n  results: {\n    order: {\n      type: 'score', // score | text | date\n      key: 'author', // docPath, elastic key, ecc\n      direction: 'DESC', // ASC | DESC\n    }, \n    fields: {\n      title: {\n        highlight: true,\n        limit: 50,\n      }\n    },\n    items: []\n  },\n  page: { offset: 0, limit: 10 }\n}","import { Observable, of } from 'rxjs';\n\nexport default (params, configKeys): Observable<any> => {\n  params.totalCount = Math.floor(Math.random() * 1000);\n\n  console.log('fake-search-request----------->', params);\n\n  let { facets } = params;\n\n  // query links\n  _getFacet('query-links', facets).data = _getQueryLinksData(configKeys);\n\n  // entity types\n  _getFacet('entity-types', facets).data = _getEntityTypesData(configKeys);\n\n  // entity links\n  _getFacet('entity-links', facets).data = _getEntityLinksData();\n\n  // date from\n  _getFacet('date-from', facets).data = _getDateFromData();\n  \n  // date to\n  _getFacet('date-to', facets).data = _getDateToData();\n  \n  return of(params);\n}\n\nconst _getFacet = (id, facets) => {\n  return facets.filter(f => f.id === id)[0];\n}\n\nconst _getQueryLinksData = (configKeys) => {\n  return Object.keys(configKeys).map(key => {\n    const config = configKeys[key];\n    return {\n      value: key,\n      label: config.label,\n      counter: Math.floor(Math.random() * 100),\n      \n      // questi vanno aggiunti a mano lato front-end\n      options: {\n        icon: config.icon,\n        classes: `color-${key}`\n      }\n    };\n  });\n}\n\nconst _getEntityTypesData = (configKeys) => {\n  return Object.keys(configKeys).map(key => {\n    const config = configKeys[key];\n    return {\n      value: key,\n      label: config.label,\n    };\n  });\n}\n\nconst _getDateFromData = () => {\n  return ['1990', '1991', '1992', '1993'].map(key => {\n    return {\n      value: key,\n      label: key,\n    };\n  });\n}\n\nconst _getDateToData = () => {\n  return ['2000', '2001', '2002', '2003'].map(key => {\n    return {\n      value: key,\n      label: key,\n    };\n  });\n}\n\nconst _getEntityLinksData = () => {\n  const types = ['places', 'places', 'concepts', 'people', 'people'];\n  const items = ['milano', 'roma', 'spazio', 'rodolfo-marna', 'alighiero-boetti'];\n\n  return items.map((key, index) => {\n    const label = key.replace('-', ' ');\n    return {\n      value: key,\n      label: label,\n      counter: Math.floor(Math.random() * 100),\n      metadata: {\n        title: label,\n        'entity-type': types[index]\n      }  \n    }\n  });\n}","import { LayoutDataSource } from '@n7-frontend/core';\nimport { SearchService, SearchModel } from 'n7-boilerplate-lib/lib/common/services';\nimport facetsConfig from './search-facets.config';\nimport fakeSearchRequest$ from './search-mock-request';\nimport { withLatestFrom, tap } from 'rxjs/operators';\nimport { Observable, of } from 'rxjs';\n\nconst SEARCH_MODEL_ID = 'aw-search-layout';\n\nexport class AwSearchLayoutDS extends LayoutDataSource {\n  private communication: any;\n  private configuration: any;\n  private mainState: any;\n  private search: SearchService;\n  private searchModel: SearchModel;\n\n  public pageTitle: string;\n  public resultsTitle: string;\n  public totalCount: number;\n  public currentPage: any = 1; // pagination value (url param)\n  public pageSize: number = 10; // linked objects page size\n\n  public options: any;\n\n  public orderByLabel: string = 'Ordina per';\n  public orderByOptions: any = [{\n    value: 'text_DESC',\n    label: 'Ordine alfabetico (DESC)'\n  }, {\n    value: 'text_ASC',\n    label: 'Ordine alfabetico (ASC)'\n  }, /* {\n    value: 'score_DESC',\n    label: 'Ordine per rilevanza (DESC)'\n  }, {\n    value: 'score_ASC',\n    label: 'Ordine per rilevanza (ASC)'\n  }, {\n    value: 'date_DESC',\n    label: 'Ordina per data (DESC)'\n  }, {\n    value: 'date_ASC',\n    label: 'Ordina per data (ASC)'\n  } */];\n\n  onInit({configuration, mainState, options, communication, search }) {\n    this.configuration = configuration;\n    this.mainState = mainState;\n    this.communication = communication;\n    this.search = search;\n    this.options = options;\n\n    this.pageTitle = this.configuration.get('search-layout').title;\n\n    if(!this.search.model(SEARCH_MODEL_ID)) this.search.add(SEARCH_MODEL_ID, facetsConfig);\n    this.searchModel = this.search.model(SEARCH_MODEL_ID);\n\n    this.doSearchRequest$().subscribe(() => {\n      this.one('facets-wrapper').update({ searchModel: this.searchModel });\n    });\n  }\n\n  onOrderByChange(payload){\n    const [orderBy, direction] = payload.split('_');\n\n    this.searchModel.setSearchConfigOrderBy(orderBy);\n    this.searchModel.setSearchConfigDirection(direction);\n  }\n\n  onPaginationChange(payload): Observable<boolean> {\n    const page = payload.replace('page-', '');\n    return this._updateSearchPage(page);\n  }\n\n  onPaginationGoToChange(payload){\n    const page = payload.replace('goto-', '');\n    this._updateSearchPage(page);\n  }\n\n  onResultsLimitChange(payload){\n    this.pageSize = payload;\n    this.searchModel.setPageConfigLimit(payload);\n    \n    // reset page & offset\n    this.currentPage = 1;\n    this.searchModel.setPageConfigOffset(0);\n  }\n\n  public getSearchModelId = () => SEARCH_MODEL_ID;\n\n  public doSearchRequest$(): Observable<any> {\n    // FIXME: togliere configKeys\n    // dovrebbe venire dall'API\n    const configKeys = this.configuration.get('config-keys');\n\n    // FIXME: mettere logica definitiva \n    // per la chiamata search\n    /* \n    this.communication.request$('search', {\n      onError: error => console.error(error),\n      params: requestParams\n    })\n    */\n\n    const requestParams = this.searchModel.getRequestParams();\n\n    const fakeResultsRequest$ = this.communication.request$('getEntityDetails', {\n      onError: error => console.error(error),\n      params: { entityId: '55vf-entity-s3ar' }\n    });\n\n    return fakeResultsRequest$.pipe(\n      withLatestFrom(fakeSearchRequest$(requestParams, configKeys)),\n      tap(([resultsResponse, searchResponse]) => {\n        this.totalCount = searchResponse.totalCount;\n        let resultsTitleIndex = 0;\n        // results title\n        if(this.totalCount > 1){\n          resultsTitleIndex = 2;\n        } else if(this.totalCount === 1) {\n          resultsTitleIndex = 1;\n        }\n        this.resultsTitle = this.configuration.get('search-layout').results[resultsTitleIndex];\n  \n        this.searchModel.updateFacets(searchResponse.facets);\n        this.searchModel.updateTotalCount(searchResponse.totalCount);\n        \n        this.one('aw-linked-objects').updateOptions({\n          context: 'search',\n          config: this.configuration,\n          // todo: swap to next line after merge\n          // config: this.configuration\n          page: this.currentPage,\n          size: this.pageSize,\n        });\n  \n        this.one('aw-linked-objects').update({ items: resultsResponse.items });\n      })\n    );\n  }\n\n  private _updateSearchPage(page){\n    if(+page === this.currentPage) return of(false);\n\n    this.currentPage = +page;\n\n    const searchConfig = this.searchModel.getConfig(),\n      pageConfig = searchConfig.page,\n      { limit } = pageConfig,\n      newOffset = (this.currentPage - 1) * limit;\n\n    this.searchModel.setPageConfigOffset(newOffset);\n\n    return of(true);\n  }\n}\n","import { EventHandler } from '@n7-frontend/core';\nimport { Subject } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\n\nexport class AwSearchLayoutEH extends EventHandler {\n  private facetsChange$: Subject<any> = new Subject();\n\n  public listen() {\n    this.innerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'aw-search-layout.init':\n          this.dataSource.onInit(payload);\n          this._listenToFacetsChange();\n          break;\n\n        case 'aw-search-layout.orderbychange':\n          this.dataSource.onOrderByChange(payload);\n          this.facetsChange$.next();\n          break;\n\n        default:\n          break;\n      }\n    });\n\n    this.outerEvents$.subscribe(({ type, payload }) => {\n      switch (type) {\n        case 'facets-wrapper.facetschange':\n          this.facetsChange$.next();\n          break;\n\n        case 'aw-linked-objects.pagination':\n          this.dataSource.onPaginationChange(payload).subscribe(changed => {\n            if(changed) this.facetsChange$.next();\n          });\n          break;\n\n        case 'aw-linked-objects.change':\n          this.dataSource.onResultsLimitChange(payload);\n          this.facetsChange$.next();\n          break;\n\n        case 'aw-linked-objects.goto':\n            this.dataSource.onPaginationGoToChange(payload).subscribe(changed => {\n              if(changed) this.facetsChange$.next();\n            });\n            break;\n    \n        default:\n          break;\n      }\n    });\n  }\n\n  private _listenToFacetsChange(){\n    this.facetsChange$.pipe(\n      debounceTime(500)\n    ).subscribe(() => {\n      this.dataSource.doSearchRequest$().subscribe(() => {\n        this.emitGlobal('searchresponse', this.dataSource.getSearchModelId());\n      });\n    })\n  }\n}","import { AwSearchLayoutDS } from './search-layout.ds';\nimport { AwSearchLayoutEH } from './search-layout.eh';\nimport * as DS from '../../data-sources';\nimport * as EH from '../../event-handlers';\nimport { FacetsWrapperDS } from '../../../common/data-sources';\nimport { FacetsWrapperEH } from '../../../common/event-handlers';\n\nexport const AwSearchLayoutConfig = {\n  layoutId: 'aw-search-layout',\n  /**\n   * Array of components you want to use\n   * in this layout\n   */\n  widgets: [\n    { id: 'facets-wrapper', dataSource: FacetsWrapperDS, eventHandler: FacetsWrapperEH },\n    { id: 'aw-linked-objects' },\n    { id: 'aw-search-layout-tabs', hasStaticData: true },\n  ],\n  layoutDS: AwSearchLayoutDS,\n  layoutEH: AwSearchLayoutEH,\n  widgetsDataSources: DS,\n  widgetsEventHandlers: EH,\n  options: {\n    // TODO\n  }\n};\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { AbstractLayout } from '../../../common/models/abstract-layout'\nimport { \n  ConfigurationService,\n  LayoutsConfigurationService,\n  MainStateService,\n  SearchService,\n  CommunicationService,\n} from '../../../common/services';\nimport { AwSearchLayoutConfig as config } from './search-layout.config';\n\n@Component({\n  selector: 'aw-search-layout',\n  templateUrl: './search-layout.html'\n})\n\nexport class AwSearchLayoutComponent extends AbstractLayout implements OnInit, OnDestroy {\n  constructor(\n    private configuration: ConfigurationService,\n    private layoutsConfiguration: LayoutsConfigurationService,\n    private mainState: MainStateService,\n    private communication: CommunicationService,\n    private search: SearchService,\n\n  ) {\n    super(layoutsConfiguration.get('AwSearchLayoutConfig') || config);\n  }\n\n  /**\n   * Optional variables that can be accessed from the layout's logic.\n   * If removed, they must also be removed from the layout's DataSource file,\n   * and from this file imports.\n   */\n  protected initPayload() {\n    return {\n      configuration: this.configuration,\n      mainState: this.mainState,\n      communication: this.communication,\n      search: this.search,\n      options: this.config.options || {},\n    }\n  }\n\n  ngOnInit() {\n    this.onInit();\n  }\n\n  ngOnDestroy() {\n    this.onDestroy();\n  }\n}","//---------------------------\n// BubbleChartWrapper.ts\n//---------------------------\n\nimport { Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'aw-bubble-chart-wrapper',\n  templateUrl: './bubble-chart-wrapper.html'\n})\nexport class BubbleChartWrapperComponent {\n  @Input() hover: any;\n  @Input() emit: any;\n  @Input() container: string;\n  @Input() buttons: any;\n\n  onClick(type, payload) {\n    this.emit(type, payload);\n  }\n}\n","// MODULES\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DvComponentsLibModule } from '@n7-frontend/components';\nimport { N7BoilerplateCommonModule } from '../common/n7-boilerplate-common.module';\n// LAYOUTS\nimport { AwAboutLayoutComponent } from './layouts/about-layout/about-layout';\nimport { AwEntitaLayoutComponent } from \"./layouts/entita-layout/entita-layout\";\nimport { AwHomeLayoutComponent } from './layouts/home-layout/home-layout';\nimport { AwSchedaLayoutComponent } from './layouts/scheda-layout/scheda-layout';\nimport { AwWorksLayoutComponent } from './layouts/works-layout/works-layout';\nimport { AwSearchLayoutComponent } from './layouts/search-layout/search-layout';\n// COMPONENTS\nimport { BubbleChartWrapperComponent } from './components/bubble-chart-wrapper/bubble-chart-wrapper';\n\nconst COMPONENTS = [\n  AwAboutLayoutComponent,\n  AwEntitaLayoutComponent,\n  AwHomeLayoutComponent,\n  AwSchedaLayoutComponent,\n  AwWorksLayoutComponent,\n  AwSearchLayoutComponent,\n  BubbleChartWrapperComponent\n];\n\n\n@NgModule({\n  declarations: COMPONENTS,\n  imports: [\n    CommonModule,\n    DvComponentsLibModule,\n    N7BoilerplateCommonModule,\n  ],\n  providers: [],\n  exports: COMPONENTS\n})\nexport class N7BoilerplateAriannaWebModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { N7BoilerplateCommonModule } from './common/n7-boilerplate-common.module';\nimport { N7BoilerplateAriannaWebModule } from './arianna-web/n7-boilerplate-arianna-web.module';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  providers: [],\n  exports: [\n    N7BoilerplateCommonModule,\n    N7BoilerplateAriannaWebModule,\n  ]\n})\nexport class N7BoilerplateLibModule { }\n"]}