!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http"),require("@n7-frontend/components"),require("rxjs"),require("rxjs/operators"),require("@angular/router"),require("@angular/platform-browser"),require("@n7-frontend/core"),require("tippy.js"),require("lodash"),require("slug"),require("n7-boilerplate-lib/lib/common/helpers")):"function"==typeof define&&define.amd?define("@n7-frontend/boilerplate",["exports","@angular/core","@angular/common","@angular/common/http","@n7-frontend/components","rxjs","rxjs/operators","@angular/router","@angular/platform-browser","@n7-frontend/core","tippy.js","lodash","slug","n7-boilerplate-lib/lib/common/helpers"],t):t(((e=e||self)["n7-frontend"]=e["n7-frontend"]||{},e["n7-frontend"].boilerplate={}),e.ng.core,e.ng.common,e.ng.common.http,e.components,e.rxjs,e.rxjs.operators,e.ng.router,e.ng.platformBrowser,e.core$1,e.tippy,e.lodash,e.slug,e.helpers$1)}(this,function(e,t,a,n,i,r,o,s,c,l,u,d,p,h){"use strict";var f="default"in u?u.default:u;p=p&&p.hasOwnProperty("default")?p.default:p,h=h&&h.hasOwnProperty("default")?h.default:h;var g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)};function b(e,t){function a(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}var y=function(){return(y=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function m(e){var t="function"==typeof Symbol&&e[Symbol.iterator],a=0;return t?t.call(e):{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}}}function v(e,t){var a="function"==typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o}var w=function(){function e(e){var t=this;this.config=e,this.defaults={},this.get=function(e){return t.defaults[e]},this.set=function(e,a){return t.defaults[e]=a},this.config.global&&Object.keys(this.config.global).forEach(function(e){t.set(e,t.config.global[e])})}return e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:["config"]}]}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject("config"))},token:e,providedIn:"root"}),e}();var S=function(){function e(e){var t=this;this.config=e,this.defaults={},this.get=function(e){return t.defaults[e]},this.set=function(e,a){return t.defaults[e]=a},this.config.layouts&&Object.keys(this.config.layouts).forEach(function(e){t.set(e,t.config.layouts[e])})}return e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:["config"]}]}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject("config"))},token:e,providedIn:"root"}),e}();var _=function(){function e(){var e=this;this.custom={},this.default={headTitle:new r.ReplaySubject,pageTitle:new r.ReplaySubject,subnav:new r.ReplaySubject,breadcrumbs:new r.ReplaySubject,filters:new r.ReplaySubject},this.get$=function(t){return e._get("default",t)},this.getCustom$=function(t){return e._get("custom",t)},this.update=function(t,a){return e._update("default",t,a)},this.updateCustom=function(t,a){return e._update("custom",t,a)},this.has=function(t){return!!e.default[t]},this.hasCustom=function(t){return!!e.custom[t]}}return e.prototype.addCustom=function(e,t){if(this.custom[e])throw Error("custom stream "+e+" exists!");this.custom[e]=t},e.prototype._update=function(e,t,a){if(!this[e])throw Error(e+" stream group does not exists!");if(!this[e][t])throw Error(e+" stream "+t+" does not exists!");this[e][t].next(a)},e.prototype._get=function(e,t){if(!this[e])throw Error(e+" stream group does not exists!");if(!this[e][t])throw Error(e+" stream "+t+" does not exists!");return this[e][t]},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();var k={getLastPosts:{queryName:"getLastPosts",queryBody:"\n      {\n        getLastPosts(__PARAMS__) {\n          id\n          title\n        }\n      }\n    "},getTree:{queryName:"getTreeOfItems",queryBody:"\n    {\n      getTreeOfItems{\n        id\n        label\n        icon\n        branches {\n          label\n          id\n          img\n          branches {\n            label\n            id\n            icon\n            img\n            branches {\n              label\n              id\n              icon\n              img\n              branches {\n                label\n                id\n                icon\n                img\n                branches {\n                  label\n                  id\n                  icon\n                  img\n                  branches {\n                    label\n                    id\n                    icon\n                    img\n                    branches {\n                      label\n                      id\n                      icon\n                      img\n                      branches {\n                        label\n                        id\n                        icon\n                        img\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    "},globalFilter:{queryName:"globalFilter",queryBody:"{\n      globalFilter(__PARAMS__){\n        entitiesData {\n          entity {\n              id\n              label\n              typeOfEntity\n          } count\n        }\n        typeOfEntityData {\n          type\n          count\n        }\n        itemsPagination {\n          totalCount\n          items {\n            thumbnail\n            item {\n              id\n              label\n              fields\n              {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n              breadcrumbs {\n                label\n                link\n              }\n            }\n            relatedTypesOfEntity {\n              type\n              count\n            }\n          }\n        }\n      }\n      }"},getEntityDetails:{queryName:"getEntity",queryBody:"{\n      getEntity(__PARAMS__){\n        overviewTab\n        label\n        id\n        typeOfEntity\n        fields {\n          ...\n          on KeyValueField {\n            key\n            value\n          }\n          ... on\n          KeyValueFieldGroup {\n            label\n            fields\n            {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n            }\n          }\n        }\n        extraTab\n        wikiTab {\n          text\n          url\n        }\n        relatedItems {\n          thumbnail\n          item {\n            label\n            id\n            fields\n            {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n            }\n            breadcrumbs {\n              label\n              link\n            }\n          }\n          relatedTypesOfEntity {\n            type\n            count\n          }\n        }\n        relatedEntities {\n          entity {\n              id\n              label\n              typeOfEntity\n          }\n          count\n        }\n      }\n    }\n    "},getItem:{queryName:"getItem",queryBody:"{\n      getItem(__PARAMS__) {\n        id\n        label\n        icon\n        title\n        subTitle\n        image\n        text\n        fields {\n          ...\n          on KeyValueField {\n            key\n            value\n          }\n          ... on KeyValueFieldGroup {\n            label\n            fields {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n            }\n          }\n          }\n          relatedEntities {\n            count\n            entity{\n              id\n              label\n              typeOfEntity\n            }\n          }\n          relatedItems {\n            thumbnail\n            item {\n              label\n              id\n          }\n          relatedTypesOfEntity {\n            type\n            count\n          }\n        }\n        breadcrumbs {\n          label\n          link\n        }\n      }\n    }"},getNode:{queryName:"getNode",queryBody:"{\n      getNode(__PARAMS__) {\n        ... on Item {\n          id\n          label\n          icon\n          title\n          subTitle\n          image\n          text\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on KeyValueFieldGroup {\n              label\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n          relatedEntities {\n              count\n              entity{\n                id\n                label\n                typeOfEntity\n              }\n          }\n          relatedItems {\n              thumbnail\n              item {\n                label\n                id\n                fields {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                  ... on KeyValueFieldGroup {\n                    label\n                    fields {\n                      ...\n                      on KeyValueField {\n                        key\n                        value\n                      }\n                    }\n                  }\n                }\n            }\n            relatedTypesOfEntity {\n              type\n              count\n            }\n          }\n          breadcrumbs {\n            label\n            link\n          }\n        }\n        ... on Node {\n          id\n          label\n          img\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on KeyValueFieldGroup {\n              label\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n        }\n      }\n    }"},autoComplete:{queryName:"autoComplete",queryBody:"{\n      autoComplete(__PARAMS__){\n        totalCount\n        results {\n          ... on EntityCountData {\n            count\n            entity {\n              id\n              label\n              typeOfEntity\n              fields {\n                ... on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ... on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n          ... on ItemListing {\n            item {\n              id\n              label\n              document_type\n              fields {\n                ... on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ... on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }"},search:{queryName:"search",queryBody:"{\n      search(__PARAMS__){\n        totalCount\n        facets {\n          id\n          type\n          operator\n          limit\n          order\n          data {\n            label\n            value\n            counter\n            searchData {\n              key\n              value\n            }\n          }\n        }\n        results {\n          order{\n            type\n            key\n            direction\n          }\n          fields\n          {\n            id\n            highlight\n            limit\n          }\n          items {\n            ... on Entity {\n              id\n              label\n              typeOfEntity\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ...\n                    on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n              relatedEntities {\n                  count\n                  entity{\n                    id\n                    label\n                    typeOfEntity\n                  }\n              }\n              relatedItems {\n                  thumbnail\n                  item {\n                    label\n                    id\n                    fields {\n                      ...\n                      on KeyValueField {\n                        key\n                        value\n                      }\n                      ... on KeyValueFieldGroup {\n                        label\n                        fields {\n                          ...\n                          on KeyValueField {\n                            key\n                            value\n                          }\n                        }\n                      }\n                    }\n                }\n                relatedTypesOfEntity {\n                  type\n                  count\n                }\n              }\n            }\n            ... on Item {\n              id\n              label\n              icon\n              title\n              subTitle\n              image\n              text\n              relatedTypesOfEntity {\n                type\n                count\n              }\n              breadcrumbs {\n                label\n                link\n              }\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ...\n                    on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }"},getMissingBubble:{queryName:"getEntity",queryBody:"{\n      getEntity(__PARAMS__){\n        label\n        id\n        typeOfEntity\n      }\n    }"}},I=function(){function e(e,t){this.config=e,this.http=t;try{this.providerConfig=this.config.get("communication").providers.apollo}catch(e){throw Error("No config found for apollo provider!")}}return e.prototype.request$=function(e,t){var a=t.params,n=t.method,i=t.httpOptions,r=k[e];this.providerConfig.config&&this.providerConfig.config[e]&&(r=this.providerConfig.config[e]);var s=(r=r||{}).queryName,c=r.queryBody;if(!s||!c)throw Error("No config found for requestId '"+e+"'");if(a){var l=this.makeParamsStr(a);c=c.replace("__PARAMS__",l)}else c=c.replace("(__PARAMS__)","");return(n&&"GET"===n?this.http.get(this.providerConfig.baseUrl):this.http.post(this.providerConfig.baseUrl,{query:c},i)).pipe(o.map(function(e){return e.data[s]}))},e.prototype.makeParamsStr=function(e){var t=this,a=[];return Object.keys(e).forEach(function(n){if(Array.isArray(e[n])){var i=[];e[n].forEach(function(e){if("object"==typeof e){var a=t.makeParamsStr(e);i.push("{ "+a+" }")}else"number"==typeof e||"boolean"==typeof e||null===e?i.push(""+e):i.push('"'+e+'"')}),a.push(n+": ["+i.join(",")+"]")}else if("object"==typeof e[n]&&e[n]){var r=t.makeParamsStr(e[n]);a.push(n+": { "+r+" }")}else"string"==typeof e[n]&&0===n.indexOf("$")?a.push(n.replace("$","")+": "+e[n]):"number"==typeof e[n]||"boolean"==typeof e[n]||null===e[n]?a.push(n+": "+e[n]):a.push(n+': "'+e[n]+'"')}),a.join(" ")},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:w},{type:n.HttpClient}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(w),t.ɵɵinject(n.HttpClient))},token:e,providedIn:"root"}),e}();var E={getLastPosts:"posts"},C=function(){function e(e,t){this.config=e,this.http=t;try{this.providerConfig=this.config.get("communication").providers.rest}catch(e){throw Error("No config found for rest provider!")}}return e.prototype.request$=function(e,t){void 0===t&&(t={});var a=t.params,n=t.method,i=t.httpOptions,r=t.urlParams,o=void 0===r?"":r,s=E[e];if(n||(n=this.providerConfig.defaultMethod||"GET"),this.providerConfig.config&&this.providerConfig.config[e]&&(s=this.providerConfig.config[e]),!s)throw Error('No config found for requestId "'+e+'"');if("POST"===n||"PUT"===n)return this.http[n.toLowerCase()](this.providerConfig.baseUrl+s,a,i);if("GET"===n||"DELETE"===n)return this.http[n.toLowerCase()](this.providerConfig.baseUrl+s+o,i);throw Error("Rest method "+n+" not supported")},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:w},{type:n.HttpClient}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(w),t.ɵɵinject(n.HttpClient))},token:e,providedIn:"root"}),e}();var D=function(){function e(e,t,a){this.config=e,this.apollo=t,this.rest=a;try{this.communicationConfig=this.config.get("communication"),this.defaultProvider=this.communicationConfig.defaultProvider}catch(e){throw Error("No communications.defaultProvider setted in config")}}return e.prototype.request$=function(e,t,a){var n=this;if(void 0===t&&(t={}),!this[a=a||this.defaultProvider])throw Error("There is no "+a+" provider");var i=t.onError;return this[a].request$(e,t).pipe(o.catchError(function(e){return n.handleError(e,i)}))},e.prototype.handleError=function(e,t){return t?t(e):console.warn("No error handler for communication request",e),r.empty()},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:w},{type:I},{type:C}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(w),t.ɵɵinject(I),t.ɵɵinject(C))},token:e,providedIn:"root"}),e}();var x=function(){function e(e){this.config=e,this.widgets=this.config.widgets,this.lb=new l.LayoutBuilder(this.config.layoutId)}return e.prototype.initPayload=function(){},e.prototype.onInit=function(){var e=this;this.lb.ready$.subscribe(function(){e.lb.eventHandler.emitInner("init",e.initPayload())}),this.lb.init({widgetsConfig:this.widgets,widgetsDataSources:this.config.widgetsDataSources,widgetsEventHandlers:this.config.widgetsEventHandlers,dataSource:new this.config.layoutDS,eventHandler:new this.config.layoutEH})},e.prototype.onDestroy=function(){this.lb.eventHandler.emitInner("destroy")},e}();var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.onInit=function(e){var t=this,a=e.configuration,n=e.mainState,i=e.router,r=e.options,o=e.titleService,s=e.route;this.configuration=a,this.mainState=n,this.router=i,this.route=s,this.titleService=o,this.options=r,this.configuration.get("header")&&this.one("header").update({items:this.configuration.get("header")}),this.configuration.get("footer")&&this.one("footer").update({items:this.configuration.get("footer")}),this.mainState.get$("headTitle").subscribe(function(e){return t.titleService.setTitle(e)}),this.mainState.get$("pageTitle").subscribe(function(e){return t.pageTitle=e}),this.mainState.get$("subnav").subscribe(function(e){return t.one("subnav").update(e)}),this.mainState.get$("breadcrumbs").subscribe(function(e){return t.one("breadcrumbs").update(e)})},t.prototype.onNavigate=function(e){if("router"===e.handler){var t=e.path,a=e.queryParams;if(!t)throw Error("onNavigate: no path for router navigate");a?this.router.navigate(t,{relativeTo:this.route,queryParams:a,queryParamsHandling:"merge"}):this.router.navigate(t),this._onRouterNavigate()}},t.prototype.onRouterChanged=function(){u.hideAll()},t.prototype._onRouterNavigate=function(){u.hideAll()},t}(l.LayoutDataSource);var A=function(){function e(e,t){this.http=e,this.config=t}return e.prototype.load=function(e){var t=this;return this.http.get(e).pipe(o.catchError(function(e){return r.of({})}),o.tap(function(e){return t._handleResponse(e)})).toPromise()},e.prototype._handleResponse=function(e){var t=this;if(e&&(Object.keys(e).forEach(function(a){return t.config.set(a,e[a])}),e["config-keys"])){var a=document.querySelector("head"),n=document.createElement("style"),i=[];Object.keys(e["config-keys"]).forEach(function(t){var a=e["config-keys"][t]||{};a.color&&a.color.hex&&i.push("--color-"+t+": "+a.color.hex+";")}),i.length&&(i.unshift(":root {"),i.push("}"),n.appendChild(document.createTextNode(i.join("\n"))),a.appendChild(n))}},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:n.HttpClient},{type:w}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(n.HttpClient),t.ɵɵinject(w))},token:e,providedIn:"root"}),e}();var O=function(){function e(t){var a=this;this.isEmpty=!1,this.update=function(){return a.output=a.transform()},this.getId=function(){return a.id},this.getData=function(){return a.data},this.getConfig=function(){return a.config},this.getFacetId=function(){return a.config.facetId},this.getInputIndex=function(){return a.config.inputIndex},this.getSectionIndex=function(){return a.config.sectionIndex},this.getContext=function(){return a.config.filterConfig.context||"external"},this.getTarget=function(){return a.config.filterConfig.target||null},this.getSearchIn=function(){return a.config.filterConfig.searchIn||null},this.getType=function(){return a.config.type},this.getOutput=function(){return a.output},this.setIsEmpty=function(e){a.isEmpty=e},this.setData=function(e){return a.data=e},this.config=t,this._setId(),e.index++}return e.prototype.clear=function(){},e.prototype._setId=function(){this.id="facet-input-"+this.getType()+"-"+e.index},e.index=0,e}();var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(){var e=this,t=this.getFacetId();return this.data.map(function(a,n){var i=a.label,r=a.value;return r=""+r,{type:"checkbox",id:e.getId()+"-"+n,label:i,payload:{facetId:t,source:"input-checkbox",value:r},_meta:{facetId:t,value:r}}})},t.prototype.setActive=function(e){var t=this.config.filterConfig.isArray;this.output.forEach(function(a){t&&Array.isArray(e)&&-1!==e.indexOf(a._meta.value)?a.checked=!0:e===a._meta.value?a.checked=!0:a.checked=!1})},t}(O),F=new DOMParser,L={prettifySnakeCase:function(e,t){var a=this;return t||(e||"").split("_").map(function(e,t){return 0===t?a.ucFirst(e):e}).join(" ")},ucFirst:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},slugify:function(e){if(!e)return"";var t=F.parseFromString(e,"text/html").body.textContent||"";return p(t,{lower:!0})},browserIsIE:function(){return window.navigator.userAgent.match(/(MSIE|Trident)/)},escapeDoubleQuotes:function(e){return e.replace(/\\([\s\S])|(")/g,"\\$1$2")},unescapeDoubleQuotes:function(e){return e&&""!=e&&(e=e.replace(/\\(")/g,"$1")),e}},H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(){var e=this.getFacetId(),t={facetId:e,source:"input-text"};return{type:"text",id:this.getId(),label:this.config.label,disabled:this.config.disabled,placeholder:this.config.placeholder,icon:this.config.icon,inputPayload:y({},t,{trigger:"input"}),enterPayload:y({},t,{trigger:"enter"}),iconPayload:y({},t,{trigger:"icon"}),_meta:{facetId:e}}},t.prototype.setActive=function(e){this.output.value=L.unescapeDoubleQuotes(e)||null},t}(O),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(){var e,t,a=this.getFacetId(),n=[],i=0;try{for(var r=m(this.data),o=r.next();!o.done;o=r.next()){var s=o.value,c=s.label,l=s.counter,u=s.hidden,d=s.value,p=s.options;if(!u){if((i+=1)>1e3)break;d=""+d;var h=[];(p=p||{}).classes&&h.push(p.classes),this._isActive(this.facetValue,d)&&h.push("is-active"),n.push({type:"link",id:this.getId(),text:c,counter:l,payload:{facetId:a,source:"input-link",value:d},icon:p.icon||null,classes:h.join(" "),_meta:{facetId:a,value:d}})}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}var f=n.filter(function(e){return"empty"===e.id})[0];if(this.isEmpty)if(f)f.classes="empty-text-link";else{c=this.getConfig().emptyState.label;n.push({type:"link",id:"empty-link",text:c,classes:"empty-text-link",_meta:{facetId:"empty-link",value:null}})}else f&&(f.classes="empty-text-link is-hidden");return n},t.prototype.setActive=function(e){var t=this;this.output.forEach(function(a){var n=t._isActive(e,a._meta.value),i=a.classes?a.classes.split(" "):[];n?-1===i.indexOf("is-active")&&i.push("is-active"):i=i.filter(function(e){return"is-active"!==e}),a.classes=i.join(" ")})},t.prototype._isActive=function(e,t){return this.facetValue=e,Array.isArray(e)&&-1!==e.indexOf(t)||e===t},t.prototype.clear=function(){this.facetValue=[]},t}(O);var j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(){var e=this.getFacetId();return{type:"select",id:this.getId(),label:this.config.label,disabled:this.config.disabled,options:this.data?this.data.map(function(e){return{value:""+e.value,label:e.label}}):[],payload:{facetId:e,source:"input-select"},_meta:{facetId:e}}},t.prototype.setActive=function(e){this.output.options.filter(function(t){return t.value===e}).forEach(function(e){return e.selected=!0})},t}(O),B={checkbox:T,text:H,link:$,select:j},M={"=":"_filterDataEquals",">":"_filterDataGreaterThan","<":"_filterDataLessThan",">=":"_filterDataGreaterOrEquals","<=":"_filterDataLessOrEquals","<>":"_filterDataNotEqual",LIKE:"_filterDataLike"};var q=function(){function e(e,t){var a=this;this._filters=[],this._facets=[],this._inputs=[],this._results$=new r.Subject,this.getId=function(){return a._id},this.getFilters=function(){return a._filters},this.getFacets=function(){return a._facets},this.getInputs=function(){return a._inputs},this.getConfig=function(){return a._config},this.getTotalCount=function(){return a._totalCount},this.getFields=function(){return a._config.fields},this.getResults$=function(){return a._results$},this.setResults=function(e){return a._results$.next(e)},this._id=e,this._config=t,this._setFilters(),this._setFacets(),this._setPage(),this._setInputs(),this._setInputsData(),this._setTotalCount(),R.queryParams&&(this.updateFiltersFromQueryParams(R.queryParams),R.queryParams=null)}return e.prototype.updateFilter=function(e,t,a){this.getFiltersByFacetId(e).forEach(function(e){Array.isArray(e.value)&&a?e.value=e.value.filter(function(e){return e!==t}):Array.isArray(e.value)&&-1===e.value.indexOf(t)?e.value.push(t):e.value=a?null:L.escapeDoubleQuotes(t)})},e.prototype.clear=function(){this.updateFiltersFromQueryParams({},!0),this._clearInputs()},e.prototype.updateFiltersFromQueryParams=function(e,t){var a=this;void 0===t&&(t=!1),this._facets.forEach(function(n){var i=n.id,r=a.getFiltersByFacetId(i),o=e[i];"internal"===a.getInputByFacetId(i).getContext()&&!t||r.forEach(function(e){e.isArray?e.value=o?o.split(","):[]:e.value=o||null})})},e.prototype.updateInputsFromFilters=function(){var e=this;this._filters.forEach(function(t){var a=t.facetId,n=t.value;e.getInputByFacetId(a).setActive(n)})},e.prototype.updateFacets=function(e){var t=this;e.forEach(function(e){var a=e.id,n=e.data;return t.updateFacet(a,n)}),this._setInputsData()},e.prototype.updateTotalCount=function(e){this._totalCount=e},e.prototype.updateFacet=function(e,t){var a=this._facets.filter(function(t){return t.id===e});if(!a.length)throw Error("Facet with id '"+e+"' does not exists");a.forEach(function(e){return e.data=t})},e.prototype.reset=function(){this._filters.forEach(function(e){return e.value=null})},e.prototype.getRequestParams=function(){return{facets:this._getRequestFacets(),page:this._page,results:this._config.results,filters:this._filters.filter(function(e){return"internal"!==e.context}).map(function(e){return{facetId:e.facetId,value:e.value,searchIn:e.searchIn}})}},e.prototype.getInternalFilters=function(){return this._filters.filter(function(e){return"internal"===e.context&&(Array.isArray(e.value)&&e.value.length||!Array.isArray(e.value)&&e.value)}).map(function(e){return{facetId:e.facetId,value:e.value,searchIn:e.searchIn}})},e.prototype.filtersAsQueryParams=function(e){var t={};return e.forEach(function(e){return t[e.facetId]=Array.isArray(e.value)?e.value.join(","):e.value}),t},e.prototype.getFiltersByFacetId=function(e){return this._filters.filter(function(t){return t.facetId===e})},e.prototype.getInputByFacetId=function(e){return this._inputs.filter(function(t){return t.getFacetId()===e})[0]},e.prototype.setInputData=function(e,t){this.getInputByFacetId(e).setData(t)},e.prototype.filterTarget=function(e){var t=this,a=this._inputs.filter(function(t){return t.getTarget()===e}),n=this.getInputByFacetId(e),i=this._facets.filter(function(t){return t.id===e})[0].data,r=[];if(a.forEach(function(e){var a=t.getFiltersByFacetId(e.getFacetId())[0],n=e.getSearchIn(),i=a.value;r.push([n,i])}),i.forEach(function(e){return t._filterData(r,e)}),n.setData(i),n.getConfig().emptyState){var o=!i.filter(function(e){return!e.hidden}).length;n.setIsEmpty(o)}n.update()},e.prototype.setSearchConfigOrderBy=function(e){this._config.results.order.key=e},e.prototype.setSearchConfigDirection=function(e){this._config.results.order.direction=e},e.prototype.setPageConfigOffset=function(e){this._config.page.offset=e},e.prototype.setPageConfigLimit=function(e){this._config.page.limit=e},e.prototype._clearInputs=function(){this._inputs.forEach(function(e){e.clear()})},e.prototype._filterData=function(e,t){var a=this;t.hidden=!1,e.forEach(function(e){var n=v(e,2),i=n[0],r=n[1];i.forEach(function(e){var n=e.key,i=e.operator;if(!t.hidden){var o=d.get(t,n,null);if(-1!==n.indexOf("searchData")&&Array.isArray(t.searchData)){var s=n.replace("searchData.","");t.searchData.forEach(function(e){var t=e.key,a=e.value;t===s&&(o=a)})}null===o?t.hidden=!0:M[i]?t.hidden=a[M[i]](r,o):console.warn("SearchIn: operator "+i+" not supported")}})})},e.prototype._filterDataEquals=function(e,t){if(Array.isArray(t)){if(Array.isArray(e)){var a=0===e.length;return t.forEach(function(t){-1!==e.indexOf(t)&&(a=!0)}),!a}return!(e&&-1!==t.indexOf(e))}return Array.isArray(e)?!(!e.length||-1!==e.indexOf(t)):!(e&&e===t)},e.prototype._filterDataGreaterThan=function(e,t){return!Array.isArray(e)&&!(e&&e>t)},e.prototype._filterDataLessThan=function(e,t){return!Array.isArray(e)&&!(e&&e<t)},e.prototype._filterDataGreaterOrEquals=function(e,t){return!Array.isArray(e)&&!(e&&e>=t)},e.prototype._filterDataLessOrEquals=function(e,t){return!Array.isArray(e)&&!(e&&e<=t)},e.prototype._filterDataNotEqual=function(e,t){return!Array.isArray(e)&&!(e&&e!==t)},e.prototype._filterDataLike=function(e,t){if(e&&"string"==typeof e&&"string"==typeof t){var a=t.toLowerCase(),n=e.toLocaleLowerCase();return!(-1!==a.indexOf(n))}return!1},e.prototype._setFilters=function(){var e=this;this._config.fields.forEach(function(t){t.inputs.forEach(function(t){return e._filters.push(y({},t.filterConfig,{facetId:t.facetId,value:t.filterConfig.isArray?[]:null}))})})},e.prototype._setFacets=function(){this._facets=this._config.facets},e.prototype._setPage=function(){this._page=this._config.page},e.prototype._setTotalCount=function(){this._totalCount=this._config.totalCount},e.prototype._setInputs=function(){var e=this;this._config.fields.forEach(function(t,a){t.inputs.forEach(function(t,n){var i=B[t.type];if(!i)throw Error("Input type "+t.type+" not supported");e._inputs.push(new i(y({},t,{inputIndex:n,sectionIndex:a})))})})},e.prototype._setInputsData=function(){var e=this;this._facets.forEach(function(t){return e.setInputData(t.id,t.data)})},e.prototype._getRequestFacets=function(){var e=[];return this._facets.forEach(function(t){var a=y({},t);t.hasStaticData||delete a.data,delete a.hasStaticData,Array.isArray(a.data)&&a.data.filter(function(e){return void 0!==e.searchData}).forEach(function(e){delete e.searchData}),e.push(a)}),e},e}();var R=function(){function e(){this._models={}}return e.prototype.add=function(e,t){if(this._models[e])throw Error("Search model '"+e+"' already exists!");this._models[e]=new q(e,t)},e.prototype.remove=function(e){this._models[e]&&delete this._models[e]},e.prototype.model=function(e){return this._models[e]||null},e.queryParams=null,e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new r.Subject,t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"main-layout.init":e.dataSource.onInit(n),e.mainState=n.mainState,e.route=n.route,e.router=n.router,e._listenRouterChanges(),e._listenMainStateChanges();break;case"main-layout.destroy":e.destroyed$.next()}}),l.EventHandler.globalEvents$.pipe(o.takeUntil(this.destroyed$)).subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"global.navigate":e.dataSource.onNavigate(n)}})},t.prototype._listenRouterChanges=function(){var e=this;this.route.queryParams.pipe(o.filter(function(e){return!!Object.keys(e).length})).subscribe(function(t){e.emitGlobal("queryparams",t),R.queryParams=t}),this.router.events.pipe(o.filter(function(e){return e instanceof s.NavigationStart})).subscribe(function(t){e.dataSource.onRouterChanged()})},t.prototype._listenMainStateChanges=function(){var e=this;this.mainState.addCustom("currentNav",new r.Subject),this.mainState.getCustom$("currentNav").subscribe(function(t){e.emitOuter("currentnavchange",t)})},t}(l.EventHandler);var z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return e.items},t.prototype.onCurrentNavChange=function(e){this.output.nav.items.forEach(function(t){t._meta.id===e?t.classes="is-current":t.classes=""})},t}(l.DataSource),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return{classes:"main-subnav",items:e}},t.prototype.setActive=function(e){this.output.items.forEach(function(t){t._meta.id===e?(t.classes="is-current",t._meta.isActive=!0):(t.classes="",t._meta.isActive=!1)})},t.prototype.getActive=function(){return this.output.items.filter(function(e){return e._meta.isActive})[0]||null},t}(l.DataSource),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){var t=e.fields,a=this.options.searchModel;return this.searchModel=a,t},t}(l.DataSource);var K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getRequestParams=function(){return t.searchModel.getRequestParams()},t.filtersAsQueryParams=function(e){return t.searchModel.filtersAsQueryParams(e)},t.updateFiltersFromQueryParams=function(e){return t.searchModel.updateFiltersFromQueryParams(e)},t.getInputByFacetId=function(e){return t.searchModel.getInputByFacetId(e)},t.filterTarget=function(e){return t.searchModel.filterTarget(e)},t.updateInputsFromFilters=function(){return t.searchModel.updateInputsFromFilters()},t}return b(t,e),t.prototype.transform=function(e){var t=this;this.searchModel||(this.searchModel=e.searchModel);var a=this.searchModel.getId(),n=this.searchModel.getFields(),i=[];return n.forEach(function(e,n){var r="group-"+a+"-"+n,o=t._headerConfig(e.header,r),s=[];t.searchModel.getInputs().filter(function(e){return e.getSectionIndex()===n}).map(function(e){return e.update(),{facetId:e.getFacetId(),type:e.getType(),output:e.getOutput()}}).forEach(function(e){var a=e.type,n=e.output,i=e.facetId;s.push({classes:t._getSectionClasses(a),inputs:Array.isArray(n)?n:[n],_meta:{facetId:i}})}),i.push({header:o,facet:{sections:s},classes:"n7-facets-wrapper__"+r,isOpen:!0,_meta:{groupId:r}})}),{groups:i,classes:"n7-facets-wrapper__"+this.searchModel.getId()}},t.prototype.toggleGroup=function(e){var t=e.eventPayload;this.output.groups.forEach(function(e){e._meta.groupId===t.groupId&&(e.isOpen=!e.isOpen,e.header.iconRight=e.isOpen?"n7-icon-angle-down":"n7-icon-angle-right")})},t.prototype.onFacetChange=function(e){var t=e.eventPayload,a=t.inputPayload,n=a.facetId,i=a.source,r=a.trigger,o=(this.searchModel.getFiltersByFacetId(n)[0]||{}).value,s=!1,c=t.inputPayload.value||t.value;c=""+c,s=Array.isArray(o)?-1!==o.indexOf(c):o===c,"input-text"===i&&-1!==["enter","icon"].indexOf(r)||(this.searchModel.updateFilter(n,c,s),this.searchModel.updateInputsFromFilters())},t.prototype.updateFilteredTarget=function(e){var t=this.searchModel.getInputByFacetId(e);this.output.groups.map(function(e){return e.facet}).map(function(e){return e.sections}).map(function(a){a.forEach(function(a){if(a._meta.facetId===e){var n=t.getOutput();a.inputs=Array.isArray(n)?n:[n]}})})},t.prototype.updateInputLinks=function(){var e=this,t=this.searchModel.getInputs().filter(function(e){return"link"===e.getType()}).map(function(e){return e.getFacetId()});this.output.groups.map(function(e){return e.facet}).map(function(e){return e.sections}).map(function(a){a.forEach(function(a){if(-1!==t.indexOf(a._meta.facetId)){var n=e.searchModel.getInputByFacetId(a._meta.facetId);n.update();var i=n.getOutput();a.inputs=Array.isArray(i)?i:[i]}})})},t.prototype._getSectionClasses=function(e){return"n7-facet__section-input-"+{text:"text",checkbox:"checkboxes",link:"links",select:"select"}[e]},t.prototype._headerConfig=function(e,t){return e?{text:e.label,iconRight:"n7-icon-angle-down",classes:e.classes,payload:{source:"group-header",id:t+"-header",groupId:t},_meta:{id:t+"-header"}}:null},t}(l.DataSource);var Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){if(e)return e.items},t}(l.DataSource),U=Object.freeze({HeaderDS:z,SubnavDS:V,BreadcrumbsDS:W,FacetsDS:G,FacetsWrapperDS:K,FooterDS:Q}),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"main-layout.currentnavchange":e.dataSource.onCurrentNavChange(n)}})},t}(l.EventHandler),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"subnav.click":"navigate"===n.source&&e.emitGlobal("navigate",n),e.emitGlobal(a,n)}})},t}(l.EventHandler),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"breadcrumbs.click":"navigate"===n.source&&e.emitGlobal("navigate",n),e.emitGlobal(a,n)}})},t}(l.EventHandler),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){this.innerEvents$.subscribe(function(e){var t=e.type;e.payload})},t}(l.EventHandler),ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._facetsChanged=!1,t.internalFacetsChange$=new r.Subject,t.externalFacetsChange$=new r.Subject,t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"facets-wrapper.facet":if(!n.eventPayload.inputPayload)return;var i=n.eventPayload.inputPayload.facetId,r=e.dataSource.getInputByFacetId(i),o=r.getContext();e._facetsChanged=!0,e.dataSource.onFacetChange(n),"internal"===o?e.internalFacetsChange$.next(r.getTarget()):e.externalFacetsChange$.next();break;case"facets-wrapper.facetheader":e.dataSource.toggleGroup(n)}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;-1!==a.indexOf("queryparamschange")&&e.dataSource.searchModel&&(e.dataSource.updateFiltersFromQueryParams(n),e.dataSource.updateInputsFromFilters())}),l.EventHandler.globalEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"global.searchresponse":if(e.dataSource.searchModel&&e.dataSource.searchModel.getId()===n)e.dataSource.updateInputLinks(),e.dataSource.searchModel.getInternalFilters().forEach(function(t){var a=e.dataSource.searchModel.getInputByFacetId(t.facetId).getTarget();e.dataSource.filterTarget(a),e.dataSource.updateFilteredTarget(a)})}}),this.internalFacetsChange$.pipe(o.debounceTime(500)).subscribe(function(t){e.dataSource.filterTarget(t),e.dataSource.updateFilteredTarget(t)}),this.externalFacetsChange$.pipe(o.debounceTime(500)).subscribe(function(){var t=e.dataSource.getRequestParams(),a=e.dataSource.filtersAsQueryParams(t.filters);Object.keys(a).forEach(function(e){return a[e]=a[e]||null}),e.emitOuter("facetschange"),a.page=1,e.emitGlobal("navigate",{handler:"router",path:[],queryParams:a})})},t}(l.EventHandler);var te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){},t}(l.EventHandler),ae=Object.freeze({HeaderEH:X,SubnavEH:Y,BreadcrumbsEH:Z,FacetsEH:J,FacetsWrapperEH:ee,FooterEH:te}),ne={layoutId:"main-layout",widgets:[{id:"header"},{id:"subnav"},{id:"breadcrumbs"},{id:"footer"}],layoutDS:P,layoutEH:N,widgetsDataSources:U,widgetsEventHandlers:ae,options:{}},ie=function(e){function a(t,a,n,i,r,o){var s=e.call(this,i.get("MainLayoutConfig")||ne)||this;return s.router=t,s.route=a,s.configuration=n,s.layoutsConfiguration=i,s.mainState=r,s.titleService=o,s}return b(a,e),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:t.Component,args:[{selector:"main-layout",template:'<div class="n7-main-layout" id="main-layout">\n    <div class="n7-page-content">\n        <n7-header\n            [data]="lb.widgets[\'header\'].ds.out$ | async"\n            [emit]="lb.widgets[\'header\'].emit">\n        </n7-header>\n        <main class="n7-content">\n            <div class="n7-top-page-bar">\n                <div class="n7-top-page-bar__main"></div>\n            </div>\n            <div class="n7-alert-bar">\n                \x3c!--<n7-alert\n                [attr.id]="\'main-layout-alert\'"\n                [data]="lb.dataSource.alertData$ | async"\n                [emit]="lb.dataSource.closeAlert.bind(lb.dataSource)"></n7-alert>--\x3e\n            </div>\n            <ng-content></ng-content>\n        </main>\n    </div>\n    <n7-footer \n        [data]="lb.widgets[\'footer\'].ds.out$ | async" \n        [emit]="lb.widgets[\'footer\'].emit">\n    </n7-footer>\n</div>'}]}],a.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:w},{type:S},{type:_},{type:c.Title}]},a}(x);var re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.onInit=function(e){var t=e.options;this.options=t},t}(l.LayoutDataSource);var oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new r.Subject,t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"n7-page404-layout.init":e.dataSource.onInit(n);break;case"n7-page404-layout.destroy":e.destroyed$.next()}})},t}(l.EventHandler);var se={layoutId:"n7-page404-layout",widgets:[],layoutDS:re,layoutEH:oe,widgetsDataSources:U,widgetsEventHandlers:ae,options:{}},ce=function(e){function a(t){return e.call(this,t.get("Page404LayoutConfig")||se)||this}return b(a,e),a.prototype.initPayload=function(){return{options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:t.Component,args:[{selector:"n7-page404-layout",template:'<div class="n7-page404-layout">\n    404 - Resource not found\n</div>'}]}],a.ctorParameters=function(){return[{type:S}]},a}(x),le=function(){function e(){}return e.prototype.headerEmit=function(e,t){this.emit&&this.emit("facetheader",{eventType:e,eventPayload:t})},e.prototype.facetEmit=function(e,t){this.emit&&this.emit("facet",{eventType:e,eventPayload:t})},e.decorators=[{type:t.Component,args:[{selector:"n7-facets-wrapper",template:'<div *ngIf="data" class="n7-facets-wrapper {{ data.classes || \'\' }}">\n    <div *ngFor="let group of data.groups" class="n7-facets-wrapper__group {{ group.classes || \'\' }}">\n        <n7-facet-header\n            [data]="group.header"\n            [emit]="headerEmit.bind(this)"\n        ></n7-facet-header>\n\n        <n7-facet\n            *ngIf="group.isOpen"\n            [data]="group.facet"\n            [emit]="facetEmit.bind(this)"\n        ></n7-facet>\n    </div>\n</div>'}]}],e.propDecorators={data:[{type:t.Input}],emit:[{type:t.Input}]},e}();var ue=[ie,ce,le],de=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[_,w,S,D,I,{provide:"config",useValue:t}]}},e.decorators=[{type:t.NgModule,args:[{declarations:ue,imports:[a.CommonModule,n.HttpClientModule,i.DvComponentsLibModule],providers:[],exports:ue}]}],e}(),pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showFields=!1,t.navHeader={},t.pageSize=10,t.bubblesSize=10,t.updateComponent=function(e,a,n){n&&t.one(e).updateOptions(n),t.one(e).update(a)},t.handlePageNavigation=function(){if(t.myResponse){var e=t._getPaginationParams();t.one("aw-linked-objects").updateOptions({paginationParams:e,context:t.selectedTab,config:t.configuration,page:t.currentPage,pagination:!0,size:t.pageSize}),t.one("aw-linked-objects").update({items:t.myResponse.relatedItems})}},t.handleNavUpdate=function(e){t.selectedTab=e,t.updateWidgets(t.myResponse);"oggetti-collegati"===e?(t.one("aw-linked-objects").updateOptions({context:t.selectedTab,config:t.configuration,page:t.currentPage,pagination:!0,paginationParams:t._getPaginationParams(),size:t.pageSize}),t.one("aw-linked-objects").update({items:t.myResponse.relatedItems})):"overview"==e&&(t.one("aw-linked-objects").updateOptions({size:3,config:t.configuration,context:"entita"}),t.one("aw-linked-objects").update({items:t.myResponse.relatedItems})),"overview"!=e&&"entita-collegate"!=e||setTimeout(function(){t.updateBubbes(t.myResponse.relatedEntities)},800)},t}return b(t,e),t.prototype.onInit=function(e){var t=e.configuration,a=e.mainState,n=e.router,i=e.route,r=e.location,o=e.options,s=e.titleService,c=e.communication;this.route=i,this.communication=c,this.configuration=t,this.mainState=a,this.options=o,this.router=n,this.location=r,this.titleService=s,this.currentId="",this.currentPage=+this.route.snapshot.params.page,this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.bubblesSize=this.configuration.get("entita-layout")?this.configuration.get("entita-layout").entitiesQuerySize:this.bubblesSize,this.one("aw-bubble-chart").updateOptions({selectable:!1,simple:!0,config:this.configuration,limit:this.configuration.get("bubble-chart").bubbleLimit,smallChartSize:this.configuration.get("entita-layout").overview.smallChartSize}),this.one("aw-chart-tippy").updateOptions({basePath:this.configuration.get("paths").entitaBasePath}),this.mainState.updateCustom("currentNav","entita"),this.mainState.update("headTitle","Arianna Web > Entità")},t.prototype.getNavigation=function(e){return this.communication.request$("getEntityDetails",{onError:function(e){return console.error(e)},params:{entityId:e,entitiesListSize:this.bubblesSize}})},t.prototype.updateWidgets=function(e){var t=this.selectedTab;Object.keys(e).forEach(function(t){Array.isArray(e[t])&&0==e[t].length&&(e[t]=null)}),console.log({data:e}),this.one("aw-entita-nav").update({data:e,selected:t,basePath:this.getNavBasePath()}),this.updateComponent("aw-entita-metadata-viewer",this.myResponse.fields,{context:this.selectedTab,config:this.configuration,labels:this.configuration.get("labels")})},t.prototype.updateBubbes=function(e){this.one("aw-bubble-chart").update(e)},t.prototype.loadItem=function(e,t,a){if(e&&a)return this.currentId=e,this.currentSlug=t,this.selectedTab=a,this.communication.request$("getEntityDetails",{onError:function(e){return console.error(e)},params:{entityId:e,entitiesListSize:this.bubblesSize}});this.pageTitle="Entità Test"},t.prototype.loadContent=function(e){var t=this;this.myResponse=e,(e.fields||[]).filter(function(e){return((t.configuration.get("entita-layout")||{}).overview||{}).campi.includes(e.key)}).length>0?this.showFields=!0:this.showFields=!1,this.navHeader={icon:this.configuration.get("config-keys")[this.myResponse.typeOfEntity]?this.configuration.get("config-keys")[this.myResponse.typeOfEntity].icon:"",text:this.myResponse.label,color:this.myResponse.typeOfEntity.replace(/ /g,"-")},this.one("aw-entita-nav").updateOptions({bubblesEnabled:this.bubblesEnabled}),this.one("aw-entita-metadata-viewer").updateOptions({context:this.selectedTab,labels:this.configuration.get("labels"),config:this.configuration}),this.one("aw-entita-metadata-viewer").update(e.fields),"oggetti-collegati"==this.selectedTab?this.one("aw-linked-objects").updateOptions({context:this.selectedTab,config:this.configuration,page:this.currentPage,pagination:!0,paginationParams:this._getPaginationParams(),size:this.pageSize}):this.one("aw-linked-objects").updateOptions({size:3,config:this.configuration,context:"entita"}),this.one("aw-linked-objects").update({items:e.relatedItems}),this.mainState.update("headTitle","Arianna Web > Entità > "+this.myResponse.label)},t.prototype._getPaginationParams=function(){return{href:[this.configuration.get("paths").entitaBasePath,this.currentId+"/",this.currentSlug,"/oggetti-collegati/"].join(""),queryParams:{page:this.currentPage}}},t.prototype.getNavBasePath=function(){return[this.configuration.get("paths").entitaBasePath,this.currentId+"/",this.currentSlug].join("")},t}(l.LayoutDataSource);var he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new r.Subject,t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-entita-layout.init":e.dataSource.onInit(n),e.configuration=n.configuration,e.route=n.route,e.entityId=e.route.snapshot.params.id||"",e.dataSource.currentPage=e.route.snapshot.params.page||1,e.listenRoute(e.entityId);break;case"aw-entita-layout.destroy":e.destroyed$.next();break;case"aw-entita-layout.showmore":n&&e.dataSource.handleNavUpdate(n)}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-bubble-chart.d3end":e.emitOuter("d3end",n);break;case"aw-entita-nav.click":n&&(e.dataSource.selectedTab=n,e.dataSource.handleNavUpdate(n));break;case"aw-linked-objects.change":e.dataSource.pageSize=n,e.dataSource.currentPage=1;var i={context:e.dataSource.selectedTab,config:e.dataSource.configuration,page:e.dataSource.currentPage,pagination:!0,size:e.dataSource.pageSize};e.dataSource.updateComponent("aw-linked-objects",{items:e.dataSource.myResponse.relatedItems},i);break;case"aw-bubble-chart.bubble-tooltip-goto-click":var r=n.id,o=n.label;e.emitGlobal("navigate",{handler:"router",path:[e.configuration.get("paths").entitaBasePath,r,L.slugify(o),"overview"]});break;case"aw-bubble-chart.bubble-filtered":"overview"!=e.dataSource.selectedTab&&"entita-collegate"!=e.dataSource.selectedTab||e.emitOuter("filterbubbleresponse",n.relatedEntities)}})},t.prototype.listenRoute=function(e,t){var a=this;void 0===e&&(e=""),void 0===t&&(t=!1),this.route.queryParams.pipe(o.map(function(e){return e.page})).subscribe(function(e){a.dataSource.currentPage!==e&&(a.dataSource.currentPage=e,a.dataSource.handlePageNavigation())}),this.route.paramMap.subscribe(function(n){if(n.get("id")){if(a.dataSource.currentId===n.get("id")&&!t)return void(a.dataSource.selectedTab!==n.get("tab")&&a.dataSource.handleNavUpdate(n.get("tab")));a.dataSource.loadItem(n.get("id"),n.get("slug"),n.get("tab")).subscribe(function(t){if(t){a.dataSource.loadContent(t);var i=t.relatedEntities.filter(function(e){return e.id!==n.get("id")});a.dataSource.updateWidgets(t),e&&a.emitOuter("selectItem",e),a.emitOuter("filterbubbleresponse",i)}})}else a.dataSource.loadItem()})},t}(l.EventHandler);var fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadingData=!1,t.checkForMore=function(e){t.loadedData.actions&&(void 0===e?t.loadedData.result.length>=t.totalObjects?t.loadedData.actions[1].disabled=!0:t.loadedData.actions[1].disabled=!1:t.loadedData.actions[1].disabled=!e)},t.handleIncomingData=function(e){t.currentPage+=1;var a=t.unpackData(e.itemsPagination);t.loadedData.result=t.loadedData.result.concat(a.result),t.checkForMore(),t.loadedData.isLoading=!1},t.addPagination=function(e,a,n){t.loadedData.pagination={first:{classes:1===e?"is-disabled":"",anchor:1!==e?t._getPaginationAnchor(1):null},prev:{classes:1===e?"is-disabled":"",anchor:1!==e?t._getPaginationAnchor(e/1-1):null},next:{classes:e===a?"is-disabled":"",anchor:e!==a?t._getPaginationAnchor(e/1+1):null},last:{classes:e===a?"is-disabled":"",anchor:e!==a?t._getPaginationAnchor(a):null},links:t.makePagination(a,e),select:{label:"Numero di risultati",options:[10,25,50].map(function(e){return{text:e,selected:e===n}}),payload:"select-size"}}},t.makePagination=function(e,a){var n=[],i=t.options.paginationParams,r=(i.href,i.queryParams,t.paths.paginationLimit-1);if(e<=r&&(r=e-1),r){var o=void 0,s=void 0;a>Math.floor(r/2)?2===e?(o=e,s=1):a<e-Math.floor(r/2)?(o=a/1+Math.floor(r/2),s=a/1-Math.floor(r/2)):(o=e,s=a-r+(e-a)):(o=r+1,s=1);for(var c=s;c<=o;c++)n.push({text:String(c),classes:a===c?"is-active":"",anchor:a!==c?t._getPaginationAnchor(c):null})}else{n.push({text:"1",classes:1===a?"is-active":"",anchor:1!==a?t._getPaginationAnchor(1):null});for(c=1;c<e;c++)n.push({text:String(c+1),classes:a===c+1?"is-active":"",anchor:a!==c+1?t._getPaginationAnchor(c+1):null})}return n},t.unpackData=function(e){var a,n,i=t.options.config,r=i.get("item-preview"),o=e.totalCount,s=(t.totalPages,t.currentPage),c=t.context,l=t.pageSize,u=i.get("labels"),p=t.options.dynamicPagination,h=i?i.get("config-keys"):{},f=e.items?e.items:e.relatedItems;i&&i.get(c+"-layout")&&(a=i.get(c+"-layout")["max-item-length"],n=i.get(c+"-layout")["results-limit"]),!p&&l&&s?f=f.slice(s*l-l,s*l):l&&(f=f.slice(0,l));var g=[],b=r.metadata.info.selection.map(function(e){return e.key});return f.forEach(function(e){var t=e.item?e.item:e,a=d.get(e,r.metadata.info.data,t.fields),n=a?a.filter(function(e){return-1!==b.indexOf(e.key)}):[],o=d.get(e,r.metadata.toe.data,t.relatedTypesOfEntity),s=d.get(e,r.metadata.breadcrumbs.data,t.breadcrumbs);["entita","search"].includes(c)&&t.typeOfEntity&&""!=t.typeOfEntity&&n.push({key:"Tipo di entità",value:h[t.typeOfEntity]["singular-label"]});var l=["entita","search","oggetti-collegati"].includes(c)?"is-fullwidth":"";l+=t.typeOfEntity?" is-"+t.typeOfEntity.replace(/ /g,"-"):" is-oggetto-culturale";var p=+r.title.maxLength&&d.get(e,r.title,t.label).length>+r.title.maxLength?d.get(e,r.title,t.label).slice(0,+r.title.maxLength)+"…":d.get(e,r.title,t.label),f=d.get(e,r.payload,t.id),y=[t.typeOfEntity?i.get("paths").entitaBasePath:i.get("paths").schedaBasePath,f,L.slugify(p)].join("/"),m={image:d.get(e,r.image,t.image),title:p,text:r.text?+r.text.maxLength&&d.get(e,r.text.data,t.text).length>+r.text.maxLength?d.get(e,r.text.data,t.text).slice(0,+r.text.maxLength)+"…":d.get(e,r.text.data,t.text):null,anchor:{href:y},classes:l,metadata:n.length||o?[]:null,breadcrumbs:s};n.length&&m.metadata.push({classes:"n7-objects__metadata-artist",items:n.map(function(e){return{label:L.prettifySnakeCase(e.key,u[e.key]),value:e.value}})}),o&&m.metadata.push({classes:"n7-objects__metadata-linked",items:o.map(function(e){return{value:d.get(e,r.metadata.toe.value,e.count),icon:h[d.get(e,r.metadata.toe.icon,e.type).replace(" ","-")]?h[d.get(e,r.metadata.toe.icon,e.type).replace(" ","-")].icon:"",classes:"color-"+d.get(e,r.metadata.toe.icon,e.type).replace(" ","-")}})}),s&&(m.breadcrumbs={items:d.get(e,r.metadata.breadcrumbs.data,e.item.breadcrumbs).map(function(e){return{label:d.get(e,r.metadata.breadcrumbs.label,e.label),anchor:{href:y}}})}),g.push(m)}),"home"===c?{result:g,actions:[{label:"Mostra Tutti ("+o+")"},a?{label:"Mostra Altri ("+n+")",disabled:!1}:null],isLoading:!1,fallback:i.get("home-layout")["linked-objects-fallback"]}:{previews:g}},t}return b(t,e),t.prototype.transform=function(e){return this.paths=this.options.config.get("item-preview"),this.pageSize=this.options.size,this.totalObjects=e.totalCount,this.currentPage=this.options.page?+this.options.page:1,this.options.dynamicPagination&&this.options.dynamicPagination.total?this.totalPages=Math.ceil(this.options.dynamicPagination.total/this.pageSize):e.items?this.totalPages=Math.ceil(e.items.length/this.pageSize):e.relatedItems&&(this.totalPages=Math.ceil(e.relatedItems.length/this.pageSize)),this.context=this.options.context,this.loadedData=this.unpackData(e),this.options.pagination&&this.addPagination(this.currentPage,this.totalPages,this.pageSize),this.checkForMore(),this.loadedData.loaderData={},this.loadedData},t.prototype._getPaginationAnchor=function(e){var t=this.options.paginationParams,a=t.href,n=t.queryParams;return{href:n?a:a+e,queryParams:n?y({},n,{page:e}):null}},t}(l.DataSource);var ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stringTrim=function(e,t){return e.length>t?e.slice(0,t)+"…":e},t}return b(t,e),t.prototype.transform=function(e){var t=this,a=(e.key,e.response);if(!a)return{suggestion:[],loading:!0};var n=[],i=this.options.config.get("home-layout")["max-item-length"]||20;return a.results.filter(function(e){return"object"==typeof e.entity}).forEach(function(e){if("fallback"==e.entity.id)return n.push({text:e.entity.label,payload:"fallback-simple-autocomplete"}),{suggestion:n};var a=t.stringTrim(e.entity.label,i);n.push({text:a,anchor:{payload:e.entity.id}})}),{suggestion:n}},t}(l.DataSource);var be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chartData=[],t.draw=null,t.selected=[],t.filters=[],t.closedEyes=[],t.tippyList=[],t.updateChart=function(e){null===e?e=t.chartData:t.chartData=e,t.filters.length>0&&(e=t.chartData.filter(function(e){return!t.filters.includes(e.entity.typeOfEntity.replace(/ /g,"-"))})),t.draw?(t.output.selected=t.selected,t.output.data=t.smartSlice(e),t.output.smallView.data=t.smartSlice(e,t.options.smallChartSize),t.draw()):t.update(t.smartSlice(e))},t.smartSlice=function(e,a){var n=a||t.options.limit;return n&&n<e.length?e.slice(0,n):e},t.handleBubbleClick=function(e){var a=e;t.selected.includes(a)?t.selected.splice(t.selected.indexOf(a),1):t.selected.push(a)},t}return b(t,e),t.prototype.transform=function(e){var t=this,a=this.options,n=a.config,i=a.smallChartSize,r=n.get("bubble-chart"),o=r.fontRendering,s=r.transition,c=r.shuffle,l=[],u=[],d=n.get("config-keys");Object.keys(d).forEach(function(e){l.push(e.replace(/-/g," ")),u.push(((d[e]||{}).color||{}).hex)});var p={containerId:"bubbleChartContainer",setDraw:function(e){return t.draw=e},colorMatch:{domain:l,range:u},selected:this.selected,sizeRange:[.5,500],fontRendering:o,height:500,width:500,transition:s,shuffle:c};return y({},p,{anchorData:{href:"/placeholder/"},data:this.smartSlice(e),smallView:y({},p,{data:this.smartSlice(e,i)})})},t}(l.DataSource);var ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){var t=e.bubbles,a=e.selected,n=this.options,i=n.basePath,r=n.selectable;return t.map(function(e){var t=e.count,n=e.entity,o=n.id,s=n.label;n.typeOfEntity;return{id:o,selectable:r,title:s,text:"È collegato a "+t+" entità",isSelected:a.includes(o),anchorData:{href:""+i+o+"/"+h.slugify(s)}}})},t}(l.DataSource),me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentInputValue="",t}return b(t,e),t.prototype.transform=function(e){var t=e.title,a=e.text,n=e.button,i=e.backgroundImage,r=e.input;return{title:t,text:a,backgroundImage:i,button:{text:n.text,anchor:{payload:"cerca"}},input:{placeholder:r.placeholder,payload:"cerca-in-maxxi"}}},t}(l.DataSource);var ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return i.TABLE_MOCK},t}(l.DataSource),we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.autoComplete={},t.lockedFacets={},t.lastData={},t.closedEyes=[],t.openTippy="",t.tippyMaker=function(e){if(e=e.replace(/ /g,"-"),!t.autoComplete[e]){t.autoComplete[e]={tippy:void 0,open:!0};var a=t.autoComplete[e];if(!a.tippy){var n=document.getElementsByClassName(e)[1];a.tippy=f(n,{content:(i=document.getElementsByClassName("aw-simple-autocomplete__template")[0],i.setAttribute("style","display: block"),i),trigger:"manual",interactive:!0,arrow:!1,flip:!1,appendTo:"parent",theme:"light-border aw-home__facet-tippy",placement:"bottom-start",maxWidth:"100%"})}}var i,r=t.autoComplete[e];r.tippy&&r.tippy.show()},t.tippyClose=function(e){if(e=e.replace(/ /g,"-"),t.autoComplete[e]){var a=t.autoComplete[e];a.tippy&&a.tippy.hide()}},t}return b(t,e),t.prototype.transform=function(e){var t=this;this.lastData=e;var a=[],n=[],i=e,r=this.lockedFacets,o=this.closedEyes;Object.keys(this.autoComplete).forEach(function(e){t.autoComplete[e]&&t.autoComplete[e].tippy&&t.autoComplete[e].tippy.destroy()}),this.autoComplete={},i.forEach(function(e,t){if(Object.keys(r).forEach(function(e){var t=r[e].indexOf("LOCK_LAST");t>=0&&r[e].splice(t,1)}),o){if(o.length==i.length-1){var s=i.find(function(e){return!o.includes(e.type.replace(/ /g,"-"))});s&&(o[s.type]?r[s.type].push("LOCK_LAST"):r[s.type]=["LOCK_LAST"])}o.includes(e.type.replace(/ /g,"-"))?e.enabled=!1:e.enabled=!0}Object.keys(r).length&&r[e.type]&&r[e.type].length>0?e.locked=!0:e.locked=!1;var c=[],l=[e.icon];e.enabled||c.push("is-disabled"),e.configKey&&(c.push("color-"+e.configKey),l.push("color-"+e.configKey)),a.push({iconLeft:l.join(" "),text:e.label,additionalText:e.count,iconRight:e.enabled?"n7-icon-eye":"n7-icon-eye-slash",classes:c.join(" ")+(e.locked?" is-blocked":" not-blocked"),payload:!0===e.locked?null:e.type.replace(/ /g,"-")}),n.push({sections:[{inputs:[{id:e.type.replace(/ /g,"-")+"-"+t,type:"text",placeholder:e["input-placeholder"],icon:"n7-icon-search",disabled:!e.enabled,inputPayload:String(e.type.replace(/ /g,"-"))+"-search",iconPayload:String(e.type.replace(/ /g,"-"))+"-search",enterPayload:String(e.type.replace(/ /g,"-"))+"-search",classes:String(e.type.replace(" ","-"))+"-search"}]}]})});var s=[];return a.map(function(e,t){s.push({header:e,input:n[t]})}),s},t}(l.DataSource);var _e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){var t=e.response,a=e.query,n=t.results,i=t.totalCount,r=this.options,o=r.keys,s=r.config,c=r.paths,l=this.options.labels||{},u=[],d={};return n.forEach(function(e){var t=e.item,a=e.entity,n=a?a.typeOfEntity.replace(" ","-"):t.document_type,i=o[n],r=i["main-metadata"],s=t||a;if(!d[n]){var p=i.label,h=i.icon;d[n]={title:p,icon:h,classes:"color-"+n,items:[],type:n}}if(-1===u.indexOf(s.id)){var f=[];s.fields&&s.fields.forEach(function(e){var t=e.key,a=e.value;r&&t===r&&f.push({key:L.prettifySnakeCase(t,l[t]),value:a})}),d[n].items.push({title:s.label,metadata:f,anchor:{href:c[a?"entitaBasePath":"schedaBasePath"]+"/"+s.id+"/"+L.slugify(s.label)}})}}),{results:Object.keys(d).map(function(e){return{group:{title:d[e].title,icon:d[e].icon,classes:d[e].classes},items:d[e].items}}),actions:{showMore:{text:"Visualizza tutti i "+i+" risultati",anchor:{href:c.searchBasePath,queryParams:{query:a}}}},fallback:((s.get("home-layout")||{})["top-hero"]||{}).fallback}},t}(l.DataSource),Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){if(e){var t=e.data,a=e.selected,n={items:[],payload:"entita-nav"};return n.items.push({text:"OVERVIEW",anchor:{href:e.basePath+"/overview"},classes:"overview"===a?"is-selected":""}),t.fields&&t.fields.length>0&&n.items.push({text:"CAMPI",anchor:{href:e.basePath+"/campi"},classes:"campi"===a?"is-selected":""}),t.relatedItems&&n.items.push({text:"OGGETTI-COLLEGATI",anchor:{href:e.basePath+"/oggetti-collegati",queryParams:{page:1}},classes:"oggetti-collegati"===a?"is-selected":""}),t.relatedEntities&&this.options.bubblesEnabled&&n.items.push({text:"ENTITÀ COLLEGATE",anchor:{href:e.basePath+"/entita-collegate"},classes:"entita-collegate"===a?"is-selected":""}),t.extraTab&&n.items.push({text:"MAXXI",anchor:{href:e.basePath+"/maxxi"},classes:"maxxi"===a?"is-selected":""}),t.wikiTab&&n.items.push({text:"WIKIPEDIA",anchor:{href:e.basePath+"/wiki"},classes:"wiki"===a?"is-selected":""}),n}},t}(l.DataSource),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){var a=this.options,n=a.context,i=a.labels,r=a.config;i=i||{};var o=[];if("overview"==n){var s=((r.get("entita-layout")||{}).overview||{}).campi,c=e.filter(function(e){return s.includes(e.key)});o=t.unpackFields(c)}else o=t.unpackFields(e);return o.forEach(function(e){e.items.filter(function(e){return e.label}).forEach(function(e){return e.label=L.prettifySnakeCase(e.label,i[e.label])})}),{group:o}},t.unpackFields=function(e){var a=[];if(e instanceof Array)return[{items:a=e.map(function(e){return{label:e.key,value:e.value}})}];if(!e)return[];for(var n=0;n<e.length;n++){var i=e[n],r=i.label,o=i.key,s=i.value,c=i.fields,l={};r&&(l.title=r),o&&s&&(l.label=o,l.value=s),c&&(c[0].key?l.items=t.unpackFields(c):l.group=t.unpackFields(c)),a.push(l)}return a},t}(l.DataSource),Ce=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a._getCachedData=function(){return t.dataCache[a.rootId]},a._normalize=function(e){var t=e.id,n=e.label,i=e.icon,r=e.img,o=e.branches,s=!(!Array.isArray(o)||!o.length);a._getCachedData().flatData[t]={id:t,label:n,icon:i,img:r,hasBranches:s},s&&o.forEach(function(e){a._getCachedData().flatIds.push([t,e.id]),a._normalize(e)})},a._getParent=function(e){return a._getCachedData().flatIds.filter(function(t){return v(t,2)[1]===e}).map(function(e){return v(e,1)[0]})[0]||null},a._getTreePath=function(e){for(var t=[e],n=e;n;){var i=a._getParent(n);i&&t.push(i),n=i}return t.reverse()},a._getTree=function(e){var t={},n=0,i=function(t,r){var o=e[n+=1];r.items=[],a._getCachedData().flatIds.filter(function(e){return v(e,1)[0]===t}).forEach(function(e,t){var n=v(e,2)[1],s=n===o,c=a._getTreeItem(n,s);r.items.push(c),s&&i(n,r.items[t])})};return i(e[0],t),t},a._getTreeItem=function(e,t){var n=a._getCachedData().flatData[e],i=n.label,r=n.icon,o=n.img,s=n.hasBranches,c=t?"n7-icon-angle-down":"n7-icon-angle-right",l=[];return t&&l.push("is-expanded"),a.activeId===e&&l.push("is-active"),{classes:l.join(" "),text:i||null,img:o||null,icon:r||null,toggle:s?{icon:r||c,payload:{source:"toggle",id:e}}:null,meta:e,anchor:{href:a.basePath+"/"+e+"/"+L.slugify(i)}}},a}return b(t,e),t.prototype.transform=function(e){if(e)return e},t.prototype.load=function(e){var a=e.tree,n=e.basePath;this.rootId=a.id,this.basePath=n,t.dataCache[this.rootId]||(t.dataCache[this.rootId]={flatIds:[],flatData:{}},this._normalize(a))},t.prototype.build=function(e){var t=this._getTreePath(e),a=this._getTreePath(this.currentId).indexOf(e);if(a>0)t.splice(a),this.currentId=null;else if(this.currentId===e){var n=t.indexOf(this.currentId);t.splice(n),this.currentId=null}else this.currentId=e;var i=this._getTree(t);this.update(i)},t.prototype.setActive=function(e){this.activeId=e},t.prototype.highlightActive=function(){var e=this,t=function(a){a.forEach(function(a){var n,i=a.meta===e.activeId;-1===a.classes.indexOf("is-active")||i||((n=a.classes.split(" ")).splice(n.indexOf("is-active"),1),a.classes=n.join(" "));i&&(-1===(n=a.classes.split(" ")).indexOf("is-active")&&n.push("is-active"),a.classes=n.join(" "));Array.isArray(a.items)&&a.items.length&&t(a.items)})};t(this.output.items)},t.dataCache={},t}(l.DataSource);var De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return{iconLeft:"n7-icon-tree-icon",text:e.text||"",iconRight:"n7-icon-angle-left",classes:"is-expanded",payload:"header"}},t.prototype.toggleSidebar=function(){var e=this.output;"is-expanded"===e.classes?(e.classes="is-collapsed",e.iconRight="n7-icon-tree-icon"):(e.classes="is-expanded",e.iconRight="n7-icon-angle-left"),this.update(e)},t}(l.DataSource),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return e},t.prototype.toggleSidebar=function(){var e=this.output;"is-expanded"==e.classes?e.classes="is-collapsed":e.classes="is-expanded",this.update(e)},t}(l.DataSource),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){var t=this.options.labels;t=t||{};var a={group:[]};return e.fields&&e.fields.forEach(function(e){var n=[];e.fields?(e.fields.forEach(function(e){n.push({label:L.prettifySnakeCase(e.key,t[e.key]),value:e.value})}),a.group.push({title:e.label,items:n})):(n.push({label:L.prettifySnakeCase(e.key,t[e.key]),value:e.value}),a.group.push({items:n}))}),a},t}(l.DataSource),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selected="list",t}return b(t,e),t.prototype.transform=function(e){return{items:[{text:"LISTA",payload:"list",classes:"list"===this.selected?"is-selected":""},{text:"GRAFICO",payload:"chart",classes:"chart"===this.selected?"is-selected":""},{text:"TIMELINE",payload:"timeline",classes:"timeline"===this.selected?"is-selected":""}]}},t.prototype.setSelected=function(e){this.selected=e},t}(l.DataSource);var Fe=Object.freeze({AwLinkedObjectsDS:fe,AwAutocompleteWrapperDS:ge,AwBubbleChartDS:be,AwChartTippyDS:ye,AwHeroDS:me,AwTableDS:ve,AwHomeHeroPatrimonioDS:we,AwHomeFacetsWrapperDS:Se,AwHomeItemTagsWrapperDS:_e,AwHomeAutocompleteDS:ke,AwEntitaNavDS:Ie,AwEntitaMetadataViewerDS:Ee,AwTreeDS:Ce,AwSidebarHeaderDS:De,AwSchedaBreadcrumbsDS:xe,AwSchedaMetadataDS:Pe,AwSchedaImageDS:Ae,AwSchedaInnerTitleDS:Oe,AwSearchLayoutTabsDS:Te}),Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleScroll=function(e){var a=t.dataSource,n=a.totalObjects,i=a.loadedData;(Array.isArray(i.result)?i.result.length:0)>=n||e.scrollTop+e.clientHeight>=e.scrollHeight-150&&0==t.dataSource.loadedData.isLoading&&(t.dataSource.loadedData.isLoading=!0,t.emitOuter("datarequest",{currentPage:t.dataSource.currentPage}))},t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-linked-objects.change":e.emitOuter("change",+n.value);break;default:console.warn("unhandled event type: ",a," with payload: ",n)}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.viewmore":e.dataSource.checkForMore(!1),e.emitOuter("datarequest",{currentPage:e.dataSource.currentPage});break;case"aw-home-layout.dataresponse":var i=n.res;e.dataSource.handleIncomingData(i);case"aw-home-layout.scroll":e.handleScroll(n)}})},t}(l.EventHandler);var He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-autocomplete-wrapper.click":"fallback-simple-autocomplete"!==n&&e.emitOuter("clickresult",n);break;default:console.warn("unhandled event of type:",a)}})},t}(l.EventHandler),$e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.initialLoad=!1,t.toggleSelection=function(e){t.dataSource.handleBubbleClick(e),t.emitOuter("selection",t.dataSource.selected)},t.toggleFilter=function(e){t.dataSource.filters.includes(e)?t.dataSource.filters.splice(t.dataSource.filters.indexOf(e),1):t.dataSource.filters.push(e),t.dataSource.updateChart(null)},t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-bubble-chart.click":0!=e.dataSource.options.selectable&&e.toggleSelection(n),e.emitOuter("lockfilter",e.dataSource.chartData.find(function(e){return n==e.entity.id}));break;case"aw-bubble-chart.d3end":var i=void 0;i=e.dataSource.filters.length>0?e.dataSource.chartData.filter(function(t){return!e.dataSource.filters.includes(t.entity.typeOfEntity.replace(/ /g,"-"))}):e.dataSource.chartData,e.emitOuter("d3end",{bubbles:e.dataSource.smartSlice(i),selected:e.dataSource.selected});break;default:console.warn("unhandled inner event of type",a,"with payload",n)}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.select":var i=n.id;e.toggleSelection(i);var r=e.dataSource.chartData.find(function(e){return i==e.entity.id});r?e.emitOuter("lockfilter",r):console.warn("Unable to determine which bubble was selected.");break;case"aw-home-layout.tagclick":e.toggleSelection(n);break;case"aw-home-layout.facetclick":e.dataSource.selected.includes(n)||e.toggleSelection(n);break;case"aw-home-layout.togglefilter":e.toggleFilter(n);break;case"aw-home-layout.clearselection":e.dataSource.selected=[],e.emitOuter("selection",[]);break;case"aw-scheda-layout.filterbubbleresponse":case"aw-entita-layout.filterbubbleresponse":case"aw-home-layout.filterbubbleresponse":e.dataSource.updateChart(n)}})},t}(l.EventHandler);var je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tippyList=[],t.tippyMaker=function(e){t.tippyList.forEach(function(e){e&&e.destroy()}),t.tippyList=[],e.forEach(function(e){var a=document.getElementById("g_"+e.entity.id);a&&t.tippyList.push(f(a,{content:document.getElementById("template__"+e.entity.id),interactive:!0,appendTo:document.body,arrow:!0,flip:!1,theme:"light-border no-padding",placement:"top",delay:[150,30],updateDuration:400}))})},t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-chart-tippy.select":e.emitOuter("select",n);break;default:console.warn("(chart-tippy) unhandled inner event of type",a)}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.d3end":case"aw-entita-layout.d3end":case"aw-scheda-layout.d3end":e.dataSource.update(n),setTimeout(function(){e.tippyMaker(n.bubbles)})}})},t}(l.EventHandler);var Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(console.log(a,n),a){case"aw-hero.click":"cerca"===n&&e.dataSource.currentInputValue&&e.emitOuter("enter",e.dataSource.currentInputValue);break;case"aw-hero.change":e.dataSource.currentInputValue=n,e.emitOuter("change",n);break;case"aw-hero.enter":e.emitOuter("enter",n);break;default:console.log("(hero) unhandled event of type",a)}})},t}(l.EventHandler),Me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.changedInput$=new r.Subject,t.handleEyeClick=function(e){if(t.dataSource.closedEyes){var a=t.dataSource.closedEyes.indexOf(e);a>=0?t.dataSource.closedEyes.splice(a,1):t.dataSource.closedEyes.push(e)}else t.dataSource.closedEyes=[e];t.dataSource.update(t.dataSource.lastData)},t.updateFilters=function(e){e.entity.id.replace(/ /g,"-");var a=e.entity,n=a.id,i=a.typeOfEntity;if(t.dataSource.lockedFacets[i]||(t.dataSource.lockedFacets[i]=[]),t.dataSource.lockedFacets[i].includes(n)){var r=t.dataSource.lockedFacets[i].indexOf(n);t.dataSource.lockedFacets[i].splice(r,1)}else t.dataSource.lockedFacets[i].push(n);t.dataSource.update(t.dataSource.lastData)},t}return b(t,e),t.prototype.listen=function(){var e=this;this.changedInput$.pipe(o.debounceTime(500)).subscribe(function(t){e.emitOuter("change",t)}),this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-facets-wrapper.click":if(null===n)break;e.emitOuter("click",n),e.handleEyeClick(n);break;case"aw-home-facets-wrapper.change":e.dataSource.openTippy=n.inputPayload.replace("-search",""),e.changedInput$.next(n);break;case"aw-home-facets-wrapper.enter":e.emitOuter("enter",n);break;default:console.warn("unhandled inner event of type:",a)}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.facetswrapperrequest":e.dataSource.tippyMaker(n.facetId.inputPayload);break;case"aw-home-layout.facetswrapperclose":e.dataSource.tippyClose(n.facetId.inputPayload);break;case"aw-home-layout.facetswrapperresponse":break;case"aw-home-layout.lockfilter":e.updateFilters(n);break;case"aw-home-layout.tagclick":Object.keys(e.dataSource.lockedFacets).forEach(function(t){e.dataSource.lockedFacets[t].includes(n)&&e.dataSource.lockedFacets[t].splice(e.dataSource.lockedFacets[t].indexOf(n),1)}),e.dataSource.update(e.dataSource.lastData);break;case"aw-home-layout.clearselection":e.dataSource.lockedFacets={},e.dataSource.closedEyes=[],e.dataSource.update(e.dataSource.lastData);break;case"aw-home-layout.facetclick":var i=e.dataSource.openTippy;e.dataSource.lockedFacets[i]?-1==e.dataSource.lockedFacets[i].indexOf(n)&&e.dataSource.lockedFacets[i].push(n):e.dataSource.lockedFacets[i]=[n],e.dataSource.update(e.dataSource.lastData)}})},t}(l.EventHandler);var qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){},t}(l.EventHandler),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){switch(t.type){case"aw-home-item-tags-wrapper.click":e.emitOuter("click",t.payload)}})},t}(l.EventHandler),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-autocomplete.click":e.emitOuter("click",n)}})},t}(l.EventHandler),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-entita-nav.click":e.emitOuter("click",n);break;default:console.warn("unhandled event type")}})},t}(l.EventHandler),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;"aw-sidebar-header.click"==a&&(e.dataSource.toggleSidebar(),e.emitOuter(a,n))})},t}(l.EventHandler),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;"aw-sidebar-header.click"==a&&(e.dataSource.toggleSidebar(),e.emitOuter("click",n))})},t}(l.EventHandler),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){t.type;var a=t.payload;switch(a.source){case"toggle":e.dataSource.build(a.id)}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-sidebar-header.click":e.dataSource.toggleSidebar();break;case"aw-scheda-layout.selectItem":e.dataSource.build(n);break;case"aw-scheda-layout.navigationresponse":n.currentItem&&e.dataSource.setActive(n.currentItem);var i=n.currentItem||n.tree.id;e.dataSource.load(n),e.dataSource.build(i);break;case"aw-scheda-layout.routechanged":e.dataSource.output&&(e.dataSource.setActive(n),e.dataSource.highlightActive())}})},t}(l.EventHandler),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){},t}(l.EventHandler),Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){},t}(l.EventHandler),Ue=Object.freeze({AwLinkedObjectsEH:Le,AwAutocompleteWrapperEH:He,AwBubbleChartEH:$e,AwChartTippyEH:je,AwHeroEH:Be,AwHomeFacetsWrapperEH:Me,AwHomeHeroPatrimonioEH:qe,AwHomeItemTagsWrapperEH:Re,AwHomeAutocompleteEH:Ne,AwEntitaNavEH:ze,AwSchedaSidebarEH:Ve,AwSidebarHeaderEH:We,AwTreeEH:Ge,AwSearchLayoutTabsEH:Ke,AwTableEH:Qe}),Xe={layoutId:"aw-entita-layout",widgets:[{id:"aw-entita-nav",hasStaticData:!0},{id:"aw-entita-metadata-viewer"},{id:"aw-linked-objects"},{id:"aw-bubble-chart"},{id:"aw-chart-tippy"}],layoutDS:pe,layoutEH:he,widgetsDataSources:Fe,widgetsEventHandlers:Ue,options:{}},Ye=function(e){function n(t,a,n,i,r,o,s,c){var l=e.call(this,r.get("AwEntitaLayoutConfig")||Xe)||this;return l.router=t,l.route=a,l.location=n,l.configuration=i,l.layoutsConfiguration=r,l.communication=o,l.mainState=s,l.titleService=c,l}return b(n,e),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,location:this.location,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:t.Component,args:[{selector:"aw-entita-layout",template:'<div class="aw-entity n7-side-auto-padding" *ngIf="lb.dataSource">\n\n    <div class="aw-entity__sidebar">\n        \x3c!-- Custom header --\x3e\n        <div *ngIf="!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__sidebar-title-wrapper-loading">\n            <n7-content-placeholder [data]="{\n                blocks: [{\n                    classes: \'entity-placeholder-title\'\n                }]\n            }">\n            </n7-content-placeholder>\n        </div>\n        <div *ngIf="!!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)"\n            class="aw-entity__sidebar-title-wrapper color-{{lb.dataSource.navHeader.color}}">\n            <h1 class="aw-entity__sidebar-title">\n                <span class="aw-entity__sidebar-title-icon {{lb.dataSource.navHeader.icon}}"></span>\n                <span class="aw-entity__sidebar-title-text">{{lb.dataSource.navHeader.text}}</span>\n            </h1>\n        </div>\n        \x3c!-- Navigation --\x3e\n        <div *ngIf="!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__sidebar-nav-loading">\n            <n7-content-placeholder *ngFor="let n of [0,1,2]"\n            [data]="{\n                blocks: [{\n                    classes: \'entity-placeholder-nav\'\n                }]\n            }">\n            </n7-content-placeholder>\n        </div>\n        <n7-nav [data]="lb.widgets[\'aw-entita-nav\'].ds.out$ | async" [emit]="lb.widgets[\'aw-entita-nav\'].emit">\n        </n7-nav>\n    </div>\n\n    \x3c!-- lb.dataSource.selectedTab --\x3e\n    <div *ngIf="!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__content-loading">\n        <div class="aw-entity__content-loading-title">\n            <n7-content-placeholder [data]="{\n                blocks: [{\n                    classes: \'entity-placeholder-title\'\n                }]\n            }"></n7-content-placeholder>\n        </div>\n\n        <div class="aw-entity__content-loading-items">\n            <n7-content-placeholder *ngFor="let n of [0,1,2,3]"\n            [data]="{\n                blocks: [\n                {\n                    classes: \'entity-placeholder-item-preview\'\n                }\n                ]\n            }"></n7-content-placeholder>\n        </div>\n    </div>\n\n    <div *ngIf="!!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__content">\n        <section>\n            <div *ngIf="lb.dataSource.myResponse.wikiTab || lb.dataSource.myResponse.extraTab"\n                class="aw-entity__content-section" [hidden]="lb.dataSource.selectedTab != \'overview\'">\n                <div class="aw-entity__overview-description">\n                    {{lb.dataSource.myResponse.extraTab}}\n                </div>\n                <div class="aw-entity-layout__button-wrapper">\n                    <a *ngIf="lb.dataSource.myResponse.wikiTab" class="n7-btn n7-btn-light"\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/wiki\']">\n                        DESCRIZIONE WIKIPEDIA <i class="n7-icon-angle-right"></i>\n                    </a>\n                    <a *ngIf="lb.dataSource.myResponse.extraTab" class="n7-btn n7-btn-light"\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/maxxi\']">\n                        DESCRIZIONE MAXXI <i class="n7-icon-angle-right"></i>\n                    </a>\n                </div>\n            </div>\n\n            <ng-container *ngIf="\n            ((lb.dataSource.myResponse.fields || []).length > 0 && lb.dataSource.selectedTab == \'campi\') ||\n            (lb.dataSource.showFields && lb.dataSource.selectedTab == \'overview\')">\n                <div class="aw-entity__content-section aw-entity__content-section-overview"\n                    [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'campi\'">\n                    <div class="aw-entity__content-section-header">\n                        <h2 class="aw-entity__content-section-title">Campi</h2>\n                        <a class="n7-btn n7-btn-light" [routerLink]="[lb.dataSource.getNavBasePath() + \'campi\']">\n                            TUTTI I CAMPI <i class="n7-icon-angle-right"></i>\n                        </a>\n                    </div>\n                    <n7-metadata-viewer class="aw-entity-layout__metadata-viewer"\n                        [data]="lb.widgets[\'aw-entita-metadata-viewer\'].ds.out$ | async ">\n                    </n7-metadata-viewer>\n                </div>\n            </ng-container>\n\n            <div class="aw-entity__content-section aw-entity__content-section-overview"\n                *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews"\n                [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'oggetti-collegati\'">\n                <div class="aw-entity__content-section-header">\n                    <h2 class="aw-entity__content-section-title">Oggetti collegati</h2>\n\n                    <a *ngIf="lb.dataSource.selectedTab === \'overview\' "\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/oggetti-collegati/\']"\n                        [queryParams]="{ page: 1 }" class="n7-btn n7-btn-light">\n                        TUTTI GLI OGGETTI COLLEGATI <i class="n7-icon-angle-right"></i>\n                    </a>\n                </div>\n                <div class="aw-entity__content-item-previews">\n                    <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                        </n7-smart-breadcrumbs>\n                        <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                        </n7-item-preview>\n                    </ng-container>\n                </div>\n                <n7-pagination [data]="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.pagination"\n                    [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                </n7-pagination>\n            </div>\n\n            <div class="aw-entity__content-section aw-entity__content-section-overview aw-bubble-chart__{{lb.dataSource.selectedTab}}"\n                *ngIf="lb.dataSource.bubblesEnabled && lb.dataSource.myResponse.relatedEntities"\n                [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'entita-collegate\'">\n                <div class="aw-entity__content-section-header">\n                    <h2 class="aw-entity__content-section-title">Entità collegate</h2>\n                    <a *ngIf="lb.dataSource.selectedTab == \'overview\'" class="n7-btn n7-btn-light"\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/entita-collegate\']">\n                        TUTTE LE ENTITÀ COLLEGATE <i class="n7-icon-angle-right"></i>\n                    </a>\n                </div>\n                \x3c!-- Small Bubble Chart --\x3e\n                <div class="aw-entity__bubble-chart-wrapper-small" *ngIf="lb.dataSource.selectedTab == \'overview\'">\n                    <aw-bubble-chart-wrapper>\n                        \x3c!-- Tippy template moved to end of HTML --\x3e\n                        <n7-bubble-chart [data]="(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)?.smallView"\n                            [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                        </n7-bubble-chart>\n                    </aw-bubble-chart-wrapper>\n                </div>\n                \x3c!-- Big Bubble Chart --\x3e\n                <div class="aw-entity__bubble-chart-wrapper" *ngIf="lb.dataSource.selectedTab == \'entita-collegate\'">\n                    <aw-bubble-chart-wrapper>\n                        \x3c!-- Tippy template moved to end of HTML --\x3e\n                        <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                            [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                        </n7-bubble-chart>\n                    </aw-bubble-chart-wrapper>\n                </div>\n            </div>\n            <div class="aw-entity__content-section aw-entity__content-section-maxxi"\n                *ngIf="lb.dataSource.myResponse.extraTab" [hidden]="lb.dataSource.selectedTab != \'maxxi\'">\n                <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n                    <h2 class="aw-entity__content-section-title">Descrizione Maxxi</h2>\n                </div>\n                <div>\n                    {{lb.dataSource.myResponse.extraTab}}\n                </div>\n            </div>\n            <div class="aw-entity__content-section aw-entity__content-section-wiki"\n                *ngIf="lb.dataSource.myResponse.wikiTab" [hidden]="lb.dataSource.selectedTab != \'wiki\'">\n                <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n                    <h2 class="aw-entity__content-section-title">Descrizione Wikipedia</h2>\n                </div>\n                <div>\n                    {{lb.dataSource.myResponse.wikiTab.text}}\n                </div>\n                <a href="{{lb.dataSource.myResponse.wikiTabUrl}}">\n                    {{ lb.dataSource.myResponse.wikiTab.url }}\n                </a>\n            </div>\n        </section>\n    </div>\n    \x3c!-- Template for bubble chart tooltips --\x3e\n    <aw-chart-tippy [data]="lb.widgets[\'aw-chart-tippy\'].ds.out$ | async" [emit]="lb.widgets[\'aw-chart-tippy\'].emit">\n    </aw-chart-tippy>\n</div>'}]}],n.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:a.Location},{type:w},{type:S},{type:D},{type:_},{type:c.Title}]},n}(x);var Ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.facetInputs={},t.autocompletePopoverOpen=!1,t.autocompleteChanged$=new r.Subject,t.numOfItemsStr=null,t.currentHoverEntity=null,t.hasScrollBackground=!1,t.resultsLimit=-1,t.selectedEntitiesIds=[],t.destroyed$=new r.Subject,t.homeAutocompleteIsLoading=!1,t.resultsListIsLoading=!1,t.bubblesEnabled=!1,t.selectedBubbles=[],t.updateComponent=function(e,a,n){n&&t.one(e).updateOptions(n),t.one(e).update(a)},t}return b(t,e),t.prototype.onInit=function(e){var t=e.communication,a=e.mainState,n=e.configuration,i=e.tippy;this.communication=t,this.configuration=n,this.mainState=a,this.tippy=i,this.resultsLimit=this.configuration.get("home-layout")["results-limit"],this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.one("aw-hero").update(this.configuration.get("home-layout")["top-hero"]),this.one("aw-home-hero-patrimonio").update(this.configuration.get("home-layout")["bottom-hero"]),this.mainState.update("headTitle","Arianna Web > Home"),this.mainState.update("pageTitle","Arianna Web: Home Layout"),this.mainState.updateCustom("currentNav","home"),this._listenAutoCompleteChanges(),this.outerLinks=this.configuration.get("home-layout")["outer-links"].test,this.outerLinksTitle=this.configuration.get("home-layout")["outer-links"].title,this.one("aw-bubble-chart").updateOptions({selectable:!0,config:this.configuration,limit:this.configuration.get("bubble-chart").bubbleLimit}),this.one("aw-chart-tippy").updateOptions({basePath:this.configuration.get("paths").entitaBasePath,selectable:!0})},t.prototype.onDestroy=function(){this.destroyed$.next()},t.prototype.makeRequest$=function(e,t){return this.communication.request$(e,{onError:function(e){return console.error(e)},params:t})},t.prototype.initialFilterRequest=function(){return this.communication.request$("globalFilter",{onError:function(e){return console.error(e)},params:{entitiesListSize:this.configuration.get("bubble-chart").bubbleLimit}})},t.prototype.parseInitialRequest=function(e){var t=this;this.firstBubbleResponse=e.entitiesData;var a=[];e.typeOfEntityData.forEach(function(e){var n=t.configuration.get("config-keys")[e.type.replace(" ","-")];a.push(y({},e,{enabled:!0,locked:!1,configKey:e.type.replace(" ","-")},n))}),this.one("aw-home-facets-wrapper").update(a)},t.prototype.renderPreviewsFromApolloQuery=function(e){var t=this;if(e&&e.itemsPagination){var a=e.itemsPagination.totalCount;if(a>0){for(var n=0;a>999;)a-=1e3,n+=1;var i=a+"";a<10?i="00"+a:a<100&&(i="0"+a),this.numOfItemsStr=n>0?n+"."+i:a+""}else this.numOfItemsStr="0";this.one("aw-linked-objects").updateOptions({context:"home",config:this.configuration}),this.one("aw-linked-objects").update(e.itemsPagination),setTimeout(function(){t._scrollBackgroundControl()})}},t.prototype.updateTags=function(e){e||this.renderItemTags()},t.prototype.handleFacetSearchChange=function(e){var t=e.inputPayload,a=e.value;this.facetInputs[t]=a},t.prototype.handleFacetSearchEnter=function(e){var t=e.inputPayload;this.facetInputs[t]},t.prototype.renderItemTags=function(){var e=this,t=[],a=[];this.selectedBubbles.forEach(function(n){var i=e.firstBubbleResponse.find(function(e){return e.entity.id==n});if(i)a.push({label:i.entity.label,icon:"n7-icon-close",payload:n,classes:"tag-"+i.entity.typeOfEntity.replace(/ /g,"-")});else{var r={entityId:n,entitiesListSize:1};t.push(e.makeRequest$("getMissingBubble",r))}}),t.length>0?r.forkJoin(t).subscribe(function(t){t.forEach(function(e){a.push({label:e.label,icon:"n7-icon-close",payload:e.id,classes:"tag-"+e.typeOfEntity.replace(/ /g,"-")})}),e.one("aw-home-item-tags-wrapper").update(a)}):this.one("aw-home-item-tags-wrapper").update(a)},t.prototype.onHeroChange=function(e){e?(this.autocompleteChanged$.next(e),this.homeAutocompleteIsLoading=!0,this.homeAutocompleteQuery=e,this.autocompletePopoverOpen||this._toggleAutocompletePopover()):this.autocompletePopoverOpen&&this._toggleAutocompletePopover()},t.prototype._scrollBackgroundControl=function(){var e=this,t=document.getElementById("bubble-results-list");if(t){var a=r.fromEvent(t,"scroll");setTimeout(function(){e._setHasScrollBackground(t)},500),a.pipe(o.debounceTime(50)).subscribe(function(t){var a=t.target;e._setHasScrollBackground(a)})}},t.prototype._setHasScrollBackground=function(e){this.hasScrollBackground=!!e&&e.scrollHeight>e.scrollTop+e.clientHeight},t.prototype._listenAutoCompleteChanges=function(){var e=this;this.one("aw-home-autocomplete").updateOptions({keys:this.configuration.get("config-keys"),config:this.configuration,labels:this.configuration.get("labels"),paths:this.configuration.get("paths")}),this.autocompleteChanged$.pipe(o.debounceTime(500),o.takeUntil(this.destroyed$)).subscribe(function(t){e.communication.request$("autoComplete",{onError:function(e){return console.error(e)},params:{input:t,itemsPagination:{offset:0,limit:e.configuration.get("home-layout")["results-limit"]}}}).subscribe(function(a){e.homeAutocompleteIsLoading=!1,e.one("aw-home-autocomplete").update({response:a,query:t})})})},t.prototype._toggleAutocompletePopover=function(){var e=this;if(!this.autocompletePopover){var t=document.getElementById("aw-home-advanced-autocomplete-popover");t.style.display="block",this.autocompletePopover=this.tippy(".aw-home__top-hero .n7-hero__input",{content:t,trigger:"manual",interactive:!0,arrow:!1,flip:!1,appendTo:"parent",theme:"light-border",placement:"bottom-start",maxWidth:"100%",onHidden:function(){return e.autocompletePopoverOpen=!1}})[0]}this.autocompletePopoverOpen?this.autocompletePopover.hide():this.autocompletePopover.show(),this.autocompletePopoverOpen=!this.autocompletePopoverOpen},t}(l.LayoutDataSource);var Je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new r.Subject,t.handleSimpleAutocompleteClick=function(e){t.emitOuter("facetclick",e)},t.handleChartSelection=function(e){var a=e;t.dataSource.selectedBubbles=e,t.dataSource.resultsListIsLoading=!0,t.dataSource.makeRequest$("globalFilter",{selectedEntitiesIds:a,entitiesListSize:t.configuration.get("bubble-chart").bubbleLimit}).subscribe(function(e){if(t.dataSource.resultsListIsLoading=!1,e&&e.entitiesData.length>0)t.dataSource.lastBubbleResponse=e.entitiesData,t.emitOuter("filterbubbleresponse",e.entitiesData),t.dataSource.renderPreviewsFromApolloQuery(e),t.dataSource.renderItemTags();else{var a=[];t.dataSource.selectedBubbles.forEach(function(e){var n={entityId:e,entitiesListSize:1};a.push(t.dataSource.makeRequest$("getMissingBubble",n))}),r.forkJoin(a).subscribe(function(a){var n=[];a.forEach(function(e){n.push({count:0,entity:e})}),t.emitOuter("filterbubbleresponse",n),t.dataSource.renderPreviewsFromApolloQuery(e),t.dataSource.renderItemTags()})}})},t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.init":e.dataSource.onInit(n),e.loadFilters(),e.configuration=n.configuration;break;case"aw-home-layout.outerlinkclick":e.emitGlobal("navigate",{handler:"router",path:n});break;case"aw-home-layout.destroy":e.dataSource.onDestroy();break;case"aw-home-layout.bubbleresultsviewallclick":var i=e.dataSource.selectedBubbles.join(","),r=e.configuration.get("paths").searchBasePath;e.emitGlobal("navigate",{handler:"router",path:[r],queryParams:{"entity-links":i}});break;case"aw-home-layout.clearselection":e.emitOuter("clearselection");break;default:console.warn("(home) unhandled inner event of type: ",a)}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-bubble-chart.d3end":e.emitOuter("d3end",n);break;case"aw-chart-tippy.select":e.emitOuter("select",n);break;case"aw-hero.enter":var i=n.value;e.emitGlobal("navigate",{handler:"router",path:[e.configuration.get("paths").searchBasePath],queryParams:{query:i}});break;case"aw-hero.change":e.dataSource.autocompleteValue=n.value,e.dataSource.onHeroChange(n.value);break;case"aw-home-facets-wrapper.click":e.emitOuter("togglefilter",n);break;case"aw-home-facets-wrapper.change":if(!n.value||"string"==typeof n.value&&0===n.value.trim().length)e.emitOuter("facetswrapperclose",{facetId:n});else if(n.value){e.emitOuter("facetswrapperrequest",{facetId:n}),e.dataSource.updateComponent("aw-autocomplete-wrapper",{key:n.value,response:null});var r={input:n.value,typeOfEntity:n.inputPayload.replace(/-search/g,"").replace(/-/g," "),itemsPagination:{offset:0,limit:e.configuration.get("home-layout")["results-limit"]}};e.dataSource.makeRequest$("autoComplete",r).subscribe(function(t){if(t.results.length<1){var a={totalcount:0,results:[{entity:{id:"fallback",label:e.configuration.get("home-layout")["autocomplete-fallback"]?e.configuration.get("home-layout")["autocomplete-fallback"]:"Nessun risultato trovato"}}]};e.dataSource.updateComponent("aw-autocomplete-wrapper",{key:n.value,response:a},{config:e.configuration})}else e.dataSource.updateComponent("aw-autocomplete-wrapper",{key:n.value,response:t},{config:e.configuration})})}break;case"aw-home-facets-wrapper.enter":e.dataSource.handleFacetSearchEnter(n);break;case"aw-home-item-tags-wrapper.click":e.emitOuter("tagclick",n);break;case"aw-linked-objects.datarequest":var o=n.currentPage,s={selectedEntitiesIds:e.dataSource.selectedBubbles,itemsPagination:{offset:o*e.dataSource.resultsLimit,limit:e.dataSource.resultsLimit}};e.dataSource.makeRequest$("globalFilter",s).subscribe(function(t){t?e.emitOuter("dataresponse",{res:t}):console.log("Unable to fetch additional data.")});break;case"aw-autocomplete-wrapper.clickresult":e.handleSimpleAutocompleteClick(n);break;case"aw-home-autocomplete.click":var c=n.source,l=n.type,u=void 0;if("item"===c)u="oggetto-culturale"===l?e.configuration.get("paths").schedaBasePath:e.configuration.get("paths").entitaBasePath,e.emitGlobal("navigate",{handler:"router",path:[u,n.id,L.slugify(n.title)]});else if("showMore"===c){var d=e.dataSource.homeAutocompleteQuery;u=e.configuration.get("paths").searchBasePath,e.emitGlobal("navigate",{handler:"router",path:[u],queryParams:{query:d}})}break;case"aw-bubble-chart.selection":e.handleChartSelection(n);break;case"aw-bubble-chart.lockfilter":e.emitOuter("lockfilter",n)}})},t.prototype.loadFilters=function(){var e=this;this.dataSource.initialFilterRequest().subscribe(function(t){t&&(e.dataSource.parseInitialRequest(t),e.dataSource.bubblesEnabled&&e.emitOuter("filterbubbleresponse",t.entitiesData))})},t.prototype.outerLinkClick=function(e,t){window.open(t,"_blank")},t}(l.EventHandler);var et={layoutId:"aw-home-layout",widgets:[{id:"aw-hero"},{id:"aw-home-hero-patrimonio"},{id:"aw-bubble-chart"},{id:"aw-home-facets-wrapper"},{id:"aw-home-item-tags-wrapper"},{id:"aw-home-autocomplete"},{id:"aw-linked-objects"},{id:"aw-autocomplete-wrapper"},{id:"aw-chart-tippy"}],layoutDS:Ze,layoutEH:Je,widgetsDataSources:Fe,widgetsEventHandlers:Ue,options:{}},tt=function(e){function a(t,a,n,i,r){var o=e.call(this,t.get("AwHomeLayoutConfig")||et)||this;return o.router=a,o.configuration=n,o.communication=i,o.mainState=r,o}return b(a,e),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,communication:this.communication,options:this.config.options||{},tippy:f}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:t.Component,args:[{selector:"aw-home-layout",template:'<div class="aw-home" *ngIf="lb.dataSource">\n    \x3c!-- Hero section at the top of the page --\x3e\n    <div class="aw-home__top-hero">\n        <n7-hero [data]="lb.widgets[\'aw-hero\'].ds.out$ | async" [emit]="lb.widgets[\'aw-hero\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- Bubble chart --\x3e\n    <div class="aw-home__bubble-wrapper n7-side-auto-padding"\n        [ngClass]="{ \'has-results\' : lb.dataSource.selectedBubbles.length > 0 }" *ngIf="lb.dataSource.bubblesEnabled">\n        <div class="aw-home__facets-wrapper-loading" *ngIf="!(lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async)">\n            <n7-content-placeholder\n            [data]="{\n                blocks: [{\n                    classes: \'facet-placeholder-header\'\n                }, {\n                    classes: \'facet-placeholder-input\'\n                }] \n            }"></n7-content-placeholder>\n            <n7-content-placeholder\n            [data]="{\n                blocks: [{\n                    classes: \'facet-placeholder-header\'\n                }, {\n                    classes: \'facet-placeholder-input\'\n                }] \n            }"></n7-content-placeholder>\n            <n7-content-placeholder\n            [data]="{\n                blocks: [{\n                    classes: \'facet-placeholder-header\'\n                }, {\n                    classes: \'facet-placeholder-input\'\n                }] \n            }"></n7-content-placeholder>\n            <n7-content-placeholder\n            [data]="{\n                blocks: [{\n                    classes: \'facet-placeholder-header\'\n                }, {\n                    classes: \'facet-placeholder-input\'\n                }] \n            }"></n7-content-placeholder>\n        </div>\n        <div class="aw-home__facets-wrapper" *ngIf="!!(lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async)">\n            <span class="aw-home__facet"\n                *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;">\n                <n7-facet-header [data]="widgetData.header" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet-header>\n                <n7-facet [data]="widgetData.input" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet>\n            </span>\n        </div>\n\n        <div class="aw-home__bubble-chart-wrapper-loading" *ngIf="!(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)">\n            <n7-content-placeholder\n            [data]="{\n                blocks: [\n                    {\n                        classes: \'facet-placeholder-item-1\'\n                    }\n                ]\n            }"></n7-content-placeholder>\n        </div>\n        <div class="aw-home__bubble-chart-wrapper" *ngIf="!!(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)"\n            [style.overflow]="lb.dataSource.loadingBubbles ? \'visible\' : \'hidden\'">\n            <aw-bubble-chart-wrapper>\n                <aw-chart-tippy \n                    [data]="lb.widgets[\'aw-chart-tippy\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'aw-chart-tippy\'].emit">\n                </aw-chart-tippy>\n                <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                </n7-bubble-chart>\n            </aw-bubble-chart-wrapper>\n        </div>\n\n        \x3c!-- Linked objects --\x3e\n        <ng-container *ngIf="(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)?.selected.length > 0;">\n            <div class="aw-home__bubble-results" id="home-bubble-results">\n                <div *ngIf="lb.dataSource.numOfItemsStr" class="aw-home__bubble-results-title-wrapper">\n                    <h1 class="aw-home__bubble-results-title"><strong class="aw-home__bubble-results-title-counter">\n                            {{ lb.dataSource.numOfItemsStr }}</strong> <span> Oggetti culturali</span>\n                    </h1>\n                </div>\n                <div class="aw-home__bubble-tags-wrapper">\n                    <h3 class="aw-home__bubble-tags-title">Collegati a </h3>\n                    <ng-container *ngFor="let widgetData of lb.widgets[\'aw-home-item-tags-wrapper\'].ds.out$ | async;">\n                        <n7-tag [data]="widgetData" [emit]="lb.widgets[\'aw-home-item-tags-wrapper\'].emit">\n                        </n7-tag>\n                        <br>\n                    </ng-container>\n                </div>\n                \n                <div class="aw-home__bubble-results-list-wrapper">\n                    <div class="aw-home__bubble-results-list-loading" *ngIf="lb.dataSource.resultsListIsLoading">\n                        <n7-content-placeholder\n                        [data]="{\n                            blocks: [{\n                                classes: \'search-result-placeholder-title\'\n                            }, {\n                                classes: \'search-result-placeholder-metadata\'\n                            }]\n                        }"></n7-content-placeholder>\n                        <n7-content-placeholder\n                        [data]="{\n                            blocks: [{\n                                classes: \'search-result-placeholder-title\'\n                            }, {\n                                classes: \'search-result-placeholder-metadata\'\n                            }]\n                        }"></n7-content-placeholder>\n                        <n7-content-placeholder\n                        [data]="{\n                            blocks: [{\n                                classes: \'search-result-placeholder-title\'\n                            }, {\n                                classes: \'search-result-placeholder-metadata\'\n                            }]\n                        }"></n7-content-placeholder>\n                        <n7-content-placeholder\n                        [data]="{\n                            blocks: [{\n                                classes: \'search-result-placeholder-title\'\n                            }, {\n                                classes: \'search-result-placeholder-metadata\'\n                            }]\n                        }"></n7-content-placeholder>\n                        <n7-content-placeholder\n                        [data]="{\n                            blocks: [{\n                                classes: \'search-result-placeholder-title\'\n                            }, {\n                                classes: \'search-result-placeholder-metadata\'\n                            }]\n                        }"></n7-content-placeholder>\n                    </div>\n                    <div\n                    *ngIf="!lb.dataSource.resultsListIsLoading" \n                    class="aw-home__bubble-results-list" [attr.id]="\'bubble-results-list\'"\n                        (scroll)="lb.eventHandler.emitOuter(\'scroll\', $event.target)">\n\n                        <div class="aw-home__bubble-results-fallback"\n                            *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result.length < 1;">\n                            <p class="aw-home__bubble-results-fallback-text">\n                                {{ (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.fallback }}\n                            </p>\n                            <button class="n7-btn aw-home__bubble-results-reset"\n                                (click)="lb.eventHandler.emitInner(\'clearselection\')">\n                                Resetta la ricerca\n                            </button>\n                        </div>\n\n                        <ng-container\n                            *ngFor="let widgetData of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result;">\n                            <n7-item-preview [data]="widgetData" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                            </n7-item-preview>\n                        </ng-container>\n\n                        <ng-container *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.isLoading">\n                            <div class="aw-home__bubble-results-list-loader">\n                                <n7-loader [data]="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.loaderData">\n                                </n7-loader>\n                            </div>\n                        </ng-container>\n                    </div>\n                    <div [ngClass]="{ \'is-visible\' : lb.dataSource.hasScrollBackground }"\n                         class="aw-home__bubble-results-list-wrapper-with-scroll"></div>\n                </div>\n                \x3c!-- aw-linked-objects__actions --\x3e\n                <ng-container *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result.length > 0 && !lb.dataSource.resultsListIsLoading">\n                    <div *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.actions as action"\n                        class="aw-home__bubble-results-list-actions">\n                        <button (click)="lb.eventHandler.emitInner(\'bubbleresultsviewallclick\')"\n                            class="n7-btn n7-btn-light n7-btn-l aw-home__bubble-results-list-view-all">\n                            {{action[0].label}}\n                        </button>\n                    </div>\n                </ng-container>\n\n            </div>\n        </ng-container>\n    </div>\n\n    \x3c!-- Outer links --\x3e\n    <div *ngIf="lb.dataSource.outerLinks && lb.dataSource.outerLinks.length > 0" class="aw-home__outer-links">\n        <section class="aw-home__outer-links-wrapper n7-side-auto-padding">\n            <h2 class="aw-home__outer-links-title" *ngIf="lb.dataSource.outerLinksTitle">\n                {{ lb.dataSource.outerLinksTitle }}\n            </h2>\n            <div class="aw-home__outer-links-items">\n                \x3c!-- Item preview --\x3e\n                <n7-item-preview *ngFor="let outerLink of lb.dataSource.outerLinks" [data]="outerLink"\n                    [emit]="lb.eventHandler.outerLinkClick.bind(lb.eventHandler)">\n                </n7-item-preview>\n                \x3c!-- END // Item preview --\x3e\n            </div>\n        </section>\n    </div>\n    \x3c!-- END // Outer links --\x3e\n\n    \x3c!-- Hero section at the bottom of the page --\x3e\n    <div class="aw-home__bottom-hero">\n        <n7-hero [data]="lb.widgets[\'aw-home-hero-patrimonio\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-hero-patrimonio\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- Adavanced autocomplete popover  --\x3e\n    <div class="aw-home__advanced-autocomplete" id="aw-home-advanced-autocomplete-popover" style="display: none;">\n        <div class="aw-home__advanced-autocomplete-loader" *ngIf="lb.dataSource.homeAutocompleteIsLoading">\n            <n7-loader [data]="{}"></n7-loader>\n        </div>\n        <n7-advanced-autocomplete *ngIf="!lb.dataSource.homeAutocompleteIsLoading"\n            [data]="lb.widgets[\'aw-home-autocomplete\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-autocomplete\'].emit">\n        </n7-advanced-autocomplete>\n    </div>\n\n    \x3c!-- Simple autocomplete popover. DO NOT CHANGE parent div class! --\x3e\n    \x3c!-- Creating one template for each facet --\x3e\n    <div *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;"\n        class="aw-home__simple-autocomplete aw-simple-autocomplete__template" style="display: none;">\n        <div class="aw-home__simple-autocomplete-content aw-simple-autocomplete__tippy-wrapper">\n            <div class="aw-home__simple-autocomplete-loader aw-simple-autocomplete__tippy-wrapper-loader" *ngIf="(lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async)?.loading">\n                <n7-loader [data]="{}"></n7-loader>\n            </div>\n            <n7-simple-autocomplete \n                *ngIf="!(lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async)?.loading"\n                [data]="lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-autocomplete-wrapper\'].emit">\n            </n7-simple-autocomplete>\n        </div>\n    </div>\n</div>'}]}],a.ctorParameters=function(){return[{type:S},{type:s.Router},{type:w},{type:D},{type:_}]},a}(x);var at=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.destroyed$=new r.Subject,a.stickyControlTrigger$=new r.Subject,a.contentParts={},a.sidebarIsSticky=!1,a.treeMaxHeight="100%",a.contentIsLoading=!1,a.currentId=null,a.getTree=function(){return t.tree},a}return b(t,e),t.prototype.onInit=function(e){var t=e.configuration,a=e.mainState,n=e.router,i=e.options,r=e.titleService,o=e.communication;this.configuration=t,this.mainState=a,this.router=n,this.titleService=r,this.communication=o,this.options=i,this.sidebarCollapsed=!1,this.bubbleChartSectionTitle=this.configuration.get("scheda-layout")["bubble-chart"].title,this.similarItemsSectionTitle=this.configuration.get("scheda-layout")["related-items"].title,this.metadataSectionTitle=this.configuration.get("scheda-layout").metadata.title,this.hasSimilarItems=!1,this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.one("aw-bubble-chart").updateOptions({selectable:!1,simple:!0,config:this.configuration,limit:this.configuration.get("bubble-chart").bubbleLimit}),this.one("aw-chart-tippy").updateOptions({basePath:this.configuration.get("paths").entitaBasePath}),this.emptyLabel=this.configuration.get("scheda-layout")["empty-label"],this.mainState.update("headTitle","Arianna Web > Patrimonio"),this.mainState.update("pageTitle","Arianna Web: patrimonio Layout"),this.mainState.updateCustom("currentNav","patrimonio"),this._sidebarStickyControl()},t.prototype.onDestroy=function(){this.destroyed$.next()},t.prototype.getNavigation=function(e){return t.tree?r.of(t.tree):this.communication.request$("getTree",{onError:function(e){return console.error(e)},params:{treeId:e}})},t.prototype.setTree=function(e){t.tree=e},t.prototype.updateNavigation=function(e){this.one("aw-sidebar-header").update({text:e})},t.prototype.loadItem=function(e){var t=this.configuration.get("scheda-layout")["related-items"]["max-related-items"];return this.communication.request$("getNode",{onError:function(e){return console.error(e)},params:{id:e,maxSimilarItems:t}})},t.prototype.loadContent=function(e){var t=this;if(e){this.hasMetadata=Array.isArray(e.fields)&&e.fields.length,this.hasSimilarItems=Array.isArray(e.relatedItems)&&e.relatedItems.length,this.hasBreadcrumb=Array.isArray(e.breadcrumbs)&&e.breadcrumbs.length,this.hasBubbles=Array.isArray(e.relatedEntities)&&e.relatedEntities.length,this.hasImage=!!e.image,this.contentParts=[];var a={};if(e.text&&(a.content=e.text),this.contentParts.push(a),e.image){var n=[{type:"image",url:e.image,buildPyramid:!1}];this.imageViewerIstance?this.imageViewerIstance.open(n):this.one("aw-scheda-image").update({viewerId:"scheda-layout-viewer",_setViewer:function(e){t.imageViewerIstance=e,e.open(n)}})}var i={icon:e.icon,title:{main:{text:e.title||e.label,classes:"bold"}},tools:e.subTitle,actions:{}};this.one("aw-scheda-inner-title").update(i),this.one("aw-scheda-metadata").updateOptions({labels:this.configuration.get("labels")}),this.one("aw-scheda-metadata").update(e);var r={items:[]};e.breadcrumbs&&(e.breadcrumbs.forEach(function(e){r.items.push({label:e.label,anchor:{href:[t.configuration.get("paths").schedaBasePath,e.link+"/",h.slugify(e.label)].join("")}})}),this.one("aw-scheda-breadcrumbs").update(r)),this.mainState.update("headTitle","Arianna Web > Patrimonio > "+(e.title||e.label))}e.relatedItems&&(this.one("aw-linked-objects").updateOptions({context:"scheda",config:this.configuration}),this.one("aw-linked-objects").update(e)),setTimeout(function(){t.stickyControlTrigger$.next()})},t.prototype.collapseSidebar=function(){this.sidebarCollapsed=!this.sidebarCollapsed},t.prototype._sidebarStickyControl=function(){var e=this;if(!h.browserIsIE()){var t=r.fromEvent(window,"scroll");r.merge(t,this.stickyControlTrigger$).pipe(o.takeUntil(this.destroyed$)).subscribe(function(){var t=window.pageYOffset,a=window.scrollY+window.innerHeight,n=document.getElementsByClassName("sticky-parent")[0],i=n.offsetTop,r=i+n.clientHeight;e.sidebarIsSticky=i<=t,e.sidebarIsSticky&&a<r?e.treeMaxHeight=a-t-50+"px":e.sidebarIsSticky&&a>=r?e.treeMaxHeight=r-t-50+"px":e.treeMaxHeight=a<r?a-i-50+"px":r-i-50+"px"})}},t.tree=null,t}(l.LayoutDataSource);var nt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new r.Subject,t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-scheda-layout.init":e.dataSource.onInit(n),e.configuration=n.configuration,e.route=n.route;var i=e.route.snapshot.params.id||"";i&&(e.dataSource.currentId=i),e.listenRoute(),e.loadNavigation(i);break;case"aw-scheda-layout.destroy":e.destroyed$.next(),e.dataSource.onDestroy()}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-bubble-chart.d3end":e.emitOuter("d3end",n);break;case"aw-sidebar-header.click":e.dataSource.collapseSidebar();break;case"aw-bubble-chart.bubble-tooltip-goto-click":var i=n.id,r=n.label;e.emitGlobal("navigate",{handler:"router",path:[e.configuration.get("paths").entitaBasePath,i,L.slugify(r),"overview"]})}})},t.prototype.listenRoute=function(){var e=this;this.route.paramMap.subscribe(function(t){var a=t.get("id");a&&(a&&(e.dataSource.currentId=a,e.emitOuter("routechanged",a)),e.dataSource.contentIsLoading=!0,e.dataSource.loadItem(a).subscribe(function(t){e.dataSource.contentIsLoading=!1,t&&(e.dataSource.loadContent(t),Array.isArray(t.relatedEntities)&&t.relatedEntities.length&&e.dataSource.bubblesEnabled&&e.emitOuter("filterbubbleresponse",t.relatedEntities))}))})},t.prototype.loadNavigation=function(e){var t=this;this.dataSource.updateNavigation("Loading..."),this.dataSource.getNavigation("patrimonio").subscribe(function(a){a&&(t.dataSource.setTree(a),t.dataSource.updateNavigation(t.dataSource.getTree().label),t.emitOuter("navigationresponse",{tree:t.dataSource.getTree(),currentItem:e,basePath:t.configuration.get("paths").schedaBasePath}))})},t}(l.EventHandler);var it={layoutId:"aw-scheda-layout",widgets:[{id:"aw-sidebar-header"},{id:"aw-tree"},{id:"aw-scheda-breadcrumbs"},{id:"aw-scheda-metadata"},{id:"aw-scheda-image"},{id:"aw-scheda-inner-title"},{id:"aw-bubble-chart"},{id:"aw-chart-tippy"},{id:"aw-linked-objects"}],layoutDS:at,layoutEH:nt,widgetsDataSources:Fe,widgetsEventHandlers:Ue,options:{}},rt=function(e){function a(t,a,n,i,r,o,s){var c=e.call(this,i.get("AwPatrimonioLayoutConfig")||it)||this;return c.router=t,c.route=a,c.configuration=n,c.layoutsConfiguration=i,c.mainState=r,c.titleService=o,c.communication=s,c}return b(a,e),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:t.Component,args:[{selector:"aw-scheda-layout",template:'<div class="aw-scheda" id="scheda-layout">\n    <div class="aw-scheda__content n7-side-auto-padding sticky-parent"\n        [ngClass]="{ \'is-collapsed\' : lb.dataSource.sidebarCollapsed }">\n        \x3c!-- Left sidebar: tree --\x3e\n        <div class="aw-scheda__tree sticky-target" [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <n7-sidebar-header [data]="lb.widgets[\'aw-sidebar-header\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-sidebar-header\'].emit"></n7-sidebar-header>\n            <div class="aw-scheda__tree-content-loading" *ngIf="!(lb.widgets[\'aw-tree\'].ds.out$ | async)">\n                <n7-content-placeholder *ngFor="let n of [0,1,2,3]" [data]="{\n                    blocks: [{\n                        classes: \'tree-placeholder-item\'\n                    }]\n                }"></n7-content-placeholder>\n            </div>\n            <div class="aw-scheda__tree-content" [ngStyle]="{ \n                    \'max-height\': lb.dataSource.treeMaxHeight, \n                    \'overflow\': \'auto\' \n                }">\n                <n7-tree [data]="lb.widgets[\'aw-tree\'].ds.out$ | async" [emit]="lb.widgets[\'aw-tree\'].emit"\n                    *ngIf="!lb.dataSource.sidebarCollapsed"></n7-tree>\n            </div>\n        </div>\n\n        \x3c!-- Scheda details --\x3e\n        <div class="aw-scheda__scheda-wrapper-loading" *ngIf="lb.dataSource.contentIsLoading">\n            \x3c!--\n                <n7-content-placeholder [data]="{\n                blocks: [{\n                    classes: \'content-placeholder-title\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }]\n            }"></n7-content-placeholder>\n            --\x3e\n        </div>\n        <div class="aw-scheda__scheda-wrapper" *ngIf="!lb.dataSource.contentIsLoading">\n            <div *ngIf="!lb.dataSource.currentId" class="aw-scheda__intro-text" [innerHTML]="lb.dataSource.emptyLabel">\n            </div>\n            <n7-smart-breadcrumbs *ngIf="lb.dataSource.hasBreadcrumb" [data]="lb.widgets[\'aw-scheda-breadcrumbs\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-scheda-breadcrumbs\'].emit">\n            </n7-smart-breadcrumbs>\n\n            <n7-inner-title [data]="lb.widgets[\'aw-scheda-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n\n            <n7-image-viewer *ngIf="lb.dataSource.hasImage" [data]="lb.widgets[\'aw-scheda-image\'].ds.out$ | async">\n            </n7-image-viewer>\n\n            <section class="aw-scheda__description" *ngIf="lb.dataSource.contentParts.content">\n                <div *ngFor="let part of lb.dataSource.contentParts">\n                    <div [innerHTML]="part.content"></div>\n                </div>\n            </section>\n\n            <section class="aw-scheda__metadata" *ngIf="lb.dataSource.hasMetadata">\n                <div class="aw-scheda__inner-title">\n                    {{lb.dataSource.metadataSectionTitle}}\n                </div>\n                <n7-metadata-viewer [data]="lb.widgets[\'aw-scheda-metadata\'].ds.out$ | async">\n                </n7-metadata-viewer>\n            </section>\n\n            <section class="aw-scheda__bubble-chart" *ngIf="lb.dataSource.bubblesEnabled && lb.dataSource.hasBubbles">\n                <div *ngIf="lb.dataSource.hasBubbles" class="aw-scheda__inner-title">\n                    {{lb.dataSource.bubbleChartSectionTitle}}\n                </div>\n                <aw-bubble-chart-wrapper>\n                    <aw-chart-tippy [data]="lb.widgets[\'aw-chart-tippy\'].ds.out$ | async"\n                        [emit]="lb.widgets[\'aw-chart-tippy\'].emit">\n                    </aw-chart-tippy>\n                    <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                        [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                    </n7-bubble-chart>\n                </aw-bubble-chart-wrapper>\n            </section>\n\n            <section *ngIf="lb.dataSource.hasSimilarItems" id="related-item-container" class="aw-scheda__related">\n                <div class="aw-scheda__inner-title">{{lb.dataSource.similarItemsSectionTitle}}</div>\n                <div class="aw-scheda__related-items n7-grid-2">\n                    \x3c!--<ng-container *ngFor="let widgetData of lb.widgets[\'aw-linked-objects\'].ds.out$ | async;">--\x3e\n                    <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                        </n7-item-preview>\n                    </ng-container>\n                </div>\n            </section>\n        </div>\n    </div>\n</div>'}]}],a.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:w},{type:S},{type:_},{type:c.Title},{type:D}]},a}(x);var ot={totalCount:0,facets:[{id:"query",type:"value"},{id:"query-all",type:"value",hasStaticData:!0,data:[{value:"1",label:"Cerca in tutti campi delle schede"}]},{id:"query-links",type:"value"},{id:"entity-types",type:"value",operator:"OR",limit:10,order:"count"},{id:"entity-search",type:"value"},{id:"entity-links",type:"value",searchData:["entity-type"]}],fields:[{inputs:[{type:"text",facetId:"query",placeholder:"Cerca...",filterConfig:{delay:500,minChars:3,searchIn:[{key:"label",operator:"LIKE"}]}},{type:"checkbox",facetId:"query-all",filterConfig:{searchIn:[{key:"query-all",operator:"="}]}},{type:"link",facetId:"query-links",filterConfig:{isArray:!0,searchIn:[{key:"source.entityType",operator:"="}]}}]},{header:{label:"Relazione con",classes:"related-class"},inputs:[{type:"checkbox",facetId:"entity-types",filterConfig:{isArray:!0,context:"internal",target:"entity-links",searchIn:[{key:"searchData.entity-type",operator:"="}]}},{type:"text",facetId:"entity-search",placeholder:"Cerca entità",filterConfig:{delay:500,minChars:3,context:"internal",target:"entity-links",searchIn:[{key:"label",operator:"LIKE"}]}},{type:"link",facetId:"entity-links",emptyState:{label:"La tua ricerca non ha dato risultati, prova a cambiare i filtri"},filterConfig:{isArray:!0,limit:20,searchIn:[{key:"relatedEntities.id",operator:"="}]}}]}],results:{order:{type:"text",key:"label",direction:"ASC"},fields:[{id:"description",highlight:!0,limit:200}]},page:{offset:0,limit:10}},st="aw-search-layout",ct=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new r.Subject,t.resetButtonEnabled=!0,t.currentPage=1,t.pageSize=10,t.sidebarIsSticky=!1,t.isFirstLoading=!0,t.resultsLoading=!1,t.orderBy="label",t.orderDirection="ASC",t.orderByLabel="Ordina per",t.orderByOptions=[{value:"label_ASC",label:"Ordine alfabetico (A→Z)",selected:!0},{value:"label_DESC",label:"Ordine alfabetico (Z→A)",selected:!1}],t.getSearchModelId=function(){return st},t}return b(t,e),t.prototype.onInit=function(e){var t=e.configuration,a=e.mainState,n=e.options,i=e.communication,r=e.search;this.configuration=t,this.mainState=a,this.communication=i,this.search=r,this.options=n,this.prettifyLabels=this.configuration.get("labels"),this.configKeys=this.configuration.get("config-keys"),this.fallback=this.configuration.get("search-layout").fallback,this.pageTitle=this.configuration.get("search-layout").title,this.search.model(st)&&this.search.remove(st),this.search.add(st,d.cloneDeep(ot)),this.searchModel=this.search.model(st),R.queryParams&&(this.searchModel.updateFiltersFromQueryParams(R.queryParams),R.queryParams=null),this._sidebarStickyControl(),this.mainState.updateCustom("currentNav","ricerca"),this.mainState.update("headTitle","Arianna Web > Ricerca")},t.prototype.onDestroy=function(){this.destroyed$.next(),R.queryParams=null},t.prototype.onSearchResponse=function(){this.resetButtonEnabled=!0,this.isFirstLoading&&(this.isFirstLoading=!1,this.one("facets-wrapper").update({searchModel:this.searchModel}),this.searchModel.updateInputsFromFilters())},t.prototype.onOrderByChange=function(e){var t=v(e.split("_"),2),a=t[0],n=t[1];this.orderByOptions.forEach(function(t){t.value===e?t.selected=!0:t.selected=!1}),this.orderBy=a,this.orderDirection=n,this.searchModel.setSearchConfigOrderBy(a),this.searchModel.setSearchConfigDirection(n)},t.prototype.onPaginationChange=function(e){var t=e.replace("page-","");return this._updateSearchPage(t)},t.prototype.onPaginationGoToChange=function(e){var t=e.replace("goto-","");return this._updateSearchPage(t)},t.prototype.resetPagination=function(){this._updateSearchPage(1)},t.prototype.onResultsLimitChange=function(e){this.setLimit(e),this.currentPage=1,this.searchModel.setPageConfigOffset(0)},t.prototype.setLimit=function(e){this.pageSize=e,this.searchModel.setPageConfigLimit(e),this.searchModel.setPageConfigOffset((this.currentPage-1)*this.pageSize)},t.prototype.doSearchRequest$=function(){var e=this,t=this.searchModel.getRequestParams(),a={searchParameters:y({totalCount:100},t)};return this.communication.request$("search",{onError:function(e){return console.error(e)},params:a}).pipe(o.tap(function(t){var a=t.totalCount,n=t.results,i=t.facets;e.totalCount=a;var r=0;e.totalCount>1?r=2:1===e.totalCount&&(r=1),e.resultsTitle=e.configuration.get("search-layout").results[r],e._addFacetsLabels(i),e._addFacetsOptions(i),e.searchModel.updateFacets(i),e.searchModel.updateTotalCount(a),e.one("aw-linked-objects").updateOptions({context:"search",config:e.configuration,page:e.currentPage,pagination:!0,paginationParams:e._getPaginationParams(),dynamicPagination:{total:a},size:e.pageSize}),e.one("aw-linked-objects").update({items:e._normalizeItems(n.items)})}))},t.prototype._updateSearchPage=function(e){if(+e===this.currentPage)return r.of(!1);this.currentPage=+e;var t=this.searchModel.getConfig().page.limit,a=(this.currentPage-1)*t;return this.searchModel.setPageConfigOffset(a),r.of(!0)},t.prototype._addFacetsLabels=function(e){var t=this;e.filter(function(e){return Array.isArray(e.data)}).forEach(function(e){e.data.forEach(function(e){var a=e.label;e.label=L.prettifySnakeCase(a,t.prettifyLabels[a])})})},t.prototype._addFacetsOptions=function(e){var t=this;e.filter(function(e){return"query-links"===e.id}).forEach(function(e){e.data.forEach(function(e){var a=e.value.replace(" ","-"),n=t.configKeys[a];n&&(e.options={icon:n.icon,classes:"color-"+a})})})},t.prototype._normalizeItems=function(e){return e.map(function(e){return{item:y({},e)}})},t.prototype._sidebarStickyControl=function(){var e=this;L.browserIsIE()||r.fromEvent(window,"scroll").pipe(o.takeUntil(this.destroyed$)).subscribe(function(){var t=window.pageYOffset,a=document.getElementsByClassName("sticky-parent")[0].offsetTop;e.sidebarIsSticky=a<=t})},t.prototype._getPaginationParams=function(){var e=this.searchModel.getRequestParams(),t=this.searchModel.filtersAsQueryParams(e.filters);return Object.keys(t).forEach(function(e){return t[e]=t[e]||null}),t.orderby=this.orderBy,t.orderdirection=this.orderDirection,t.page=this.currentPage,t.limit=this.pageSize,{queryParams:t,href:this.configuration.get("paths").searchBasePath}},t}(l.LayoutDataSource);var lt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new r.Subject,t.facetsChange$=new r.Subject,t.aditionalParamsChange$=new r.Subject,t}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"aw-search-layout.init":e.route=n.route,e.configuration=n.configuration,e.dataSource.onInit(n),e._listenToFacetsChange(),e._listenToAditionalParamsChange(),e._listenToRouterChanges();break;case"aw-search-layout.destroy":e.dataSource.onDestroy(),e.destroyed$.next();break;case"aw-search-layout.orderbychange":e.dataSource.onOrderByChange(n),e.aditionalParamsChange$.next();break;case"aw-search-layout.searchreset":e.dataSource.resetButtonEnabled=!1,e.dataSource.searchModel.clear(),e.aditionalParamsChange$.next();break;default:console.warn("(search) unhandled inner event of type",a)}}),this.outerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"facets-wrapper.facetschange":e.dataSource.resetPagination();break;case"aw-linked-objects.change":e.dataSource.onResultsLimitChange(n),e.aditionalParamsChange$.next()}})},t.prototype._listenToFacetsChange=function(){var e=this;this.facetsChange$.pipe(o.debounceTime(500)).subscribe(function(){e.dataSource.resultsLoading=!0,e.dataSource.doSearchRequest$().subscribe(function(){e.dataSource.resultsLoading=!1,e.dataSource.onSearchResponse(),e.emitGlobal("searchresponse",e.dataSource.getSearchModelId())})})},t.prototype._listenToAditionalParamsChange=function(){var e=this;this.aditionalParamsChange$.subscribe(function(){var t=e.dataSource.searchModel,a=t.getRequestParams(),n=t.filtersAsQueryParams(a.filters);Object.keys(n).forEach(function(e){return n[e]=n[e]||null}),n.orderby=e.dataSource.orderBy,n.orderdirection=e.dataSource.orderDirection,n.page=e.dataSource.currentPage,n.limit=e.dataSource.pageSize,e.emitGlobal("navigate",{handler:"router",path:[],queryParams:n})})},t.prototype._listenToRouterChanges=function(){var e=this;this.route.queryParams.pipe(o.takeUntil(this.destroyed$)).subscribe(function(t){e.emitOuter("queryparamschange",t),t.orderby&&t.orderdirection&&e.dataSource.onOrderByChange(t.orderby+"_"+t.orderdirection),t.page&&e.dataSource.onPaginationChange("page-"+t.page),t.limit&&e.dataSource.setLimit(+t.limit),e.facetsChange$.next()})},t}(l.EventHandler);var ut={layoutId:"aw-search-layout",widgets:[{id:"facets-wrapper",dataSource:K,eventHandler:ee},{id:"aw-linked-objects"},{id:"aw-search-layout-tabs",hasStaticData:!0}],layoutDS:ct,layoutEH:lt,widgetsDataSources:Fe,widgetsEventHandlers:Ue,options:{}},dt=function(e){function a(t,a,n,i,r,o){var s=e.call(this,a.get("AwSearchLayoutConfig")||ut)||this;return s.configuration=t,s.layoutsConfiguration=a,s.mainState=n,s.communication=i,s.search=r,s.route=o,s}return b(a,e),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,communication:this.communication,search:this.search,route:this.route,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:t.Component,args:[{selector:"aw-search-layout",template:'<div class="aw-search n7-side-auto-padding" id="search-layout">\n    <div class="aw-search__header">\n        <div class="aw-search__header-left">\n            <h1 class="aw-search__header-title">{{ lb.dataSource.pageTitle }}</h1>\n        </div>\n        \x3c!--\n        <div class="aw-search__header-right">\n            <n7-nav\n                [data]="lb.widgets[\'aw-search-layout-tabs\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-search-layout-tabs\'].emit">\n            </n7-nav>\n        </div>\n        --\x3e\n    </div>\n    <div class="aw-search__content-wrapper sticky-parent">\n        \x3c!-- Left sidebar: facets --\x3e\n        <div *ngIf="!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)" class="aw-search__sidebar-loading sticky-target">\n            <div class="aw-search__facets-loading">\n                <n7-content-placeholder [data]="{\n                    blocks: [{\n                        classes: \'search-placeholder-facet-input\'\n                    }, {\n                        classes: \'search-placeholder-facet-check\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }]\n                }">\n                </n7-content-placeholder>\n            </div>\n        </div>\n        <div *ngIf="!!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)" class="aw-search__sidebar sticky-target" [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <div class="aw-search__facets">\n                <n7-facets-wrapper [data]="lb.widgets[\'facets-wrapper\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'facets-wrapper\'].emit">\n                </n7-facets-wrapper>\n            </div>\n        </div>\n        <div class="aw-search__content">\n            <div class="aw-search__results-header">\n                <div class="aw-search__results-header-left">\n                    <h3 *ngIf="!lb.dataSource.resultsLoading" class="aw-search__total">\n                        <span class="aw-search__total-number">{{ lb.dataSource.totalCount }}</span>&nbsp;\n                        <span class="aw-search__total-title">{{ lb.dataSource.resultsTitle }}</span>\n                    </h3>\n                </div>\n                <div class="aw-search__results-header-right">\n                    <label class="aw-search__results-select-orderby-label"\n                        for="aw-search__results-select-orderby">{{ lb.dataSource.orderByLabel }}</label>\n                    <select (change)="lb.eventHandler.emitInner(\'orderbychange\', $event.target.value)"\n                        id="aw-search__results-select-orderby">\n                        <option *ngFor="let option of lb.dataSource.orderByOptions" [value]="option.value" [selected]="option.selected">\n                            {{ option.label }}</option>\n                    </select>\n                </div>\n            </div>\n            \x3c!-- Search details --\x3e\n            <div *ngIf="lb.dataSource.resultsLoading"\n                 class="aw-search__results-wrapper-loading">\n                <n7-content-placeholder *ngIf="lb.dataSource.resultsLoading" [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n                <n7-content-placeholder *ngIf="lb.dataSource.resultsLoading" [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n                <n7-content-placeholder *ngIf="lb.dataSource.resultsLoading" [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n                <n7-content-placeholder *ngIf="lb.dataSource.resultsLoading" [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n                <n7-content-placeholder *ngIf="lb.dataSource.resultsLoading" [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n                <n7-content-placeholder *ngIf="lb.dataSource.resultsLoading" [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n            </div>\n            <div *ngIf="!lb.dataSource.resultsLoading" class="aw-search__results-wrapper">\n                <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                    <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                    </n7-smart-breadcrumbs>\n                    <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                    </n7-item-preview>\n                </ng-container>\n                <ng-container *ngIf="lb.dataSource.totalCount == 0">\n                    <div class="aw-search__fallback">\n                        <p class="aw-search__fallback-string">\n                            {{ lb.dataSource.fallback }}\n                        </p>\n                        <button [disabled]="!lb.dataSource.resetButtonEnabled" class="n7-btn aw-search__fallback-button" (click)="lb.eventHandler.emitInner(\'searchreset\', {})">\n                            Resetta la ricerca\n                        </button>\n                    </div>\n                </ng-container>\n                <n7-pagination *ngIf="lb.dataSource.totalCount > 10"\n                    [data]="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.pagination"\n                    [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                </n7-pagination>\n            </div>\n        </div>\n    </div>\n</div>'}]}],a.ctorParameters=function(){return[{type:w},{type:S},{type:_},{type:D},{type:R},{type:s.ActivatedRoute}]},a}(x);var pt=function(){function e(){}return e.prototype.onClick=function(e,t){this.emit(e,t)},e.decorators=[{type:t.Component,args:[{selector:"aw-chart-tippy",template:'<div *ngIf="data" style="display: none;">\n  <div *ngFor="let d of data" id="template__{{d.id}}" class="bubble-chart__tippy-template">\n    <div id="bubble-popup-menu" class="aw-bubble-popup-menu">\n      <h2 class="aw-bubble-popup-menu__title">{{ d.title }}</h2>\n      <p class="aw-bubble-popup-menu__text">\n        {{ d.text }}\n      </p>\n      <div class="aw-bubble-popup-menu__actions">\n        <n7-anchor-wrapper [classes]="\'aw-bubble-popup-menu__link\'" [data]="d.anchorData">\n          Vai alla scheda\n        </n7-anchor-wrapper>\n        <span *ngIf="d.selectable" class="aw-bubble-popup-menu__link" (click)="onClick(\'select\', {id: d.id})">\n          {{ d.isSelected ? \'Deseleziona\' : \'Seleziona\'}}\n        </span>\n      </div>\n    </div>\n  </div>\n</div>'}]}],e.propDecorators={data:[{type:t.Input}],emit:[{type:t.Input}],anchorData:[{type:t.Input}]},e}();var ht=function(){function e(){}return e.prototype.onClick=function(e,t){this.emit(e,t)},e.decorators=[{type:t.Component,args:[{selector:"aw-bubble-chart-wrapper",template:'<div class="aw-bubble-chart-wrapper">\n    <ng-content></ng-content>\n</div>'}]}],e.propDecorators={emit:[{type:t.Input}],container:[{type:t.Input}],buttons:[{type:t.Input}]},e}();var ft=function(){function e(){var e=this;this.ngAfterViewInit=function(){var t=e.bcdiv.nativeElement.clientWidth,a=e.bcol.nativeElement.clientWidth,n=e.bcol.nativeElement.children;if(t===a){var i=document.createElement("ol"),r=1;for(i.className="n7-smart-breadcrumbs__tippy-content";t===a&&r<n.length-1;)r>1?i.appendChild(n[r]):(i.appendChild(n[r]),n[r].children[0].innerText="…"),e.tippyBuilder(n[r],i),r++,t=e.bcdiv.nativeElement.clientWidth,a=e.bcol.nativeElement.clientWidth}},this.tippyBuilder=function(e,t){document.body.appendChild(t),f(e,{content:t,interactive:!0,arrow:!0,theme:"light-border no-padding"})}}return e.prototype.onClick=function(e){this.emit&&this.emit("click",e)},e.decorators=[{type:t.Component,args:[{selector:"n7-smart-breadcrumbs",template:'<div *ngIf="data" class="n7-breadcrumbs {{ data.classes || \'\' }}" #bcdiv>\n    <nav class="n7-breadcrumbs__nav">\n        <ol class="n7-breadcrumbs__list" #bcol>\n            <li *ngFor="let item of data.items" class="n7-breadcrumbs__item {{ item.classes || \'\' }}">\n                <n7-anchor-wrapper [classes]="\'n7-breadcrumbs__label\'"\n                [data]="item.anchor"\n                (clicked)="onClick($event)">\n                    {{ item.label }}\n                </n7-anchor-wrapper>\n            </li>\n        </ol>\n    </nav>\n</div>'}]}],e.propDecorators={data:[{type:t.Input}],emit:[{type:t.Input}],bcol:[{type:t.ViewChild,args:["bcol",{read:t.ElementRef,static:!1}]}],bcdiv:[{type:t.ViewChild,args:["bcdiv",{read:t.ElementRef,static:!1}]}]},e}();var gt=[Ye,tt,rt,dt,ht,pt,ft],bt=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{declarations:gt,imports:[a.CommonModule,s.RouterModule,i.DvComponentsLibModule,de],providers:[],exports:gt}]}],e}();var yt=function(){function e(){}return e.decorators=[{type:t.Component,args:[{selector:"dv-data-widget-wrapper",template:"<div class=\"dv-data-widget-wrapper {{ data && data.classes || '' }}\">\n    <ng-content></ng-content>\n</div>"}]}],e.propDecorators={data:[{type:t.Input}]},e}();var mt=function(){function e(){}return e.prototype.onClick=function(e){this.emit&&this.emit("click",e)},e.prototype.toggleDropDown=function(e){this.emit&&this.emit("toggle",e)},e.decorators=[{type:t.Component,args:[{selector:"dv-datepicker-wrapper",template:'<div *ngIf="data" class="dv-datepicker-wrapper {{ data.select.classes || \'\' }}">\n    <div class="dv-datepicker-wrapper__label" (click)="toggleDropDown(data.payload)">\n        <input type="text" [value]="data.select.label" [readOnly]="true"/>\n        <span class="{{data.select.icon}}"></span>\n    </div>\n    <div class="dv-datepicker-wrapper__dropdown" [hidden]="data.select.hidden">\n        <ul class="dv-datepicker-wrapper__dropdown-list">\n            <li class="dv-datepicker-wrapper__dropdown-list-option {{ opt.classes || \'\' }}" *ngFor="let opt of data.select.items" (click)="onClick(opt.payload)">{{opt.text}}</li>\n        </ul>\n    </div>\n    <n7-datepicker\n        [hidden]="data.datepicker.hidden"\n        [data]="data.datepicker.data"\n        [emit]="emit">\n    </n7-datepicker>\n</div>\n'}]}],e.propDecorators={data:[{type:t.Input}],emit:[{type:t.Input}]},e}();var vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Items=[{text:"Last week",payload:"lastWeek"},{text:"Last month",payload:"lastMonth"},{text:"Last year",payload:"lastYear"},{text:"Select Date",payload:"ByDate"}],t.datepickerOptions={dateFormat:"Y-m-d",mode:"range"},t.datePickerExternalData={select:{id:"dv-select",label:"Last Week",items:t.Items},datepicker:{id:"datepicker",libOptions:t.datepickerOptions}},t}return b(t,e),t.prototype.onInit=function(){this.one("dv-datepicker-wrapper").update(this.datePickerExternalData)},t}(l.LayoutDataSource);var wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){t.type,t.payload;e.dataSource.onInit()})},t}(l.EventHandler),St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){if(!e)return null},t}(l.DataSource),_t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._datepicker=null,t}return b(t,e),t.prototype.transform=function(e){var t=this;if(e)return{select:{id:e.select.id,hidden:!0,icon:e.select.icon||"n7-icon-angle-down",label:e.select.label,items:e.select.items,classes:e.select.classes},datepicker:{hidden:!0,data:{id:e.datepicker.id,libOptions:e.datepicker.libOptions,getInstance:function(e){return t._datepicker=e}}}}},t.prototype.openDatepicker=function(){var e=this;setTimeout(function(){return e._datepicker.open()}),this.output.select.hidden=!0,this.output.datepicker.hidden=!1},t.prototype.closeDatepicker=function(){var e=this;setTimeout(function(){return e._datepicker.close()}),this.output.select.hidden=!0,this.output.datepicker.hidden=!0},t.prototype.setLabel=function(e){this.output.select.label=e,this.output.datepicker.hidden=!0},t.prototype.toggleDropDown=function(){!1===this.output.select.hidden?this.output.select.hidden=!0:this.output.select.hidden=!1},t}(l.DataSource);var kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return{containerId:"test-Chart",libOptions:{chart:{height:550,width:1500,type:"area",toolbar:{show:!0}},dataLabels:{enabled:!1},colors:["rgba(15,200,255)"],fill:{colors:["#0fc8ff"],gradient:{opacityFrom:.5,opacityTo:.1}},stroke:{curve:"straight",width:[2,1]},series:[{name:"Reddish value",data:[["2019-08-01","770.17"],["2019-08-02","645.03"],["2019-08-03","709.32"],["2019-08-04","708.11"],["2019-08-05","706.59"],["2019-08-06","607.28"],["2019-08-07","494.59"],["2019-08-08","636.81"],["2019-08-09","709.04"],["2019-08-10","717.31"],["2019-08-11","805.61"],["2019-08-12","758.60"],["2019-08-13","612.82"],["2019-08-14","608.90"],["2019-08-15","734.68"],["2019-08-16","838.54"],["2019-08-17","692.88"]]}],grid:{borderColor:"#e7e7e7",strokeDashArray:3,xaxis:{lines:{show:!0}}},markers:{size:3,hover:{size:6}},xaxis:{axisBorder:{show:!0,color:"#f4f6fc"},labels:{},type:"datetime",tickAmount:6},yaxis:[{show:!0,showAlways:!1,opposite:!1,reversed:!1,logarithmic:!1,forceNiceScale:!1,floating:!1,labels:{show:!0,minWidth:0,maxWidth:160,offsetX:0,offsetY:0,rotate:0,padding:20,style:{colors:[],fontSize:"11px",cssClass:""}},axisBorder:{show:!0,color:"#f4f6fc",offsetX:0,offsetY:0},axisTicks:{show:!1,color:"#78909C",width:6,offsetX:0,offsetY:0},title:{text:"P Totale °C",rotate:90,offsetY:0,offsetX:0,style:{fontSize:"11px",cssClass:""}},tooltip:{enabled:!1,offsetX:0},crosshairs:{show:!0,position:"front",stroke:{color:"#b6b6b6",width:1,dashArray:0}}}],legend:{show:!0},tooltip:{},annotations:{yaxis:[],xaxis:[],points:[]}}}},t}(l.DataSource),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return{title:{main:{text:"Dipendenti",classes:"n7-main-widget-title"},secondary:{text:"Dipendeti al 10/10/10",classes:"n7-secondary-widget-title"}}}},t}(l.DataSource),Et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.transform=function(e){return i.DATA_WIDGET_MOCK},t}(l.DataSource),Ct=Object.freeze({DvDataWidgetDS:St,DvDatepickerWrapperDS:_t,DvGraphDS:kt,DvInnerTitleDS:It,DvWidgetDS:Et}),Dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){},t}(l.EventHandler),xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe(function(t){var a=t.type,n=t.payload;switch(a){case"dv-datepicker-wrapper.click":e.dataSource.setLabel(n),"ByDate"===n?e.dataSource.openDatepicker():e.dataSource.closeDatepicker();break;case"dv-datepicker-wrapper.toggle":e.dataSource.toggleDropDown();break;case"dv-datepicker-wrapper.change":e.dataSource.setLabel(n.dateStr)}})},t}(l.EventHandler),Pt={layoutId:"dv-example-layout",widgets:[{id:"dv-inner-title",hasStaticData:!0},{id:"dv-widget",hasStaticData:!0},{id:"dv-datepicker-wrapper"},{id:"dv-graph",hasStaticData:!0}],layoutDS:vt,layoutEH:wt,widgetsDataSources:Ct,widgetsEventHandlers:Object.freeze({DvDataWidgetEH:Dt,DvDatepickerWrapperEH:xt}),options:{}},At=function(e){function a(){return e.call(this,Pt)||this}return b(a,e),a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:t.Component,args:[{selector:"dv-example-layout",template:'<div class="dv-example-layout" id="example-layout">\n\n    \x3c!-- Data widget wrapper with not-fixed height, two rows --\x3e\n    <dv-data-widget-wrapper>\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-chart\n                    [data]="lb.widgets[\'dv-graph\'].ds.out$ | async">\n                </n7-chart>\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n\n    \x3c!-- Data widget wrapper with fixed height, two rows --\x3e\n    <dv-data-widget-wrapper [data]="{ classes: \'dv-data-widget-wrapper-fixed-height\' }">\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n            <div class="dv-data-widget-wrapper__content-row">\n                Row content\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n\n    \x3c!-- Data widget wrapper with fixed height, one row --\x3e\n    <dv-data-widget-wrapper [data]="{ classes: \'dv-data-widget-wrapper-fixed-height\' }">\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n    \n    <dv-datepicker-wrapper \n        [data]="lb.widgets[\'dv-datepicker-wrapper\'].ds.out$ | async"\n        [emit]="lb.widgets[\'dv-datepicker-wrapper\'].emit">\n    </dv-datepicker-wrapper>\n</div>'}]}],a.ctorParameters=function(){return[]},a}(x),Ot=[yt,mt,At],Tt=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{declarations:Ot,imports:[a.CommonModule,i.DvComponentsLibModule,de],providers:[],exports:Ot}]}],e}(),Ft=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[a.CommonModule],providers:[],exports:[de,bt,Tt]}]}],e}();e.AbstractLayout=x,e.ApolloProvider=I,e.ApolloProviderConfig=k,e.AwAutocompleteWrapperDS=ge,e.AwAutocompleteWrapperEH=He,e.AwBubbleChartDS=be,e.AwBubbleChartEH=$e,e.AwChartTippyDS=ye,e.AwChartTippyEH=je,e.AwEntitaLayoutComponent=Ye,e.AwEntitaLayoutConfig=Xe,e.AwEntitaLayoutDS=pe,e.AwEntitaLayoutEH=he,e.AwEntitaMetadataViewerDS=Ee,e.AwEntitaNavDS=Ie,e.AwEntitaNavEH=ze,e.AwHeroDS=me,e.AwHeroEH=Be,e.AwHomeAutocompleteDS=ke,e.AwHomeAutocompleteEH=Ne,e.AwHomeFacetsWrapperDS=Se,e.AwHomeFacetsWrapperEH=Me,e.AwHomeHeroPatrimonioDS=we,e.AwHomeHeroPatrimonioEH=qe,e.AwHomeItemTagsWrapperDS=_e,e.AwHomeItemTagsWrapperEH=Re,e.AwHomeLayoutComponent=tt,e.AwHomeLayoutConfig=et,e.AwHomeLayoutDS=Ze,e.AwHomeLayoutEH=Je,e.AwLinkedObjectsDS=fe,e.AwLinkedObjectsEH=Le,e.AwPatrimonioLayoutConfig=it,e.AwSchedaBreadcrumbsDS=xe,e.AwSchedaImageDS=Ae,e.AwSchedaInnerTitleDS=Oe,e.AwSchedaLayoutComponent=rt,e.AwSchedaLayoutDS=at,e.AwSchedaLayoutEH=nt,e.AwSchedaMetadataDS=Pe,e.AwSchedaSidebarEH=Ve,e.AwSearchLayoutComponent=dt,e.AwSearchLayoutConfig=ut,e.AwSearchLayoutDS=ct,e.AwSearchLayoutEH=lt,e.AwSearchLayoutTabsDS=Te,e.AwSearchLayoutTabsEH=Ke,e.AwSidebarHeaderDS=De,e.AwSidebarHeaderEH=We,e.AwTableDS=ve,e.AwTableEH=Qe,e.AwTreeDS=Ce,e.AwTreeEH=Ge,e.BreadcrumbsDS=W,e.BreadcrumbsEH=Z,e.BubbleChartWrapperComponent=ht,e.ChartTippyComponent=pt,e.CommunicationService=D,e.ConfigurationService=w,e.DataWidgetWrapperComponent=yt,e.DatepickerWrapperComponent=mt,e.DvDataWidgetDS=St,e.DvDataWidgetEH=Dt,e.DvDatepickerWrapperDS=_t,e.DvDatepickerWrapperEH=xt,e.DvExampleLayoutComponent=At,e.DvExampleLayoutConfig=Pt,e.DvExampleLayoutDS=vt,e.DvExampleLayoutEH=wt,e.DvGraphDS=kt,e.DvInnerTitleDS=It,e.DvWidgetDS=Et,e.FacetInput=O,e.FacetInputCheckbox=T,e.FacetInputLink=$,e.FacetInputSelect=j,e.FacetInputText=H,e.FacetsDS=G,e.FacetsEH=J,e.FacetsWrapperComponent=le,e.FacetsWrapperDS=K,e.FacetsWrapperEH=ee,e.FooterDS=Q,e.FooterEH=te,e.HeaderDS=z,e.HeaderEH=X,e.JsonConfigService=A,e.LayoutsConfigurationService=S,e.MainLayoutComponent=ie,e.MainLayoutConfig=ne,e.MainLayoutDS=P,e.MainLayoutEH=N,e.MainStateService=_,e.N7BoilerplateAriannaWebModule=bt,e.N7BoilerplateCommonModule=de,e.N7BoilerplateDataVizModule=Tt,e.N7BoilerplateLibModule=Ft,e.Page404LayoutComponent=ce,e.Page404LayoutConfig=se,e.Page404LayoutDS=re,e.Page404LayoutEH=oe,e.RestProvider=C,e.RestProviderConfig=E,e.SearchModel=q,e.SearchService=R,e.SmartBreadcrumbsComponent=ft,e.SubnavDS=V,e.SubnavEH=Y,e.ɵa=ie,e.ɵb=x,e.ɵc=w,e.ɵd=S,e.ɵe=_,e.ɵf=ce,e.ɵg=le,e.ɵh=D,e.ɵi=I,e.ɵj=C,e.ɵk=Ye,e.ɵl=D,e.ɵm=_,e.ɵn=tt,e.ɵo=rt,e.ɵp=dt,e.ɵq=w,e.ɵr=S,e.ɵs=R,e.ɵt=ht,e.ɵu=pt,e.ɵv=ft,e.ɵw=yt,e.ɵx=mt,e.ɵy=At,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=n7-frontend-boilerplate.umd.min.js.map