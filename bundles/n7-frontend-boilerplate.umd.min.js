!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http"),require("@n7-frontend/components"),require("rxjs"),require("rxjs/operators"),require("@angular/router"),require("@angular/platform-browser"),require("@n7-frontend/core"),require("@n7-frontend/core/dist/layout-data-source"),require("tippy.js"),require("lodash"),require("slugify"),require("@n7-frontend/core/dist/data-source")):"function"==typeof define&&define.amd?define("@n7-frontend/boilerplate",["exports","@angular/core","@angular/common","@angular/common/http","@n7-frontend/components","rxjs","rxjs/operators","@angular/router","@angular/platform-browser","@n7-frontend/core","@n7-frontend/core/dist/layout-data-source","tippy.js","lodash","slugify","@n7-frontend/core/dist/data-source"],t):t(((e=e||self)["n7-frontend"]=e["n7-frontend"]||{},e["n7-frontend"].boilerplate={}),e.ng.core,e.ng.common,e.ng.common.http,e.components,e.rxjs,e.rxjs.operators,e.ng.router,e.ng.platformBrowser,e.core$1,e.layoutDataSource,e.tippy,e.lodash,e.slugify,e.dataSource)}(this,(function(e,t,a,n,i,o,r,s,c,l,u,d,p,h,f){"use strict";var g="default"in d?d.default:d;h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var y=function(e,t){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)};function m(e,t){function a(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}var b=function(){return(b=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function v(e,t,a,n){var i,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(r=(o<3?i(r):o>3?i(t,a,r):i(t,a))||r);return o>3&&r&&Object.defineProperty(t,a,r),r}function w(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,a=t&&e[t],n=0;if(a)return a.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function k(e,t){var a="function"==typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,o=a.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)r.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(a=o.return)&&a.call(o)}finally{if(i)throw i.error}}return r}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(k(arguments[t]));return e}var I,C=function(){function e(){var e=this;this.defaults={},this.get=function(t){return e.defaults[t]},this.set=function(t,a){e.defaults[t]=a}}return e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"})],e)}(),E=function(){function e(e){var t=this;this.config=e,this.defaults={},this.get=function(e){return t.defaults[e]},this.set=function(e,a){t.defaults[e]=a},this.config.layouts&&Object.keys(this.config.layouts).forEach((function(e){t.set(e,t.config.layouts[e])}))}var a,n;return e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:["config"]}]}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject("config"))},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"}),(a=0,n=t.Inject("config"),function(e,t){n(e,t,a)}),w("design:paramtypes",[Object])],e)}(),x=function(){function e(){var e=this;this.custom={},this.default={headTitle:new o.ReplaySubject,pageTitle:new o.ReplaySubject,subnav:new o.ReplaySubject,breadcrumbs:new o.ReplaySubject,filters:new o.ReplaySubject},this.get$=function(t){return e._get("default",t)},this.getCustom$=function(t){return e._get("custom",t)},this.update=function(t,a){return e._update("default",t,a)},this.updateCustom=function(t,a){return e._update("custom",t,a)},this.has=function(t){return!!e.default[t]},this.hasCustom=function(t){return!!e.custom[t]}}return e.prototype.addCustom=function(e,t){if(this.custom[e])throw Error("custom stream "+e+" exists!");this.custom[e]=t},e.prototype._update=function(e,t,a){if(!this[e])throw Error(e+" stream group does not exists!");if(!this[e][t])throw Error(e+" stream "+t+" does not exists!");this[e][t].next(a)},e.prototype._get=function(e,t){if(!this[e])throw Error(e+" stream group does not exists!");if(!this[e][t])throw Error(e+" stream "+t+" does not exists!");return this[e][t]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"})],e)}(),P=function(){function e(e){this.http=e}return e.prototype.request$=function(e,t,a){var n,i=a.params,o=a.method,s=a.httpOptions;e.config&&e.config[t]&&(n=e.config[t]);var c=(n=n||{}).queryName,l=n.queryBody;if(!c||!l)throw Error("No config found for requestId '"+t+"'");if(i){var u=this.makeParamsStr(i);l=l.replace("__PARAMS__",u)}else l=l.replace("(__PARAMS__)","");return(o&&"GET"===o?this.http.get(e.baseUrl):this.http.post(e.baseUrl,{query:l},s)).pipe(r.map((function(e){return e.data[c]})))},e.prototype.makeParamsStr=function(e){var t=this,a=[];return Object.keys(e).forEach((function(n){if(Array.isArray(e[n])){var i=[];e[n].forEach((function(e){if("object"==typeof e){var a=t.makeParamsStr(e);i.push("{ "+a+" }")}else"number"==typeof e||"boolean"==typeof e||null===e?i.push(""+e):i.push('"'+e+'"')})),a.push(n+": ["+i.join(",")+"]")}else if("object"==typeof e[n]&&e[n]){var o=t.makeParamsStr(e[n]);a.push(n+": { "+o+" }")}else"string"==typeof e[n]&&0===n.indexOf("$")?a.push(n.replace("$","")+": "+e[n]):"number"==typeof e[n]||"boolean"==typeof e[n]||null===e[n]?a.push(n+": "+e[n]):a.push(n+': "'+e[n]+'"')})),a.join(" ")},e.ctorParameters=function(){return[{type:n.HttpClient}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(n.HttpClient))},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"}),w("design:paramtypes",[n.HttpClient])],e)}(),D=function(){function e(e){this.http=e}return e.prototype.request$=function(e,t,a){void 0===a&&(a={});var n,i=a.params,o=a.httpOptions,r=a.urlParams,s=void 0===r?"":r,c=a.method;if(c||(c=e.defaultMethod||"GET"),e.config&&e.config[t]&&(n=e.config[t]),!n)throw Error('No config found for requestId "'+t+'"');if("POST"===c||"PUT"===c)return this.http[c.toLowerCase()](e.baseUrl+n,i,o);if("GET"===c||"DELETE"===c)return this.http[c.toLowerCase()](e.baseUrl+n+s,o);throw Error("Rest method "+c+" not supported")},e.ctorParameters=function(){return[{type:n.HttpClient}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(n.HttpClient))},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"}),w("design:paramtypes",[n.HttpClient])],e)}(),T=function(){function e(e,t,a){this.config=e,this.apollo=t,this.rest=a;try{this.communicationConfig=this.config.get("communication"),this.defaultProvider=this.communicationConfig.defaultProvider}catch(e){throw Error("No communications.defaultProvider setted in config")}}return e.prototype.request$=function(e,t,a){var n=this;void 0===t&&(t={});var i=a||this.defaultProvider,o=this.communicationConfig.providers[i];if(!o)throw Error('There is no config for "'+i+'" provider');var s=o.type||i;if(!this[s])throw Error('There is no "'+s+'" provider type');var c=t.onError;return this[s].request$(o,e,t).pipe(r.catchError((function(e){return n.handleError(e,c)})))},e.prototype.handleError=function(e,t){return t?t(e):console.warn("No error handler for communication request",e),o.empty()},e.ctorParameters=function(){return[{type:C},{type:P},{type:D}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(C),t.ɵɵinject(P),t.ɵɵinject(D))},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"}),w("design:paramtypes",[C,P,D])],e)}(),A=function(){function e(e){this.config=e,this.widgets=this.config.widgets,this.lb=new l.LayoutBuilder(this.config.layoutId)}return e.prototype.onInit=function(){var e=this;this.lb.ready$.subscribe((function(){e.lb.eventHandler.emitInner("init",e.initPayload())}));var t=this.config.layoutDS,a=this.config.layoutEH;this.lb.init({widgetsConfig:this.widgets,widgetsDataSources:this.config.widgetsDataSources,widgetsEventHandlers:this.config.widgetsEventHandlers,dataSource:new t,eventHandler:new a})},e.prototype.onDestroy=function(){this.lb.eventHandler.emitInner("destroy")},e}(),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.onInit=function(e){var t=this,a=e.configuration,n=e.mainState,i=e.router,o=e.options,r=e.titleService,s=e.route;this.configuration=a,this.mainState=n,this.router=i,this.route=s,this.titleService=r,this.options=o,this.configuration.get("header")&&this.one("header").update(this.configuration.get("header")),this.configuration.get("footer")&&this.one("footer").update(this.configuration.get("footer")),this.mainState.get$("headTitle").subscribe((function(e){return t.titleService.setTitle(e)})),this.mainState.get$("pageTitle").subscribe((function(e){t.pageTitle=e})),this.mainState.get$("subnav").subscribe((function(e){return t.one("subnav").update(e)})),this.mainState.get$("breadcrumbs").subscribe((function(e){return t.one("breadcrumbs").update(e)}))},t.prototype.onNavigate=function(e){if("router"===e.handler){var t=e.path,a=e.queryParams;if(!t)throw Error("onNavigate: no path for router navigate");a?this.router.navigate(t,{relativeTo:this.route,queryParams:a,queryParamsHandling:"merge"}):this.router.navigate(t),this._onRouterNavigate()}},t.prototype.onRouterChanged=function(){d.hideAll()},t.prototype._onRouterNavigate=function(){d.hideAll()},t}(u.LayoutDataSource),F=function(){function e(e,t){this.http=e,this.config=t}return e.prototype.load=function(e,t){var a=this;return this.http.get(e).pipe(r.catchError((function(){return o.of({})})),r.tap((function(e){return a._handleResponse(e,t)}))).toPromise()},e.prototype._handleResponse=function(e,t){var a=this;if(t&&Object.keys(t).forEach((function(e){return a.config.set(e,t[e])})),e&&(Object.keys(e).forEach((function(t){return a.config.set(t,e[t])})),e["config-keys"])){var n=document.querySelector("head"),i=document.createElement("style"),o=[];Object.keys(e["config-keys"]).forEach((function(t){var a=e["config-keys"][t]||{},n=a["class-name"];a.color&&a.color.hex&&o.push("--color-"+n+": "+a.color.hex+";")})),o.length&&(o.unshift(":root {"),o.push("}"),i.appendChild(document.createTextNode(o.join("\n"))),n.appendChild(i))}},e.ctorParameters=function(){return[{type:n.HttpClient},{type:C}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(n.HttpClient),t.ɵɵinject(C))},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"}),w("design:paramtypes",[n.HttpClient,C])],e)}(),L=function(){function e(t){var a=this;this.isEmpty=!1,this.update=function(){a.output=a.transform()},this.getId=function(){return a.id},this.getData=function(){return a.data},this.getConfig=function(){return a.config},this.getFacetId=function(){return a.config.facetId},this.getInputIndex=function(){return a.config.inputIndex},this.getSectionIndex=function(){return a.config.sectionIndex},this.getContext=function(){return a.config.filterConfig.context||"external"},this.getTarget=function(){return a.config.filterConfig.target||null},this.getSearchIn=function(){return a.config.filterConfig.searchIn||null},this.getType=function(){return a.config.type},this.getOutput=function(){return a.output},this.setIsEmpty=function(e){a.isEmpty=e},this.setData=function(e){a.data=e},this.config=t,this._setId(),e.index+=1}return e.prototype.clear=function(){return null},e.prototype._setId=function(){this.id="facet-input-"+this.getType()+"-"+e.index},e.index=0,e}(),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(){var e=this,t=this.getFacetId();return this.data.map((function(a,n){var i=a.label,o=a.value;return{type:"checkbox",id:e.getId()+"-"+n,label:i,payload:{facetId:t,source:"input-checkbox",value:""+o},_meta:{facetId:t,value:""+o}}}))},t.prototype.setActive=function(e){var t=this.config.filterConfig.isArray;this.output.forEach((function(a){t&&Array.isArray(e)&&-1!==e.indexOf(a._meta.value)||e===a._meta.value?a.checked=!0:a.checked=!1}))},t}(L),M=new DOMParser,$={prettifySnakeCase:function(e,t){var a=this;return"string"==typeof t?t:(e||"").split("_").map((function(e,t){return 0===t?a.ucFirst(e):e})).join(" ")},ucFirst:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},slugify:function(e){if(!e)return"";var t=M.parseFromString(e,"text/html").body.textContent||"";return t=t.replace(/\//g,"-"),h(t,{remove:/[*+~.()'"!:@,]/g,lower:!0})},browserIsIE:function(){return window.navigator.userAgent.match(/(MSIE|Trident)/)},escapeDoubleQuotes:function(e){return e.search(/\\?(")([\w\s]+)\\?(")/g)>=0?e.replace(/\\?(")([\w\s]+)\\?(")/g,"\\$1$2\\$3"):e.replace(/\\([\s\S])|(")/g,"\\\\\\$1$2")},unescapeDoubleQuotes:function(e){return e&&""!==e?e.replace(/\\*(")/g,"$1"):e}},z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(){var e=this.getFacetId(),t={facetId:e,source:"input-text"};return{type:"text",id:this.getId(),label:this.config.label,disabled:this.config.disabled,placeholder:this.config.placeholder,icon:this.config.icon,inputPayload:b(b({},t),{trigger:"input"}),enterPayload:b(b({},t),{trigger:"enter"}),iconPayload:b(b({},t),{trigger:"icon"}),_meta:{facetId:e}}},t.prototype.setActive=function(e){this.output.value=$.unescapeDoubleQuotes(e)||null},t}(L),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(){var e,t,a=this.getFacetId(),n=[],i=0;try{for(var o=S(this.data),r=o.next();!r.done;r=o.next()){var s=r.value,c=s.label,l=s.counter,u=s.hidden,d=s.value,p=s.options;if(!u){if((i+=1)>1e3)break;d=""+d;var h=[];(p=p||{}).classes&&h.push(p.classes),this._isActive(this.facetValue,d)&&h.push("is-active"),n.push({type:"link",id:this.getId(),text:c,counter:l,payload:{facetId:a,source:"input-link",value:d},icon:p.icon||null,classes:h.join(" "),_meta:{facetId:a,value:d}})}}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}var f=n.filter((function(e){return"empty"===e.id}))[0];if(this.isEmpty)if(f)f.classes="empty-text-link";else{c=this.getConfig().emptyState.label;n.push({type:"link",id:"empty-link",text:c,classes:"empty-text-link",_meta:{facetId:"empty-link",value:null}})}else f&&(f.classes="empty-text-link is-hidden");return n},t.prototype.setActive=function(e){var t=this;this.output.forEach((function(a){var n=t._isActive(e,a._meta.value),i=a.classes?a.classes.split(" "):[];n?-1===i.indexOf("is-active")&&i.push("is-active"):i=i.filter((function(e){return"is-active"!==e})),a.classes=i.join(" ")}))},t.prototype._isActive=function(e,t){return this.facetValue=e,Array.isArray(e)&&-1!==e.indexOf(t)||e===t},t.prototype.clear=function(){this.facetValue=[]},t}(L),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(){var e=this.getFacetId();return{type:"select",id:this.getId(),label:this.config.label,disabled:this.config.disabled,options:this.data?this.data.map((function(e){return{value:""+e.value,label:e.label}})):[],payload:{facetId:e,source:"input-select"},_meta:{facetId:e}}},t.prototype.setActive=function(e){this.output.options.filter((function(t){return t.value===e})).forEach((function(e){e.selected=!0}))},t}(L),q={checkbox:R,text:z,link:H,select:j},B={"=":"_filterDataEquals",">":"_filterDataGreaterThan","<":"_filterDataLessThan",">=":"_filterDataGreaterOrEquals","<=":"_filterDataLessOrEquals","<>":"_filterDataNotEqual",LIKE:"_filterDataLike"},G=function(){function e(e,t){var a=this;this._filters=[],this._facets=[],this._inputs=[],this._results$=new o.Subject,this.getId=function(){return a._id},this.getFilters=function(){return a._filters},this.getFacets=function(){return a._facets},this.getInputs=function(){return a._inputs},this.getConfig=function(){return a._config},this.getTotalCount=function(){return a._totalCount},this.getFields=function(){return a._config.fields},this.getResults$=function(){return a._results$},this.setResults=function(e){return a._results$.next(e)},this._id=e,this._config=t,this._setFilters(),this._setFacets(),this._setPage(),this._setInputs(),this._setInputsData(),this._setTotalCount(),V.queryParams&&(this.updateFiltersFromQueryParams(V.queryParams),V.queryParams=null)}return e.prototype.updateFilter=function(e,t,a){this.getFiltersByFacetId(e).forEach((function(e){Array.isArray(e.value)&&a?e.value=e.value.filter((function(e){return e!==t})):Array.isArray(e.value)&&-1===e.value.indexOf(t)?e.value.push(t):e.value=a?null:$.escapeDoubleQuotes(t)}))},e.prototype.clear=function(){this.updateFiltersFromQueryParams({},!0),this._clearInputs()},e.prototype.updateFiltersFromQueryParams=function(e,t){var a=this;void 0===t&&(t=!1),this._facets.forEach((function(n){var i=n.id,o=a.getFiltersByFacetId(i),r=e[i];"internal"===a.getInputByFacetId(i).getContext()&&!t||o.forEach((function(e){e.isArray?e.value=r?r.split(","):[]:e.value=r||null}))}))},e.prototype.updateInputsFromFilters=function(){var e=this;this._filters.forEach((function(t){var a=t.facetId,n=t.value;e.getInputByFacetId(a).setActive(n)}))},e.prototype.updateFacets=function(e){var t=this;e.forEach((function(e){var a=e.id,n=e.data;return t.updateFacet(a,n)})),this._setInputsData()},e.prototype.updateTotalCount=function(e){this._totalCount=e},e.prototype.updateFacet=function(e,t){var a=this._facets.filter((function(t){return t.id===e}));if(!a.length)throw Error("Facet with id '"+e+"' does not exists");a.forEach((function(e){e.data=t}))},e.prototype.reset=function(){this._filters.forEach((function(e){e.value=null}))},e.prototype.getRequestParams=function(){return{facets:this._getRequestFacets(),page:this._page,results:this._config.results,filters:this._filters.filter((function(e){return"internal"!==e.context})).map((function(e){return{facetId:e.facetId,value:e.value,searchIn:e.searchIn}}))}},e.prototype.getInternalFilters=function(){return this._filters.filter((function(e){return"internal"===e.context&&(Array.isArray(e.value)&&e.value.length||!Array.isArray(e.value)&&e.value)})).map((function(e){return{facetId:e.facetId,value:e.value,searchIn:e.searchIn}}))},e.prototype.filtersAsQueryParams=function(e){var t={};return e.forEach((function(e){t[e.facetId]=Array.isArray(e.value)?e.value.join(","):e.value})),t},e.prototype.getFiltersByFacetId=function(e){return this._filters.filter((function(t){return t.facetId===e}))},e.prototype.getInputByFacetId=function(e){return this._inputs.filter((function(t){return t.getFacetId()===e}))[0]},e.prototype.setInputData=function(e,t){this.getInputByFacetId(e).setData(t)},e.prototype.filterTarget=function(e){var t=this,a=this._inputs.filter((function(t){return t.getTarget()===e})),n=this.getInputByFacetId(e),i=this._facets.filter((function(t){return t.id===e}))[0].data,o=[];if(a.forEach((function(e){var a=t.getFiltersByFacetId(e.getFacetId())[0],n=e.getSearchIn(),i=a.value;o.push([n,i])})),i.forEach((function(e){return t._filterData(o,e)})),n.setData(i),n.getConfig().emptyState){var r=!i.filter((function(e){return!e.hidden})).length;n.setIsEmpty(r)}n.update()},e.prototype.setSearchConfigOrderBy=function(e){this._config.results.order.key=e},e.prototype.setSearchConfigDirection=function(e){this._config.results.order.direction=e},e.prototype.setSearchConfigType=function(e){this._config.results.order.type=e},e.prototype.setPageConfigOffset=function(e){this._config.page.offset=e},e.prototype.setPageConfigLimit=function(e){this._config.page.limit=e},e.prototype._clearInputs=function(){},e.prototype._filterData=function(e,t){var a=this;t.hidden=!1,e.forEach((function(e){var n=k(e,2),i=n[0],o=n[1];i.forEach((function(e){var n=e.key,i=e.operator;if(!t.hidden){var r=p.get(t,n,null);if(-1!==n.indexOf("searchData")&&Array.isArray(t.searchData)){var s=n.replace("searchData.","");t.searchData.forEach((function(e){var t=e.key,a=e.value;t===s&&(r=a)}))}null===r?t.hidden=!0:B[i]?t.hidden=a[B[i]](o,r):console.warn("SearchIn: operator "+i+" not supported")}}))}))},e.prototype._filterDataEquals=function(e,t){if(Array.isArray(t)){if(Array.isArray(e)){var a=0===e.length;return t.forEach((function(t){-1!==e.indexOf(t)&&(a=!0)})),!a}return!(e&&-1!==t.indexOf(e))}return Array.isArray(e)?!(!e.length||-1!==e.indexOf(t)):!(e&&e===t)},e.prototype._filterDataGreaterThan=function(e,t){return!Array.isArray(e)&&!(e&&e>t)},e.prototype._filterDataLessThan=function(e,t){return!Array.isArray(e)&&!(e&&e<t)},e.prototype._filterDataGreaterOrEquals=function(e,t){return!Array.isArray(e)&&!(e&&e>=t)},e.prototype._filterDataLessOrEquals=function(e,t){return!Array.isArray(e)&&!(e&&e<=t)},e.prototype._filterDataNotEqual=function(e,t){return!Array.isArray(e)&&!(e&&e!==t)},e.prototype._filterDataLike=function(e,t){if(e&&"string"==typeof e&&"string"==typeof t){var a=t.toLowerCase(),n=e.toLocaleLowerCase();return!(-1!==a.indexOf(n))}return!1},e.prototype._setFilters=function(){var e=this;this._config.fields.forEach((function(t){t.inputs.forEach((function(t){return e._filters.push(b(b({},t.filterConfig),{facetId:t.facetId,value:t.filterConfig.isArray?[]:null}))}))}))},e.prototype._setFacets=function(){this._facets=this._config.facets},e.prototype._setPage=function(){this._page=this._config.page},e.prototype._setTotalCount=function(){this._totalCount=this._config.totalCount},e.prototype._setInputs=function(){var e=this;this._config.fields.forEach((function(t,a){t.inputs.forEach((function(t,n){var i=q[t.type];if(!i)throw Error("Input type "+t.type+" not supported");e._inputs.push(new i(b(b({},t),{inputIndex:n,sectionIndex:a})))}))}))},e.prototype._setInputsData=function(){var e=this;this._facets.forEach((function(t){return e.setInputData(t.id,t.data)}))},e.prototype._getRequestFacets=function(){var e=[];return this._facets.forEach((function(t){var a=b({},t);t.hasStaticData||delete a.data,delete a.hasStaticData,Array.isArray(a.data)&&a.data.filter((function(e){return void 0!==e.searchData})).forEach((function(e){delete e.searchData})),e.push(a)})),e},e}(),V=function(){function e(){this._models={}}return e.prototype.add=function(e,t){if(this._models[e])throw Error("Search model '"+e+"' already exists!");this._models[e]=new G(e,t)},e.prototype.remove=function(e){this._models[e]&&delete this._models[e]},e.prototype.model=function(e){return this._models[e]||null},e.queryParams=null,e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"})],e)}(),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"main-layout.init":e.dataSource.onInit(n),e.mainState=n.mainState,e.route=n.route,e.router=n.router,e._listenRouterChanges(),e._listenMainStateChanges();break;case"main-layout.destroy":e.destroyed$.next()}})),l.EventHandler.globalEvents$.pipe(r.takeUntil(this.destroyed$)).subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"global.navigate":e.dataSource.onNavigate(n)}}))},t.prototype._listenRouterChanges=function(){var e=this;this.route.queryParams.pipe(r.filter((function(e){return!!Object.keys(e).length}))).subscribe((function(t){e.emitGlobal("queryparams",t),V.queryParams=t})),this.router.events.pipe(r.filter((function(e){return e instanceof s.NavigationStart}))).subscribe((function(){window.scrollTo(0,0),e.emitOuter("routerchange"),e.dataSource.onRouterChanged()}))},t.prototype._listenMainStateChanges=function(){var e=this;this.mainState.addCustom("currentNav",new o.Subject),this.mainState.getCustom$("currentNav").subscribe((function(t){e.emitOuter("currentnavchange",t)}))},t}(l.EventHandler),W="is-mobile-nav-displayed",U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e?b(b({},e),{menuToggle:{open:{payload:"mobile-open"},close:{payload:"mobile-close"}}}):null},t.prototype.onCurrentNavChange=function(e){this.output.nav.items.forEach((function(t){t.classes=t._meta.id===e?"is-active":""}))},t.prototype.onRouterChange=function(){var e=this.output.classes;(e=(e=e||"").split(" ")).includes(W)&&(e.splice(e.indexOf(W),1),this.output.classes=e.join(" "))},t.prototype.onClick=function(e){if(["mobile-open","mobile-close"].includes(e)){var t=this.output.classes;(t=(t=t||"").split(" ")).includes(W)?t.splice(t.indexOf(W),1):t.push(W),this.output.classes=t.join(" ")}},t}(l.DataSource),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return{classes:"main-subnav",items:e}},t.prototype.setActive=function(e){this.output.items.forEach((function(t){t._meta.id===e?(t.classes="is-current",t._meta.isActive=!0):(t.classes="",t._meta.isActive=!1)}))},t.prototype.getActive=function(){return this.output.items.filter((function(e){return e._meta.isActive}))[0]||null},t}(l.DataSource),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){var t=e.fields,a=this.options.searchModel;return this.searchModel=a,t},t}(l.DataSource),X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getRequestParams=function(){return t.searchModel.getRequestParams()},t.filtersAsQueryParams=function(e){return t.searchModel.filtersAsQueryParams(e)},t.updateFiltersFromQueryParams=function(e){t.searchModel.updateFiltersFromQueryParams(e)},t.getInputByFacetId=function(e){return t.searchModel.getInputByFacetId(e)},t.filterTarget=function(e){t.searchModel.filterTarget(e)},t.updateInputsFromFilters=function(){t.searchModel.updateInputsFromFilters()},t}return m(t,e),t.prototype.transform=function(e){var t=this;this.searchModel||(this.searchModel=e.searchModel);var a=this.searchModel.getId(),n=this.searchModel.getFields(),i=[];return n.forEach((function(e,n){var o="group-"+a+"-"+n,r=t._headerConfig(e.header,o),s=[];t.searchModel.getInputs().filter((function(e){return e.getSectionIndex()===n})).map((function(e){return e.update(),{facetId:e.getFacetId(),type:e.getType(),output:e.getOutput()}})).forEach((function(e){var a=e.type,n=e.output,i=e.facetId;s.push({classes:t._getSectionClasses(a),inputs:Array.isArray(n)?n:[n],_meta:{facetId:i}})})),i.push({header:r,facet:{sections:s},classes:"n7-facets-wrapper__"+o,isOpen:!0,_meta:{groupId:o}})})),{groups:i,classes:"n7-facets-wrapper__"+this.searchModel.getId()}},t.prototype.toggleGroup=function(e){var t=e.eventPayload;this.output.groups.forEach((function(e){e._meta.groupId===t.groupId&&(e.isOpen=!e.isOpen,e.header.iconRight=e.isOpen?"n7-icon-angle-down":"n7-icon-angle-right")}))},t.prototype.onFacetChange=function(e){var t=e.eventPayload,a=t.inputPayload,n=a.facetId,i=a.source,o=a.trigger,r=(this.searchModel.getFiltersByFacetId(n)[0]||{value:null}).value,s=!1,c=t.inputPayload.value||t.value;c=""+c,s=Array.isArray(r)?-1!==r.indexOf(c):r===c,"input-text"===i&&-1!==["enter","icon"].indexOf(o)||(this.searchModel.updateFilter(n,c,s),this.searchModel.updateInputsFromFilters())},t.prototype.updateFilteredTarget=function(e){var t=this.searchModel.getInputByFacetId(e);this.output.groups.map((function(e){return e.facet})).map((function(e){return e.sections})).forEach((function(a){a.forEach((function(a){if(a._meta.facetId===e){var n=t.getOutput();a.inputs=Array.isArray(n)?n:[n]}}))}))},t.prototype.updateInputLinks=function(){var e=this,t=this.searchModel.getInputs().filter((function(e){return"link"===e.getType()})).map((function(e){return e.getFacetId()}));this.output.groups.map((function(e){return e.facet})).map((function(e){return e.sections})).forEach((function(a){a.forEach((function(a){if(-1!==t.indexOf(a._meta.facetId)){var n=e.searchModel.getInputByFacetId(a._meta.facetId);n.update();var i=n.getOutput();a.inputs=Array.isArray(i)?i:[i]}}))}))},t.prototype._getSectionClasses=function(e){return"n7-facet__section-input-"+{text:"text",checkbox:"checkboxes",link:"links",select:"select"}[e]},t.prototype._headerConfig=function(e,t){return e?{text:e.label,iconRight:"n7-icon-angle-down",classes:e.classes,payload:{source:"group-header",id:t+"-header",groupId:t},_meta:{id:t+"-header"}}:null},t}(l.DataSource),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e||null},t}(l.DataSource),Z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.paginationBuilder=function(e,a,n,i,o,r){var s=[],c=n;if(e<=c&&(c=e-1),c){var l=void 0,u=void 0;a>Math.floor(c/2)?2===e?(l=e,u=1):a<e-Math.floor(c/2)?(l=a/1+Math.floor(c/2),u=a/1-Math.floor(c/2)):(l=e,u=a-c+(e-a)):(l=c+1,u=1);for(var d=u;d<=l;d+=1)s.push({text:String(d),classes:a===d?"is-active":"",anchor:a!==d?t._getPaginationAnchor(d,i,o,r):null})}else{s.push({text:"1",classes:1===a?"is-active":"",anchor:1!==a?t._getPaginationAnchor(1,i,o,r):null});for(d=1;d<e;d+=1)s.push({text:String(d+1),classes:a===d+1?"is-active":"",anchor:a!==d+1?t._getPaginationAnchor(d+1,i,o,r):null})}return{links:s,first:{classes:1===a?"is-disabled":"",anchor:1!==a?t._getPaginationAnchor(1,i,o,r):null},prev:{classes:1===a?"is-disabled":"",anchor:1!==a?t._getPaginationAnchor(a/1-1,i,o,r):null},next:{classes:a===e?"is-disabled":"",anchor:a!==e?t._getPaginationAnchor(a/1+1,i,o,r):null},last:{classes:a===e?"is-disabled":"",anchor:a!==e?t._getPaginationAnchor(e,i,o,r):null}}},t}return m(t,e),t.prototype.transform=function(e){var t=e.totalPages,a=e.currentPage,n=e.pageLimit,i=e.sizes,o=this.options,r=o.mode,s=o.href,c=o.queryParams;["href","payload"].includes(r)||console.warn('(smart-pagination) The "mode" option is incorrect. Please specify "href" or "payload" as the mode option.');var l=this.paginationBuilder(t,+a,n,r,s,c),u=l.links;return{first:l.first,prev:l.prev,next:l.next,last:l.last,links:u,select:i?{label:"Numero di risultati",options:i.list.map((function(e){return{text:e,selected:e===i.active}})),payload:"select-size"}:null}},t.prototype._getPaginationAnchor=function(e,t,a,n){switch(t){case"payload":return{payload:{source:"pagination",page:e}};case"href":return{href:n?a:a+e,queryParams:n?b(b({},n),{page:e}):null}}return{}},t}(l.DataSource),ee=Object.freeze({__proto__:null,HeaderDS:U,SubnavDS:K,BreadcrumbsDS:Q,FacetsDS:Y,FacetsWrapperDS:X,FooterDS:J,SmartPaginationDS:Z}),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"header.click":e.dataSource.onClick(n)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"main-layout.currentnavchange":e.dataSource.onCurrentNavChange(n);break;case"main-layout.routerchange":e.dataSource.onRouterChange()}}))},t}(l.EventHandler),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"subnav.click":"navigate"===n.source&&e.emitGlobal("navigate",n),e.emitGlobal(a,n)}}))},t}(l.EventHandler),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"breadcrumbs.click":"navigate"===n.source&&e.emitGlobal("navigate",n),e.emitGlobal(a,n)}}))},t}(l.EventHandler),ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._facetsChanged=!1,t.internalFacetsChange$=new o.Subject,t.externalFacetsChange$=new o.Subject,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"facets-wrapper.facet":if(!n.eventPayload.inputPayload)return;var i=n.eventPayload.inputPayload.facetId,o=e.dataSource.getInputByFacetId(i),r=o.getContext();e._facetsChanged=!0,e.dataSource.onFacetChange(n),"internal"===r?e.internalFacetsChange$.next(o.getTarget()):e.externalFacetsChange$.next();break;case"facets-wrapper.facetheader":e.dataSource.toggleGroup(n)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;-1!==a.indexOf("queryparamschange")&&e.dataSource.searchModel&&(e.dataSource.updateFiltersFromQueryParams(n),e.dataSource.updateInputsFromFilters())})),l.EventHandler.globalEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"global.searchresponse":if(e.dataSource.searchModel&&e.dataSource.searchModel.getId()===n)e.dataSource.updateInputLinks(),e.dataSource.searchModel.getInternalFilters().forEach((function(t){var a=e.dataSource.searchModel.getInputByFacetId(t.facetId).getTarget();e.dataSource.filterTarget(a),e.dataSource.updateFilteredTarget(a)}))}})),this.internalFacetsChange$.pipe(r.debounceTime(500)).subscribe((function(t){e.dataSource.filterTarget(t),e.dataSource.updateFilteredTarget(t)})),this.externalFacetsChange$.pipe(r.debounceTime(500)).subscribe((function(){var t=e.dataSource.getRequestParams(),a=e.dataSource.filtersAsQueryParams(t.filters);Object.keys(a).forEach((function(e){a[e]=a[e]||null})),e.emitOuter("facetschange"),a.page=1,e.emitGlobal("navigate",{handler:"router",path:[],queryParams:a})}))},t}(l.EventHandler),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"n7-smart-pagination.change":e.emitOuter("change",n);break;case"n7-smart-pagination.click":e.emitOuter("click",n);break;default:console.warn("unhandled inner event of type",a)}}))},t}(l.EventHandler),se=Object.freeze({__proto__:null,HeaderEH:te,SubnavEH:ae,BreadcrumbsEH:ne,FacetsWrapperEH:ie,FooterEH:oe,SmartPaginationEH:re}),ce={layoutId:"main-layout",widgets:[{id:"header"},{id:"subnav"},{id:"breadcrumbs"},{id:"footer"}],layoutDS:O,layoutEH:N,widgetsDataSources:ee,widgetsEventHandlers:se,options:{}},le=function(e){function a(t,a,n,i,o,r){var s=e.call(this,i.get("MainLayoutConfig")||ce)||this;return s.router=t,s.route=a,s.configuration=n,s.layoutsConfiguration=i,s.mainState=o,s.titleService=r,s}return m(a,e),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:C},{type:E},{type:x},{type:c.Title}]},a=v([t.Component({selector:"main-layout",template:'<div class="n7-main-layout" id="main-layout">\n    <div class="n7-page-content">\n        <n7-header\n            [data]="lb.widgets[\'header\'].ds.out$ | async"\n            [emit]="lb.widgets[\'header\'].emit">\n        </n7-header>\n        <main class="n7-content">\n            <div class="n7-top-page-bar">\n                <div class="n7-top-page-bar__main"></div>\n            </div>\n            <div class="n7-alert-bar">\n                \x3c!--<n7-alert\n                [attr.id]="\'main-layout-alert\'"\n                [data]="lb.dataSource.alertData$ | async"\n                [emit]="lb.dataSource.closeAlert.bind(lb.dataSource)"></n7-alert>--\x3e\n            </div>\n            <ng-content></ng-content>\n        </main>\n    </div>\n    <n7-footer\n        [data]="lb.widgets[\'footer\'].ds.out$ | async" \n        [emit]="lb.widgets[\'footer\'].emit">\n    </n7-footer>\n</div>\n'}),w("design:paramtypes",[s.Router,s.ActivatedRoute,C,E,x,c.Title])],a)}(A),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.onInit=function(e){var t=e.options;this.options=t},t}(u.LayoutDataSource),de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"n7-page404-layout.init":e.dataSource.onInit(n);break;case"n7-page404-layout.destroy":e.destroyed$.next()}}))},t}(l.EventHandler),pe={layoutId:"n7-page404-layout",widgets:[],layoutDS:ue,layoutEH:de,widgetsDataSources:ee,widgetsEventHandlers:se,options:{}},he=function(e){function a(t){return e.call(this,t.get("Page404LayoutConfig")||pe)||this}return m(a,e),a.prototype.initPayload=function(){return{options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.ctorParameters=function(){return[{type:E}]},a=v([t.Component({selector:"n7-page404-layout",template:'<div class="n7-page404-layout">\n    404 - Resource not found\n</div>'}),w("design:paramtypes",[E])],a)}(A),fe=function(){function e(){}return e.prototype.headerEmit=function(e,t){this.emit&&this.emit("facetheader",{eventType:e,eventPayload:t})},e.prototype.facetEmit=function(e,t){this.emit&&this.emit("facet",{eventType:e,eventPayload:t})},v([t.Input(),w("design:type",Object)],e.prototype,"data",void 0),v([t.Input(),w("design:type",Object)],e.prototype,"emit",void 0),e=v([t.Component({selector:"n7-facets-wrapper",template:'<div *ngIf="data" class="n7-facets-wrapper {{ data.classes || \'\' }}">\n    <div *ngFor="let group of data.groups" class="n7-facets-wrapper__group {{ group.classes || \'\' }}">\n        <n7-facet-header\n            [data]="group.header"\n            [emit]="headerEmit.bind(this)"\n        ></n7-facet-header>\n\n        <n7-facet\n            *ngIf="group.isOpen"\n            [data]="group.facet"\n            [emit]="facetEmit.bind(this)"\n        ></n7-facet>\n    </div>\n</div>'})],e)}(),ge=function(){function e(){this.handlePaginationEvent.bind(this)}return e.prototype.handlePaginationEvent=function(e,t){this.emit&&this.emit("change",t)},v([t.Input(),w("design:type",Object)],e.prototype,"data",void 0),v([t.Input(),w("design:type",Object)],e.prototype,"emit",void 0),e=v([t.Component({selector:"n7-smart-pagination",template:'<div class="n7-smart-pagination" *ngIf="data">\n  <n7-pagination\n    [data]="data"\n    [emit]="emit">\n  </n7-pagination>\n</div>'}),w("design:paramtypes",[])],e)}(),ye=[le,he,fe,ge],me=function(){function e(){}var o;return o=e,e.forRoot=function(e){return{ngModule:o,providers:[x,C,E,T,{provide:"config",useValue:e}]}},e=o=v([t.NgModule({declarations:ye,imports:[a.CommonModule,n.HttpClientModule,i.DvComponentsLibModule],providers:[],entryComponents:ye,exports:ye})],e)}(),be=function(e){return!e||"null"===e},ve=function(e){return!!e.filter((function(e){return"isLink"===e.key})).length},we=function(e){return Array.isArray(e)},Se=function(e,t){var a=e.find((function(e){return"label"===e.key})).value,n=$.slugify(a),i=e.find((function(e){return"id"===e.key})).value,o=e.find((function(e){return"type"===e.key})).value,r=t.entitaBasePath;return["oggetto-culturale","aggregazione-logica"].includes(o)&&(r=t.schedaBasePath),'<a href="'+r+i+"/"+n+'">'+a+"</a>"},ke=function(e,t,a,n){var i=[];return e.filter((function(e){var t=e.key,n=e.value;return a.includes(t)&&!be(n)})).map((function(e){var i=e.key;return{key:i,value:e.value,order:a.indexOf(i),label:$.prettifySnakeCase(i,t[n+"."+i])}})).sort((function(e,t){return e.order-t.order})).forEach((function(e){var t=e.label,a=e.value;i.push("<dt>"+t+"</dt>"),i.push("<dd>"+a+"</dd>")})),i.length?"<dl>"+i.join("")+"</dl>":null},_e=function(e){var t=e.fields,a=e.paths,n=e.labels,i=e.metadataToShow,o=e.type,r=[];return Array.isArray(t)&&t.forEach((function(e){var t=e.key,s=e.value,c=e.label,l=e.fields;l&&Array.isArray(l)?ve(l)?r.push({key:c,value:Se(l,a)}):we(l)&&r.push({key:c,value:ke(l,n,i,o)}):r.push({key:t,value:s})})),r.filter((function(e){var t=e.key,a=e.value;return i.includes(t)&&!be(a)})).map((function(e){var t=e.key;return{key:t,value:e.value,order:i.indexOf(t),label:$.prettifySnakeCase(t,n[o+"."+t])}})).sort((function(e,t){return e.order-t.order}))},Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasMetadataFields=!1,t.navHeader={},t.pageSize=10,t.bubblesSize=10,t.updateComponent=function(e,a,n){n&&t.one(e).updateOptions(n),t.one(e).update(a)},t.drawPagination=function(){if(t.myResponse.relatedItems){var e=t._getPaginationParams(),a=e.href,n=e.queryParams;t.one("n7-smart-pagination").updateOptions({mode:"href",href:a,queryParams:n}),t.one("n7-smart-pagination").update({totalPages:Math.ceil(t.myResponse.relatedItems.length/t.pageSize),currentPage:t.currentPage,pageLimit:5,sizes:{list:[10,25,50],active:t.pageSize}})}},t.handlePageNavigation=function(){if(t.myResponse){var e=t._getPaginationParams(),a=e.href,n=e.queryParams;t.drawPagination(),t.one("aw-linked-objects").updateOptions({paginationParams:{href:a,queryParams:n},context:t.selectedTab,config:t.configuration,page:t.currentPage,pagination:!0,size:t.pageSize}),t.one("aw-linked-objects").update({items:t.myResponse.relatedItems})}},t.handleNavUpdate=function(e){t.selectedTab=e,t.updateWidgets(t.myResponse),"oggetti-collegati"===e?(t.one("aw-linked-objects").updateOptions({context:t.selectedTab,config:t.configuration,page:t.currentPage,pagination:!0,paginationParams:t._getPaginationParams(),size:t.pageSize}),t.one("aw-linked-objects").update({items:t.myResponse.relatedItems})):"overview"===e&&t.myResponse.relatedItems&&(t.one("aw-linked-objects").updateOptions({size:3,config:t.configuration,context:"entita"}),t.one("aw-linked-objects").update({items:t.myResponse.relatedItems})),"overview"!==e&&"entita-collegate"!==e||!t.myResponse.relatedEntities||setTimeout((function(){t.updateBubbes(t.myResponse.relatedEntities)}),800)},t}return m(t,e),t.prototype.onInit=function(e){var t=e.configuration,a=e.mainState,n=e.router,i=e.route,o=e.location,r=e.options,s=e.titleService,c=e.communication;this.route=i,this.communication=c,this.configuration=t,this.mainState=a,this.options=r,this.router=n,this.location=o,this.titleService=s,this.currentId="",this.currentPage=+this.route.snapshot.queryParams.page,this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.bubblesSize=this.configuration.get("entita-layout")?this.configuration.get("entita-layout").entitiesQuerySize:this.bubblesSize,this.one("aw-bubble-chart").updateOptions({selectable:!1,simple:!0,config:this.configuration,limit:this.configuration.get("bubble-chart").bubbleLimit,smallChartSize:this.configuration.get("entita-layout").overview.smallChartSize}),this.one("aw-chart-tippy").updateOptions({basePath:this.configuration.get("paths").entitaBasePath}),this.mainState.updateCustom("currentNav","entita"),this.mainState.update("headTitle","Arianna4View - Entità"),this.oneTabControl()},t.prototype.oneTabControl=function(){var e=this;this.getWidgetDataSource("aw-entita-nav").out$.pipe(r.filter((function(e){return!!e}))).subscribe((function(t){var a=t.items;1===a.length&&e.router.navigate([a[0].anchor.href],{replaceUrl:!0})}))},t.prototype.updateWidgets=function(e){var t=this.selectedTab;Object.keys(e).forEach((function(t){Array.isArray(e[t])&&0===e[t].length&&(e[t]=null)})),this.one("aw-entita-nav").update({data:e,selected:t,basePath:this.getNavBasePath()}),this.updateComponent("aw-entita-metadata-viewer",this.getFields(this.myResponse)),this.drawPagination()},t.prototype.updateBubbes=function(e){this.one("aw-bubble-chart").update(e)},t.prototype.loadItem=function(e,t,a){var n=this;return e&&a?(this.currentId=e,this.currentSlug=t,this.selectedTab=a,this.communication.request$("getEntityDetails",{onError:function(e){return console.error(e)},params:{entityId:e,entitiesListSize:this.bubblesSize}}).pipe(r.tap((function(e){var t=e.fields,a=e.typeOfEntity;n.hasMetadataFields=!!_e({fields:t,paths:n.configuration.get("paths"),labels:n.configuration.get("labels"),metadataToShow:p.get(n.configuration.get("entita-layout"),"metadata-to-show",[]),type:a}).length})))):(this.pageTitle="Entità Test",o.of(null))},t.prototype.loadContent=function(e){var t=this.configuration.get("config-keys")[e.typeOfEntity];this.myResponse=e,this.navHeader={icon:t?t.icon:"",text:this.myResponse.label,color:t["class-name"]},this.one("aw-entita-nav").updateOptions({bubblesEnabled:this.bubblesEnabled,config:this.configuration.get("entita-layout"),hasMetadataFields:this.hasMetadataFields}),this.one("aw-entita-metadata-viewer").update(this.getFields(e)),"oggetti-collegati"===this.selectedTab?this.one("aw-linked-objects").updateOptions({context:this.selectedTab,config:this.configuration,page:this.currentPage,pagination:!0,paginationParams:this._getPaginationParams(),size:this.pageSize}):this.one("aw-linked-objects").updateOptions({size:3,config:this.configuration,context:"entita"}),e.relatedItems.forEach((function(t){t.relationName=e.label.length>30?e.label.substr(0,30)+"... ":e.label})),this.one("aw-linked-objects").update({items:e.relatedItems}),this.drawPagination(),this.mainState.update("headTitle","Arianna4View - Entità - "+this.myResponse.label)},t.prototype._getPaginationParams=function(){return{href:[this.configuration.get("paths").entitaBasePath,this.currentId+"/",this.currentSlug,"/oggetti-collegati/"].join(""),queryParams:{page:this.currentPage}}},t.prototype.getNavBasePath=function(){return[this.configuration.get("paths").entitaBasePath,this.currentId+"/",this.currentSlug].join("")},t.prototype.getFields=function(e){var t=e.fields,a=e.typeOfEntity,n=this.configuration.get("paths"),i=this.configuration.get("labels"),o=p.get(this.configuration.get("entita-layout"),"metadata-to-show",[]);return"overview"===this.selectedTab&&(o=p.get(this.configuration.get("entita-layout"),"overview.campi",[])),_e({fields:t,paths:n,labels:i,metadataToShow:o,type:a})},t}(u.LayoutDataSource),Ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t.handlePageSizeChange=function(e){t.dataSource.pageSize=e,t.dataSource.handleNavUpdate("oggetti-collegati")},t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-entita-layout.init":e.dataSource.onInit(n),e.configuration=n.configuration,e.route=n.route,e.entityId=e.route.snapshot.params.id||"",e.dataSource.currentPage=e.route.snapshot.params.page||1,e.listenRoute(e.entityId);break;case"aw-entita-layout.destroy":e.destroyed$.next();break;case"aw-entita-layout.showmore":n&&e.dataSource.handleNavUpdate(n)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-bubble-chart.d3end":e.emitOuter("d3end",n);break;case"aw-entita-nav.click":n&&(e.dataSource.selectedTab=n,e.dataSource.handleNavUpdate(n));break;case"aw-linked-objects.change":e.dataSource.pageSize=n,e.dataSource.currentPage=1;var i={context:e.dataSource.selectedTab,config:e.dataSource.configuration,page:e.dataSource.currentPage,pagination:!0,size:e.dataSource.pageSize};e.dataSource.updateComponent("aw-linked-objects",{items:e.dataSource.myResponse.relatedItems},i);break;case"aw-bubble-chart.bubble-tooltip-goto-click":var o=n.id,r=n.label;e.emitGlobal("navigate",{handler:"router",path:[e.configuration.get("paths").entitaBasePath,o,$.slugify(r),"overview"]});break;case"aw-bubble-chart.bubble-filtered":"overview"!==e.dataSource.selectedTab&&"entita-collegate"!==e.dataSource.selectedTab||e.emitOuter("filterbubbleresponse",n.relatedEntities);break;case"n7-smart-pagination.change":e.handlePageSizeChange(n.value)}}))},t.prototype.listenRoute=function(e,t){var a=this;void 0===e&&(e=""),void 0===t&&(t=!1),this.route.queryParams.pipe(r.map((function(e){return e.page}))).subscribe((function(e){a.dataSource.currentPage!==e&&(a.dataSource.currentPage=e,a.dataSource.handlePageNavigation())})),this.route.paramMap.subscribe((function(n){if(n.get("id")){if(a.dataSource.currentId===n.get("id")&&!t)return void(a.dataSource.selectedTab!==n.get("tab")&&a.dataSource.handleNavUpdate(n.get("tab")));a.dataSource.loadItem(n.get("id"),n.get("slug"),n.get("tab")).subscribe((function(t){if(t){a.dataSource.loadContent(t);var i=t.relatedEntities.filter((function(e){return e.id!==n.get("id")}));a.dataSource.updateWidgets(t),e&&a.emitOuter("selectItem",e),a.emitOuter("filterbubbleresponse",i)}}))}else a.dataSource.loadItem()}))},t}(l.EventHandler),Ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadingData=!1,t.checkForMore=function(e){t.loadedData.actions&&(void 0===e?t.loadedData.result.length>=t.totalObjects?t.loadedData.actions[1].disabled=!0:t.loadedData.actions[1].disabled=!1:t.loadedData.actions[1].disabled=!e)},t.handleIncomingData=function(e){t.currentPage+=1;var a=t.unpackData(e.itemsPagination);t.loadedData.result=t.loadedData.result.concat(a.result),t.checkForMore(),t.loadedData.isLoading=!1},t.unpackData=function(e){var a,n,i=t.options.config,o=i.get("item-preview"),r=e.totalCount,s=t.currentPage,c=t.context,l=t.pageSize,u=i.get("labels"),d=t.options.dynamicPagination,h=i?i.get("config-keys"):{},f=e.items?e.items:e.relatedItems;i&&i.get(c+"-layout")&&(a=i.get(c+"-layout")["max-item-length"],n=i.get(c+"-layout")["results-limit"]),!d&&l&&s?f=f.slice(s*l-l,s*l):l&&(f=f.slice(0,l));var g=[],y=o.metadata.info.selection.map((function(e){return e.key}));return f.forEach((function(e){var t=e.item?e.item:e,a=p.get(e,o.metadata.info.data,t.fields),n=a?a.filter((function(e){return-1!==y.indexOf(e.key)})):[],r=p.get(e,o.metadata.toe.data,t.relatedTypesOfEntity),s=p.get(e,o.metadata.breadcrumbs.data,t.breadcrumbs);["entita","search","gallery"].includes(c)&&t.typeOfEntity&&""!==t.typeOfEntity&&n.push({key:"Tipo di entità",value:h[t.typeOfEntity]["singular-label"]});var l=["entita","search","oggetti-collegati"].includes(c)?"is-fullwidth":"";l+=t.typeOfEntity?" is-"+i.get("config-keys")[t.typeOfEntity]["class-name"]:" is-oggetto-culturale","gallery"===c&&(l+=" is-vertical has-image");var d=p.get(e,o.title,t.label).match(/<em>/g)?9*p.get(e,o.title,t.label).match(/<em>/g).length:0,f=+o.title.maxLength&&p.get(e,o.title,t.label).length>+o.title.maxLength+d?p.get(e,o.title,t.label).slice(0,+o.title.maxLength+d)+"…":p.get(e,o.title,t.label),m=p.get(e,o.payload,t.id),b=[t.typeOfEntity?i.get("paths").entitaBasePath:i.get("paths").schedaBasePath,m,$.slugify(f)].join("/"),v={text:o.text?+o.text.maxLength&&p.get(e,o.text.data,t.text).length>+o.text.maxLength?p.get(e,o.text.data,t.text).slice(0,+o.text.maxLength)+"…":p.get(e,o.text.data,t.text):null,classes:l,breadcrumbs:s,image:p.get(e,o.image,t.image),title:f,anchor:{href:b,target:["gallery","search"].includes(c)?"_blank":"_self"},relation:{key:e.relationName,value:e.relation},metadata:n.length||r?[]:null};n.length&&v.metadata.push({classes:"aw-item-preview_metadata",items:n.map((function(e){return{label:$.prettifySnakeCase(e.key,u[e.key]),value:e.value}}))}),r&&v.metadata.push({classes:"aw-item-preview-entities",items:r.map((function(e){return{value:p.get(e,o.metadata.toe.value,e.count),icon:h[p.get(e,o.metadata.toe.icon,e.type)]?h[p.get(e,o.metadata.toe.icon,e.type)].icon:"",classes:"color-"+h[p.get(e,o.metadata.toe.icon,e.type)]["class-name"]}}))}),s&&(v.breadcrumbs={items:p.get(e,o.metadata.breadcrumbs.data,e.item.breadcrumbs).map((function(e){return{label:p.get(e,o.metadata.breadcrumbs.label,e.label),anchor:{href:b}}}))}),g.push(v)})),"home"===c?{result:g,actions:[{label:"Mostra Tutti ("+r+")"},a?{label:"Mostra Altri ("+n+")",disabled:!1}:null],isLoading:!1,fallback:i.get("home-layout")["linked-objects-fallback"]}:{previews:g}},t}return m(t,e),t.prototype.transform=function(e){return this.paths=this.options.config.get("item-preview"),this.pageSize=this.options.size,this.totalObjects=e.totalCount,this.currentPage=this.options.page?+this.options.page:1,this.options.dynamicPagination&&this.options.dynamicPagination.total?this.totalPages=Math.ceil(this.options.dynamicPagination.total/this.pageSize):e.items?this.totalPages=Math.ceil(e.items.length/this.pageSize):e.relatedItems&&(this.totalPages=Math.ceil(e.relatedItems.length/this.pageSize)),this.context=this.options.context,this.loadedData=this.unpackData(e),this.checkForMore(),this.loadedData.loaderData={},this.loadedData},t}(l.DataSource),xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stringTrim=function(e,t){return e.length>t?e.slice(0,t)+"…":e},t}return m(t,e),t.prototype.transform=function(e){var t=this,a=e.response;if(!a)return{suggestion:[],loading:!0};var n=[],i=this.options.config.get("home-layout")["max-item-length"]||20;return a.results.filter((function(e){return"object"==typeof e.entity})).forEach((function(e){if("fallback"===e.entity.id)return n.push({text:e.entity.label,payload:"fallback-simple-autocomplete"}),{suggestion:n};var a=t.stringTrim(e.entity.label,i);n.push({text:a,anchor:{payload:e.entity.id}})})),{suggestion:n}},t}(f.DataSource),Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chartData=[],t.draw=null,t.selected=[],t.filters=[],t.closedEyes=[],t.tippyList=[],t.updateChart=function(e){var a=e;null===e?a=t.chartData:t.chartData=e,t.filters.length>0&&(a=t.chartData.filter((function(e){return!t.filters.includes(e.entity.typeOfEntity.replace(/ /g,"-"))}))),t.draw?(t.output.selected=t.selected,t.output.data=t.smartSlice(a),t.output.smallView.data=t.smartSlice(a,t.options.smallChartSize),t.draw()):t.update(t.smartSlice(a))},t.smartSlice=function(e,a){var n=a||t.options.limit;return n&&n<e.length?e.slice(0,n):e},t.handleBubbleClick=function(e){var a=e;t.selected.includes(a)?t.selected.splice(t.selected.indexOf(a),1):t.selected.push(a)},t}return m(t,e),t.prototype.transform=function(e){var t=this,a=this.options,n=a.config,i=a.smallChartSize,o=n.get("bubble-chart"),r=o.fontRendering,s=o.transition,c=o.shuffle,l=[],u=[],d=n.get("config-keys");Object.keys(d).forEach((function(e){l.push(e.replace(/-/g," ")),u.push(((d[e]||{}).color||{}).hex)}));var p={containerId:"bubbleChartContainer",setDraw:function(e){t.draw=e},colorMatch:{domain:l,range:u},selected:this.selected,sizeRange:[.5,500],fontRendering:r,height:500,width:500,transition:s,shuffle:c};return b(b({},p),{anchorData:{href:"/placeholder/"},data:this.smartSlice(e),smallView:b(b({},p),{data:this.smartSlice(e,i)})})},t}(l.DataSource),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){var t=e.bubbles,a=e.selected,n=this.options,i=n.basePath,o=n.selectable;return t.map((function(e){var t=e.count,n=e.entity,r=n.id,s=n.label,c=n.relation,l=n.relationName;return{id:r,selectable:o,title:s,text:"È collegato a "+t+" oggetti culturali",isSelected:a.includes(r),anchorData:{href:""+i+r+"/"+$.slugify(s)},relation:{key:l,value:c}}}))},t}(l.DataSource),Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentInputValue="",t}return m(t,e),t.prototype.transform=function(e){var t=e.title,a=e.text,n=e.button,i=e.backgroundImage,o=e.input;return{title:t,text:a,backgroundImage:i,button:{text:n.text,anchor:{payload:"cerca"}},input:{placeholder:o.placeholder,payload:"cerca-in-maxxi"}}},t}(l.DataSource),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(){return i.TABLE_MOCK},t}(l.DataSource),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),Fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.autoComplete={},t.lockedFacets={},t.lastData={},t.closedEyes=[],t.openTippy="",t.tippyMaker=function(e){var a,n=e.replace(/ /g,"-");if(!t.autoComplete[n]){t.autoComplete[n]={tippy:void 0,open:!0};var i=t.autoComplete[n];if(!i.tippy){var o=document.getElementsByClassName(n)[1];i.tippy=g(o,{content:(a=document.getElementsByClassName("aw-simple-autocomplete__template")[0],a.setAttribute("style","display: block"),a),trigger:"manual",interactive:!0,arrow:!1,flip:!1,appendTo:"parent",theme:"light-border aw-home__facet-tippy",placement:"bottom-start",maxWidth:"100%"})}}var r=t.autoComplete[n];r.tippy&&r.tippy.show()},t.tippyClose=function(e){var a=e.replace(/ /g,"-");if(t.autoComplete[a]){var n=t.autoComplete[a];n.tippy&&n.tippy.hide()}},t}return m(t,e),t.prototype.transform=function(e){var t=this;this.lastData=e;var a=[],n=[],i=e,o=this.lockedFacets,r=this.closedEyes;return Object.keys(this.autoComplete).forEach((function(e){t.autoComplete[e]&&t.autoComplete[e].tippy&&t.autoComplete[e].tippy.destroy()})),this.autoComplete={},i.forEach((function(e,t){if(Object.keys(o).forEach((function(e){var t=o[e].indexOf("LOCK_LAST");t>=0&&o[e].splice(t,1)})),r){if(r.length===i.length-1){var s=i.find((function(e){return!r.includes(e.type.replace(/ /g,"-"))}));s&&(r[s.type]?o[s.type].push("LOCK_LAST"):o[s.type]=["LOCK_LAST"])}r.includes(e.type.replace(/ /g,"-"))?e.enabled=!1:e.enabled=!0}Object.keys(o).length&&o[e.type]&&o[e.type].length>0?e.locked=!0:e.locked=!1;var c=[],l=[e.icon];e.enabled||c.push("is-disabled"),e["class-name"]&&(c.push("color-"+e["class-name"]),l.push("color-"+e["class-name"])),a.push({iconLeft:l.join(" "),text:e.label,additionalText:e.count,iconRight:e.enabled?"n7-icon-eye":"n7-icon-eye-slash",classes:c.join(" ")+(e.locked?" is-blocked":" not-blocked"),payload:!0===e.locked?null:e.type.replace(/ /g,"-")}),n.push({sections:[{inputs:[{id:e.type.replace(/ /g,"-")+"-"+t,type:"text",placeholder:e["input-placeholder"],icon:"n7-icon-search",disabled:!e.enabled,inputPayload:String(e.type.replace(/ /g,"-"))+"-search",iconPayload:String(e.type.replace(/ /g,"-"))+"-search",enterPayload:String(e.type.replace(/ /g,"-"))+"-search",classes:String(e.type.replace(" ","-"))+"-search"}]}]})})),a.map((function(e,t){return{header:e,input:n[t]}}))},t}(l.DataSource),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){var t=e.response,a=e.query,n=t.results,i=t.totalCount,o=this.options,r=o.keys,s=o.config,c=o.paths,l=this.options.labels||{},u=[],d={};n.forEach((function(e){var t=e.item,a=e.entity,n=a?a.typeOfEntity:t.document_type,i=r[n],o=i["main-metadata"],s=t||a;if(!d[n]){var p=i.label,h=i.icon;d[n]={title:p,icon:h,classes:"color-"+i["class-name"],items:[],type:n}}if(-1===u.indexOf(s.id)){var f=[];s.fields&&s.fields.forEach((function(e){var t=e.key,a=e.value;o&&t===o&&f.push({key:$.prettifySnakeCase(t,l[t]),value:a})})),d[n].items.push({title:s.label,metadata:f,anchor:{href:c[a?"entitaBasePath":"schedaBasePath"]+"/"+s.id+"/"+$.slugify(s.label)}})}}));var p=Object.keys(d).map((function(e){return{group:{title:d[e].title,icon:d[e].icon,classes:d[e].classes},items:d[e].items}}));return{results:p,actions:p.length>0?{showMore:{text:"Visualizza tutti i "+i+" risultati",anchor:{href:c.searchBasePath,queryParams:{query:a}}}}:{showMore:{text:"Cerca in tutti i campi",anchor:{href:c.searchBasePath,queryParams:{query:a,"query-all":1}}}},fallback:((s.get("home-layout")||{})["top-hero"]||{}).fallback}},t}(l.DataSource),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){if(!e)return null;var t=e.data,a=e.selected,n={items:[],payload:"entita-nav"},i=this.options.hasMetadataFields;return n.items.push({text:"OVERVIEW",anchor:{href:e.basePath+"/overview"},classes:"overview"===a?"is-selected":""}),i&&n.items.push({text:"CAMPI",anchor:{href:e.basePath+"/campi"},classes:"campi"===a?"is-selected":""}),t.relatedItems&&n.items.push({text:"OGGETTI COLLEGATI",anchor:{href:e.basePath+"/oggetti-collegati",queryParams:{page:1}},classes:"oggetti-collegati"===a?"is-selected":""}),t.relatedEntities&&this.options.bubblesEnabled&&n.items.push({text:"ENTITÀ COLLEGATE",anchor:{href:e.basePath+"/entita-collegate"},classes:"entita-collegate"===a?"is-selected":""}),t.extraTab&&n.items.push({text:"MAXXI",anchor:{href:e.basePath+"/maxxi"},classes:"maxxi"===a?"is-selected":""}),t.wikiTab&&n.items.push({text:"WIKIPEDIA",anchor:{href:e.basePath+"/wiki"},classes:"wiki"===a?"is-selected":""}),2===n.items.length&&n.items.shift(),n},t}(l.DataSource),$e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasFields=!1,t}return m(t,e),t.prototype.transform=function(e){return this.hasFields=!(!Array.isArray(e)||!e.length),{group:[{items:e||[]}]}},t}(l.DataSource),ze=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.transform=function(e){return e},a._getCachedData=function(){return t.dataCache[a.rootId]},a._normalize=function(e){var t=e.id,n=e.label,i=e.icon,o=e.img,r=e.branches,s=e.document_type,c=e.document_classification,l=!(!Array.isArray(r)||!r.length);a._getCachedData().flatData[t]={id:t,label:n,icon:i,img:o,hasBranches:l,type:s,classification:c},l&&r.forEach((function(e){a._getCachedData().flatIds.push([t,e.id]),a._normalize(e)}))},a._getParent=function(e){return a._getCachedData().flatIds.filter((function(t){return k(t,2)[1]===e})).map((function(e){return k(e,1)[0]}))[0]||null},a._getTreePath=function(e){for(var t=[e],n=e;n;){var i=a._getParent(n);i&&t.push(i),n=i}return t.reverse()},a._getTree=function(e){var t={},n=0,i=function(t,o){var r=e[n+=1];o.items=[],a._getCachedData().flatIds.filter((function(e){return k(e,1)[0]===t})).forEach((function(e,t){var n=k(e,2)[1],s=n===r,c=a._getTreeItem(n,s);o.items.push(c),s&&i(n,o.items[t])}))};return i(e[0],t),t},a._getTreeItem=function(e,t){var n=a._getCachedData().flatData[e],i=n.label,o=n.img,r=n.hasBranches,s=n.type,c=n.classification,l=(a.options.config[s]||{icon:null}).icon,u="",d=/.*\.(\w+)$/;if(c&&d.test(c)){var p=c.match(d)[1].toUpperCase();u=a.options.config[s].classifications[p].icon}var h=t?"n7-icon-angle-down":"n7-icon-angle-right",f=[];return t&&f.push("is-expanded"),a.activeId===e&&f.push("is-active"),{classes:f.join(" "),text:i||null,img:o||null,icon:u||l,toggle:r?{icon:h,payload:{source:"toggle",id:e}}:null,meta:e,anchor:{href:a.basePath+"/"+e+"/"+$.slugify(i)}}},a}return m(t,e),t.prototype.load=function(e){var a=e.tree,n=e.basePath;this.rootId=a.id,this.basePath=n,t.dataCache[this.rootId]||(t.dataCache[this.rootId]={flatIds:[],flatData:{}},this._normalize(a))},t.prototype.build=function(e){var t=this._getTreePath(e),a=this._getTreePath(this.currentId).indexOf(e);if(a>0)t.splice(a),this.currentId=null;else if(this.currentId===e){var n=t.indexOf(this.currentId);t.splice(n),this.currentId=null}else this.currentId=e;var i=this._getTree(t);this.update(i)},t.prototype.setActive=function(e){this.activeId=e},t.prototype.highlightActive=function(){var e=this,t=function(a){a.forEach((function(a){var n,i=a.meta===e.activeId;-1===a.classes.indexOf("is-active")||i||((n=a.classes.split(" ")).splice(n.indexOf("is-active"),1),a.classes=n.join(" "));i&&(-1===(n=a.classes.split(" ")).indexOf("is-active")&&n.push("is-active"),a.classes=n.join(" "));Array.isArray(a.items)&&a.items.length&&t(a.items)}))};t(this.output.items)},t.dataCache={},t}(f.DataSource),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return{iconLeft:"n7-icon-tree-icon",text:e.text||"",iconRight:"n7-icon-angle-left",classes:"is-expanded",payload:"header"}},t.prototype.toggleSidebar=function(){var e=this.output;"is-expanded"===e.classes?(e.classes="is-collapsed",e.iconRight="n7-icon-angle-right"):(e.classes="is-expanded",e.iconRight="n7-icon-angle-left")},t}(l.DataSource),je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transform=function(e){return e},t}return m(t,e),t.prototype.toggleSidebar=function(){var e=this.output;"is-expanded"===e.classes?e.classes="is-collapsed":e.classes="is-expanded",this.update(e)},t}(l.DataSource),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return{group:[{items:e||[]}]}},t}(l.DataSource),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){var t=this;return{images:[],viewerId:"scheda-layout-viewer",libOptions:{tileSources:this.getTileSources(e.images),sequenceMode:!0,showReferenceStrip:!0,autoHideControls:!1,showNavigator:!1},_setViewer:function(e){t.instance=e}}},t.prototype.hasInstance=function(){return!!this.instance},t.prototype.updateImages=function(e){var t=this;this.instance&&(this.instance.world.removeAll(),setTimeout((function(){var a=t.getTileSources(e.images);console.warn("images",a.length,a),t.instance.open(a)})))},t.prototype.getTileSources=function(e){return e.map((function(e){return e.replace("FIF","Deepzoom").replace(".tif",".tif.dzi")}))},t}(l.DataSource),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),Ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selected="list",t}return m(t,e),t.prototype.transform=function(){return{items:[{text:"LISTA",payload:"list",classes:"list"===this.selected?"is-selected":""},{text:"GRAFICO",payload:"chart",classes:"chart"===this.selected?"is-selected":""},{text:"TIMELINE",payload:"timeline",classes:"timeline"===this.selected?"is-selected":""}]}},t.prototype.setSelected=function(e){this.selected=e},t}(l.DataSource),Ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.addPagination=function(e,a,n){t.pagination={first:{payload:"goto-1",classes:1===e?"is-disabled":""},prev:{payload:"goto-"+(e/1-1),classes:1===e?"is-disabled":""},next:{payload:"goto-"+(e/1+1),classes:e===a?"is-disabled":""},last:{payload:"goto-"+a,classes:e===a?"is-disabled":""},links:t.makePagination(a,e),select:{label:"Numero di risultati",options:[12,24,48].map((function(e){return{text:e,selected:e===n}})),payload:"select-size"}}},t.makePagination=function(e,t){var a=[],n=4;if(e<=n&&(n=e-1),n){var i=void 0,o=void 0;t>Math.floor(n/2)?2===e?(i=e,o=1):t<e-Math.floor(n/2)?(i=t/1+Math.floor(n/2),o=t/1-Math.floor(n/2)):(i=e,o=t-n+(e-t)):(i=n+1,o=1);for(var r=o;r<=i;r++)a.push({text:String(r),payload:"page-"+String(r),classes:t===r?"is-active":""})}else{a.push({text:"1",payload:"page-1",classes:1===t?"is-active":""});for(r=1;r<e;r++)a.push({text:String(r+1),payload:"page-"+String(r+1),classes:t===r+1?"is-active":""})}return a},t}return m(t,e),t.prototype.transform=function(e){if(!e)return null;var t=this.options,a=t.pageSize,n=t.currentPage;return e.length>a&&this.addPagination(n,Math.ceil(e.length/a),a),{res:e.slice(0,a),pagination:this.pagination}},t.prototype.chunks=function(e,t){for(var a=[];e.length;)a.push(e.splice(0,t));return a},t}(l.DataSource),We=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transform=function(e){return i.MAP_MOCK},t}return m(t,e),t}(l.DataSource),Ue=Object.freeze({__proto__:null,AwLinkedObjectsDS:Ee,AwAutocompleteWrapperDS:xe,AwBubbleChartDS:Pe,AwChartTippyDS:De,AwHeroDS:Te,AwTableDS:Ae,AwHomeHeroPatrimonioDS:Oe,AwHomeFacetsWrapperDS:Fe,AwHomeItemTagsWrapperDS:Le,AwHomeAutocompleteDS:Re,AwEntitaNavDS:Me,AwEntitaMetadataViewerDS:$e,AwTreeDS:ze,AwSidebarHeaderDS:He,AwSchedaBreadcrumbsDS:je,AwSchedaMetadataDS:qe,AwSchedaImageDS:Be,AwSchedaInnerTitleDS:Ge,AwSearchLayoutTabsDS:Ve,AwGalleryResultsDS:Ne,AwMapDS:We}),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-hero.click":"cerca"===n&&e.dataSource.currentInputValue&&e.emitOuter("enter",e.dataSource.currentInputValue);break;case"aw-hero.change":e.dataSource.currentInputValue=n,e.emitOuter("change",n);break;case"aw-hero.enter":e.emitOuter("enter",n);break;default:console.warn("(hero) unhandled event of type",a)}}))},t}(l.EventHandler),Qe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.changedInput$=new o.Subject,t.handleEyeClick=function(e){if(t.dataSource.closedEyes){var a=t.dataSource.closedEyes.indexOf(e);a>=0?t.dataSource.closedEyes.splice(a,1):t.dataSource.closedEyes.push(e)}else t.dataSource.closedEyes=[e];t.dataSource.update(t.dataSource.lastData)},t.updateFilters=function(e){e.entity.id.replace(/ /g,"-");var a=e.entity,n=a.id,i=a.typeOfEntity;if(t.dataSource.lockedFacets[i]||(t.dataSource.lockedFacets[i]=[]),t.dataSource.lockedFacets[i].includes(n)){var o=t.dataSource.lockedFacets[i].indexOf(n);t.dataSource.lockedFacets[i].splice(o,1)}else t.dataSource.lockedFacets[i].push(n);t.dataSource.update(t.dataSource.lastData)},t}return m(t,e),t.prototype.listen=function(){var e=this;this.changedInput$.pipe(r.debounceTime(500)).subscribe((function(t){e.emitOuter("change",t)})),this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-facets-wrapper.click":if(null===n)break;e.emitOuter("click",n),e.handleEyeClick(n);break;case"aw-home-facets-wrapper.change":e.dataSource.openTippy=n.inputPayload.replace("-search",""),e.changedInput$.next(n);break;case"aw-home-facets-wrapper.enter":e.emitOuter("enter",n);break;default:console.warn("unhandled inner event of type:",a)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.facetswrapperrequest":e.dataSource.tippyMaker(n.facetId.inputPayload);break;case"aw-home-layout.facetswrapperclose":e.dataSource.tippyClose(n.facetId.inputPayload);break;case"aw-home-layout.facetswrapperresponse":break;case"aw-home-layout.lockfilter":e.updateFilters(n);break;case"aw-home-layout.tagclick":Object.keys(e.dataSource.lockedFacets).forEach((function(t){e.dataSource.lockedFacets[t].includes(n)&&e.dataSource.lockedFacets[t].splice(e.dataSource.lockedFacets[t].indexOf(n),1)})),e.dataSource.update(e.dataSource.lastData);break;case"aw-home-layout.clearselection":e.dataSource.lockedFacets={},e.dataSource.closedEyes=[],e.dataSource.update(e.dataSource.lastData);break;case"aw-home-layout.facetclick":var i=e.dataSource.openTippy;e.dataSource.lockedFacets[i]?-1===e.dataSource.lockedFacets[i].indexOf(n)&&e.dataSource.lockedFacets[i].push(n):e.dataSource.lockedFacets[i]=[n],e.dataSource.update(e.dataSource.lastData)}}))},t}(l.EventHandler),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){switch(t.type){case"aw-home-item-tags-wrapper.click":e.emitOuter("click",t.payload)}}))},t}(l.EventHandler),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-autocomplete.click":e.emitOuter("click",n)}}))},t}(l.EventHandler),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-entita-nav.click":e.emitOuter("click",n);break;default:console.warn("unhandled event type")}}))},t}(l.EventHandler),et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;"aw-sidebar-header.click"===a&&(e.dataSource.toggleSidebar(),e.emitOuter(a,n))}))},t}(l.EventHandler),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;"aw-sidebar-header.click"===a&&(e.dataSource.toggleSidebar(),e.emitOuter("click",n))}))},t}(l.EventHandler),at=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetOffset=new o.ReplaySubject,t.targetIsOpen=!1,t.scrollOpenedIntoView=function(){t.dataSource.out$.pipe(r.filter((function(e){return!!e})),r.first(),r.withLatestFrom(t.targetOffset)).subscribe((function(e){var t=k(e,2)[1];setTimeout((function(){var e=document.querySelector(".aw-scheda__tree-content"),a=document.getElementsByClassName("n7-tree__item is-expanded"),n=a.length?a[a.length-1]:null;if(n){var i=document.querySelector(".n7-tree"),o=e.getBoundingClientRect(),r=t-o.top;i.style.marginBottom="1000px",n.scrollIntoView(),e.scrollTop-=r,window.scrollTo(0,0),i.style.marginBottom="0px"}}),200)}))},t.scrollLeafIntoView=function(){var e=document.querySelector("div.aw-scheda__tree");setTimeout((function(){var a=e.querySelector(".is-active");a&&!t.isInViewport(a)&&(a.scrollIntoView(),window.scrollTo(0,0))}),200)},t.isInViewport=function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-tree.click":"toggle"===n.source&&setTimeout((function(){e.dataSource.build(n.id),e.targetIsOpen&&e.scrollOpenedIntoView()}))}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-sidebar-header.click":e.dataSource.toggleSidebar();break;case"aw-scheda-layout.selectItem":e.dataSource.build(n);break;case"aw-scheda-layout.navigationresponse":n.currentItem&&e.dataSource.setActive(n.currentItem);var i=n.currentItem||n.tree.id;e.dataSource.load(n),e.dataSource.build(i);break;case"aw-scheda-layout.routechanged":e.dataSource.output&&(e.dataSource.build(n),e.dataSource.setActive(n),e.dataSource.highlightActive(),e.scrollLeafIntoView());break;case"aw-scheda-layout.viewleaf":e.dataSource.out$.pipe(r.filter((function(e){return!!e})),r.first()).subscribe((function(){e.scrollLeafIntoView()}));break;case"aw-scheda-layout.treeposition":var o=n.target,s=o.getBoundingClientRect();e.targetIsOpen=-1!==o.className.indexOf("n7-icon-angle-right"),e.targetOffset.next(s.top)}}))},t}(l.EventHandler),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-gallery-results.change":e.emitOuter("change",+n.value);break;case"aw-gallery-results.click":if("string"==typeof n){if(n.startsWith("page"))e.emitOuter("pagination",n);else if(n.startsWith("goto")){var i=+n.replace("goto-","");if(i>e.dataSource.totalPages)return;if(i<1||i===e.dataSource.currentPage)return;e.emitOuter("goto",n)}}else e.emitOuter("click",n);break;default:console.warn("(gallery-results) unhandled inner event of type",a)}}))},t}(l.EventHandler),ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleScroll=function(e){var a=t.dataSource,n=a.totalObjects,i=a.loadedData;(Array.isArray(i.result)?i.result.length:0)>=n||e.scrollTop+e.clientHeight>=e.scrollHeight-150&&!1===t.dataSource.loadedData.isLoading&&(t.dataSource.loadedData.isLoading=!0,t.emitOuter("datarequest",{currentPage:t.dataSource.currentPage}))},t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-linked-objects.change":e.emitOuter("change",+n.value);break;default:console.warn("unhandled event type: ",a," with payload: ",n)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.viewmore":e.dataSource.checkForMore(!1),e.emitOuter("datarequest",{currentPage:e.dataSource.currentPage});break;case"aw-home-layout.dataresponse":var i=n.res;e.dataSource.handleIncomingData(i);break;case"aw-home-layout.scroll":e.handleScroll(n)}}))},t}(l.EventHandler),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-autocomplete-wrapper.click":"fallback-simple-autocomplete"!==n&&e.emitOuter("clickresult",n);break;default:console.warn("unhandled event of type:",a)}}))},t}(l.EventHandler),st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.initialLoad=!1,t.toggleSelection=function(e){t.dataSource.handleBubbleClick(e),t.emitOuter("selection",t.dataSource.selected)},t.toggleFilter=function(e){t.dataSource.filters.includes(e)?t.dataSource.filters.splice(t.dataSource.filters.indexOf(e),1):t.dataSource.filters.push(e),t.dataSource.updateChart(null)},t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-bubble-chart.click":!1!==e.dataSource.options.selectable&&e.toggleSelection(n),e.emitOuter("lockfilter",e.dataSource.chartData.find((function(e){return n===e.entity.id})));break;case"aw-bubble-chart.d3end":var i=void 0;i=e.dataSource.filters.length>0?e.dataSource.chartData.filter((function(t){return!e.dataSource.filters.includes(t.entity.typeOfEntity.replace(/ /g,"-"))})):e.dataSource.chartData,e.emitOuter("d3end",{bubbles:e.dataSource.smartSlice(i),selected:e.dataSource.selected});break;default:console.warn("unhandled inner event of type",a,"with payload",n)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.select":var i=n.id;e.toggleSelection(i);var o=e.dataSource.chartData.find((function(e){return i===e.entity.id}));o?e.emitOuter("lockfilter",o):console.warn("Unable to determine which bubble was selected.");break;case"aw-home-layout.tagclick":e.toggleSelection(n);break;case"aw-home-layout.facetclick":e.dataSource.selected.includes(n)||e.toggleSelection(n);break;case"aw-home-layout.togglefilter":e.toggleFilter(n);break;case"aw-home-layout.clearselection":e.dataSource.selected=[],e.emitOuter("selection",[]);break;case"aw-scheda-layout.filterbubbleresponse":case"aw-entita-layout.filterbubbleresponse":case"aw-home-layout.filterbubbleresponse":e.dataSource.updateChart(n)}}))},t}(l.EventHandler),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),lt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tippyList=[],t.tippyMaker=function(e){t.tippyList.forEach((function(e){e&&e.destroy()})),t.tippyList=[],e.forEach((function(e){var a=document.getElementById("g_"+e.entity.id);a&&t.tippyList.push(g(a,{content:document.getElementById("template__"+e.entity.id),interactive:!0,appendTo:document.body,arrow:!0,flip:!1,theme:"light-border no-padding",placement:"top",delay:[150,30],updateDuration:400}))}))},t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-chart-tippy.select":e.emitOuter("select",n);break;default:console.warn("(chart-tippy) unhandled inner event of type",a)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.d3end":case"aw-entita-layout.d3end":case"aw-scheda-layout.d3end":e.dataSource.update(n),setTimeout((function(){e.tippyMaker(n.bubbles)}))}}))},t}(l.EventHandler),ut=Object.freeze({__proto__:null,AwHeroEH:Ke,AwHomeFacetsWrapperEH:Qe,AwHomeHeroPatrimonioEH:Ye,AwHomeItemTagsWrapperEH:Xe,AwHomeAutocompleteEH:Je,AwEntitaNavEH:Ze,AwSchedaSidebarEH:et,AwSidebarHeaderEH:tt,AwTreeEH:at,AwSearchLayoutTabsEH:nt,AwGalleryResultsEH:it,AwLinkedObjectsEH:ot,AwAutocompleteWrapperEH:rt,AwBubbleChartEH:st,AwTableEH:ct,AwChartTippyEH:lt}),dt={layoutId:"aw-entita-layout",widgets:[{id:"aw-entita-nav",hasStaticData:!0},{id:"aw-entita-metadata-viewer"},{id:"aw-linked-objects"},{id:"aw-bubble-chart"},{id:"aw-chart-tippy"},{id:"n7-smart-pagination",dataSource:Z,eventHandler:re}],layoutDS:Ie,layoutEH:Ce,widgetsDataSources:Ue,widgetsEventHandlers:ut,options:{}},pt=function(e){function n(t,a,n,i,o,r,s,c){var l=e.call(this,o.get("AwEntitaLayoutConfig")||dt)||this;return l.router=t,l.route=a,l.location=n,l.configuration=i,l.layoutsConfiguration=o,l.communication=r,l.mainState=s,l.titleService=c,l}return m(n,e),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,location:this.location,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:a.Location},{type:C},{type:E},{type:T},{type:x},{type:c.Title}]},n=v([t.Component({selector:"aw-entita-layout",template:'<div class="aw-entity n7-side-auto-padding" *ngIf="lb.dataSource">\n\n    <div class="aw-entity__sidebar">\n        \x3c!-- Custom header --\x3e\n        <div *ngIf="!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__sidebar-title-wrapper-loading">\n            <n7-content-placeholder [data]="{\n                blocks: [{\n                    classes: \'entity-placeholder-title\'\n                }]\n            }">\n            </n7-content-placeholder>\n        </div>\n        <div *ngIf="!!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)"\n            class="aw-entity__sidebar-title-wrapper color-{{lb.dataSource.navHeader.color}}">\n            <h1 class="aw-entity__sidebar-title">\n                <span class="aw-entity__sidebar-title-icon {{lb.dataSource.navHeader.icon}}"></span>\n                <span class="aw-entity__sidebar-title-text">{{lb.dataSource.navHeader.text}}</span>\n            </h1>\n        </div>\n        \x3c!-- Navigation --\x3e\n        <div *ngIf="!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__sidebar-nav-loading">\n            <n7-content-placeholder *ngFor="let n of [0,1,2]"\n            [data]="{\n                blocks: [{\n                    classes: \'entity-placeholder-nav\'\n                }]\n            }">\n            </n7-content-placeholder>\n        </div>\n        <n7-nav [data]="lb.widgets[\'aw-entita-nav\'].ds.out$ | async" [emit]="lb.widgets[\'aw-entita-nav\'].emit">\n        </n7-nav>\n    </div>\n\n    \x3c!-- lb.dataSource.selectedTab --\x3e\n    <div *ngIf="!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__content-loading">\n        <div class="aw-entity__content-loading-title">\n            <n7-content-placeholder [data]="{\n                blocks: [{\n                    classes: \'entity-placeholder-title\'\n                }]\n            }"></n7-content-placeholder>\n        </div>\n\n        <div class="aw-entity__content-loading-items">\n            <n7-content-placeholder *ngFor="let n of [0,1,2,3]"\n            [data]="{\n                blocks: [\n                {\n                    classes: \'entity-placeholder-item-preview\'\n                }\n                ]\n            }"></n7-content-placeholder>\n        </div>\n    </div>\n\n    <div *ngIf="!!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__content">\n        <section>\n            <div *ngIf="lb.dataSource.myResponse.wikiTab || lb.dataSource.myResponse.extraTab"\n                class="aw-entity__content-section" [hidden]="lb.dataSource.selectedTab != \'overview\'">\n                <div class="aw-entity__overview-description">\n                    {{lb.dataSource.myResponse.extraTab}}\n                </div>\n                <div class="aw-entity-layout__button-wrapper">\n                    <a *ngIf="lb.dataSource.myResponse.wikiTab" class="n7-btn n7-btn-light"\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/wiki\']">\n                        DESCRIZIONE WIKIPEDIA <i class="n7-icon-angle-right"></i>\n                    </a>\n                    <a *ngIf="lb.dataSource.myResponse.extraTab" class="n7-btn n7-btn-light"\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/maxxi\']">\n                        DESCRIZIONE MAXXI <i class="n7-icon-angle-right"></i>\n                    </a>\n                </div>\n            </div>\n\n            <ng-container \n                *ngIf="(\n                    lb.widgets[\'aw-entita-metadata-viewer\'].ds.hasFields && \n                    [\'overview\', \'campi\'].indexOf(lb.dataSource.selectedTab) !== -1\n                )">\n                <div class="aw-entity__content-section aw-entity__content-section-overview">\n                    <div class="aw-entity__content-section-header">\n                        <h2 class="aw-entity__content-section-title">Campi</h2>\n                        <a \n                        *ngIf="lb.dataSource.selectedTab !== \'campi\'"\n                        class="n7-btn n7-btn-light" \n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/campi\']">\n                            TUTTI I CAMPI <i class="n7-icon-angle-right"></i>\n                        </a>\n                    </div>\n                    <n7-metadata-viewer class="aw-entity-layout__metadata-viewer"\n                        [data]="lb.widgets[\'aw-entita-metadata-viewer\'].ds.out$ | async ">\n                    </n7-metadata-viewer>\n                </div>\n            </ng-container>\n\n            <div class="aw-entity__content-section aw-entity__content-section-overview"\n                *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews && lb.dataSource.myResponse.relatedItems"\n                [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'oggetti-collegati\'">\n                <div class="aw-entity__content-section-header">\n                    <h2 class="aw-entity__content-section-title">Oggetti collegati</h2>\n\n                    <a *ngIf="lb.dataSource.selectedTab === \'overview\' "\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/oggetti-collegati/\']"\n                        [queryParams]="{ page: 1 }" class="n7-btn n7-btn-light">\n                        TUTTI GLI OGGETTI COLLEGATI <i class="n7-icon-angle-right"></i>\n                    </a>\n                </div>\n                <div class="aw-entity__content-item-previews">\n                    <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <div class="aw-entity__content-item-preview-wrapper">\n                            <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                            </n7-smart-breadcrumbs>\n                            <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                            </n7-item-preview>\n                            \x3c!-- relation --\x3e\n                            <div class="aw-entity__relation" *ngIf="preview.relation.value">\n                                <p class="aw-entity__relation-description">Relazione con \n                                <span class="aw-entity__relation-key">{{preview.relation.key}}</span>:\n                                <span class="aw-entity__relation-value"> {{preview.relation.value}}</span>\n                                </p>\n                            </div>\n                        </div>\n                    </ng-container>\n                </div>\n                <n7-smart-pagination \n                    *ngIf="lb.dataSource.selectedTab === \'oggetti-collegati\'"\n                    [data]="lb.widgets[\'n7-smart-pagination\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'n7-smart-pagination\'].emit">\n                </n7-smart-pagination>\n            </div>\n\n            <div class="aw-entity__content-section aw-entity__content-section-overview aw-bubble-chart__{{lb.dataSource.selectedTab}}"\n                *ngIf="lb.dataSource.bubblesEnabled && lb.dataSource.myResponse.relatedEntities"\n                [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'entita-collegate\'">\n                <div class="aw-entity__content-section-header">\n                    <h2 class="aw-entity__content-section-title">Entità collegate</h2>\n                    <a *ngIf="lb.dataSource.selectedTab == \'overview\'" class="n7-btn n7-btn-light"\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/entita-collegate\']">\n                        TUTTE LE ENTITÀ COLLEGATE <i class="n7-icon-angle-right"></i>\n                    </a>\n                </div>\n                \x3c!-- Small Bubble Chart --\x3e\n                <div class="aw-entity__bubble-chart-wrapper-small" *ngIf="lb.dataSource.selectedTab == \'overview\'">\n                    <aw-bubble-chart-wrapper>\n                        \x3c!-- Tippy template moved to end of HTML --\x3e\n                        <n7-bubble-chart [data]="(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)?.smallView"\n                            [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                        </n7-bubble-chart>\n                    </aw-bubble-chart-wrapper>\n                </div>\n                \x3c!-- Big Bubble Chart --\x3e\n                <div class="aw-entity__bubble-chart-wrapper" *ngIf="lb.dataSource.selectedTab == \'entita-collegate\'">\n                    <aw-bubble-chart-wrapper>\n                        \x3c!-- Tippy template moved to end of HTML --\x3e\n                        <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                            [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                        </n7-bubble-chart>\n                    </aw-bubble-chart-wrapper>\n                </div>\n            </div>\n            <div class="aw-entity__content-section aw-entity__content-section-maxxi"\n                *ngIf="lb.dataSource.myResponse.extraTab" [hidden]="lb.dataSource.selectedTab != \'maxxi\'">\n                <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n                    <h2 class="aw-entity__content-section-title">Descrizione Maxxi</h2>\n                </div>\n                <div>\n                    {{lb.dataSource.myResponse.extraTab}}\n                </div>\n            </div>\n            <div class="aw-entity__content-section aw-entity__content-section-wiki"\n                *ngIf="lb.dataSource.myResponse.wikiTab" [hidden]="lb.dataSource.selectedTab != \'wiki\'">\n                <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n                    <h2 class="aw-entity__content-section-title">Descrizione Wikipedia</h2>\n                </div>\n                <div>\n                    {{lb.dataSource.myResponse.wikiTab.text}}\n                </div>\n                <a href="{{lb.dataSource.myResponse.wikiTabUrl}}">\n                    {{ lb.dataSource.myResponse.wikiTab.url }}\n                </a>\n            </div>\n        </section>\n    </div>\n    \x3c!-- Template for bubble chart tooltips --\x3e\n    <aw-chart-tippy [data]="lb.widgets[\'aw-chart-tippy\'].ds.out$ | async" [emit]="lb.widgets[\'aw-chart-tippy\'].emit">\n    </aw-chart-tippy>\n</div>\n'}),w("design:paramtypes",[s.Router,s.ActivatedRoute,a.Location,C,E,T,x,c.Title])],n)}(A),ht={totalCount:0,facets:[{id:"query",type:"value"},{id:"query-all",type:"value",hasStaticData:!0,data:[{value:"1",label:"Cerca in tutti campi delle schede"}]},{id:"entity-types",type:"value",operator:"OR",limit:10,order:"count"},{id:"entity-search",type:"value"},{id:"entity-links",type:"value",searchData:["entity-type"]}],fields:[{inputs:[{type:"text",facetId:"query",placeholder:"Cerca nei titoli delle schede",filterConfig:{delay:500,minChars:3,searchIn:[{key:"label.ngrams",operator:"LIKE"}]}},{type:"checkbox",facetId:"query-all",filterConfig:{searchIn:[{key:"label.ngrams^5,text^4,fields.*^3",operator:"="}]}}]},{header:{label:"Relazione con",classes:"related-class"},inputs:[{type:"checkbox",facetId:"entity-types",filterConfig:{isArray:!0,context:"internal",target:"entity-links",searchIn:[{key:"searchData.entity-type",operator:"="}]}},{type:"text",facetId:"entity-search",placeholder:"Cerca entità",filterConfig:{delay:500,minChars:3,context:"internal",target:"entity-links",searchIn:[{key:"label",operator:"LIKE"}]}},{type:"link",facetId:"entity-links",emptyState:{label:"La tua ricerca non ha dato risultati, prova a cambiare i filtri"},filterConfig:{isArray:!0,limit:20,searchIn:[{key:"relatedEntities.id",operator:"="}]}}]}],results:{order:{type:"score",key:"_score",direction:"DESC"},fields:[{id:"description",highlight:!0,limit:200}]},page:{offset:0,limit:12}},ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t.resetButtonEnabled=!0,t.currentPage=1,t.pageSize=12,t.sidebarIsSticky=!1,t.isFirstLoading=!0,t.resultsLoading=!1,t.isSearchingText=new o.BehaviorSubject(!1),t.orderBy="label_sort",t.orderDirection="ASC",t.orderByLabel="Ordina per",t.orderByOptions=[{value:"_score_DESC",label:"Ordine per pertinenza",type:"score",selected:!1},{value:"label_sort_ASC",label:"Ordine alfabetico (A→Z)",type:"text",selected:!0},{value:"label_sort_DESC",label:"Ordine alfabetico (Z→A)",type:"text",selected:!1}],t.drawPagination=function(){var e=t._getPaginationParams(),a=e.href,n=e.queryParams;t.one("n7-smart-pagination").updateOptions({mode:"href",href:a,queryParams:n}),t.one("n7-smart-pagination").update({totalPages:Math.ceil(t.totalCount/t.pageSize),currentPage:t.currentPage,pageLimit:5,sizes:{list:[12,24,48],active:t.pageSize}})},t.getSearchModelId=function(){return"aw-gallery-layout"},t}return m(t,e),t.prototype.onInit=function(e){var t=e.configuration,a=e.mainState,n=e.options,i=e.communication,o=e.search;this.configuration=t,this.mainState=a,this.communication=i,this.search=o,this.options=n,this.prettifyLabels=this.configuration.get("labels"),this.configKeys=this.configuration.get("config-keys"),this.fallback=this.configuration.get("gallery-layout").fallback,this.pageTitle=this.configuration.get("gallery-layout").title,this.search.model("aw-gallery-layout")&&this.search.remove("aw-gallery-layout"),this.search.add("aw-gallery-layout",p.cloneDeep(ht)),this.searchModel=this.search.model("aw-gallery-layout"),V.queryParams&&(this.searchModel.updateFiltersFromQueryParams(V.queryParams),V.queryParams=null),this._sidebarStickyControl(),this.mainState.updateCustom("currentNav","galleria"),this.mainState.update("headTitle","Arianna4View - Galleria")},t.prototype.onDestroy=function(){this.destroyed$.next(),V.queryParams=null},t.prototype.onSearchResponse=function(){this.resetButtonEnabled=!0,this.isFirstLoading&&(this.isFirstLoading=!1,this.one("facets-wrapper").update({searchModel:this.searchModel}),this.searchModel.updateInputsFromFilters())},t.prototype.onOrderByChange=function(e){var t=e.substring(0,e.lastIndexOf("_")),a=e.substring(e.lastIndexOf("_")+1),n="";this.orderByOptions.forEach((function(t){t.value===e?(t.selected=!0,n=t.type):t.selected=!1})),this.orderBy=t,this.orderDirection=a,this.searchModel.setSearchConfigOrderBy(t),this.searchModel.setSearchConfigDirection(a),this.searchModel.setSearchConfigType(n)},t.prototype.onPageSizeChange=function(e){return this.pageSize=e,this._updateSearchPage(this.currentPage)},t.prototype.onPaginationChange=function(e){var t=e.replace("page-","");return this._updateSearchPage(t)},t.prototype.onPaginationGoToChange=function(e){var t=e.replace("goto-","");return this._updateSearchPage(t)},t.prototype.resetPagination=function(){this._updateSearchPage(1)},t.prototype.onResultsLimitChange=function(e){this.setLimit(e),this.currentPage=1,this.searchModel.setPageConfigOffset(0)},t.prototype.setLimit=function(e){this.pageSize=e,this.searchModel.setPageConfigLimit(e),this.searchModel.setPageConfigOffset((this.currentPage-1)*this.pageSize)},t.prototype.doSearchRequest$=function(){var e=this,t=this.searchModel.getRequestParams(),a={searchParameters:b({totalCount:100,gallery:!0},t)};return this.communication.request$("search",{onError:function(e){return console.error(e)},params:a}).pipe(r.tap((function(t){var a=t.totalCount,n=t.results,i=t.facets;e.totalCount=a;var o=0;e.totalCount>1?o=2:1===e.totalCount&&(o=1),e.resultsTitle=e.configuration.get("gallery-layout").results[o],e._addFacetsLabels(i),e._addFacetsOptions(i),e.searchModel.updateFacets(i),e.searchModel.updateTotalCount(a),e.one("aw-linked-objects").updateOptions({context:"gallery",config:e.configuration,page:e.currentPage,pagination:!0,paginationParams:e._getPaginationParams(),dynamicPagination:{total:a},size:e.pageSize}),e.drawPagination(),e.one("aw-linked-objects").update({items:e._normalizeItems(n.items)})})))},t.prototype._updateSearchPage=function(e){if(+e===this.currentPage)return o.of(!1);this.currentPage=+e;var t=this.searchModel.getConfig().page.limit,a=(this.currentPage-1)*t;return this.searchModel.setPageConfigOffset(a),o.of(!0)},t.prototype._addFacetsLabels=function(e){var t=this;e.filter((function(e){return Array.isArray(e.data)})).forEach((function(e){e.data.forEach((function(e){var a=e.label;e.label=$.prettifySnakeCase(a,t.prettifyLabels[a])}))}))},t.prototype._addFacetsOptions=function(e){var t=this;e.filter((function(e){return"query-links"===e.id})).forEach((function(e){e.data.forEach((function(e){var a=t.configKeys[e.value];a&&(e.options={icon:a.icon,classes:"color-"+a["class-name"]})}))}))},t.prototype._normalizeItems=function(e){return e.map((function(e){return{item:b({},e)}}))},t.prototype._sidebarStickyControl=function(){var e=this;$.browserIsIE()||o.fromEvent(window,"scroll").pipe(r.takeUntil(this.destroyed$)).subscribe((function(){var t=window.pageYOffset,a=document.getElementsByClassName("sticky-parent")[0],n=a?a.offsetTop:0;e.sidebarIsSticky=n<=t}))},t.prototype._getPaginationParams=function(){var e=this.searchModel.getRequestParams(),t=this.searchModel.filtersAsQueryParams(e.filters);return Object.keys(t).forEach((function(e){t[e]=t[e]||null})),t.orderby=this.orderBy,t.orderdirection=this.orderDirection,t.page=this.currentPage,t.limit=this.pageSize,{queryParams:t,href:this.configuration.get("paths").galleryBasePath}},t}(u.LayoutDataSource),gt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t.facetsChange$=new o.Subject,t.additionalParamsChange$=new o.Subject,t.previousText="",t.textHasChanged=!1,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-gallery-layout.init":e.route=n.route,e.configuration=n.configuration,e.dataSource.onInit(n),e._listenToFacetsChange(),e._listenToAdditionalParamsChange(),e._listenToRouterChanges(),(e.dataSource.searchModel.getFiltersByFacetId("query")[0].value||"").length>0&&(e.dataSource.isSearchingText.next(!0),setTimeout((function(){e.dataSource.onOrderByChange("_score_DESC"),e.additionalParamsChange$.next()}),100));break;case"aw-gallery-layout.destroy":e.dataSource.onDestroy(),e.destroyed$.next();break;case"aw-gallery-layout.orderbychange":e.dataSource.onOrderByChange(n),e.additionalParamsChange$.next();break;case"aw-gallery-layout.searchreset":e.dataSource.resetButtonEnabled=!1,e.dataSource.searchModel.clear(),e.additionalParamsChange$.next();break;default:console.warn("(search) unhandled inner event of type",a)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"facets-wrapper.facetschange":e.dataSource.resetPagination();var i=e.dataSource.searchModel.getFiltersByFacetId("query")[0].value;e.textHasChanged=!(!i||i===e.previousText),e.previousText=i;var o=e.dataSource.orderByOptions.filter((function(e){return e.selected}))[0].value;e.textHasChanged&&(i||"").length>0?e.dataSource.isSearchingText.next(!0):0===(i||"").length&&/score/i.test(o)&&(e.dataSource.isSearchingText.next(!1),setTimeout((function(){e.dataSource.onOrderByChange("label_sort_ASC"),e.additionalParamsChange$.next()}),100));break;case"n7-smart-pagination.change":e.dataSource.onResultsLimitChange(n.value),e.additionalParamsChange$.next()}}))},t.prototype._listenToFacetsChange=function(){var e=this;this.facetsChange$.pipe(r.debounceTime(500)).subscribe((function(){e.dataSource.resultsLoading=!0,e.textHasChanged?(e.additionalParamsChange$.next(),e.textHasChanged=!1):e.dataSource.doSearchRequest$().subscribe((function(){e.dataSource.resultsLoading=!1,e.dataSource.onSearchResponse(),e.emitGlobal("searchresponse",e.dataSource.getSearchModelId())}))}))},t.prototype._listenToAdditionalParamsChange=function(){var e=this;this.additionalParamsChange$.subscribe((function(){var t=e.dataSource.searchModel,a=t.getRequestParams(),n=t.filtersAsQueryParams(a.filters);Object.keys(n).forEach((function(e){n[e]=n[e]||null})),n.orderby=e.dataSource.orderBy,n.orderdirection=e.dataSource.orderDirection,n.page=e.dataSource.currentPage,n.limit=e.dataSource.pageSize,e.textHasChanged&&(n.orderby="_score",n.orderdirection="DESC"),e.emitGlobal("navigate",{handler:"router",path:[],queryParams:n})}))},t.prototype._listenToRouterChanges=function(){var e=this;this.route.queryParams.pipe(r.takeUntil(this.destroyed$)).subscribe((function(t){e.emitOuter("queryparamschange",t),t.orderby&&t.orderdirection&&e.dataSource.onOrderByChange(t.orderby+"_"+t.orderdirection),t.page&&e.dataSource.onPaginationChange("page-"+t.page),t.limit&&e.dataSource.setLimit(+t.limit),e.facetsChange$.next()}))},t}(l.EventHandler),yt={layoutId:"aw-gallery-layout",widgets:[{id:"facets-wrapper",dataSource:X,eventHandler:ie},{id:"aw-linked-objects"},{id:"aw-search-layout-tabs",hasStaticData:!0},{id:"n7-smart-pagination",dataSource:Z,eventHandler:re}],layoutDS:ft,layoutEH:gt,widgetsDataSources:Ue,widgetsEventHandlers:ut,options:{}},mt=function(e){function a(t,a,n,i,o,r,s,c){var l=e.call(this,yt)||this;return l.router=t,l.configuration=a,l.titleService=n,l.layoutsConfiguration=i,l.mainState=o,l.communication=r,l.search=s,l.route=c,l}return m(a,e),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,communication:this.communication,options:this.config.options||{},search:this.search}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.ctorParameters=function(){return[{type:s.Router},{type:C},{type:c.Title},{type:E},{type:x},{type:T},{type:V},{type:s.ActivatedRoute}]},a=v([t.Component({selector:"aw-gallery-layout",template:'<div class="aw-search aw-gallery n7-side-auto-padding"\n     id="gallery-layout">\n    <div class="aw-search__header">\n        <div class="aw-search__header-left">\n            <h1 class="aw-search__header-title">{{ lb.dataSource.pageTitle }}</h1>\n        </div>\n    </div>\n    <div class="aw-search__content-wrapper sticky-parent">\n        \x3c!-- Left sidebar: facets --\x3e\n        <div *ngIf="!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)"\n             class="aw-search__sidebar-loading sticky-target">\n            <div class="aw-search__facets-loading">\n                <n7-content-placeholder [data]="{\n                    blocks: [{\n                        classes: \'search-placeholder-facet-input\'\n                    }, {\n                        classes: \'search-placeholder-facet-check\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }]\n                }">\n                </n7-content-placeholder>\n            </div>\n        </div>\n        <div *ngIf="!!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)"\n             class="aw-search__sidebar sticky-target"\n             [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <div class="aw-search__facets">\n                <n7-facets-wrapper [data]="lb.widgets[\'facets-wrapper\'].ds.out$ | async"\n                                   [emit]="lb.widgets[\'facets-wrapper\'].emit">\n                </n7-facets-wrapper>\n            </div>\n        </div>\n        <div class="aw-search__content">\n            <div class="aw-search__results-header">\n                <div class="aw-search__results-header-left">\n                    <h3 *ngIf="!lb.dataSource.resultsLoading"\n                        class="aw-search__total">\n                        <span class="aw-search__total-number">{{ lb.dataSource.totalCount }}</span>&nbsp;\n                        <span class="aw-search__total-title">{{ lb.dataSource.resultsTitle }}</span>\n                    </h3>\n                </div>\n                <div class="aw-search__results-header-right">\n                    <label class="aw-search__results-select-orderby-label"\n                           for="aw-search__results-select-orderby">{{ lb.dataSource.orderByLabel }}</label>\n                    <select (change)="lb.eventHandler.emitInner(\'orderbychange\', $event.target.value)"\n                            id="aw-search__results-select-orderby">\n                        <option *ngFor="let option of lb.dataSource.orderByOptions"\n                                [value]="option.value"\n                                [selected]="option.selected"\n                                [hidden]="option.type === \'score\' && lb.dataSource.isSearchingText.value === false">\n                            {{ option.label }}</option>\n                    </select>\n                </div>\n            </div>\n            \x3c!-- Search details --\x3e\n            <div *ngIf="lb.dataSource.resultsLoading"\n                 class="aw-search__results-wrapper-loading">\n                <n7-content-placeholder *ngFor="let n of [0,1,2,3,4,5,6,7,8,9]"\n                                        [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n            </div>\n            <div *ngIf="!lb.dataSource.resultsLoading"\n                 class="aw-search__results-wrapper">\n                <div class="n7-grid-3">\n                    <div *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                        </n7-smart-breadcrumbs>\n                        <n7-item-preview [data]="preview"\n                                         [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                        </n7-item-preview>\n                    </div>\n                </div>\n                <ng-container *ngIf="lb.dataSource.totalCount == 0">\n                    <div class="aw-search__fallback">\n                        <p class="aw-search__fallback-string">\n                            {{ lb.dataSource.fallback }}\n                        </p>\n                        <button [disabled]="!lb.dataSource.resetButtonEnabled"\n                                class="n7-btn aw-search__fallback-button"\n                                (click)="lb.eventHandler.emitInner(\'searchreset\', {})">\n                            Resetta la ricerca\n                        </button>\n                    </div>\n                </ng-container>\n                <n7-smart-pagination *ngIf="lb.dataSource.totalCount > 10"\n                                     [data]="lb.widgets[\'n7-smart-pagination\'].ds.out$ | async"\n                                     [emit]="lb.widgets[\'n7-smart-pagination\'].emit">\n                </n7-smart-pagination>\n            </div>\n        </div>\n    </div>\n</div>\n'}),w("design:paramtypes",[s.Router,C,c.Title,E,x,T,V,s.ActivatedRoute])],a)}(A),bt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.facetInputs={},t.autocompletePopoverOpen=!1,t.autocompleteChanged$=new o.Subject,t.numOfItemsStr=null,t.currentHoverEntity=null,t.hasScrollBackground=!1,t.resultsLimit=-1,t.selectedEntitiesIds=[],t.destroyed$=new o.Subject,t.homeAutocompleteIsLoading=!1,t.resultsListIsLoading=!1,t.bubblesEnabled=!1,t.selectedBubbles=[],t.updateComponent=function(e,a,n){n&&t.one(e).updateOptions(n),t.one(e).update(a)},t}return m(t,e),t.prototype.onInit=function(e){var t=e.communication,a=e.mainState,n=e.configuration,i=e.tippy;this.communication=t,this.configuration=n,this.mainState=a,this.tippy=i,this.resultsLimit=this.configuration.get("home-layout")["results-limit"],this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.one("aw-hero").update(this.configuration.get("home-layout")["top-hero"]),this.one("aw-home-hero-patrimonio").update(this.configuration.get("home-layout")["bottom-hero"]),this.mainState.update("headTitle","Arianna4View - Homepage"),this.mainState.update("pageTitle","Arianna4View - Homepage"),this.mainState.updateCustom("currentNav","home"),this._listenAutoCompleteChanges(),this.outerLinks=this.configuration.get("home-layout")["outer-links"].test,this.outerLinksTitle=this.configuration.get("home-layout")["outer-links"].title,this.one("aw-bubble-chart").updateOptions({selectable:!0,config:this.configuration,limit:this.configuration.get("bubble-chart").bubbleLimit}),this.one("aw-chart-tippy").updateOptions({basePath:this.configuration.get("paths").entitaBasePath,selectable:!0})},t.prototype.onDestroy=function(){this.destroyed$.next()},t.prototype.makeRequest$=function(e,t){return this.communication.request$(e,{onError:function(e){return console.error(e)},params:t})},t.prototype.initialFilterRequest=function(){return this.communication.request$("globalFilter",{onError:function(e){return console.error(e)},params:{entitiesListSize:this.configuration.get("bubble-chart").bubbleLimit}})},t.prototype.parseInitialRequest=function(e){var t=this;this.firstBubbleResponse=e.entitiesData;var a=[];e.typeOfEntityData.forEach((function(e){var n=t.configuration.get("config-keys")[e.type];a.push(b(b(b({},e),{enabled:!0,locked:!1}),n))})),this.one("aw-home-facets-wrapper").update(a)},t.prototype.renderPreviewsFromApolloQuery=function(e){var t=this;if(e&&e.itemsPagination){var a=e.itemsPagination.totalCount;if(a>0){for(var n=0;a>999;)a-=1e3,n+=1;var i=""+a;a<10?i="00"+a:a<100&&(i="0"+a),this.numOfItemsStr=n>0?n+"."+i:""+a}else this.numOfItemsStr="0";this.one("aw-linked-objects").updateOptions({context:"home",config:this.configuration}),this.one("aw-linked-objects").update(e.itemsPagination),setTimeout((function(){t._scrollBackgroundControl()}))}},t.prototype.updateTags=function(e){e||this.renderItemTags()},t.prototype.handleFacetSearchChange=function(e){var t=e.inputPayload,a=e.value;this.facetInputs[t]=a},t.prototype.renderItemTags=function(){var e=this,t=[],a=[];this.selectedBubbles.forEach((function(n){var i=e.firstBubbleResponse.find((function(e){return e.entity.id===n}));if(i){var o=e.configuration.get("config-keys")[i.entity.typeOfEntity];a.push({label:i.entity.label,icon:"n7-icon-close",payload:n,classes:"tag-"+o["class-name"]})}else{var r={entityId:n,entitiesListSize:1};t.push(e.makeRequest$("getMissingBubble",r))}})),t.length>0?o.forkJoin(t).subscribe((function(t){t.forEach((function(t){var n=e.configuration.get("config-keys")[t.typeOfEntity];a.push({label:t.label,icon:"n7-icon-close",payload:t.id,classes:"tag-"+n["class-name"]})})),e.one("aw-home-item-tags-wrapper").update(a)})):this.one("aw-home-item-tags-wrapper").update(a)},t.prototype.onHeroChange=function(e){if(e){var t=$.escapeDoubleQuotes(e);this.autocompleteChanged$.next(t),this.homeAutocompleteIsLoading=!0,this.homeAutocompleteQuery=t,this.autocompletePopoverOpen||this._toggleAutocompletePopover()}else this.autocompletePopoverOpen&&this._toggleAutocompletePopover()},t.prototype._scrollBackgroundControl=function(){var e=this,t=document.getElementById("bubble-results-list");if(t){var a=o.fromEvent(t,"scroll");setTimeout((function(){e._setHasScrollBackground(t)}),500),a.pipe(r.debounceTime(50)).subscribe((function(t){var a=t.target;e._setHasScrollBackground(a)}))}},t.prototype._setHasScrollBackground=function(e){this.hasScrollBackground=!!e&&e.scrollHeight>e.scrollTop+e.clientHeight},t.prototype._listenAutoCompleteChanges=function(){var e=this;this.one("aw-home-autocomplete").updateOptions({keys:this.configuration.get("config-keys"),config:this.configuration,labels:this.configuration.get("labels"),paths:this.configuration.get("paths")}),this.autocompleteChanged$.pipe(r.debounceTime(500),r.takeUntil(this.destroyed$)).subscribe((function(t){e.communication.request$("autoComplete",{onError:function(e){return console.error(e)},params:{input:t,itemsPagination:{offset:0,limit:e.configuration.get("home-layout")["results-limit"]}}}).subscribe((function(a){e.homeAutocompleteIsLoading=!1,e.one("aw-home-autocomplete").update({response:a,query:t})}))}))},t.prototype._toggleAutocompletePopover=function(){var e=this;if(!this.autocompletePopover){var t=document.getElementById("aw-home-advanced-autocomplete-popover");t.style.display="block";var a=k(this.tippy(".aw-home__top-hero .n7-hero__input",{content:t,trigger:"manual",interactive:!0,arrow:!1,flip:!1,appendTo:"parent",theme:"light-border",placement:"bottom-start",maxWidth:"100%",onHidden:function(){e.autocompletePopoverOpen=!1}}),1)[0];this.autocompletePopover=a}this.autocompletePopoverOpen?this.autocompletePopover.hide():this.autocompletePopover.show(),this.autocompletePopoverOpen=!this.autocompletePopoverOpen},t}(u.LayoutDataSource),vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t.handleSimpleAutocompleteClick=function(e){t.emitOuter("facetclick",e)},t.handleChartSelection=function(e){var a=e;t.dataSource.selectedBubbles=e,t.dataSource.resultsListIsLoading=!0,t.dataSource.makeRequest$("globalFilter",{selectedEntitiesIds:a,entitiesListSize:t.configuration.get("bubble-chart").bubbleLimit}).subscribe((function(e){if(t.dataSource.resultsListIsLoading=!1,e&&e.entitiesData.length>0)t.dataSource.lastBubbleResponse=e.entitiesData,t.emitOuter("filterbubbleresponse",e.entitiesData),t.dataSource.renderPreviewsFromApolloQuery(e),t.dataSource.renderItemTags();else{var a=[];t.dataSource.selectedBubbles.forEach((function(e){var n={entityId:e,entitiesListSize:1};a.push(t.dataSource.makeRequest$("getMissingBubble",n))})),o.forkJoin(a).subscribe((function(a){var n=[];a.forEach((function(e){n.push({count:0,entity:e})})),t.emitOuter("filterbubbleresponse",n),t.dataSource.renderPreviewsFromApolloQuery(e),t.dataSource.renderItemTags()}))}}))},t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-home-layout.init":e.dataSource.onInit(n),e.loadFilters(),e.configuration=n.configuration;break;case"aw-home-layout.outerlinkclick":e.emitGlobal("navigate",{handler:"router",path:n});break;case"aw-home-layout.destroy":e.dataSource.onDestroy();break;case"aw-home-layout.bubbleresultsviewallclick":var i=e.dataSource.selectedBubbles.join(","),o=e.configuration.get("paths").searchBasePath;e.emitGlobal("navigate",{handler:"router",path:[o],queryParams:{"entity-links":i}});break;case"aw-home-layout.clearselection":e.emitOuter("clearselection");break;default:console.warn("(home) unhandled inner event of type: ",a)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-bubble-chart.d3end":e.emitOuter("d3end",n);break;case"aw-chart-tippy.select":e.emitOuter("select",n);break;case"aw-hero.enter":var i=n.value;e.emitGlobal("navigate",{handler:"router",path:[e.configuration.get("paths").searchBasePath],queryParams:{query:i}});break;case"aw-hero.change":e.dataSource.autocompleteValue=n.value,e.dataSource.onHeroChange(n.value);break;case"aw-home-facets-wrapper.click":e.emitOuter("togglefilter",n);break;case"aw-home-facets-wrapper.change":if(!n.value||"string"==typeof n.value&&0===n.value.trim().length)e.emitOuter("facetswrapperclose",{facetId:n});else if(n.value){e.emitOuter("facetswrapperrequest",{facetId:n}),e.dataSource.updateComponent("aw-autocomplete-wrapper",{key:n.value,response:null});var o={input:n.value,typeOfEntity:n.inputPayload.replace(/-search/g,"").replace(/-/g," "),itemsPagination:{offset:0,limit:e.configuration.get("home-layout")["results-limit"]}};e.dataSource.makeRequest$("autoComplete",o).subscribe((function(t){if(t.results.length<1){var a={totalcount:0,results:[{entity:{id:"fallback",label:e.configuration.get("home-layout")["autocomplete-fallback"]?e.configuration.get("home-layout")["autocomplete-fallback"]:"Nessun risultato trovato"}}]};e.dataSource.updateComponent("aw-autocomplete-wrapper",{key:n.value,response:a},{config:e.configuration})}else e.dataSource.updateComponent("aw-autocomplete-wrapper",{key:n.value,response:t},{config:e.configuration})}))}break;case"aw-home-item-tags-wrapper.click":e.emitOuter("tagclick",n);break;case"aw-linked-objects.datarequest":var r=n.currentPage;o={selectedEntitiesIds:e.dataSource.selectedBubbles,itemsPagination:{offset:r*e.dataSource.resultsLimit,limit:e.dataSource.resultsLimit}};e.dataSource.makeRequest$("globalFilter",o).subscribe((function(t){t?e.emitOuter("dataresponse",{res:t}):console.warn("Unable to fetch additional data.")}));break;case"aw-autocomplete-wrapper.clickresult":e.handleSimpleAutocompleteClick(n);break;case"aw-home-autocomplete.click":var s=n.source,c=n.type,l=void 0;if("item"===s)l="oggetto-culturale"===c?e.configuration.get("paths").schedaBasePath:e.configuration.get("paths").entitaBasePath,e.emitGlobal("navigate",{handler:"router",path:[l,n.id,$.slugify(n.title)]});else if("showMore"===s){i=e.dataSource.homeAutocompleteQuery;l=e.configuration.get("paths").searchBasePath,e.emitGlobal("navigate",{handler:"router",path:[l],queryParams:{query:i}})}else"extendsearch"===s&&e.emitGlobal("navigate",{handler:"router",path:[e.configuration.get("paths").searchBasePath],queryParams:{query:e.dataSource.autocompleteValue,"query-all":1}});break;case"aw-bubble-chart.selection":e.handleChartSelection(n);break;case"aw-bubble-chart.lockfilter":e.emitOuter("lockfilter",n)}}))},t.prototype.loadFilters=function(){var e=this;this.dataSource.initialFilterRequest().subscribe((function(t){t&&(e.dataSource.parseInitialRequest(t),e.dataSource.bubblesEnabled&&e.emitOuter("filterbubbleresponse",t.entitiesData))}))},t.prototype.outerLinkClick=function(e,t){window.open(t,"_blank")},t}(l.EventHandler),wt={layoutId:"aw-home-layout",widgets:[{id:"aw-hero"},{id:"aw-home-hero-patrimonio"},{id:"aw-bubble-chart"},{id:"aw-home-facets-wrapper"},{id:"aw-home-item-tags-wrapper"},{id:"aw-home-autocomplete"},{id:"aw-linked-objects"},{id:"aw-autocomplete-wrapper"},{id:"aw-chart-tippy"}],layoutDS:bt,layoutEH:vt,widgetsDataSources:Ue,widgetsEventHandlers:ut,options:{}},St=function(e){function a(t,a,n,i,o){var r=e.call(this,t.get("AwHomeLayoutConfig")||wt)||this;return r.router=a,r.configuration=n,r.communication=i,r.mainState=o,r}return m(a,e),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,communication:this.communication,options:this.config.options||{},tippy:g}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.ctorParameters=function(){return[{type:E},{type:s.Router},{type:C},{type:T},{type:x}]},a=v([t.Component({selector:"aw-home-layout",template:'<div class="aw-home" *ngIf="lb.dataSource">\n    \x3c!-- Hero section at the top of the page --\x3e\n    <div class="aw-home__top-hero">\n        <n7-hero [data]="lb.widgets[\'aw-hero\'].ds.out$ | async" [emit]="lb.widgets[\'aw-hero\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- Bubble chart --\x3e\n    <div class="aw-home__bubble-wrapper n7-side-auto-padding"\n        [ngClass]="{ \'has-results\' : lb.dataSource.selectedBubbles.length > 0 }" *ngIf="lb.dataSource.bubblesEnabled">\n        <div class="aw-home__facets-wrapper-loading" *ngIf="!(lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async)">\n            <n7-content-placeholder *ngFor="let i of [0,1,2,3]" [data]="{\n                blocks: [{\n                    classes: \'facet-placeholder-header\'\n                }, {\n                    classes: \'facet-placeholder-input\'\n                }] \n            }"></n7-content-placeholder>\n        </div>\n        <div class="aw-home__facets-wrapper" *ngIf="!!(lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async)">\n            <span class="aw-home__facet"\n                *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;">\n                <n7-facet-header [data]="widgetData.header" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet-header>\n                <n7-facet [data]="widgetData.input" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet>\n            </span>\n        </div>\n\n        <div class="aw-home__bubble-chart-wrapper-loading" *ngIf="!(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)">\n            <n7-content-placeholder [data]="{\n                blocks: [\n                    {\n                        classes: \'facet-placeholder-item-1\'\n                    }\n                ]\n            }"></n7-content-placeholder>\n        </div>\n        <div class="aw-home__bubble-chart-wrapper" *ngIf="!!(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)"\n            [style.overflow]="lb.dataSource.loadingBubbles ? \'visible\' : \'hidden\'">\n            <aw-bubble-chart-wrapper>\n                <aw-chart-tippy \n                    [data]="lb.widgets[\'aw-chart-tippy\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'aw-chart-tippy\'].emit">\n                </aw-chart-tippy>\n                <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                </n7-bubble-chart>\n            </aw-bubble-chart-wrapper>\n        </div>\n\n        \x3c!-- Linked objects --\x3e\n        <ng-container *ngIf="(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)?.selected.length > 0;">\n            <div class="aw-home__bubble-results" id="home-bubble-results">\n                <div *ngIf="lb.dataSource.numOfItemsStr" class="aw-home__bubble-results-title-wrapper">\n                    <h1 class="aw-home__bubble-results-title"><strong class="aw-home__bubble-results-title-counter">\n                            {{ lb.dataSource.numOfItemsStr }}</strong> <span> Oggetti culturali</span>\n                    </h1>\n                </div>\n                <div class="aw-home__bubble-tags-wrapper">\n                    <h3 class="aw-home__bubble-tags-title">Collegati a </h3>\n                    <ng-container *ngFor="let widgetData of lb.widgets[\'aw-home-item-tags-wrapper\'].ds.out$ | async;">\n                        <n7-tag [data]="widgetData" [emit]="lb.widgets[\'aw-home-item-tags-wrapper\'].emit">\n                        </n7-tag>\n                        <br>\n                    </ng-container>\n                </div>\n                <div class="aw-home__bubble-results-list-wrapper">\n                    <div class="aw-home__bubble-results-list-loading" *ngIf="lb.dataSource.resultsListIsLoading">\n                        <n7-content-placeholder \n                            *ngFor="let i of [1, 2, 3, 4, 5]"\n                            [data]="{\n                                blocks: [{\n                                    classes: \'search-result-placeholder-title\'\n                                }, {\n                                    classes: \'search-result-placeholder-metadata\'\n                                }]\n                        }"></n7-content-placeholder>\n                    </div>\n                    <div *ngIf="!lb.dataSource.resultsListIsLoading" class="aw-home__bubble-results-list"\n                        [attr.id]="\'bubble-results-list\'" (scroll)="lb.eventHandler.emitOuter(\'scroll\', $event.target)">\n\n                        <div class="aw-home__bubble-results-fallback"\n                            *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result.length < 1;">\n                            <p class="aw-home__bubble-results-fallback-text">\n                                {{ (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.fallback }}\n                            </p>\n                            <button class="n7-btn aw-home__bubble-results-reset"\n                                (click)="lb.eventHandler.emitInner(\'clearselection\')">\n                                Resetta la ricerca\n                            </button>\n                        </div>\n\n                        <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result">\n                            <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                            </n7-smart-breadcrumbs>\n                            <n7-item-preview [data]="preview"\n                                                [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                            </n7-item-preview>\n                        </ng-container>\n                        \x3c!-- <ng-container\n                            *ngFor="let widgetData of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result;">\n                            <n7-item-preview [data]="widgetData" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                            </n7-item-preview>\n                        </ng-container> --\x3e\n\n                        <ng-container *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.isLoading">\n                            <div class="aw-home__bubble-results-list-loader">\n                                <n7-loader [data]="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.loaderData">\n                                </n7-loader>\n                            </div>\n                        </ng-container>\n                    </div>\n                    <div [ngClass]="{ \'is-visible\' : lb.dataSource.hasScrollBackground }"\n                        class="aw-home__bubble-results-list-wrapper-with-scroll"></div>\n                </div>\n                \x3c!-- aw-linked-objects__actions --\x3e\n                <ng-container\n                    *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result.length > 0 && !lb.dataSource.resultsListIsLoading">\n                    <div *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.actions as action"\n                        class="aw-home__bubble-results-list-actions">\n                        <button (click)="lb.eventHandler.emitInner(\'bubbleresultsviewallclick\')"\n                            class="n7-btn n7-btn-light n7-btn-l aw-home__bubble-results-list-view-all">\n                            {{action[0].label}}\n                        </button>\n                    </div>\n                </ng-container>\n\n            </div>\n        </ng-container>\n    </div>\n\n    \x3c!-- Outer links --\x3e\n    <div *ngIf="lb.dataSource.outerLinks && lb.dataSource.outerLinks.length > 0" class="aw-home__outer-links">\n        <section class="aw-home__outer-links-wrapper n7-side-auto-padding">\n            <h2 class="aw-home__outer-links-title" *ngIf="lb.dataSource.outerLinksTitle">\n                {{ lb.dataSource.outerLinksTitle }}\n            </h2>\n            <div class="aw-home__outer-links-items">\n                \x3c!-- Item preview --\x3e\n                <n7-item-preview *ngFor="let outerLink of lb.dataSource.outerLinks" [data]="outerLink"\n                    [emit]="lb.eventHandler.outerLinkClick.bind(lb.eventHandler)">\n                </n7-item-preview>\n                \x3c!-- END // Item preview --\x3e\n            </div>\n        </section>\n    </div>\n    \x3c!-- END // Outer links --\x3e\n\n    \x3c!-- Hero section at the bottom of the page --\x3e\n    <div class="aw-home__bottom-hero">\n        <n7-hero [data]="lb.widgets[\'aw-home-hero-patrimonio\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-hero-patrimonio\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- Adavanced autocomplete popover  --\x3e\n    <div class="aw-home__advanced-autocomplete" id="aw-home-advanced-autocomplete-popover" style="display: none;">\n        <div class="aw-home__advanced-autocomplete-loader" *ngIf="lb.dataSource.homeAutocompleteIsLoading">\n            <n7-loader [data]="{}"></n7-loader>\n        </div>\n        <n7-advanced-autocomplete *ngIf="!lb.dataSource.homeAutocompleteIsLoading"\n            [data]="lb.widgets[\'aw-home-autocomplete\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-autocomplete\'].emit">\n        </n7-advanced-autocomplete>\n    </div>\n\n    \x3c!-- Simple autocomplete popover. DO NOT CHANGE parent div class! --\x3e\n    \x3c!-- Creating one template for each facet --\x3e\n    <div *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;"\n        class="aw-home__simple-autocomplete aw-simple-autocomplete__template" style="display: none;">\n        <div class="aw-home__simple-autocomplete-content aw-simple-autocomplete__tippy-wrapper">\n            <div class="aw-home__simple-autocomplete-loader aw-simple-autocomplete__tippy-wrapper-loader"\n                *ngIf="(lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async)?.loading">\n                <n7-loader [data]="{}"></n7-loader>\n            </div>\n            <n7-simple-autocomplete *ngIf="!(lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async)?.loading"\n                [data]="lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-autocomplete-wrapper\'].emit">\n            </n7-simple-autocomplete>\n        </div>\n    </div>\n</div>\n'}),w("design:paramtypes",[E,s.Router,C,T,x])],a)}(A),kt={items:[{item:{id:"51f03166-2241-42cd-8a0f-642907478787",label:'"1 - Casa a S. Piero a Ponti - 1964 - Tipo A - Veduta" (1964)',icon:null,title:'"1 - Casa a S. Piero a Ponti - 1964 - Tipo A - Veduta" (1964)',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondoGiuseppeGiorgioGori1906-1969/Documentazionediprogetto/0095@0001_001_95.1.tif&WID=500&CVT=jpeg",text:'"1 - Casa a S. Piero a Ponti - 1964 - Tipo A - Veduta"',relatedTypesOfEntity:[{type:"luogo",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo Giuseppe Giorgio Gori (1906 - 1969)",link:"6a2449cc-5498-4c9c-a357-1c8f770dc045"},{label:"serie 3 - Documentazione di progetto",link:"9e4bd61f-7bf9-4b35-aa2c-ecc26530e2e2"},{label:"S. Piero a Ponti, Campi Bisenzio (FI), Progetto di una casa (1964)",link:"0b300620-900f-4899-b0fb-a6b21ebda1d8"}],fields:[{key:"fase",value:"storico"},{key:"definizione_tipologia",value:"tavola di progetto"},{label:"altra_intitolazione",fields:[]},{key:"descrizione_interna_tipologia",value:"tavola definitiva"},{key:"estremo_remoto",value:"1964"},{key:"intitolazione",value:'"1 - Casa a S. Piero a Ponti - 1964 - Tipo A - Veduta"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19640101"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:""},{key:"consistenza.quantita",value:""}]}]}},{item:{id:"99373c8b-fc30-41f1-8d03-3def498652e2",label:'"1 - Mercato dei fiori a Pescia - Proposta di copertura delle 10 piazzuole laterali - Prog. arch. G. Gori" ([1966])',icon:null,title:'"1 - Mercato dei fiori a Pescia - Proposta di copertura delle 10 piazzuole laterali - Prog. arch. G. Gori" ([1966])',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondoGiuseppeGiorgioGori1906-1969/Documentazionediprogetto/0058@0003@0001_008_58.3.1_particolare.tif&WID=500&CVT=jpeg",text:'"1 - Mercato dei fiori a Pescia - Proposta di copertura delle 10 piazzuole laterali - Prog. arch. G. Gori"',relatedTypesOfEntity:[{type:"luogo",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo Giuseppe Giorgio Gori (1906 - 1969)",link:"6a2449cc-5498-4c9c-a357-1c8f770dc045"},{label:"serie 3 - Documentazione di progetto",link:"9e4bd61f-7bf9-4b35-aa2c-ecc26530e2e2"},{label:"Pescia, Ampliamento del Mercato ortoflorofrutticolo (1957 - 1966)",link:"30b3b92e-596a-4706-97aa-a8c0d7e17097"},{label:"Pescia, Proposta di copertura delle 10 piazzuole laterali (1966)",link:"3c777533-60d3-4d68-b6b6-f50fef643bdf"}],fields:[{key:"fase",value:"storico"},{key:"definizione_tipologia",value:"tavola di progetto"},{key:"descrizione_interna",value:"<p>Con annotazioni a matita rossa</p>"},{label:"altra_intitolazione",fields:[{key:"intitolazioni.altraIntitolazione.intitolazione",value:"Pianta, sezioni, veduta prospettica e assonometrica"}]},{key:"descrizione_interna_tipologia",value:"tavola di studio 1:50"},{key:"estremo_remoto",value:"[1966]"},{key:"intitolazione",value:'"1 - Mercato dei fiori a Pescia - Proposta di copertura delle 10 piazzuole laterali - Prog. arch. G. Gori"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19660101"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:""},{key:"consistenza.quantita",value:""}]}]}},{item:{id:"7c6dd66f-0ae7-44d2-a1fd-440ff18bb0f9",label:'"1953 - Settembre - Bari - Padiglione dell\'I.N.A. alla Fiera del Levante" (1953)',icon:null,title:'"1953 - Settembre - Bari - Padiglione dell\'I.N.A. alla Fiera del Levante" (1953)',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondoGiuseppeGiorgioGori1906-1969/Documentazionediprogetto/0037_002_37b.tif&WID=500&CVT=jpeg",text:'"1953 - Settembre - Bari - Padiglione dell\'I.N.A. alla Fiera del Levante"',relatedTypesOfEntity:[{type:"luogo",count:1},{type:"organizzazione",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo Giuseppe Giorgio Gori (1906 - 1969)",link:"6a2449cc-5498-4c9c-a357-1c8f770dc045"},{label:"serie 3 - Documentazione di progetto",link:"9e4bd61f-7bf9-4b35-aa2c-ecc26530e2e2"}],fields:[{key:"legatura.epoca",value:""},{key:"fase",value:"storico"},{label:"altra_intitolazione",fields:[{key:"intitolazioni.altraIntitolazione.intitolazione",value:"Bari, Padiglione INA alla Fiera del Levante"}]},{key:"intitolazione",value:'"1953 - Settembre - Bari - Padiglione dell\'I.N.A. alla Fiera del Levante"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19530101"},{key:"legatura.datazione",value:""},{key:"corredoRicerca.riferimento",value:'Fotocopie da Gori, 1961; ricerca "Giorgio Giuseppe Gori. Operosità didattica e scientifica" del corso di Storia dell\'Architettura contemporanea della Facoltà di Architettura, a.a. 1991-1992'},{key:"definizione_tipologia",value:"album"},{key:"descrizione_interna",value:"<p>3 fotografie b/n della mostra</p>"},{key:"corredoRicerca.descrizione",value:""},{key:"corredoRicerca.tipologia",value:"allegato"},{key:"estremo_remoto",value:"1953"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:""},{key:"consistenza.quantita",value:""}]},{key:"legatura.tipologia",value:"cartoncino"}]}},{item:{id:"aee6d69c-e58c-4025-861f-7735d2dc1e1f",label:'"1956 - Cagliari - cattedrale" (1956)',icon:null,title:'"1956 - Cagliari - cattedrale" (1956)',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/ArchiviofotograficodiRestauro/FondoPieroSanpaolesi/provini/A105_0001_provini.tif&WID=500&CVT=jpeg",text:'"1956 - Cagliari - cattedrale"',relatedTypesOfEntity:[{type:"luogo",count:1},{type:"persona",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Archivio fotografico di Restauro",link:"d3c172a6-eb54-4ffc-9593-67a79fe1a192"},{label:"sezione - Fondo Piero Sanpaolesi",link:"056c2c9f-83d7-4700-ad24-1ef8c76b6b20"},{label:"serie - provini",link:"f2b067ff-97b9-4944-bb13-deae3574bab9"}],fields:[{key:"fase",value:"storico"},{key:"definizione_tipologia",value:"scheda"},{key:"descrizione_interna",value:"<p>Leoni del recinto presbiteriale della Cattedrale di Cagliari (1-12)</p>"},{label:"altra_intitolazione",fields:[]},{key:"intitolazione",value:'"1956 - Cagliari - cattedrale"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19560101"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:"stampe per contatto"},{key:"consistenza.quantita",value:"12.0"}]},{key:"supporto",value:"in cartoncino"},{key:"estremo_recente",value:"1956"},{key:"descrizione_interna_trascrizione",value:"<p>[Sotto l'intitolazione] Recinto presbiteriale, leoni già appartenenti allo scomposto ambone del maestro Guglielmo</p>"}]}},{item:{id:"26e0a2b9-d466-445f-a0d3-849c1159835d",label:'"4 - Ospedale Lotti a Pontedera - 1° lotto dei lavori. Asilo mortuario - Fianco sud 1:50 - arch. G. Gori arch. R. Pagnini, Firenze 29 apr. 1960" (1960 apr. 29)',icon:null,title:'"4 - Ospedale Lotti a Pontedera - 1° lotto dei lavori. Asilo mortuario - Fianco sud 1:50 - arch. G. Gori arch. R. Pagnini, Firenze 29 apr. 1960" (1960 apr. 29)',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondoGiuseppeGiorgioGori1906-1969/Documentazionediprogetto/0057@0004@0004_004_57.4.4a.tif&WID=500&CVT=jpeg",text:'"4 - Ospedale Lotti a Pontedera - 1° lotto dei lavori. Asilo mortuario - Fianco sud 1:50 - arch. G. Gori arch. R. Pagnini, Firenze 29 apr. 1960"',relatedTypesOfEntity:[{type:"luogo",count:1},{type:"persona",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo Giuseppe Giorgio Gori (1906 - 1969)",link:"6a2449cc-5498-4c9c-a357-1c8f770dc045"},{label:"serie 3 - Documentazione di progetto",link:"9e4bd61f-7bf9-4b35-aa2c-ecc26530e2e2"},{label:"Pontedera (PI), Ampliamento dell'Ospedale Lotti, in coll. con R. Pagnini, M. Cammelli, V. Michelagnoli (1957 - 1962)",link:"ceb3d67a-de23-4f58-b731-2a0135d09826"},{label:"Pontedera (PI), Ampliamento dell'Ospedale Lotti - 1° lotto di lavori - Asilo mortuario (1960)",link:"bf951503-1950-4a19-942e-54aea808942b"}],fields:[{key:"fase",value:"storico"},{key:"definizione_tipologia",value:"tavola di progetto"},{label:"altra_intitolazione",fields:[]},{key:"descrizione_interna_tipologia",value:"tavola esecutiva"},{key:"estremo_remoto",value:"1960 apr. 29"},{key:"intitolazione",value:'"4 - Ospedale Lotti a Pontedera - 1° lotto dei lavori. Asilo mortuario - Fianco sud 1:50 - arch. G. Gori arch. R. Pagnini, Firenze 29 apr. 1960"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19600429"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:""},{key:"consistenza.quantita",value:""}]}]}},{item:{id:"3bfa1b8d-dca2-46ac-95dc-13cd76f6b5a3",label:'"4 aprile 1948 - Lucca - San Martino - Tomba di Ilaria del Carretto - (J. della Quercia)" (4 aprile 1948)',icon:null,title:'"4 aprile 1948 - Lucca - San Martino - Tomba di Ilaria del Carretto - (J. della Quercia)" (4 aprile 1948)',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/ArchiviofotograficodiRestauro/FondoPieroSanpaolesi/provini/A9_0001_provini.tif&WID=500&CVT=jpeg",text:'"4 aprile 1948 - Lucca - San Martino - Tomba di Ilaria del Carretto - (J. della Quercia)"',relatedTypesOfEntity:[{type:"luogo",count:1},{type:"persona",count:2}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Archivio fotografico di Restauro",link:"d3c172a6-eb54-4ffc-9593-67a79fe1a192"},{label:"sezione - Fondo Piero Sanpaolesi",link:"056c2c9f-83d7-4700-ad24-1ef8c76b6b20"},{label:"serie - provini",link:"f2b067ff-97b9-4944-bb13-deae3574bab9"}],fields:[{key:"fase",value:"storico"},{key:"definizione_tipologia",value:"scheda"},{label:"altra_intitolazione",fields:[]},{key:"intitolazione",value:'"4 aprile 1948 - Lucca - San Martino - Tomba di Ilaria del Carretto - (J. della Quercia)"'},{key:"document_classification",value:"a4.oc.ua.UA"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:"stampe per contatto"},{key:"consistenza.quantita",value:"12.0"}]},{key:"supporto",value:"in cartoncino"},{key:"estremo_recente",value:"4 aprile 1948"}]}},{item:{id:"12def6b6-68b9-4103-acd4-971c12ec2438",label:'"5 - Casa a S. Piero a Ponti - Tipo A - Retro 1:50" ([1964])',icon:null,title:'"5 - Casa a S. Piero a Ponti - Tipo A - Retro 1:50" ([1964])',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondoGiuseppeGiorgioGori1906-1969/Documentazionediprogetto/0095@0005_002_95.5bis.tif&WID=500&CVT=jpeg",text:'"5 - Casa a S. Piero a Ponti - Tipo A - Retro 1:50"',relatedTypesOfEntity:[{type:"luogo",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo Giuseppe Giorgio Gori (1906 - 1969)",link:"6a2449cc-5498-4c9c-a357-1c8f770dc045"},{label:"serie 3 - Documentazione di progetto",link:"9e4bd61f-7bf9-4b35-aa2c-ecc26530e2e2"},{label:"S. Piero a Ponti, Campi Bisenzio (FI), Progetto di una casa (1964)",link:"0b300620-900f-4899-b0fb-a6b21ebda1d8"}],fields:[{key:"fase",value:"storico"},{key:"definizione_tipologia",value:"tavola di progetto"},{label:"altra_intitolazione",fields:[]},{key:"descrizione_interna_tipologia",value:"tavola definitiva"},{key:"estremo_remoto",value:"[1964]"},{key:"intitolazione",value:'"5 - Casa a S. Piero a Ponti - Tipo A - Retro 1:50"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19640101"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:""},{key:"consistenza.quantita",value:""}]}]}},{item:{id:"f93752c0-1ccb-449d-8a4c-41afe4789190",label:'"50 - INA. Cassa Vecchia Roma. Fabbrica Go. Veduta prospettica della piazza" (1960 gen. 27)',icon:null,title:'"50 - INA. Cassa Vecchia Roma. Fabbrica Go. Veduta prospettica della piazza" (1960 gen. 27)',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondoGiuseppeGiorgioGori1906-1969/Documentazionediprogetto/0055@0008_003_55.8.tif&WID=500&CVT=jpeg",text:'"50 - INA. Cassa Vecchia Roma. Fabbrica Go. Veduta prospettica della piazza"',relatedTypesOfEntity:[{type:"luogo",count:1},{type:"organizzazione",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo Giuseppe Giorgio Gori (1906 - 1969)",link:"6a2449cc-5498-4c9c-a357-1c8f770dc045"},{label:"serie 3 - Documentazione di progetto",link:"9e4bd61f-7bf9-4b35-aa2c-ecc26530e2e2"},{label:"Roma, Palazzina INA in via Cassia Vecchia (1957 - 1961)",link:"3c52efe4-631d-4959-9cc3-6abd4fa8014c"}],fields:[{key:"fase",value:"storico"},{key:"definizione_tipologia",value:"tavola di progetto"},{key:"descrizione_interna",value:'<p>La tavola reca i timbri "Prof. Dott. Giuseppe Gori architetto" e la data "27 gen. 1960"</p>'},{label:"altra_intitolazione",fields:[]},{key:"estremo_remoto",value:"1960 gen. 27"},{key:"intitolazione",value:'"50 - INA. Cassa Vecchia Roma. Fabbrica Go. Veduta prospettica della piazza"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19600127"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:""},{key:"consistenza.quantita",value:""}]}]}},{item:{id:"0dc555d7-852b-4e22-8673-223bc0ec4815",label:'"58 - INA. Cassa Vecchia Roma. Fabbrica Go. Gli aggetti delle facciate - Prospetto rapp. 1:100" (1960 gen. 27)',icon:null,title:'"58 - INA. Cassa Vecchia Roma. Fabbrica Go. Gli aggetti delle facciate - Prospetto rapp. 1:100" (1960 gen. 27)',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondoGiuseppeGiorgioGori1906-1969/Documentazionediprogetto/0055@0009_004_55.9.tif&WID=500&CVT=jpeg",text:'"58 - INA. Cassa Vecchia Roma. Fabbrica Go. Gli aggetti delle facciate - Prospetto rapp. 1:100"',relatedTypesOfEntity:[{type:"luogo",count:1},{type:"organizzazione",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo Giuseppe Giorgio Gori (1906 - 1969)",link:"6a2449cc-5498-4c9c-a357-1c8f770dc045"},{label:"serie 3 - Documentazione di progetto",link:"9e4bd61f-7bf9-4b35-aa2c-ecc26530e2e2"},{label:"Roma, Palazzina INA in via Cassia Vecchia (1957 - 1961)",link:"3c52efe4-631d-4959-9cc3-6abd4fa8014c"}],fields:[{key:"fase",value:"storico"},{key:"definizione_tipologia",value:"tavola di progetto"},{key:"descrizione_interna",value:'<p>La tavola, acquerellata a colori, reca il timbro "27 gen. 1960"</p>'},{label:"altra_intitolazione",fields:[]},{key:"estremo_remoto",value:"1960 gen. 27"},{key:"intitolazione",value:'"58 - INA. Cassa Vecchia Roma. Fabbrica Go. Gli aggetti delle facciate - Prospetto rapp. 1:100"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19600127"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:""},{key:"consistenza.quantita",value:""}]}]}},{item:{id:"2dbaebed-ff6f-4ee2-95b4-cf37d0f9b0be",label:'"59 - INA. Cassa Vecchia Roma. Fabbrica Go. Gli aggetti delle facciate - Fianco sulla strada 1:100 -  Fianco sull’interno 1:100" (1960 gen. 27)',icon:null,title:'"59 - INA. Cassa Vecchia Roma. Fabbrica Go. Gli aggetti delle facciate - Fianco sulla strada 1:100 -  Fianco sull’interno 1:100" (1960 gen. 27)',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondoGiuseppeGiorgioGori1906-1969/Documentazionediprogetto/0055@0010_001_55.10.tif&WID=500&CVT=jpeg",text:'"59 - INA. Cassa Vecchia Roma. Fabbrica Go. Gli aggetti delle facciate - Fianco sulla strada 1:100 -  Fianco sull’interno 1:100"',relatedTypesOfEntity:[{type:"luogo",count:1},{type:"organizzazione",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo Giuseppe Giorgio Gori (1906 - 1969)",link:"6a2449cc-5498-4c9c-a357-1c8f770dc045"},{label:"serie 3 - Documentazione di progetto",link:"9e4bd61f-7bf9-4b35-aa2c-ecc26530e2e2"},{label:"Roma, Palazzina INA in via Cassia Vecchia (1957 - 1961)",link:"3c52efe4-631d-4959-9cc3-6abd4fa8014c"}],fields:[{key:"fase",value:"storico"},{key:"definizione_tipologia",value:"tavola di progetto"},{key:"descrizione_interna",value:'<p>La tavola, acquerellata a colori, reca i timbri "Prof. Dott. Giuseppe Gori architetto" e la data "27 gen. 1960"</p>'},{label:"altra_intitolazione",fields:[]},{key:"estremo_remoto",value:"1960 gen. 27"},{key:"intitolazione",value:'"59 - INA. Cassa Vecchia Roma. Fabbrica Go. Gli aggetti delle facciate - Fianco sulla strada 1:100 -  Fianco sull’interno 1:100"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19600127"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:""},{key:"consistenza.quantita",value:""}]}]}},{item:{id:"b2144875-82e3-4ac3-a6de-d9616fc3fe17",label:'"A S.E. Arrigo Serpieri per ricordo della visita alla bonifica Delia-Nivolelli, Mazara del Vallo 21 aprile 1933-XI" (1933)',icon:null,title:'"A S.E. Arrigo Serpieri per ricordo della visita alla bonifica Delia-Nivolelli, Mazara del Vallo 21 aprile 1933-XI" (1933)',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondofotograficodiAgraria/Bonifiche/6_0025_c12verso.tif&WID=500&CVT=jpeg",text:'"A S.E. Arrigo Serpieri per ricordo della visita alla bonifica Delia-Nivolelli, Mazara del Vallo 21 aprile 1933-XI"',relatedTypesOfEntity:[{type:"luogo",count:1},{type:"organizzazione",count:2},{type:"persona",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo fotografico di Agraria",link:"bfd06ffa-c74e-4e81-8229-1f7de1038180"},{label:"serie - Bonifiche",link:"6670c137-bb53-4eb3-9e56-bd93a764d9b3"}],fields:[{key:"legatura.epoca",value:"originale"},{key:"fase",value:"storico"},{label:"altra_intitolazione",fields:[]},{key:"documentazioneGrafica.tecnicaEsecutiva",value:""},{key:"descrizione_interna_tipologia",value:"album fotografico"},{key:"documentazioneGrafica.tipologia",value:"materiale fotografico"},{key:"intitolazione",value:'"A S.E. Arrigo Serpieri per ricordo della visita alla bonifica Delia-Nivolelli, Mazara del Vallo 21 aprile 1933-XI"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"data_inizio",value:"19330101"},{key:"legatura.datazione",value:""},{key:"definizione_tipologia",value:"album"},{key:"descrizione_interna",value:'<p>L\'album contiene 26 fotografie in b/n di diversi formati, con veline e didascalie manoscritte. Le fotografie documentano i lavori della bonifica Delia-Nivolelli nel comune di Mazara del Vallo (TP) e la visita di Arrigo Serpieri a Mazara il 21 aprile 1933.<br />Molte fotografie riportano sul verso, a lapis, il testo della didascalia; alcune sono stampate su carta che riporta l\'intestazione del fotografo: "Foto-Termini-Trapani". La fotografia a c. 13r. ha sul verso il timbro "Consorzio della bonifica Nivolelli, Mazara del Vallo".</p>'},{key:"stato_conservazione",value:"mediocre"},{key:"estremo_remoto",value:"1933"},{key:"larghezza",value:"332.0"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:"carte"},{key:"consistenza.quantita",value:"24.0"}]},{key:"legatura.tipologia",value:"cuoio istoriato con lacci in cuoio"},{key:"altezza",value:"250.0"},{key:"spessore",value:"35.0"}]}},{item:{id:"30681189-7ce0-4db0-be0a-6eedccde364b",label:'"Abbadia San Salvatore (Siena). Borgo Medievale - Arco di una porta in "peperino" (trachite)"',icon:null,title:'"Abbadia San Salvatore (Siena). Borgo Medievale - Arco di una porta in "peperino" (trachite)"',subTitle:null,image:"http://iipserver.hyperborea.com/fast/iipsrv1.fcgi?FIF=/mnt/links/unifi/BibliotecadiScienzeTecnologiche/FondoFrancescoRodolico/Soggettiarchitettonici/Toscana/0162_0001_AbbadiaSanSalvatore.tif&WID=500&CVT=jpeg",text:'"Abbadia San Salvatore (Siena). Borgo Medievale - Arco di una porta in "peperino" (trachite)"',relatedTypesOfEntity:[{type:"luogo",count:1}],breadcrumbs:[{label:"complesso di fondi - Fondi archivistici delle biblioteche",link:"c1f2126e-dbb3-45b5-82c0-dc639d605a8f"},{label:"fondo - Fondo Francesco Rodolico",link:"1cbf9ac3-a603-443c-b05e-518de387692d"},{label:"serie - Soggetti architettonici",link:"5a611c85-7cbe-445a-bad9-47f41c9c3f2e"},{label:'sottoserie - "Toscana"',link:"2a823690-9de5-4faf-8fae-f5ba152a05ac"}],fields:[{key:"fase",value:"storico"},{key:"condizionamento.epoca",value:""},{label:"altra_intitolazione",fields:[]},{key:"documentazioneGrafica.tecnicaEsecutiva",value:""},{key:"condizionamento.datazione",value:""},{key:"descrizione_interna_tipologia",value:"Negativi e fotografie"},{key:"documentazioneGrafica.tipologia",value:"materiale fotografico"},{key:"intitolazione",value:'"Abbadia San Salvatore (Siena). Borgo Medievale - Arco di una porta in "peperino" (trachite)"'},{key:"document_classification",value:"a4.oc.ua.UA"},{key:"condizionamento.materia",value:"cartone"},{key:"definizione_tipologia",value:"busta"},{key:"descrizione_interna",value:"<p>1 negativo 24x36 mm; 1 stampa su carta al bromuro d'argento 80x110 mm</p>"},{key:"stato_conservazione",value:"buono"},{key:"condizionamento.tipologia",value:"scatola"},{label:"consistenza",fields:[{key:"consistenza.unitaMisura",value:""},{key:"consistenza.quantita",value:""}]},{key:"supporto",value:"in carta"}]}}]},_t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.onInit=function(e){var t=e.configuration,a=e.mainState,n=e.router,i=e.route,o=e.location,r=e.options,s=e.titleService,c=e.communication;this.route=i,this.communication=c,this.configuration=t,this.mainState=a,this.options=r,this.router=n,this.location=o,this.titleService=s,this.mainState.update("headTitle","Arianna4View - Mappa"),this.one("aw-scheda-inner-title").update({title:{main:{text:"1.252 Oggetti culturali collegati a Firenze"}}}),this.one("aw-linked-objects").updateOptions({context:"map",config:this.configuration,page:1,size:10}),this.one("aw-linked-objects").update(kt)},t}(u.LayoutDataSource),It=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-map-layout.init":e.dataSource.onInit(n),e.configuration=n.configuration,e.route=n.route;break;case"aw-map-layout.destroy":e.destroyed$.next()}}))},t}(l.EventHandler),Ct={layoutId:"aw-map-layout",widgets:[{id:"aw-map",hasStaticData:!0},{id:"aw-scheda-inner-title"},{id:"aw-linked-objects"}],layoutDS:_t,layoutEH:It,widgetsDataSources:Ue,widgetsEventHandlers:ut,options:{}},Et=function(e){function n(t,a,n,i,o,r,s,c){var l=e.call(this,o.get("AwMapLayoutConfig")||Ct)||this;return l.router=t,l.route=a,l.location=n,l.configuration=i,l.layoutsConfiguration=o,l.communication=r,l.mainState=s,l.titleService=c,l}return m(n,e),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:a.Location},{type:C},{type:E},{type:T},{type:x},{type:c.Title}]},n=v([t.Component({selector:"aw-map-layout",template:'<div class="aw-map"\n     id="map-layout"\n     *ngIf="lb.dataSource">\n     <n7-inner-title [data]="{\n               title: {\n                    main: {\n                         text: \'I luoghi dell\\\'archivio\'\n                    }\n               }\n          }">\n     </n7-inner-title>\n     <n7-map [data]="lb.widgets[\'aw-map\'].ds.out$ | async">\n     </n7-map>\n     \x3c!-- RESULT LIST --\x3e\n     <ng-container *ngIf="lb.widgets[\'aw-scheda-inner-title\'].ds.out$ | async">\n          <n7-inner-title\n               [data]="lb.widgets[\'aw-scheda-inner-title\'].ds.out$ | async">\n          </n7-inner-title>\n     </ng-container>\n     \n     <ng-container *ngIf="lb.widgets[\'aw-linked-objects\'].ds.out$ | async">\n          <div *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n               <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n               </n7-smart-breadcrumbs>\n               <n7-item-preview [data]="preview"\n                                [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n               </n7-item-preview>\n          </div>\n     </ng-container>\n</div>\n'}),w("design:paramtypes",[s.Router,s.ActivatedRoute,a.Location,C,E,T,x,c.Title])],n)}(A),xt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.destroyed$=new o.Subject,a.stickyControlTrigger$=new o.Subject,a.contentParts={},a.sidebarIsSticky=!1,a.treeMaxHeight="100%",a.contentIsLoading=!1,a.currentId=null,a.getTree=function(){return t.tree},a}return m(t,e),t.prototype.onInit=function(e){var t=e.configuration,a=e.mainState,n=e.router,i=e.options,o=e.titleService,r=e.communication;this.configuration=t,this.mainState=a,this.router=n,this.titleService=o,this.communication=r,this.options=i,this.sidebarCollapsed=!1,this.bubbleChartSectionTitle=this.configuration.get("scheda-layout")["bubble-chart"].title,this.similarItemsSectionTitle=this.configuration.get("scheda-layout")["related-items"].title,this.metadataSectionTitle=this.getMetadataSectionTitle(),this.hasSimilarItems=!1,this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.one("aw-bubble-chart").updateOptions({selectable:!1,simple:!0,config:this.configuration,limit:this.configuration.get("bubble-chart").bubbleLimit}),this.one("aw-chart-tippy").updateOptions({basePath:this.configuration.get("paths").entitaBasePath}),this.emptyLabel=this.configuration.get("scheda-layout")["empty-label"],this.one("aw-tree").updateOptions({config:this.configuration.get("config-keys")}),this.mainState.update("headTitle","Arianna4View - Patrimonio"),this.mainState.update("pageTitle","Arianna4View - Patrimonio"),this.mainState.updateCustom("currentNav","patrimonio"),this._sidebarStickyControl()},t.prototype.onDestroy=function(){this.destroyed$.next()},t.prototype.getMetadataSectionTitle=function(){return(this.configuration.get("scheda-layout").metadata||{}).title||null},t.prototype.getNavigation=function(e){return t.tree?o.of(t.tree):this.communication.request$("getTree",{onError:function(e){return console.error(e)},params:{treeId:e}})},t.prototype.setTree=function(e){t.tree=e},t.prototype.updateNavigation=function(e){this.one("aw-sidebar-header").update({text:e})},t.prototype.loadItem=function(e){var t=this.configuration.get("scheda-layout")["related-items"]["max-related-items"];return this.communication.request$("getNode",{onError:function(e){return console.error(e)},params:{id:e,maxSimilarItems:t}})},t.prototype.loadContent=function(e){var t=this;if(e){this.hasMetadata=Array.isArray(e.fields)&&e.fields.length,this.hasSimilarItems=Array.isArray(e.relatedItems)&&e.relatedItems.length,this.hasBreadcrumb=Array.isArray(e.breadcrumbs)&&e.breadcrumbs.length,this.hasBubbles=Array.isArray(e.relatedEntities)&&e.relatedEntities.length,this.hasImage=!!e.image,this.contentParts=[];var a={content:null};if(e.text&&(a.content=e.text),this.contentParts.push(a),e.images){var n=this.getWidgetDataSource("aw-scheda-image");n.hasInstance()?n.updateImages(e):this.one("aw-scheda-image").update(e)}var i={icon:e.icon,title:{main:{text:e.title||e.label,classes:"bold"}},tools:e.subTitle,actions:{}};this.one("aw-scheda-inner-title").update(i),this.one("aw-scheda-metadata").update(this.getFields(e));var o={items:[]};e.breadcrumbs&&(e.breadcrumbs.forEach((function(e){o.items.push({label:e.label,anchor:{href:[t.configuration.get("paths").schedaBasePath,e.link+"/",$.slugify(e.label)].join("")}})})),this.one("aw-scheda-breadcrumbs").update(o)),this.mainState.update("headTitle","Arianna4View - Patrimonio - "+(e.title||e.label))}e.relatedItems&&(this.one("aw-linked-objects").updateOptions({context:"scheda",config:this.configuration}),this.one("aw-linked-objects").update(e)),setTimeout((function(){t.stickyControlTrigger$.next()}))},t.prototype.collapseSidebar=function(){this.sidebarCollapsed=!this.sidebarCollapsed},t.prototype._sidebarStickyControl=function(){var e=this;if(!$.browserIsIE()){var t=o.fromEvent(window,"scroll");o.merge(t,this.stickyControlTrigger$).pipe(r.takeUntil(this.destroyed$)).subscribe((function(){var t=window.pageYOffset,a=window.scrollY+window.innerHeight,n=document.getElementsByClassName("sticky-parent")[0],i=n.offsetTop,o=i+n.clientHeight;e.sidebarIsSticky=i<=t,e.sidebarIsSticky&&a<o?e.treeMaxHeight=a-t-50+"px":e.sidebarIsSticky&&a>=o?e.treeMaxHeight=o-t-50+"px":e.treeMaxHeight=a<o?a-i-50+"px":o-i-50+"px"}))}},t.prototype.getFields=function(e){var t=e.fields,a=e.document_type,n=this.configuration.get("paths"),i=this.configuration.get("labels"),o=p.get(this.configuration.get("scheda-layout"),"metadata-to-show",{});return o=o[a]||[],_e({fields:t,paths:n,labels:i,metadataToShow:o,type:a})},t.tree=null,t}(u.LayoutDataSource),Pt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-scheda-layout.init":e.dataSource.onInit(n),e.configuration=n.configuration,e.route=n.route;var i=e.route.snapshot.params.id||"";i&&(e.dataSource.currentId=i),e.listenRoute(),e.loadNavigation(i),e.emitOuter("viewleaf");break;case"aw-scheda-layout.destroy":e.destroyed$.next(),e.dataSource.onDestroy()}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-bubble-chart.d3end":e.emitOuter("d3end",n);break;case"aw-sidebar-header.click":e.dataSource.collapseSidebar();break;case"aw-bubble-chart.bubble-tooltip-goto-click":var i=n.id,o=n.label;e.emitGlobal("navigate",{handler:"router",path:[e.configuration.get("paths").entitaBasePath,i,$.slugify(o),"overview"]})}}))},t.prototype.listenRoute=function(){var e=this;this.route.paramMap.subscribe((function(t){var a=t.get("id");a&&(a&&(e.dataSource.currentId=a,e.emitOuter("routechanged",a)),e.dataSource.contentIsLoading=!0,e.dataSource.loadItem(a).subscribe((function(t){e.dataSource.contentIsLoading=!1,t&&(e.dataSource.loadContent(t),Array.isArray(t.relatedEntities)&&t.relatedEntities.length&&e.dataSource.bubblesEnabled&&(t.relatedEntities.forEach((function(e){e.entity.relationName=t.label.length>30?t.label.substr(0,30)+"... ":t.label})),e.emitOuter("filterbubbleresponse",t.relatedEntities)))})))}))},t.prototype.loadNavigation=function(e){var t=this;this.dataSource.updateNavigation("Loading..."),this.dataSource.getNavigation("patrimonio").subscribe((function(a){a&&(t.dataSource.setTree(a),t.dataSource.updateNavigation(t.dataSource.getTree().label),t.emitOuter("navigationresponse",{tree:t.dataSource.getTree(),currentItem:e,basePath:t.configuration.get("paths").schedaBasePath}))}))},t}(l.EventHandler),Dt={layoutId:"aw-scheda-layout",widgets:[{id:"aw-sidebar-header"},{id:"aw-tree"},{id:"aw-scheda-breadcrumbs"},{id:"aw-scheda-metadata"},{id:"aw-scheda-image"},{id:"aw-scheda-inner-title"},{id:"aw-bubble-chart"},{id:"aw-chart-tippy"},{id:"aw-linked-objects"}],layoutDS:xt,layoutEH:Pt,widgetsDataSources:Ue,widgetsEventHandlers:ut,options:{}},Tt=function(e){function a(t,a,n,i,o,r,s){var c=e.call(this,i.get("AwPatrimonioLayoutConfig")||Dt)||this;return c.router=t,c.route=a,c.configuration=n,c.layoutsConfiguration=i,c.mainState=o,c.titleService=r,c.communication=s,c}return m(a,e),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:C},{type:E},{type:x},{type:c.Title},{type:T}]},a=v([t.Component({selector:"aw-scheda-layout",template:'<div class="aw-scheda"\n     id="scheda-layout">\n    <div class="aw-scheda__content n7-side-auto-padding sticky-parent"\n         [ngClass]="{ \'is-collapsed\' : lb.dataSource.sidebarCollapsed }">\n        \x3c!-- Left sidebar: tree --\x3e\n        <div class="aw-scheda__tree sticky-target"\n             [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <n7-sidebar-header [data]="lb.widgets[\'aw-sidebar-header\'].ds.out$ | async"\n                               [emit]="lb.widgets[\'aw-sidebar-header\'].emit"></n7-sidebar-header>\n            <div class="aw-scheda__tree-content-loading"\n                 *ngIf="!(lb.widgets[\'aw-tree\'].ds.out$ | async)">\n                <n7-content-placeholder *ngFor="let n of [0,1,2,3]"\n                                        [data]="{\n                    blocks: [{\n                        classes: \'tree-placeholder-item\'\n                    }]\n                }"></n7-content-placeholder>\n            </div>\n            <div class="aw-scheda__tree-content"\n                 (click)="lb.eventHandler.emitOuter(\'treeposition\', $event)"\n                 [ngStyle]="{\n                    \'max-height\': lb.dataSource.treeMaxHeight,\n                    \'overflow\': \'auto\'\n                }">\n                <n7-tree [data]="lb.widgets[\'aw-tree\'].ds.out$ | async"\n                         [emit]="lb.widgets[\'aw-tree\'].emit"\n                         *ngIf="!lb.dataSource.sidebarCollapsed">\n                </n7-tree>\n            </div>\n        </div>\n\n        \x3c!-- Scheda details --\x3e\n        <div class="aw-scheda__scheda-wrapper-loading"\n             [hidden]="!lb.dataSource.contentIsLoading">\n            \x3c!--\n                <n7-content-placeholder [data]="{\n                blocks: [{\n                    classes: \'content-placeholder-title\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }]\n            }"></n7-content-placeholder>\n            --\x3e\n        </div>\n        <div class="aw-scheda__scheda-wrapper"\n             [hidden]="lb.dataSource.contentIsLoading">\n            <n7-smart-breadcrumbs *ngIf="lb.dataSource.hasBreadcrumb"\n                                  [data]="lb.widgets[\'aw-scheda-breadcrumbs\'].ds.out$ | async"\n                                  [emit]="lb.widgets[\'aw-scheda-breadcrumbs\'].emit">\n            </n7-smart-breadcrumbs>\n\n            <div *ngIf="!lb.dataSource.hasBreadcrumb"\n                 class="aw-scheda__fake-breadcrumbs">\n            </div>\n\n            <div *ngIf="!lb.dataSource.currentId"\n                 class="aw-scheda__intro-text"\n                 [innerHTML]="lb.dataSource.emptyLabel">\n            </div>\n\n            <n7-inner-title [data]="lb.widgets[\'aw-scheda-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n\n            <section class="aw-scheda__section aw-scheda__image-viewer"\n                     [hidden]="!lb.dataSource.hasImage">\n                <n7-image-viewer [data]="lb.widgets[\'aw-scheda-image\'].ds.out$ | async">\n                </n7-image-viewer>\n            </section>\n\n            <section class="aw-scheda__section aw-scheda__description"\n                     *ngIf="lb.dataSource.contentParts.content">\n                <div *ngFor="let part of lb.dataSource.contentParts">\n                    <div [innerHTML]="part.content"></div>\n                </div>\n            </section>\n\n            <section class="aw-scheda__section aw-scheda__metadata"\n            *ngIf="lb.dataSource.hasMetadata">\n                <div class="aw-scheda__inner-title"\n                *ngIf="lb.dataSource.metadataSectionTitle"> \n                    {{lb.dataSource.metadataSectionTitle}}\n                </div>\n                <n7-metadata-viewer [data]="lb.widgets[\'aw-scheda-metadata\'].ds.out$ | async">\n                </n7-metadata-viewer>\n            </section>\n\n            <section class="aw-scheda__section aw-scheda__bubble-chart"\n                     *ngIf="lb.dataSource.bubblesEnabled && lb.dataSource.hasBubbles">\n                <div *ngIf="lb.dataSource.hasBubbles"\n                     class="aw-scheda__inner-title">\n                    {{lb.dataSource.bubbleChartSectionTitle}}\n                </div>\n                <aw-bubble-chart-wrapper>\n                    <aw-chart-tippy [data]="lb.widgets[\'aw-chart-tippy\'].ds.out$ | async"\n                                    [emit]="lb.widgets[\'aw-chart-tippy\'].emit">\n                    </aw-chart-tippy>\n                    <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                                     [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                    </n7-bubble-chart>\n                </aw-bubble-chart-wrapper>\n            </section>\n\n            <section *ngIf="lb.dataSource.hasSimilarItems && lb.dataSource.hasBubbles"\n                     id="related-item-container"\n                     class="aw-scheda__section aw-scheda__related">\n                <div class="aw-scheda__inner-title">\n                    {{lb.dataSource.similarItemsSectionTitle}}\n                </div>\n                <div class="aw-scheda__related-items n7-grid-2">\n                    <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <n7-item-preview [data]="preview"\n                                         [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                        </n7-item-preview>\n                    </ng-container>\n                </div>\n            </section>\n        </div>\n    </div>\n</div>\n'}),w("design:paramtypes",[s.Router,s.ActivatedRoute,C,E,x,c.Title,T])],a)}(A),At={totalCount:0,facets:[{id:"query",type:"value"},{id:"query-all",type:"value",hasStaticData:!0,data:[{value:"1",label:"Cerca in tutti campi delle schede"}]},{id:"query-links",type:"value"},{id:"entity-types",type:"value",operator:"OR",limit:10,order:"count"},{id:"entity-search",type:"value"},{id:"entity-links",type:"value",searchData:["entity-type"]}],fields:[{inputs:[{type:"text",facetId:"query",placeholder:"Cerca nei titoli delle schede",filterConfig:{delay:500,minChars:3,searchIn:[{key:"label.ngrams",operator:"LIKE"}]}},{type:"checkbox",facetId:"query-all",filterConfig:{searchIn:[{key:"label.ngrams^5,text^4,fields.*^3",operator:"="}]}},{type:"link",facetId:"query-links",filterConfig:{isArray:!0,searchIn:[{key:"source.entityType",operator:"="}]}}]},{header:{label:"Relazione con",classes:"related-class"},inputs:[{type:"checkbox",facetId:"entity-types",filterConfig:{isArray:!0,context:"internal",target:"entity-links",searchIn:[{key:"searchData.entity-type",operator:"="}]}},{type:"text",facetId:"entity-search",placeholder:"Cerca entità",filterConfig:{delay:500,minChars:3,context:"internal",target:"entity-links",searchIn:[{key:"label",operator:"LIKE"}]}},{type:"link",facetId:"entity-links",emptyState:{label:"La tua ricerca non ha dato risultati, prova a cambiare i filtri"},filterConfig:{isArray:!0,limit:20,searchIn:[{key:"relatedEntities.id",operator:"="}]}}]}],results:{order:{type:"text",key:"label_sort",direction:"ASC"},fields:[{id:"description",highlight:!0,limit:200}]},page:{offset:0,limit:10}},Ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t.resetButtonEnabled=!0,t.currentPage=1,t.pageSize=10,t.sidebarIsSticky=!1,t.isFirstLoading=!0,t.resultsLoading=!1,t.isSearchingText=new o.BehaviorSubject(!1),t.orderBy="label_sort",t.orderDirection="ASC",t.orderByLabel="Ordina per",t.orderByOptions=[{value:"_score_DESC",label:"Ordine per pertinenza",type:"score",selected:!1},{value:"label_sort_ASC",label:"Ordine alfabetico (A→Z)",type:"text",selected:!0},{value:"label_sort_DESC",label:"Ordine alfabetico (Z→A)",type:"text",selected:!1}],t.drawPagination=function(){var e=t._getPaginationParams(),a=e.href,n=e.queryParams;t.one("n7-smart-pagination").updateOptions({mode:"href",href:a,queryParams:n}),t.one("n7-smart-pagination").update({totalPages:Math.ceil(t.totalCount/t.pageSize),currentPage:t.currentPage,pageLimit:5,sizes:{list:[10,25,50],active:t.pageSize}})},t.getSearchModelId=function(){return"aw-search-layout"},t}return m(t,e),t.prototype.onInit=function(e){var t=e.configuration,a=e.mainState,n=e.options,i=e.communication,o=e.search;this.configuration=t,this.mainState=a,this.communication=i,this.search=o,this.options=n,this.prettifyLabels=this.configuration.get("labels"),this.configKeys=this.configuration.get("config-keys"),this.fallback=this.configuration.get("search-layout").fallback,this.pageTitle=this.configuration.get("search-layout").title,this.search.model("aw-search-layout")&&this.search.remove("aw-search-layout"),this.search.add("aw-search-layout",p.cloneDeep(At)),this.searchModel=this.search.model("aw-search-layout"),V.queryParams&&(this.searchModel.updateFiltersFromQueryParams(V.queryParams),V.queryParams=null),this._sidebarStickyControl(),this.mainState.updateCustom("currentNav","ricerca"),this.mainState.update("headTitle","Arianna4View - Ricerca")},t.prototype.onDestroy=function(){this.destroyed$.next(),V.queryParams=null},t.prototype.onSearchResponse=function(){this.resetButtonEnabled=!0,this.isFirstLoading&&(this.isFirstLoading=!1,this.one("facets-wrapper").update({searchModel:this.searchModel}),this.searchModel.updateInputsFromFilters())},t.prototype.onOrderByChange=function(e){var t=e.substring(0,e.lastIndexOf("_")),a=e.substring(e.lastIndexOf("_")+1),n="";this.orderByOptions.forEach((function(t){t.value===e?(t.selected=!0,n=t.type):t.selected=!1})),this.orderBy=t,this.orderDirection=a,this.searchModel.setSearchConfigOrderBy(t),this.searchModel.setSearchConfigDirection(a),this.searchModel.setSearchConfigType(n)},t.prototype.onPageSizeChange=function(e){return this.pageSize=e,this._updateSearchPage(this.currentPage)},t.prototype.onPaginationChange=function(e){var t=e.replace("page-","");return this._updateSearchPage(t)},t.prototype.onPaginationGoToChange=function(e){var t=e.replace("goto-","");return this._updateSearchPage(t)},t.prototype.resetPagination=function(){this._updateSearchPage(1)},t.prototype.onResultsLimitChange=function(e){this.setLimit(e),this.currentPage=1,this.searchModel.setPageConfigOffset(0)},t.prototype.setLimit=function(e){this.pageSize=e,this.searchModel.setPageConfigLimit(e),this.searchModel.setPageConfigOffset((this.currentPage-1)*this.pageSize)},t.prototype.doSearchRequest$=function(){var e=this,t=this.searchModel.getRequestParams(),a={searchParameters:b({totalCount:100},t)};return this.communication.request$("search",{onError:function(e){return console.error(e)},params:a}).pipe(r.tap((function(t){var a=t.totalCount,n=t.results,i=t.facets;e.totalCount=a;var o=0;e.totalCount>1?o=2:1===e.totalCount&&(o=1),e.resultsTitle=e.configuration.get("search-layout").results[o],e._addFacetsLabels(i),e._addFacetsOptions(i),e.searchModel.updateFacets(i),e.searchModel.updateTotalCount(a),e.one("aw-linked-objects").updateOptions({context:"search",config:e.configuration,page:e.currentPage,pagination:!0,paginationParams:e._getPaginationParams(),dynamicPagination:{total:a},size:e.pageSize}),e.drawPagination(),e.one("aw-linked-objects").update({items:e._normalizeItems(n.items)})})))},t.prototype._updateSearchPage=function(e){if(+e===this.currentPage)return o.of(!1);this.currentPage=+e;var t=this.searchModel.getConfig().page.limit,a=(this.currentPage-1)*t;return this.searchModel.setPageConfigOffset(a),o.of(!0)},t.prototype._addFacetsLabels=function(e){var t=this;e.filter((function(e){return Array.isArray(e.data)})).forEach((function(e){e.data.forEach((function(e){var a=e.label;e.label=$.prettifySnakeCase(a,t.prettifyLabels[a])}))}))},t.prototype._addFacetsOptions=function(e){var t=this;e.filter((function(e){return"query-links"===e.id})).forEach((function(e){e.data.forEach((function(e){var a=t.configKeys[e.value];a&&(e.options={icon:a.icon,classes:"color-"+a["class-name"]})}))}))},t.prototype._normalizeItems=function(e){return e.map((function(e){return{item:b({},e)}}))},t.prototype._sidebarStickyControl=function(){var e=this;$.browserIsIE()||o.fromEvent(window,"scroll").pipe(r.takeUntil(this.destroyed$)).subscribe((function(){var t=window.pageYOffset,a=document.getElementsByClassName("sticky-parent")[0],n=a?a.offsetTop:0;e.sidebarIsSticky=n<=t}))},t.prototype._getPaginationParams=function(){var e=this.searchModel.getRequestParams(),t=this.searchModel.filtersAsQueryParams(e.filters);return Object.keys(t).forEach((function(e){t[e]=t[e]||null})),t.orderby=this.orderBy,t.orderdirection=this.orderDirection,t.page=this.currentPage,t.limit=this.pageSize,{queryParams:t,href:this.configuration.get("paths").searchBasePath}},t}(u.LayoutDataSource),Ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t.facetsChange$=new o.Subject,t.additionalParamsChange$=new o.Subject,t.previousText="",t.textHasChanged=!1,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"aw-search-layout.init":e.route=n.route,e.configuration=n.configuration,e.dataSource.onInit(n),e._listenToFacetsChange(),e._listenToAdditionalParamsChange(),e._listenToRouterChanges(),(e.dataSource.searchModel.getFiltersByFacetId("query")[0].value||"").length>0&&(e.dataSource.isSearchingText.next(!0),setTimeout((function(){e.dataSource.onOrderByChange("_score_DESC"),e.additionalParamsChange$.next()}),100));break;case"aw-search-layout.destroy":e.dataSource.onDestroy(),e.destroyed$.next();break;case"aw-search-layout.orderbychange":e.dataSource.onOrderByChange(n),e.additionalParamsChange$.next();break;case"aw-search-layout.searchreset":e.dataSource.resetButtonEnabled=!1,e.dataSource.searchModel.clear(),e.additionalParamsChange$.next();break;default:console.warn("(search) unhandled inner event of type",a)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"facets-wrapper.facetschange":e.dataSource.resetPagination();var i=e.dataSource.searchModel.getFiltersByFacetId("query")[0].value;e.textHasChanged=!(!i||i===e.previousText),e.previousText=i;var o=e.dataSource.orderByOptions.filter((function(e){return e.selected}))[0].value;e.textHasChanged&&(i||"").length>0?e.dataSource.isSearchingText.next(!0):0===(i||"").length&&/score/i.test(o)&&(e.dataSource.isSearchingText.next(!1),setTimeout((function(){e.dataSource.onOrderByChange("label_sort_ASC"),e.additionalParamsChange$.next()}),100));break;case"n7-smart-pagination.change":e.dataSource.onResultsLimitChange(n.value),e.additionalParamsChange$.next()}}))},t.prototype._listenToFacetsChange=function(){var e=this;this.facetsChange$.pipe(r.debounceTime(500)).subscribe((function(){e.dataSource.resultsLoading=!0,e.textHasChanged?(e.additionalParamsChange$.next(),e.textHasChanged=!1):e.dataSource.doSearchRequest$().subscribe((function(){e.dataSource.resultsLoading=!1,e.dataSource.onSearchResponse(),e.emitGlobal("searchresponse",e.dataSource.getSearchModelId())}))}))},t.prototype._listenToAdditionalParamsChange=function(){var e=this;this.additionalParamsChange$.subscribe((function(){var t=e.dataSource.searchModel,a=t.getRequestParams(),n=t.filtersAsQueryParams(a.filters);Object.keys(n).forEach((function(e){n[e]=n[e]||null})),n.orderby=e.dataSource.orderBy,n.orderdirection=e.dataSource.orderDirection,n.page=e.dataSource.currentPage,n.limit=e.dataSource.pageSize,e.textHasChanged&&(n.orderby="_score",n.orderdirection="DESC"),e.emitGlobal("navigate",{handler:"router",path:[],queryParams:n})}))},t.prototype._listenToRouterChanges=function(){var e=this;this.route.queryParams.pipe(r.takeUntil(this.destroyed$)).subscribe((function(t){e.emitOuter("queryparamschange",t),t.orderby&&t.orderdirection&&e.dataSource.onOrderByChange(t.orderby+"_"+t.orderdirection),t.page&&e.dataSource.onPaginationChange("page-"+t.page),t.limit&&e.dataSource.setLimit(+t.limit),e.facetsChange$.next()}))},t}(l.EventHandler),Lt={layoutId:"aw-search-layout",widgets:[{id:"facets-wrapper",dataSource:X,eventHandler:ie},{id:"aw-linked-objects"},{id:"aw-search-layout-tabs",hasStaticData:!0},{id:"n7-smart-pagination",dataSource:Z,eventHandler:re}],layoutDS:Ot,layoutEH:Ft,widgetsDataSources:Ue,widgetsEventHandlers:ut,options:{}},Rt=function(e){function a(t,a,n,i,o,r){var s=e.call(this,a.get("AwSearchLayoutConfig")||Lt)||this;return s.configuration=t,s.layoutsConfiguration=a,s.mainState=n,s.communication=i,s.search=o,s.route=r,s}return m(a,e),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,communication:this.communication,search:this.search,route:this.route,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.ctorParameters=function(){return[{type:C},{type:E},{type:x},{type:T},{type:V},{type:s.ActivatedRoute}]},a=v([t.Component({selector:"aw-search-layout",template:'<div class="aw-search n7-side-auto-padding"\n     id="search-layout">\n    <div class="aw-search__header">\n        <div class="aw-search__header-left">\n            <h1 class="aw-search__header-title">{{ lb.dataSource.pageTitle }}</h1>\n        </div>\n        \x3c!--\n        <div class="aw-search__header-right">\n            <n7-nav\n                [data]="lb.widgets[\'aw-search-layout-tabs\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-search-layout-tabs\'].emit">\n            </n7-nav>\n        </div>\n        --\x3e\n    </div>\n    <div class="aw-search__content-wrapper sticky-parent">\n        \x3c!-- Left sidebar: facets --\x3e\n        <div *ngIf="!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)"\n             class="aw-search__sidebar-loading sticky-target">\n            <div class="aw-search__facets-loading">\n                <n7-content-placeholder [data]="{\n                    blocks: [{\n                        classes: \'search-placeholder-facet-input\'\n                    }, {\n                        classes: \'search-placeholder-facet-check\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }]\n                }">\n                </n7-content-placeholder>\n            </div>\n        </div>\n        <div *ngIf="!!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)"\n             class="aw-search__sidebar sticky-target"\n             [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <div class="aw-search__facets">\n                <n7-facets-wrapper [data]="lb.widgets[\'facets-wrapper\'].ds.out$ | async"\n                                   [emit]="lb.widgets[\'facets-wrapper\'].emit">\n                </n7-facets-wrapper>\n            </div>\n        </div>\n        <div class="aw-search__content">\n            <div class="aw-search__results-header">\n                <div class="aw-search__results-header-left">\n                    <h3 *ngIf="!lb.dataSource.resultsLoading"\n                        class="aw-search__total">\n                        <span class="aw-search__total-number">{{ lb.dataSource.totalCount }}</span>&nbsp;\n                        <span class="aw-search__total-title">{{ lb.dataSource.resultsTitle }}</span>\n                    </h3>\n                </div>\n                <div class="aw-search__results-header-right">\n                    <label class="aw-search__results-select-orderby-label"\n                           for="aw-search__results-select-orderby">{{ lb.dataSource.orderByLabel }}</label>\n                    <select (change)="lb.eventHandler.emitInner(\'orderbychange\', $event.target.value)"\n                            id="aw-search__results-select-orderby">\n                        <option *ngFor="let option of lb.dataSource.orderByOptions"\n                                [value]="option.value"\n                                [selected]="option.selected"\n                                [hidden]="option.type === \'score\' && lb.dataSource.isSearchingText.value === false">\n                            {{ option.label }}</option>\n                    </select>\n                </div>\n            </div>\n            \x3c!-- Search details --\x3e\n            <div *ngIf="lb.dataSource.resultsLoading"\n                 class="aw-search__results-wrapper-loading">\n                <n7-content-placeholder *ngFor="let n of [0,1,2,3,4,5,6,7,8,9]"\n                                        [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n            </div>\n            <div *ngIf="!lb.dataSource.resultsLoading"\n                 class="aw-search__results-wrapper">\n                <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                    <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                    </n7-smart-breadcrumbs>\n                    <n7-item-preview [data]="preview"\n                                     [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                    </n7-item-preview>\n                </ng-container>\n                <ng-container *ngIf="lb.dataSource.totalCount == 0">\n                    <div class="aw-search__fallback">\n                        <p class="aw-search__fallback-string">\n                            {{ lb.dataSource.fallback }}\n                        </p>\n                        <button [disabled]="!lb.dataSource.resetButtonEnabled"\n                                class="n7-btn aw-search__fallback-button"\n                                (click)="lb.eventHandler.emitInner(\'searchreset\', {})">\n                            Resetta la ricerca\n                        </button>\n                    </div>\n                </ng-container>\n                <n7-smart-pagination *ngIf="lb.dataSource.totalCount > 10"\n                                     [data]="lb.widgets[\'n7-smart-pagination\'].ds.out$ | async"\n                                     [emit]="lb.widgets[\'n7-smart-pagination\'].emit">\n                </n7-smart-pagination>\n            </div>\n        </div>\n    </div>\n</div>\n'}),w("design:paramtypes",[C,E,x,T,V,s.ActivatedRoute])],a)}(A),Mt=function(){function e(){}return e.prototype.onClick=function(e,t){this.emit(e,t)},v([t.Input(),w("design:type",Object)],e.prototype,"data",void 0),v([t.Input(),w("design:type",Object)],e.prototype,"emit",void 0),v([t.Input(),w("design:type",Object)],e.prototype,"anchorData",void 0),e=v([t.Component({selector:"aw-chart-tippy",template:'<div *ngIf="data" style="display: none;">\n  <div *ngFor="let d of data" id="template__{{d.id}}" class="bubble-chart__tippy-template">\n    <div id="bubble-popup-menu" class="aw-bubble-popup-menu">\n      <h2 class="aw-bubble-popup-menu__title">{{ d.title }}</h2>\n      <p class="aw-bubble-popup-menu__text">\n        {{ d.text }}\n      </p>\n\n      <div *ngIf="d.relation.value" class="aw-bubble-popup-menu__relation">\n        <p class="aw-bubble-popup-menu__relation-description">Relazione con \n          <span class="aw-bubble-popup-menu__relation-key">{{d.relation.key}}</span>: \n          <span class="aw-bubble-popup-menu__relation-label"> {{d.relation.value}}</span>\n        </p>\n      </div>\n\n      <div class="aw-bubble-popup-menu__actions">\n        <n7-anchor-wrapper [classes]="\'aw-bubble-popup-menu__link\'" [data]="d.anchorData">\n          Vai alla scheda\n        </n7-anchor-wrapper>\n        <span *ngIf="d.selectable" class="aw-bubble-popup-menu__link" (click)="onClick(\'select\', {id: d.id})">\n          {{ d.isSelected ? \'Deseleziona\' : \'Seleziona\'}}\n        </span>\n      </div>\n    </div>\n  </div>\n</div>'})],e)}(),$t=function(){function e(){}return e.prototype.onClick=function(e,t){this.emit(e,t)},v([t.Input(),w("design:type",Object)],e.prototype,"emit",void 0),v([t.Input(),w("design:type",String)],e.prototype,"container",void 0),v([t.Input(),w("design:type",Object)],e.prototype,"buttons",void 0),e=v([t.Component({selector:"aw-bubble-chart-wrapper",template:'<div class="aw-bubble-chart-wrapper">\n    <ng-content></ng-content>\n</div>'})],e)}(),zt=function(){function e(){var e=this;this.tippyBuilder=function(e,t){return g(e,{content:t,interactive:!0,arrow:!0,theme:"light-border no-padding",appendTo:document.body})},this.getWidths=function(t,a){var n=t.nativeElement.clientWidth,i=a.nativeElement.clientWidth;return{parentWidth:n-e.getSidePadding(t.nativeElement),childWidth:i}},this.getSidePadding=function(e){return+window.getComputedStyle(e,null).getPropertyValue("padding-left").match(/\d+/)[0]+ +window.getComputedStyle(e,null).getPropertyValue("padding-right").match(/\d+/)[0]}}return e.prototype.ngAfterViewInit=function(){var e;if(this.bcdiv&&this.bcol){var t=this.getWidths(this.bcdiv,this.bcol),a=t.parentWidth,n=t.childWidth,i=this.bcol.nativeElement.children;if(a===n)for(var o=1;a===n&&o<i.length-1;){var r=document.createElement("ol");r.className="n7-smart-breadcrumbs__tippy-content",r.appendChild(i[o].cloneNode(!0)),i[o].children[0].innerText="…",i[o].className="n7-breadcrumbs__item-ellipsis",this.tippyBuilder(i[o],r),o+=1,a=(e=this.getWidths(this.bcdiv,this.bcol)).parentWidth,n=e.childWidth}}},e.prototype.onClick=function(e){this.emit&&this.emit("click",e)},v([t.Input(),w("design:type",Object)],e.prototype,"data",void 0),v([t.Input(),w("design:type",Object)],e.prototype,"emit",void 0),v([t.ViewChild("bcol",{read:t.ElementRef}),w("design:type",t.ElementRef)],e.prototype,"bcol",void 0),v([t.ViewChild("bcdiv",{read:t.ElementRef}),w("design:type",t.ElementRef)],e.prototype,"bcdiv",void 0),e=v([t.Component({selector:"n7-smart-breadcrumbs",template:'<div *ngIf="data" class="n7-breadcrumbs {{ data.classes || \'\' }}" #bcdiv>\n    <nav class="n7-breadcrumbs__nav">\n        <ol class="n7-breadcrumbs__list" #bcol>\n            <li *ngFor="let item of data.items" class="n7-breadcrumbs__item {{ item.classes || \'\' }}">\n                <n7-anchor-wrapper [classes]="item.classes"\n                [data]="item.anchor"\n                (clicked)="onClick($event)">\n                    {{ item.label }}\n                </n7-anchor-wrapper>\n            </li>\n        </ol>\n    </nav>\n</div>'})],e)}(),Ht={getLastPosts:{queryName:"getLastPosts",queryBody:"\n        {\n          getLastPosts(__PARAMS__) {\n            id\n            title\n          }\n        }\n      "},getTree:{queryName:"getTreeOfItems",queryBody:"\n      {\n        getTreeOfItems{\n          label\n          id\n          img\n          document_type\n          document_classification\n          branches {\n            label\n            id\n            img\n            document_type\n            document_classification\n            branches {\n              label\n              id\n              img\n              document_type\n              document_classification\n              branches {\n                label\n                id\n                img\n                document_type\n                document_classification\n                branches {\n                  label\n                  id\n                  img\n                  document_type\n                  document_classification\n                  branches {\n                    label\n                    id\n                    img\n                    document_type\n                    document_classification\n                    branches {\n                      label\n                      id\n                      img\n                      document_type\n                      document_classification\n                      branches {\n                        label\n                        id\n                        img\n                        document_type\n                        document_classification\n                        branches {\n                          label\n                          id\n                          img\n                          document_type\n                          document_classification\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      "},globalFilter:{queryName:"globalFilter",queryBody:"{\n        globalFilter(__PARAMS__){\n          entitiesData {\n            entity {\n                id\n                label\n                typeOfEntity\n            } count\n          }\n          typeOfEntityData {\n            type\n            count\n          }\n          itemsPagination {\n            totalCount\n            items {\n              thumbnail\n              item {\n                id\n                label\n                fields\n                {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                }\n                breadcrumbs {\n                  label\n                  link\n                }\n                relatedTypesOfEntity {\n                  type\n                  count\n                }\n              }\n            }\n          }\n        }\n        }"},getEntityDetails:{queryName:"getEntity",queryBody:"{\n        getEntity(__PARAMS__){\n          overviewTab\n          label\n          id\n          typeOfEntity\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on\n            KeyValueFieldGroup {\n              label\n              fields\n              {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n          extraTab\n          wikiTab {\n            text\n            url\n          }\n          relatedItems {\n            thumbnail\n            relation\n            item {\n              label\n              id\n              fields\n              {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n              breadcrumbs {\n                label\n                link\n              }\n            }\n            relatedTypesOfEntity {\n              type\n              count\n            }\n          }\n          relatedEntities {\n            entity {\n                id\n                label\n                typeOfEntity\n            }\n            count\n          }\n        }\n      }\n      "},getItem:{queryName:"getItem",queryBody:"{\n        getItem(__PARAMS__) {\n          id\n          label\n          icon\n          title\n          subTitle\n          image\n          text\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on KeyValueFieldGroup {\n              label\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n          relatedEntities {\n            count\n            entity{\n              id\n              label\n              typeOfEntity\n            }\n          }\n          relatedItems {\n            thumbnail\n            item {\n              label\n              id\n              relatedTypesOfEntity {\n                type\n                count\n              }\n            }\n          }\n          breadcrumbs {\n            label\n            link\n          }\n        }\n      }"},getNode:{queryName:"getNode",queryBody:"{\n        getNode(__PARAMS__) {\n          ... on Item {\n            id\n            label\n            title\n            subTitle\n            image\n            images\n            text\n            document_type\n            fields {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n              ... on KeyValueFieldGroup {\n                label\n                fields {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                }\n              }\n            }\n            relatedEntities {\n                count\n                entity{\n                  id\n                  label\n                  typeOfEntity\n                  relation\n                }\n            }\n            relatedItems {\n                thumbnail\n                item {\n                  label\n                  id\n                  fields {\n                    ...\n                    on KeyValueField {\n                      key\n                      value\n                    }\n                    ... on KeyValueFieldGroup {\n                      label\n                      fields {\n                        ...\n                        on KeyValueField {\n                          key\n                          value\n                        }\n                      }\n                    }\n                  }\n                  relatedTypesOfEntity {\n                    type\n                    count\n                  }\n                }\n              }\n            breadcrumbs {\n              label\n              link\n            }\n          }\n          ... on Node {\n            id\n            label\n            img\n            document_type\n            fields {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n              ... on KeyValueFieldGroup {\n                label\n                fields {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                }\n              }\n            }\n          }\n        }\n      }"},autoComplete:{queryName:"autoComplete",queryBody:"{\n        autoComplete(__PARAMS__){\n          totalCount\n          results {\n            ... on EntityCountData {\n              count\n              entity {\n                id\n                label\n                typeOfEntity\n                fields {\n                  ... on KeyValueField {\n                    key\n                    value\n                  }\n                  ... on KeyValueFieldGroup {\n                    label\n                    fields {\n                      ... on KeyValueField {\n                        key\n                        value\n                      }\n                    }\n                  }\n                }\n              }\n            }\n            ... on ItemListing {\n              item {\n                id\n                label\n                document_type\n                fields {\n                  ... on KeyValueField {\n                    key\n                    value\n                  }\n                  ... on KeyValueFieldGroup {\n                    label\n                    fields {\n                      ... on KeyValueField {\n                        key\n                        value\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }"},search:{queryName:"search",queryBody:"{\n        search(__PARAMS__){\n          totalCount\n          facets {\n            id\n            type\n            operator\n            limit\n            order\n            data {\n              label\n              value\n              counter\n              searchData {\n                key\n                value\n              }\n            }\n          }\n          results {\n            order{\n              type\n              key\n              direction\n            }\n            fields\n            {\n              id\n              highlight\n              limit\n            }\n            items {\n              ... on Entity {\n                id\n                label\n                typeOfEntity\n                fields {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                  ... on KeyValueFieldGroup {\n                    label\n                    fields {\n                      ...\n                      on KeyValueField {\n                        key\n                        value\n                      }\n                    }\n                  }\n                }\n                relatedEntities {\n                    count\n                    entity{\n                      id\n                      label\n                      typeOfEntity\n                    }\n                }\n                relatedItems {\n                    thumbnail\n                    item {\n                      label\n                      id\n                      fields {\n                        ...\n                        on KeyValueField {\n                          key\n                          value\n                        }\n                        ... on KeyValueFieldGroup {\n                          label\n                          fields {\n                            ...\n                            on KeyValueField {\n                              key\n                              value\n                            }\n                          }\n                        }\n                      }\n                  }\n                  relatedTypesOfEntity {\n                    type\n                    count\n                  }\n                }\n              }\n              ... on Item {\n                id\n                label\n                icon\n                title\n                subTitle\n                image\n                text\n                relatedTypesOfEntity {\n                  type\n                  count\n                }\n                breadcrumbs {\n                  label\n                  link\n                }\n                fields {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                  ... on KeyValueFieldGroup {\n                    label\n                    fields {\n                      ...\n                      on KeyValueField {\n                        key\n                        value\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }"},getMissingBubble:{queryName:"getEntity",queryBody:"{\n        getEntity(__PARAMS__){\n          label\n          id\n          typeOfEntity\n        }\n      }"}},jt=[pt,mt,St,Et,Tt,Rt,$t,Mt,zt],qt=function(){function e(e,t){e.donePromise.then((function(){var e=t.get("communication"),a=e.defaultProvider;e.providers[a].config=Ht,t.set("communication",e)}))}return e.ctorParameters=function(){return[{type:t.ApplicationInitStatus},{type:C}]},e=v([t.NgModule({declarations:jt,imports:[a.CommonModule,s.RouterModule,i.DvComponentsLibModule,me],entryComponents:jt,exports:jt}),w("design:paramtypes",[t.ApplicationInitStatus,C])],e)}(),Bt=function(){function e(){}return v([t.Input(),w("design:type",Object)],e.prototype,"data",void 0),e=v([t.Component({selector:"dv-data-widget-wrapper",template:"<div class=\"dv-data-widget-wrapper {{ data && data.classes || '' }}\">\n    <ng-content></ng-content>\n</div>"})],e)}(),Gt=function(){function e(){}return e.prototype.onClick=function(e){this.emit&&this.emit("click",e)},e.prototype.toggleDropDown=function(e){this.emit&&this.emit("toggle",e)},v([t.Input(),w("design:type",Object)],e.prototype,"data",void 0),v([t.Input(),w("design:type",Object)],e.prototype,"emit",void 0),e=v([t.Component({selector:"dv-datepicker-wrapper",template:'<div *ngIf="data" class="dv-datepicker-wrapper {{ data.select.classes || \'\' }}">\n    <div class="dv-datepicker-wrapper__label" (click)="toggleDropDown(data.payload)">\n        <input type="text" [value]="data.select.label" [readOnly]="true"/>\n        <span class="{{data.select.icon}}"></span>\n    </div>\n    <div class="dv-datepicker-wrapper__dropdown" [hidden]="data.select.hidden">\n        <ul class="dv-datepicker-wrapper__dropdown-list">\n            <li class="dv-datepicker-wrapper__dropdown-list-option {{ opt.classes || \'\' }}" *ngFor="let opt of data.select.items" (click)="onClick(opt.payload)">{{opt.text}}</li>\n        </ul>\n    </div>\n    <n7-datepicker\n        [data]="data.datepicker.data"\n        [emit]="emit">\n    </n7-datepicker>\n</div>\n'})],e)}(),Vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Items=[{text:"Last week",payload:"Last week"},{text:"Last month",payload:"Last month"},{text:"Last year",payload:"Last year"},{text:"Select Date",payload:"ByDate"}],t.datepickerOptions={dateFormat:"Y-m-d",mode:"range"},t.datePickerExternalData={select:{id:"dv-select",label:"Last week",items:t.Items},datepicker:{id:"datepicker",libOptions:t.datepickerOptions}},t}return m(t,e),t.prototype.onInit=function(){this.one("dv-datepicker-wrapper").update(this.datePickerExternalData)},t}(u.LayoutDataSource),Nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){t.type,t.payload;e.dataSource.onInit()}))},t}(l.EventHandler),Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return null},t}(l.DataSource),Ut=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._datepicker=null,t}return m(t,e),t.prototype.transform=function(e){var t=this;return e?{select:{id:e.select.id,hidden:!0,icon:e.select.icon||"n7-icon-angle-down",label:e.select.label,items:e.select.items,classes:e.select.classes},datepicker:{hidden:!0,data:{id:e.datepicker.id,libOptions:e.datepicker.libOptions,getInstance:function(e){t._datepicker=e}}}}:null},t.prototype.openDatepicker=function(){var e=this;setTimeout((function(){return e._datepicker.open()})),this.output.select.hidden=!0,this.output.datepicker.hidden=!1},t.prototype.closeDatepicker=function(){var e=this;setTimeout((function(){return e._datepicker.close()})),this.output.select.hidden=!0,this.output.datepicker.hidden=!0},t.prototype.setLabel=function(e){this.output.select.label=e,this.output.datepicker.hidden=!0},t.prototype.toggleDropDown=function(){!1===this.output.select.hidden?this.output.select.hidden=!0:this.output.select.hidden=!1},t}(l.DataSource),Kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(){return{containerId:"test-Chart",libOptions:{chart:{height:550,width:1500,type:"area",toolbar:{show:!0}},dataLabels:{enabled:!1},colors:["rgba(15,200,255)"],fill:{colors:["#0fc8ff"],gradient:{opacityFrom:.5,opacityTo:.1}},stroke:{curve:"straight",width:[2,1]},series:[{name:"Reddish value",data:[["2019-08-01","770.17"],["2019-08-02","645.03"],["2019-08-03","709.32"],["2019-08-04","708.11"],["2019-08-05","706.59"],["2019-08-06","607.28"],["2019-08-07","494.59"],["2019-08-08","636.81"],["2019-08-09","709.04"],["2019-08-10","717.31"],["2019-08-11","805.61"],["2019-08-12","758.60"],["2019-08-13","612.82"],["2019-08-14","608.90"],["2019-08-15","734.68"],["2019-08-16","838.54"],["2019-08-17","692.88"]]}],grid:{borderColor:"#e7e7e7",strokeDashArray:3,xaxis:{lines:{show:!0}}},markers:{size:3,hover:{size:6}},xaxis:{axisBorder:{show:!0,color:"#f4f6fc"},labels:{},type:"datetime",tickAmount:6},yaxis:[{show:!0,showAlways:!1,opposite:!1,reversed:!1,logarithmic:!1,forceNiceScale:!1,floating:!1,labels:{show:!0,minWidth:0,maxWidth:160,offsetX:0,offsetY:0,rotate:0,padding:20,style:{colors:[],fontSize:"11px",cssClass:""}},axisBorder:{show:!0,color:"#f4f6fc",offsetX:0,offsetY:0},axisTicks:{show:!1,color:"#78909C",width:6,offsetX:0,offsetY:0},title:{text:"P Totale °C",rotate:90,offsetY:0,offsetX:0,style:{fontSize:"11px",cssClass:""}},tooltip:{enabled:!1,offsetX:0},crosshairs:{show:!0,position:"front",stroke:{color:"#b6b6b6",width:1,dashArray:0}}}],legend:{show:!0},tooltip:{},annotations:{yaxis:[],xaxis:[],points:[]}}}},t}(l.DataSource),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(){return{title:{main:{text:"Dipendenti",classes:"n7-main-widget-title"},secondary:{text:"Dipendeti al 10/10/10",classes:"n7-secondary-widget-title"}}}},t}(l.DataSource),Yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(){return i.DATA_WIDGET_MOCK},t}(l.DataSource),Xt=Object.freeze({__proto__:null,DvDataWidgetDS:Wt,DvDatepickerWrapperDS:Ut,DvGraphDS:Kt,DvInnerTitleDS:Qt,DvWidgetDS:Yt}),Jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"dv-datepicker-wrapper.click":e.dataSource.setLabel(n),"ByDate"===n?e.dataSource.openDatepicker():e.dataSource.closeDatepicker();break;case"dv-datepicker-wrapper.toggle":e.dataSource.toggleDropDown();break;case"dv-datepicker-wrapper.change":e.dataSource.setLabel(n.dateStr)}}))},t}(l.EventHandler),Zt={layoutId:"dv-example-layout",widgets:[{id:"dv-inner-title",hasStaticData:!0},{id:"dv-widget",hasStaticData:!0},{id:"dv-datepicker-wrapper"},{id:"dv-graph",hasStaticData:!0}],layoutDS:Vt,layoutEH:Nt,widgetsDataSources:Xt,widgetsEventHandlers:Object.freeze({__proto__:null,DvDatepickerWrapperEH:Jt}),options:{}},ea=function(e){function a(){return e.call(this,Zt)||this}return m(a,e),a.prototype.initPayload=function(){return{}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a=v([t.Component({selector:"dv-example-layout",template:'<div class="dv-example-layout" id="example-layout">\n\n    \x3c!-- Data widget wrapper with not-fixed height, two rows --\x3e\n    <dv-data-widget-wrapper>\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-chart\n                    [data]="lb.widgets[\'dv-graph\'].ds.out$ | async">\n                </n7-chart>\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n\n    \x3c!-- Data widget wrapper with fixed height, two rows --\x3e\n    <dv-data-widget-wrapper [data]="{ classes: \'dv-data-widget-wrapper-fixed-height\' }">\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n            <div class="dv-data-widget-wrapper__content-row">\n                Row content\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n\n    \x3c!-- Data widget wrapper with fixed height, one row --\x3e\n    <dv-data-widget-wrapper [data]="{ classes: \'dv-data-widget-wrapper-fixed-height\' }">\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n    \n    <dv-datepicker-wrapper \n        [data]="lb.widgets[\'dv-datepicker-wrapper\'].ds.out$ | async"\n        [emit]="lb.widgets[\'dv-datepicker-wrapper\'].emit">\n    </dv-datepicker-wrapper>\n</div>'}),w("design:paramtypes",[])],a)}(A),ta=[Bt,Gt,ea],aa=function(){function e(){}return e=v([t.NgModule({declarations:ta,imports:[a.CommonModule,i.DvComponentsLibModule,me],providers:[],exports:ta})],e)}(),na=function(){function e(e){this.sanitizer=e}return e.prototype.transform=function(e){return this.sanitizer.bypassSecurityTrustHtml(e)},e.ctorParameters=function(){return[{type:c.DomSanitizer}]},e=v([t.Pipe({name:"keepHtml",pure:!1}),w("design:paramtypes",[c.DomSanitizer])],e)}(),ia=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.onInit=function(){},t}(l.LayoutDataSource),oa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"mr-glossary-layout.init":e.dataSource.onInit(n);break;default:console.warn("unhandled inner event of type",a)}}))},t}(l.EventHandler),ra=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),sa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){var t=this.options,a=t.classes,n=t.background,i=e.text,o=e.image,r=e.title,s=e.button,c=n?o:null;return{text:i,title:r,classes:a,backgroundImage:c,image:c?o:null,button:s?b(b({},s),{anchor:{href:s.anchor}}):null}},t}(l.DataSource),ca=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return{images:e.images,thumbs:e.thumbs,viewerId:this.id,libOptions:{showNavigator:!1,autoHideControls:!1,showRotationControl:!1,showSequenceControl:!0,showHomeControl:!0,showZoomControl:!0,sequenceMode:!0,showReferenceStrip:!0,navigationControlAnchor:"TOP_RIGHT"},_setViewer:function(e){this.viewer=e}}},t}(l.DataSource),la=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){var t=e.title,a=e.subtitle,n=e.button;return{title:{main:{text:t,classes:"bold"},secondary:{text:a,classes:"italic"}},actions:n?{buttons:[{anchor:{href:n.link},text:n.text,classes:"n7-btn-cta"}]}:null}},t}(l.DataSource),ua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),da=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mock={resources:[{image:"https://i.imgur.com/8bNcgR6.png",title:"Unattributed version",text:"A japanese colored version",metadata:[{classes:"metadata",items:[{label:"Artista",value:"Massimo Berruti"},{label:"Tecnica",value:"Fotografia"},{label:"Galleria",value:"Galleria Tonelli"}]}]},{image:"https://i.imgur.com/52UFqca.png",title:"Yudi Shanhai Quantu",text:"Complete Map of all mountains and seas"},{image:"https://i.imgur.com/sLu7u2v.png",title:"Reconstruction of D'Elia's map",text:'A digital collage of the map portions from Pasquale D\'Elia "mappamondo"',metadata:[{classes:"metadata",items:[{label:"Artista",value:"Massimo Berruti"},{label:"Tecnica",value:"Fotografia"},{label:"Galleria",value:"Galleria Tonelli"}]}]},{image:"https://i.imgur.com/8bNcgR6.png",title:"Unattributed version",text:"A japanese colored version"}],collections:[{image:"https://i.imgur.com/8bNcgR6.png",title:"Unattributed version",text:"A japanese colored version"},{image:"https://i.imgur.com/52UFqca.png",title:"Yudi Shanhai Quantu",text:"Complete Map of all mountains and seas"},{image:"https://i.imgur.com/sLu7u2v.png",title:"Reconstruction of D'Elia's map",text:'A digital collage of the map portions from Pasquale D\'Elia "mappamondo"'}],search:[{image:"https://i.imgur.com/52UFqca.png",title:"Yudi Shanhai Quantu",text:"Complete Map of all mountains and seas"},{image:"https://i.imgur.com/52UFqca.png",title:"World Map based on Matteo Ricci 1850",text:"Complete Map fo all mountains and seas"},{image:"",title:"Reconstruction of D'Elia's map",text:'A digital collage of the map portions from Pasquale D\'Elia "mappamondo"'},{image:"",title:"Unattributed version",text:"A japanese colored version"},{image:"",title:"Matteo Ricci's way from Macau to Beijing",text:"A japanese colored version"},{image:"",title:"The 400-year-old map that shows China as the centre of the world",text:"A japanese colored version"},{image:"https://i.imgur.com/52UFqca.png",title:"Yudi Shanhai Quantu",text:"Complete Map of all mountains and seas"},{image:"https://i.imgur.com/52UFqca.png",title:"World Map based on Matteo Ricci 1850",text:"Complete Map fo all mountains and seas"},{image:"",title:"Reconstruction of D'Elia's map",text:'A digital collage of the map portions from Pasquale D\'Elia "mappamondo"'},{image:"",title:"Unattributed version",text:"A japanese colored version"},{image:"",title:"Matteo Ricci's way from Macau to Beijing",text:"A japanese colored version"},{image:"",title:"The 400-year-old map that shows China as the centre of the world",text:"A japanese colored version"}]},t}return m(t,e),t.prototype.transform=function(e){return this.mock[this.options.source]},t}(l.DataSource),pa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){var t=[];return e.nav.forEach((function(e){t.push({text:e.title,anchor:{href:"http://localhost:4200/mr/static/"+e.id,target:"_blank",payload:e.id}})})),{items:t}},t}(l.DataSource),fa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(){return{title:{main:{text:this.options.config.title}}}},t}(l.DataSource),ga=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){var t=this.options.config,a=t.totalResultsText,n=t.sort,i=e.totalCount,o=e.sort;return{title:{main:{text:i},secondary:{text:a[1===i?1:0]}},actions:{select:{label:n.label,options:n.options.map((function(e){var t=e.label,a=e.value,n=e.selected;return{value:a,selected:o?a===o:n,text:t}})),payload:"sort"}}}},t}(l.DataSource),ya=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){var t=e.results,a=this.options.config.resourcePath;return t.map((function(e){return b(b({},e),{anchor:{href:a+"/"+e.id,target:"_blank"}})}))},t}(l.DataSource),ma=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasFilters=!1,t}return m(t,e),t.prototype.transform=function(e){var t=e.state,a=e.linksResponse,n=e.facetsConfig,i=a.inputs,o=[];return n.sections.forEach((function(e){e.inputs.filter((function(e){return e.queryParam})).forEach((function(e){var a=e.id;t[a]&&(Array.isArray(t[a])?t[a]:[t[a]]).forEach((function(e){var t=e;i[a]&&(t=i[a].find((function(t){return t.payload===e})).text),o.push({text:t,icon:"n7-icon-close",payload:{id:a,value:e}})}))}))})),this.hasFilters=!!o.length,o},t}(l.DataSource),ba=Object.freeze({__proto__:null,MrFiltersDS:ra,MrHeroDS:sa,MrImageViewerDS:ca,MrInnerTitleDS:la,MrItemPreviewDS:ua,MrItemPreviewsDS:da,MrMetadataDS:pa,MrNavDS:ha,MrSearchPageTitleDS:fa,MrSearchResultsTitleDS:ga,MrSearchResultsDS:ya,MrSearchTagsDS:ma}),va=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),wa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),Sa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"dv-nav.click":e.emitOuter("navclick",n);break;default:console.warn("unhandled event of type",a)}}))},t}(l.EventHandler),ka=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"mr-search-tags.click":e.emitOuter("click",n)}}))},t}(l.EventHandler),_a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"mr-search-results-title.change":e.emitOuter("change",n)}}))},t}(l.EventHandler),Ia=Object.freeze({__proto__:null,MrDummyEH:va,MrFiltersEH:wa,MrNavEH:Sa,MrSearchTagsEH:ka,MrSearchResultsTitleEH:_a}),Ca={layoutId:"n7-glossary-layout",widgets:[],layoutDS:ia,layoutEH:oa,widgetsDataSources:ba,widgetsEventHandlers:Ia,layoutOptions:{}},Ea=function(e){function a(t){return e.call(this,t.get("MrGlossaryLayoutConfig")||Ca)||this}return m(a,e),a.prototype.initPayload=function(){return{options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.ctorParameters=function(){return[{type:E}]},a=v([t.Component({selector:"mr-glossary-layout",template:'<div class="glossary-layout" *ngIf="lb.dataSource">\n    Hello, from Glossary layout!\n</div>\n'}),w("design:paramtypes",[E])],a)}(A),xa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.onInit=function(e){this.configuration=e.configuration,this.communication=e.communication,this.mainState=e.mainState,this.configId=e.configId,this.pageConfig=this.configuration.get(this.configId)||{},this.doRequest(),this.updateHeadTitle()},t.prototype.doRequest=function(){var e=this,t=this.pageConfig.sections;t&&this.communication.request$("home",{method:"POST",params:t.map((function(e){return e.id}))}).subscribe((function(t){e.initSections(t)}))},t.prototype.initSections=function(e){var t=this,a=this.pageConfig.sections;a&&a.forEach((function(a){var n=a.id,i=t.getWidgetDataSource(n),o=e[n];i.id=n,o&&t.one(n).update(o)}))},t.prototype.updateHeadTitle=function(){var e=this.configuration.get("name"),t=this.pageConfig.title;this.mainState.update("headTitle",[e,t].join(" > "))},t}(u.LayoutDataSource),Pa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"mr-home-layout.init":e.dataSource.onInit(n)}})),this.outerEvents$.subscribe((function(e){e.type}))},t}(l.EventHandler),Da={layoutId:"mr-home-layout",widgets:[],layoutDS:xa,layoutEH:Pa,widgetsDataSources:ba,widgetsEventHandlers:Ia,options:{}},Ta=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){return e},t}(l.DataSource),Aa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.transform=function(e){if(void 0===e)return null;var t=e.header,a=e.items,n=this.options.classes;return(t||{}).button&&(t.button=[{text:t.button.text,anchor:{href:t.button.anchor}}]),{header:{title:{main:{text:t.title,classes:"bold"},secondary:!!t.subtitle&&{text:t.subtitle},actions:!!t.button&&{buttons:[{text:t.button.text,payload:t.button.link,classes:"n7-btn-cta"}]}},actions:{buttons:t.button}},items:a.map((function(e){return b(b({},e),{anchor:{href:e.anchor},classes:n||""})}))}},t}(l.DataSource),Oa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),Fa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),La=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),Ra={slider:Ta,collection:Aa,hero:sa},Ma={slider:Oa,collection:Fa,hero:La},$a=function(e){function a(t,a,n,i,o){var r=e.call(this,t.get("MrHomeLayoutConfig")||Da)||this;return r.activatedRoute=a,r.configuration=n,r.communication=i,r.mainState=o,r}return m(a,e),a.prototype.initPayload=function(){return{configId:this.configId,mainState:this.mainState,configuration:this.configuration,communication:this.communication,options:this.config.options||{}}},a.prototype.ngOnInit=function(){var e=this;this.activatedRoute.data.subscribe((function(t){e.configId=t.configId,e.loadWidgets(),e.onInit()}))},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.prototype.loadWidgets=function(){var e=this,t=(this.configuration.get(this.configId)||{}).sections;this.widgets=[],t&&t.forEach((function(t){var a=t.id,n=t.type,i=t.options;e.widgets.push({id:a,options:i,dataSource:Ra[n],eventHandler:Ma[n]})}))},a.ctorParameters=function(){return[{type:E},{type:s.ActivatedRoute},{type:C},{type:T},{type:x}]},a=v([t.Component({selector:"mr-home-layout",template:'<div class="mr-home mr-layout" *ngIf="lb.dataSource">\n    <section *ngFor="let section of lb.dataSource.pageConfig.sections" class="{{ \'mr-layout__\' + section.type }}">\n        <ng-container [ngSwitch]="section.type">\n\n            \x3c!-- SLIDER --\x3e\n            <ng-container *ngSwitchCase="\'slider\'">\n                <n7-carousel \n                [data]="lb.widgets[section.id].ds.out$ | async"\n                [emit]="lb.widgets[section.id].emit">\n                </n7-carousel> \n            </ng-container>\n\n            \x3c!-- COLLECTION --\x3e\n            <ng-container *ngSwitchCase="\'collection\'">\n                <div class="mr-layout__maxwidth mr-items-preview">\n                    <n7-inner-title \n                    [data]="(lb.widgets[section.id].ds.out$ | async)?.header"\n                    [emit]="lb.widgets[section.id].emit">\n                    </n7-inner-title>\n                    <div class="{{ section.grid ? \'n7-grid-\' + section.grid : \'\' }}">\n                        <n7-item-preview\n                        *ngFor="let item of (lb.widgets[section.id].ds.out$ | async)?.items"\n                        [data]="item"\n                        [emit]="lb.widgets[section.id].emit">\n                        </n7-item-preview>\n                    </div>\n                </div>\n            </ng-container>\n\n            \x3c!-- HERO --\x3e\n            <ng-container *ngSwitchCase="\'hero\'">\n                <n7-hero \n                [data]="lb.widgets[section.id].ds.out$ | async"\n                [emit]="lb.widgets[section.id].emit">\n                </n7-hero> \n            </ng-container>\n        \n        </ng-container>\n    </section>\n    \n</div>\n'}),w("design:paramtypes",[E,s.ActivatedRoute,C,T,x])],a)}(A),za=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.onInit=function(e){this.configuration=e.configuration,this.communication=e.communication,this.mainState=e.mainState,this.configId=e.configId,this.pageConfig=this.configuration.get(this.configId)},t.prototype.pageRequest$=function(e){var t=this.pageConfig.sections;return this.communication.request$("resource",{method:"POST",params:{slug:e,type:this.pageConfig.type,sections:t.map((function(e){return e.id}))}})},t.prototype.handleResponse=function(e){this.initSections(e),this.updateHeadTitle(e)},t.prototype.initSections=function(e){var t=this;this.pageConfig.sections.forEach((function(a){var n=a.id,i=t.getWidgetDataSource(n);if(i){var o=e.sections[n];i.id=n,o&&t.one(n).update(o)}}))},t.prototype.updateHeadTitle=function(e){var t=e.title,a=this.configuration.get("name"),n=this.pageConfig.title;this.mainState.update("headTitle",[a,n,t].join(" > "))},t}(u.LayoutDataSource),Ha=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroy$=new o.Subject,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"mr-resource-layout.init":e.route=n.route,e.dataSource.onInit(n),e.listenRoute()}}))},t.prototype.listenRoute=function(){var e=this;this.route.paramMap.pipe(r.takeUntil(this.destroy$),r.map((function(e){return e.get("slug")})),r.switchMap((function(t){return e.dataSource.pageRequest$(t)}))).subscribe((function(t){e.dataSource.handleResponse(t)}))},t}(l.EventHandler),ja={layoutId:"mr-resource-layout",widgets:[],layoutDS:za,layoutEH:Ha,widgetsDataSources:ba,widgetsEventHandlers:Ia,options:{}},qa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){},t}(l.EventHandler),Ba={viewer:ca,metadata:pa,preview:ua,title:la,collection:Aa},Ga={viewer:qa},Va=function(e){function a(t,a,n,i,o,r){var s=e.call(this,t.get("MrResourceLayoutConfig")||ja)||this;return s.activatedRoute=a,s.configuration=n,s.communication=i,s.mainState=o,s.route=r,s}return m(a,e),a.prototype.initPayload=function(){return{configId:this.configId,configuration:this.configuration,communication:this.communication,mainState:this.mainState,options:this.config.options||{},route:this.route}},a.prototype.ngOnInit=function(){var e=this;this.activatedRoute.data.subscribe((function(t){e.configId=t.configId,e.loadWidgets(),e.onInit()}))},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.prototype.loadWidgets=function(){var e=this,t=this.configuration.get(this.configId).sections;this.widgets=[],t&&t.forEach((function(t){var a=t.id,n=t.type;e.widgets.push({id:a,dataSource:Ba[n],eventHandler:Ga[n]})}))},a.ctorParameters=function(){return[{type:E},{type:s.ActivatedRoute},{type:C},{type:T},{type:x},{type:s.ActivatedRoute}]},a=v([t.Component({selector:"mr-resource-layout",template:'<div class="mr-resource mr-layout"\n     *ngIf="lb.dataSource && lb.dataSource.pageConfig">\n  <section *ngFor="let section of lb.dataSource.pageConfig.sections"\n           class="{{ \'mr-layout__\' + section.type }}">\n    <ng-container [ngSwitch]="section.type">\n\n      \x3c!-- INNER TITLE --\x3e\n      <ng-container *ngSwitchCase="\'title\'">\n        <n7-inner-title [data]="lb.widgets[section.id].ds.out$ | async"\n                        [emit]="lb.widgets[section.id].emit">\n        </n7-inner-title>\n      </ng-container>\n\n      \x3c!-- IMAGE VIEWER --\x3e\n      <ng-container *ngSwitchCase="\'viewer\'">\n        <n7-image-viewer [data]="lb.widgets[section.id].ds.out$ | async"\n                         [emit]="lb.widgets[section.id].emit">\n        </n7-image-viewer>\n      </ng-container>\n\n      \x3c!-- METADATA VIEWER --\x3e\n      <ng-container *ngSwitchCase="\'metadata\'">\n        <n7-metadata-viewer [data]="lb.widgets[section.id].ds.out$ | async"\n                            [emit]="lb.widgets[section.id].emit">\n        </n7-metadata-viewer>\n      </ng-container>\n\n      \x3c!-- COLLECTION --\x3e\n      <ng-container *ngSwitchCase="\'collection\'">\n        <div class="mr-layout__maxwidth mr-items-preview">\n          <n7-inner-title [data]="(lb.widgets[section.id].ds.out$ | async)?.header"\n                          [emit]="lb.widgets[section.id].emit">\n          </n7-inner-title>\n          <div class="{{ section.grid ? \'n7-grid-\' + section.grid : \'\' }}">\n            <n7-item-preview *ngFor="let item of (lb.widgets[section.id].ds.out$ | async)?.items"\n                             [data]="item"\n                             [emit]="lb.widgets[section.id].emit">\n            </n7-item-preview>\n          </div>\n        </div>\n      </ng-container>\n\n      \x3c!-- ITEM PREVIEW --\x3e\n      <ng-container *ngSwitchCase="\'preview\'">\n        <n7-item-preview [data]="lb.widgets[section.id].ds.out$ | async"\n                         [emit]="lb.widgets[section.id].emit">\n        </n7-item-preview>\n      </ng-container>\n\n    </ng-container>\n  </section>\n</div>\n'}),w("design:paramtypes",[E,s.ActivatedRoute,C,T,x,s.ActivatedRoute])],a)}(A),Na=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputsDS={},t}return m(t,e),t.prototype.onInit=function(e){this.searchService=e.searchService,this.searchConfig=this.searchService.getConfig(),this.facets=this.searchConfig.facets,this.initInputs()},t.prototype.initInputs=function(){var e=this;this.facets.sections.forEach((function(t){_([t.header],t.inputs).forEach((function(t){var a=e.getWidgetDataSource(t.id);a.id=t.id,e.inputsDS[t.id]=a,a.update(t.data)}))}))},t.prototype.updateInputValue=function(e,t){var a=this.inputsDS[e];a.setValue(t,a.value!==t)},t.prototype.updateInputData=function(e,t){var a=this.inputsDS[e];a.update(b(b({},a.input),t)),a.setValue(a.value,!0)},t.prototype.clearInput=function(e){var t=this.inputsDS[e];t.clear(),t.setValue(t.value,!0)},t.prototype.clearInputs=function(){var e=this;Object.keys(this.inputsDS).forEach((function(t){e.clearInput(t)}))},t}(l.LayoutDataSource),Wa=function(e){return Array.isArray(e)?e.length>0:!!e},Ua=function(e,t){var a={};return Object.keys(e).forEach((function(n){var i=e[n],o=t[n],r=o.multiple,s=o.valueType;if(Wa(i))switch(s){case"number":case"string":a[n]=r?i.join(","):i;break;case"boolean":a[n]=r?i.map((function(e){return+e})).join(","):+i}})),a},Ka=function(e,t){var a={};return Object.keys(e).forEach((function(n){var i=e[n],o=t[n],r=o.multiple,s=o.valueType;if(Wa(i)&&Wa(i))switch(s){case"number":a[n]=r?i.split(",").map((function(e){return+e})):+i;break;case"string":a[n]=r?i.split(",").map((function(e){return""+e})):""+i;break;case"boolean":a[n]=r?i.split(",").map((function(e){return!!e})):!!i}})),a},Qa=function(){function e(e,t,a){var n=this;this.router=e,this.activatedRoute=t,this.communication=a,this.queryParamKeys=[],this.inputSchemas={},this.contextState={},this.state$={},this.beforeHook={},this.getConfig=function(){return n.config}}return e.prototype.init=function(e,t){this.searchId=e,this.config=t,this.clear(),this.initInputState(),this.initFacetState(),this.onInputsChange(),this.onRouteChange(),this.onResultsLoading()},e.prototype.getState$=function(e,t){var a=t?e+"."+t:e;if(!this.state$[a])throw Error('Key "'+a+"\" does'nt exists");return this.state$[a]},e.prototype.addStateContext=function(e){if(this.state$[e])throw Error('State key "'+e+'" already exists');this.contextState[e]={},this.state$[e]=new o.Subject},e.prototype.addState=function(e,t){var a=e+"."+t;if(!this.state$[e])throw Error('\n        State context "'+e+"\" does'nt exists.\n        You must add context first\n      ");if(this.state$[a])throw Error('State key "'+a+'" already exists');this.state$[a]=new o.Subject},e.prototype.setState=function(e,t,a){var n=e+"."+t;if(!this.state$[n])throw Error('Key "'+n+"\" does'nt exists");var i=a;this.beforeHook[n]&&(i=this.beforeHook[n](i)),this.state$[n].next(i),this.setContextState(e,t,i)},e.prototype.setBeforeHook=function(e,t,a){var n=e+"."+t;if(!this.state$[n])throw Error('Key "'+n+"\" does'nt exists");this.beforeHook[n]=a},e.prototype.reset=function(){var e=this;Object.keys(this.contextState.input).forEach((function(t){e.setState("input",t,null)}))},e.prototype.clear=function(){this.contextState={},this.state$={},this.beforeHook={}},e.prototype.setContextState=function(e,t,a){var n;this.contextState[e]=b(b({},this.contextState[e]),((n={})[""+t]=a,n)),this.state$[e].next({lastUpdated:t,state:this.contextState[e]})},e.prototype.initInputState=function(){var e=this,t=this.config,a=t.facets,n=t.layoutInputs;this.addStateContext("input"),a.sections.forEach((function(t){_([t.header],t.inputs).forEach((function(t){var a=t.id,n=t.queryParam,i=t.schema;e.addState("input",a),n&&e.queryParamKeys.push(a),i&&(e.inputSchemas[a]=i)}))})),n.forEach((function(t){var a=t.id,n=t.queryParam,i=t.schema;e.addState("input",a),n&&e.queryParamKeys.push(a),i&&(e.inputSchemas[a]=i)}))},e.prototype.initFacetState=function(){var e=this,t=this.config.facets;this.addStateContext("facet"),t.sections.forEach((function(t){_([t.header],t.inputs).forEach((function(t){e.addState("facet",t.id)}))}))},e.prototype.onRouteChange=function(){var e=this,t=this.config.request.results;this.addStateContext("resultsRequest"),["loading","request","success","error"].forEach((function(t){e.addState("resultsRequest",t)})),this.activatedRoute.queryParams.pipe(r.delay(1),r.map((function(t){return Ka(t,e.inputSchemas)})),r.tap((function(t){if(p.isEmpty(t)&&e.reset(),!p.isEmpty(t)){var a=e.contextState.input;p.isEmpty(a)?Object.keys(t).forEach((function(a){e.setState("input",a,t[a])})):Object.keys(a).filter((function(n){return e.notEquals(a[n],t[n])})).forEach((function(a){e.setState("input",a,t[a]||null)}))}})),r.map((function(t){return e.setState("resultsRequest","loading",t),t})),r.debounceTime(t.delay||1),r.map((function(t){return e.setState("resultsRequest","request",t),t})),r.switchMap((function(a){return e.communication.request$(t.id,{params:b(b({},a),{searchId:e.searchId}),method:"POST",onError:function(t){e.setState("resultsRequest","error",t)}},t.provider||null)}))).subscribe((function(t){e.setState("resultsRequest","success",t)}))},e.prototype.onInputsChange=function(){var e=this;this.getState$("input").pipe(r.filter((function(t){var a=t.lastUpdated;return-1!==e.queryParamKeys.indexOf(a)}))).subscribe((function(t){var a=t.state,n={};Object.keys(a).forEach((function(t){-1!==e.queryParamKeys.indexOf(t)&&(n[t]=a[t])}));var i=Ua(n,e.inputSchemas);e.router.navigate([],{queryParams:i})}))},e.prototype.onResultsLoading=function(){var e=this,t=this.config.request.facets;t&&(this.addStateContext("facetsRequest"),["loading","request","success","error"].forEach((function(t){e.addState("facetsRequest",t)})),this.getState$("resultsRequest","loading").pipe(r.map((function(t){return e.setState("facetsRequest","loading",t),t})),r.debounceTime(t.delay||1),r.map((function(t){return e.setState("facetsRequest","request",t),t})),r.switchMap((function(a){return e.communication.request$(t.id,{params:b(b({},a),{searchId:e.searchId}),method:"POST",onError:function(t){e.setState("facetsRequest","error",t)}},t.provider||null)}))).subscribe((function(t){e.setState("facetsRequest","success",t)})),this.getState$("facetsRequest","success").subscribe((function(t){var a=t.inputs;Object.keys(a).forEach((function(t){e.setState("facet",t,{links:a[t]})}))})))},e.prototype.notEquals=function(e,t){return Array.isArray(e)&&Array.isArray(t)?!!p.xor(e,t).length:e!==t},e.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:T}]},e=v([t.Injectable(),w("design:paramtypes",[s.Router,s.ActivatedRoute,T])],e)}(),Ya=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.changed$={},t.destroyed$=new o.Subject,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"mr-search-facets-layout.init":e.searchService=n.searchService,e.initChangedListener(e.searchService.getConfig()),e.initStateListener(),e.dataSource.onInit(n);break;case"mr-search-facets-layout.destroy":e.destroyed$.next()}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;a.indexOf("change")&&e.changed$[n.id].next(n)}))},t.prototype.initChangedListener=function(e){var t=this;e.facets.sections.forEach((function(e){var a=[];if(e.header){var n=e.header,i=n.id,s=n.delay;a.push({id:i,delay:s})}e.inputs.forEach((function(e){var t=e.id,n=e.delay;a.push({id:t,delay:n})})),a.forEach((function(e){t.changed$[e.id]=new o.Subject,t.changed$[e.id].pipe(r.debounceTime(e.delay||1)).subscribe((function(e){var a=e.id,n=e.value;t.searchService.setState("input",a,n)}))}))}))},t.prototype.initStateListener=function(){var e=this;this.searchService.getState$("input").pipe(r.takeUntil(this.destroyed$),r.filter((function(t){var a=t.lastUpdated;return e.dataSource.inputsDS[a]}))).subscribe((function(t){var a=t.lastUpdated,n=t.state[a];null===n?e.dataSource.clearInput(a):e.dataSource.updateInputValue(a,n)})),this.searchService.getState$("facet").pipe(r.takeUntil(this.destroyed$),r.filter((function(t){var a=t.lastUpdated;return e.dataSource.inputsDS[a]}))).subscribe((function(t){var a=t.lastUpdated,n=t.state[a];e.dataSource.updateInputData(a,n)})),this.searchService.getState$("facetsRequest","success").pipe(r.takeUntil(this.destroyed$)).subscribe((function(t){var a=t.headers;Object.keys(a).forEach((function(t){e.dataSource.updateInputValue(t,a[t])}))}))},t}(l.EventHandler),Xa={layoutId:"mr-search-facets-layout",widgets:[],layoutDS:Na,layoutEH:Ya,widgetsDataSources:ba,widgetsEventHandlers:Ia,layoutOptions:{}},Ja=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getValue=function(){return t.value},t}return m(t,e),t.prototype.transform=function(e){return e},t.prototype.setValue=function(e,t){if(void 0===t&&(t=!1),this.value=e,t){this.update(b(b({},this.input),{value:e}));var a=document.getElementById(this.output.id);a&&(a.value=e)}},t.prototype.clear=function(){this.value=null},t}(l.DataSource),Za=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=[],t.getValue=function(){return t.value},t}return m(t,e),t.prototype.transform=function(e){return e},t.prototype.setValue=function(e,t){var a=this;if(void 0===t&&(t=!1),this.value=Array.isArray(e)?e:[e],t){var n=this.input.checkboxes.map((function(e){return b(b({},e),{checked:-1!==a.value.indexOf(e.payload)})}));this.update(b(b({},this.input),{checkboxes:n}))}},t.prototype.toggleValue=function(e){var t=e.inputPayload,a=e.value,n=-1!==this.value.indexOf(t);a&&!n?this.value.push(t):!a&&n&&this.value.splice(this.value.indexOf(t),1)},t.prototype.clear=function(){this.value=[]},t}(l.DataSource),en=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getValue=function(){return t.value},t}return m(t,e),t.prototype.transform=function(e){return e},t.prototype.setValue=function(e,t){if(void 0===t&&(t=!1),this.value=e,t){var a=this.input.options.map((function(t){return b(b({},t),{selected:e===t.value})}));this.update(b(b({},this.input),{options:a}))}},t.prototype.clear=function(){this.value=null},t}(l.DataSource),tn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.getValue=function(){return t.value},t}return m(t,e),t.prototype.transform=function(e){return e},t.prototype.setValue=function(e,t){var a=this;if(void 0===t&&(t=!1),this.value=e,t){var n=this.input.links.map((function(e){return b(b({},e),{classes:a.value===e.payload?"is-active":""})}));this.update(b(b({},this.input),{links:n}))}},t.prototype.toggleValue=function(e){this.setValue(this.value!==e?e:null,!0)},t.prototype.clear=function(){this.value=null},t}(l.DataSource),an="n7-icon-angle-down",nn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getValue=function(){return t.value},t}return m(t,e),t.prototype.transform=function(e){return b(b({},e),{iconRight:e.iconRight||an})},t.prototype.setValue=function(e,t){void 0===t&&(t=!1),this.value=e,t&&this.update(b(b({},this.input),{additionalText:e}))},t.prototype.toggle=function(){var e=this.output.iconRight;e=e===an?"n7-icon-angle-right":an,this.update(b(b({},this.input),{iconRight:e}))},t.prototype.isOpen=function(){return this.output.iconRight===an},t.prototype.clear=function(){this.value=null},t}(l.DataSource),on=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){switch(t.type){case e.dataSource.id+".click":e.dataSource.toggle(),e.emitOuter("change",{isOpen:e.dataSource.isOpen(),id:e.dataSource.id})}}))},t}(l.EventHandler),rn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case e.dataSource.id+".change":e.dataSource.setValue(n.value),e.emitOuter("change",b(b({},n),{id:e.dataSource.id}))}}))},t}(l.EventHandler),sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case e.dataSource.id+".change":e.dataSource.toggleValue(n),e.emitOuter("change",{value:e.dataSource.getValue(),id:e.dataSource.id})}}))},t}(l.EventHandler),cn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case e.dataSource.id+".change":e.dataSource.setValue(n.value),e.emitOuter("change",b(b({},n),{id:e.dataSource.id}))}}))},t}(l.EventHandler),ln=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case e.dataSource.id+".change":e.dataSource.toggleValue(n),e.emitOuter("change",{value:e.dataSource.getValue(),id:e.dataSource.id})}}))},t}(l.EventHandler),un=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=[],t.getValue=function(){return t.value},t}return m(t,e),t.prototype.transform=function(e){return e},t.prototype.setValue=function(e,t){var a=this;if(void 0===t&&(t=!1),this.value=e,t){var n=this.input.links.map((function(e){return b(b({},e),{classes:a.value.includes(e.payload)?"is-active":""})}));this.update(b(b({},this.input),{links:n}))}},t.prototype.toggleValue=function(e){var t=this.value.includes(e);t?t&&this.value.splice(this.value.indexOf(e),1):this.value.push(e),this.setValue(this.value,!0)},t.prototype.clear=function(){this.value=[]},t}(l.DataSource),dn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case e.dataSource.id+".change":e.dataSource.toggleValue(n),e.emitOuter("change",{value:e.dataSource.getValue(),id:e.dataSource.id})}}))},t}(l.EventHandler),pn={header:nn,text:Ja,checkbox:Za,select:en,link:tn,"link-multiple":un},hn={header:on,text:rn,checkbox:sn,select:cn,link:ln,"link-multiple":dn},fn=function(e){function a(){return e.call(this,Xa)||this}return m(a,e),a.prototype.initPayload=function(){return{searchService:this.searchService}},a.prototype.ngOnInit=function(){this.loadWidgets(),this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.prototype.loadWidgets=function(){var e=this,t=this.searchService.getConfig().facets;this.widgets=[],t.sections.forEach((function(t){var a=t.header,n=t.inputs;a&&e.widgets.push({id:a.id,dataSource:pn.header,eventHandler:hn.header}),n.forEach((function(t){var a=t.type;t.schema.multiple&&(a+="-multiple"),e.widgets.push({id:t.id,dataSource:pn[a],eventHandler:hn[a]})}))}))},v([t.Input(),w("design:type",Qa)],a.prototype,"searchService",void 0),a=v([t.Component({selector:"mr-search-facets-layout",template:'<div *ngIf="lb.dataSource.facets" class="mr-search-facets {{ lb.dataSource.facets.classes || \'\' }}">\n    <div *ngFor="let section of lb.dataSource.facets.sections" class="mr-search-facets__section {{ section.classes || \'\' }}">\n        <n7-facet-header\n        [data]="lb.widgets[section.header.id].ds.out$ | async"\n        [emit]="lb.widgets[section.header.id].emit"\n        ></n7-facet-header>\n\n        <div [hidden]="!lb.widgets[section.header.id].ds.isOpen()" class="mr-search-facets__wrapper">\n            <div *ngFor="let input of section.inputs" class="mr-search-facets__input {{ input.classes || \'\' }}">\n                <ng-container [ngSwitch]="input.type">\n    \n                    \x3c!-- INPUT TEXT --\x3e\n                    <n7-input-text \n                    *ngSwitchCase="\'text\'"\n                    [data]="lb.widgets[input.id].ds.out$ | async"\n                    [emit]="lb.widgets[input.id].emit"></n7-input-text>\n    \n                    \x3c!-- INPUT CHECKBOX --\x3e\n                    <n7-input-checkbox \n                    *ngSwitchCase="\'checkbox\'"\n                    [data]="lb.widgets[input.id].ds.out$ | async"\n                    [emit]="lb.widgets[input.id].emit"></n7-input-checkbox>\n                    \n                    \x3c!-- INPUT SELECT --\x3e\n                    <n7-input-select \n                    *ngSwitchCase="\'select\'"\n                    [data]="lb.widgets[input.id].ds.out$ | async"\n                    [emit]="lb.widgets[input.id].emit"></n7-input-select>\n                    \n                    \x3c!-- INPUT LINK --\x3e\n                    <n7-input-link \n                    *ngSwitchCase="\'link\'"\n                    [data]="lb.widgets[input.id].ds.out$ | async"\n                    [emit]="lb.widgets[input.id].emit"></n7-input-link>\n\n                    \x3c!-- INPUT LINKMULTI --\x3e\n                    <n7-input-link \n                    *ngSwitchCase="\'linkMulti\'"\n                    [data]="lb.widgets[input.id].ds.out$ | async"\n                    [emit]="lb.widgets[input.id].emit"></n7-input-link>\n                \n                </ng-container>\n            </div>\n        </div>\n        \n        \n    </div>\n</div>'}),w("design:paramtypes",[])],a)}(A),gn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.totalResultsText=null,t}return m(t,e),t.prototype.onInit=function(e){this.configuration=e.configuration,this.mainState=e.mainState,this.searchService=e.searchService,this.configId=e.configId,this.pageConfig=this.configuration.get(this.configId),this.all().updateOptions({config:this.pageConfig}),this.one("mr-search-page-title").update({}),this.updateHeadTitle()},t.prototype.handleResponse=function(e){this.some(["mr-search-results-title","mr-search-results"]).update(e),this.one("n7-smart-pagination").updateOptions({mode:"payload"}),this.one("n7-smart-pagination").update(this.getPaginationParams(e))},t.prototype.updateActiveFilters=function(e,t){this.one("mr-search-tags").update({state:e,linksResponse:t,facetsConfig:this.searchService.getConfig().facets})},t.prototype.getPaginationParams=function(e){var t=e.totalCount,a=e.page,n=e.limit,i=this.pageConfig.pagination;return{totalPages:Math.ceil(t/n),currentPage:a,pageLimit:i.limit,sizes:{list:i.options,active:n}}},t.prototype.updateHeadTitle=function(){var e=this.configuration.get("name"),t=this.pageConfig.title;this.mainState.update("headTitle",[e,t].join(" > "))},t}(l.LayoutDataSource);!function(e){e.IDLE="IDLE",e.LOADING="LOADING",e.SUCCESS="SUCCESS",e.EMPTY="EMPTY",e.ERROR="ERROR"}(I||(I={}));var yn=function(){function e(){this.stateContainers={}}return e.prototype.add=function(e){var t=this;(Array.isArray(e)?e:[e]).forEach((function(e){if(t.stateContainers[e])throw Error("Layout state id '"+e+"' already exists");t.stateContainers[e]=new o.Subject,t.stateContainers[e].next(I.IDLE)}))},e.prototype.get$=function(e){if(!this.stateContainers[e])throw Error("Layout state id '"+e+"' does not exists");return this.stateContainers[e]},e.prototype.set=function(e,t){if(!this.stateContainers[e])throw Error("Layout state id '"+e+"' does not exists");this.stateContainers[e].next(t)},e=v([t.Injectable()],e)}(),mn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyed$=new o.Subject,t.searchState={},t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"mr-search-layout.init":e.searchService=n.searchService,e.layoutState=n.layoutState,e.dataSource.onInit(n),e.initStateListener();break;case"mr-search-layout.destroy":e.destroyed$.next(!0);break;case"mr-search-layout.searchreset":e.searchService.reset();break;default:console.warn("unhandled inner event of type",a)}})),this.outerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"n7-smart-pagination.click":e.searchService.setState("input","page",n.page);break;case"n7-smart-pagination.change":e.searchService.setState("input","limit",n.value);break;case"mr-search-results-title.change":e.searchService.setState("input","sort",n.value);break;case"mr-search-tags.click":var i=e.searchState[n.id],o=null;Array.isArray(i)&&(o=i.filter((function(e){return e!==n.value}))),e.searchService.setState("input",n.id,o)}}))},t.prototype.initStateListener=function(){var e=this;this.searchService.getState$("input").subscribe((function(t){var a=t.state;e.searchState=a})),this.searchService.getState$("facetsRequest","success").subscribe((function(t){e.linksResponse=t,e.dataSource.updateActiveFilters(e.searchState,e.linksResponse)})),this.searchService.getState$("resultsRequest","loading").subscribe((function(){e.layoutState.set("results",I.LOADING)})),this.searchService.setBeforeHook("resultsRequest","loading",(function(e){void 0===e&&(e={});var t={page:1,sort:"_score_DESC",limit:10};return Object.keys(t).forEach((function(a){e[a]=e[a]||t[a]})),e})),this.searchService.getState$("resultsRequest","success").subscribe((function(t){e.dataSource.handleResponse(t),e.layoutState.set("results",p.isEmpty(t.results)?I.EMPTY:I.SUCCESS)})),this.searchService.getState$("resultsRequest","error").subscribe((function(t){console.warn("resultsRequest",t),e.layoutState.set("results",I.ERROR)}))},t}(l.EventHandler),bn={layoutId:"mr-search-layout",widgets:[{id:"facets-wrapper",dataSource:X,eventHandler:ie},{id:"mr-search-page-title"},{id:"mr-search-results-title"},{id:"mr-search-results"},{id:"mr-search-tags"},{id:"mr-resources",dataSource:da},{id:"n7-smart-pagination",dataSource:Z,eventHandler:re}],layoutDS:gn,layoutEH:mn,widgetsDataSources:ba,widgetsEventHandlers:Ia,layoutOptions:{}},vn={request:{results:{id:"search",delay:500},facets:{id:"facets"},provider:"rest",delay:500},facets:{sections:[{header:{id:"header-filtra",data:{text:"Filtra i risultati"}},inputs:[{id:"query",type:"text",queryParam:!0,delay:500,schema:{valueType:"string"},data:{id:"query",placeholder:"Cerca nei titoli",icon:"n7-icon-search",inputPayload:"search-input",enterPayload:"search-enter",iconPayload:"search-icon"}}]},{header:{id:"header-toponimi",data:{text:"Toponimi",additionalText:"786"}},inputs:[{id:"input-toponimi-filter",type:"text",delay:500,schema:{valueType:"string"},data:{id:"input-text-01",placeholder:"Search",icon:"n7-icon-search",inputPayload:"search-input",enterPayload:"search-enter",iconPayload:"search-icon"}},{id:"input-toponimi",type:"link",queryParam:!0,schema:{valueType:"string"},data:{links:[]}}]},{header:{id:"header-glossario",data:{text:"Glossario",additionalText:"96"}},inputs:[{id:"input-glossario-filter",type:"text",delay:500,schema:{valueType:"string"},data:{id:"input-text-02",placeholder:"Search",icon:"n7-icon-search",inputPayload:"search-input",enterPayload:"search-enter",iconPayload:"search-icon"}},{id:"input-glossario",type:"link",queryParam:!0,schema:{valueType:"string",multiple:!0},data:{links:[]}}]},{header:{id:"header-continenti",data:{text:"Continenti",additionalText:"3"}},inputs:[{id:"input-continenti",type:"link",queryParam:!0,schema:{valueType:"string",multiple:!0},data:{links:[]}}]},{header:{id:"header-keywords",data:{text:"Keywords",additionalText:"108",iconRight:"n7-icon-angle-right"}},inputs:[{id:"input-keywords",type:"link",queryParam:!0,schema:{valueType:"string",multiple:!0},data:{links:[]}}]},{header:{id:"header-data",data:{text:"Data di pubblicazione",additionalText:"20",iconRight:"n7-icon-angle-right"}},inputs:[{id:"input-data",type:"link",queryParam:!0,schema:{valueType:"string",multiple:!0},data:{links:[]}}]},{header:{id:"header-luogo",data:{text:"Luogo di pubblicazione",additionalText:"15",iconRight:"n7-icon-angle-right"}},inputs:[{id:"input-luogo",type:"link",queryParam:!0,schema:{valueType:"string",multiple:!0},data:{links:[]}}]}],classes:"facets-wrapper"},layoutInputs:["page","limit","sort"].map((function(e){return{id:e,queryParam:!0,schema:{valueType:"sort"===e?"string":"number"}}}))},wn=function(e){function a(t,a,n,i,o,r,s,c){var l=e.call(this,t.get("MrSearchLayoutConfig")||bn)||this;return l.router=a,l.activatedRoute=n,l.communication=i,l.configuration=o,l.searchService=r,l.layoutState=s,l.mainState=c,l}return m(a,e),a.prototype.initPayload=function(){return{configId:this.configId,configuration:this.configuration,mainState:this.mainState,router:this.router,activatedRoute:this.activatedRoute,communication:this.communication,searchService:this.searchService,layoutState:this.layoutState,options:this.config.options||{}}},a.prototype.ngOnInit=function(){var e=this;this.activatedRoute.data.subscribe((function(t){e.configId=t.configId;var a=e.configuration.get(e.configId).searchId;e.searchService.init(a,vn),e.layoutState.add(["results"]),e.onInit()}))},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.ctorParameters=function(){return[{type:E},{type:s.Router},{type:s.ActivatedRoute},{type:T},{type:C},{type:Qa},{type:yn},{type:x}]},a=v([t.Component({selector:"mr-search-layout",template:'<div class="mr-search mr-layout"\n     *ngIf="lb.dataSource">\n    <section class="mr-layout__maxwidth">\n\n        <div class="mr-search__title">\n            <n7-inner-title\n            [data]="lb.widgets[\'mr-search-page-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        \n        <div class="mr-search__results-content">\n            <aside class="mr-search__facets">\n                <div class="filter-section">\n                    <h2 *ngIf="lb.dataSource.pageConfig[\'facetsTitle\']">\n                        {{ lb.dataSource.pageConfig[\'facetsTitle\'] }}\n                    </h2>\n                    <mr-search-facets-layout \n                    [searchService]="lb.dataSource.searchService">\n                    </mr-search-facets-layout>\n                </div>\n            </aside>\n            <div class="mr-search__results-wrapper">\n                <div class="mr-search__results-info">\n                    <n7-inner-title\n                    [data]="lb.widgets[\'mr-search-results-title\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'mr-search-results-title\'].emit">\n                    </n7-inner-title>\n                </div>\n                <div class="mr-search__results-filters">\n                    <span *ngIf="(\n                        lb.dataSource.pageConfig[\'filtersTitle\'] && \n                        lb.widgets[\'mr-search-tags\'].ds.hasFilters\n                    )" \n                    class="mr-search__results-filters-title">{{ lb.dataSource.pageConfig[\'filtersTitle\'] }}</span>\n                    <n7-tag *ngFor="let tag of (lb.widgets[\'mr-search-tags\'].ds.out$ | async)"\n                    [data]="tag"\n                    [emit]="lb.widgets[\'mr-search-tags\'].emit">\n                    </n7-tag>\n                </div>\n                <main class="mr-search__results">\n                    \x3c!-- SEARCH RESULTS --\x3e\n                    <ng-container [ngSwitch]="layoutState.get$(\'results\') | async">\n                        \n                        \x3c!-- loading --\x3e\n                        <ng-container *ngSwitchCase="\'LOADING\'">\n                            <div class="mr-search__results-loading">\n                                <n7-content-placeholder *ngFor="let n of [0,1,2,3,4,5,6,7,8,9]" [data]="{\n                                    blocks: [\n                                        { classes: \'search-result-placeholder-title\' },\n                                        { classes: \'search-result-placeholder-metadata\' },\n                                        { classes: \'search-result-placeholder-metadata\' },\n                                        { classes: \'search-result-placeholder-metadata\' }\n                                    ]\n                                }"></n7-content-placeholder>\n                            </div>\n                        </ng-container>\n                        \n                        \x3c!-- success: items > 0 --\x3e\n                        <ng-container *ngSwitchCase="\'SUCCESS\'">\n                            <n7-item-preview *ngFor="let item of (lb.widgets[\'mr-search-results\'].ds.out$ | async)"\n                            [data]="item">\n                            </n7-item-preview>\n                        </ng-container>\n\n                        \x3c!-- empty: items === 0 --\x3e\n                        <ng-container *ngSwitchCase="\'EMPTY\'">\n                            <div class="mr-search__results-fallback">\n                                <p class="mr-search__results-fallback-string">\n                                    {{ lb.dataSource.pageConfig.fallback.text }}\n                                </p>\n                                <button class="n7-btn mr-search__results-fallback-button"\n                                    (click)="lb.eventHandler.emitInner(\'searchreset\')">\n                                    {{ lb.dataSource.pageConfig.fallback.button }}\n                                </button>\n                            </div>\n                        </ng-container>\n\n                        \x3c!-- error: request problem --\x3e\n                        <ng-container *ngSwitchCase="\'ERROR\'">\n                            <p class="mr-search__results-ko-string">\n                                {{ lb.dataSource.pageConfig.ko.text }}\n                            </p>\n                            <button class="n7-btn mr-search__results-ko-button"\n                                (click)="lb.eventHandler.emitInner(\'searchreset\')">\n                                {{ lb.dataSource.pageConfig.ko.button }}\n                            </button>\n                        </ng-container>\n                        \n                    </ng-container>\n                </main>               \n                <n7-smart-pagination\n                [data]="lb.widgets[\'n7-smart-pagination\'].ds.out$ | async"\n                [emit]="lb.widgets[\'n7-smart-pagination\'].emit">\n                </n7-smart-pagination>\n            </div>\n        </div>\n\n    </section>\n</div>\n'}),w("design:paramtypes",[E,s.Router,s.ActivatedRoute,T,C,Qa,yn,x])],a)}(A),Sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.onInit=function(e){this.communication=e.communication,this.configuration=e.configuration,this.mainState=e.mainState},t.prototype.pageRequest$=function(e){return this.communication.request$("wp-page",{urlParams:e})},t.prototype.handleResponse=function(e){var t=e.title,a=e.body;this.setHtml(t,a),this.updateHeadTitle(t)},t.prototype.setHtml=function(e,t){this.html={title:e,body:t}},t.prototype.updateHeadTitle=function(e){var t=this.configuration.get("name");this.mainState.update("headTitle",[t,e].join(" > "))},t}(l.LayoutDataSource),kn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroy$=new o.Subject,t}return m(t,e),t.prototype.listen=function(){var e=this;this.innerEvents$.subscribe((function(t){var a=t.type,n=t.payload;switch(a){case"mr-static-layout.init":e.route=n.route,e.dataSource.onInit(n),e.listenRoute();break;case"mr-static-layout.destroy":e.destroy$.next();break;default:console.warn("unhandled inner event of type",a)}}))},t.prototype.listenRoute=function(){var e=this;this.route.url.pipe(r.takeUntil(this.destroy$),r.switchMap((function(t){return e.dataSource.pageRequest$(t[0].path)}))).subscribe((function(t){e.dataSource.handleResponse(t)}))},t}(l.EventHandler),_n={layoutId:"mr-static-layout",widgets:[],layoutDS:Sn,layoutEH:kn,widgetsDataSources:ba,widgetsEventHandlers:Ia,layoutOptions:{}},In=function(e){function a(t,a,n,i,o){var r=e.call(this,o.get("MrStaticLayoutConfig")||_n)||this;return r.communication=t,r.configuration=a,r.mainState=n,r.route=i,r}return m(a,e),a.prototype.initPayload=function(){return{communication:this.communication,configuration:this.configuration,mainState:this.mainState,route:this.route,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.ctorParameters=function(){return[{type:T},{type:C},{type:x},{type:s.ActivatedRoute},{type:E}]},a=v([t.Component({selector:"mr-static-layout",template:'<div class="mr-static-layout" *ngIf="lb.dataSource.html">\n    <h1 class="mr-generated-title-WP">{{lb.dataSource.html.title}}</h1>\n    <div class="mr-generated-page-WP" [innerHTML]="lb.dataSource.html.body | keepHtml"></div>\n</div>\n'}),w("design:paramtypes",[T,C,x,s.ActivatedRoute,E])],a)}(A),Cn=[Ea,$a,Va,fn,wn,In],En=function(){function e(){}return e=v([t.NgModule({declarations:[na,Cn],imports:[a.CommonModule,i.DvComponentsLibModule,me],providers:[Qa,yn],entryComponents:Cn,exports:Cn})],e)}(),xn=function(){function e(){}return e=v([t.NgModule({imports:[a.CommonModule],providers:[],exports:[me,qt,aa,En]})],e)}(),Pn=function(){function e(e,t){var a=this;this.http=e,this.configuration=t,this.dynamicPaths=[],this.isDynamicPath=function(e){return a.dynamicPaths.includes(e)}}return e.prototype.load=function(e){var t=this;return this.http.get(e).pipe(r.catchError((function(){return o.of(null)})),r.tap((function(e){return t._handleResponse(e)}))).toPromise()},e.prototype._handleResponse=function(e){var t=this;if(e){var a=this.configuration.get("header");a.nav.items=e.map((function(e){var a=e.label,n="/"+e.slug;return e.isStatic||t.dynamicPaths.push(n),{text:a,anchor:{href:n},_meta:{id:n}}})),this.configuration.set("header",a)}},e.ctorParameters=function(){return[{type:n.HttpClient},{type:C}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(n.HttpClient),t.ɵɵinject(C))},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"}),w("design:paramtypes",[n.HttpClient,C])],e)}(),Dn=function(){function e(e,t){this.menuService=e,this.router=t}return e.prototype.canActivate=function(e,t){var a=t.url;if(!this.menuService.isDynamicPath(a)){var n=e.data.notFoundPath;return this.router.navigate([n?"/"+n:"/"]),!1}return!0},e.ctorParameters=function(){return[{type:Pn},{type:s.Router}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(Pn),t.ɵɵinject(s.Router))},token:e,providedIn:"root"}),e=v([t.Injectable({providedIn:"root"}),w("design:paramtypes",[Pn,s.Router])],e)}();e.AbstractLayout=A,e.ApolloProvider=P,e.AwAutocompleteWrapperDS=xe,e.AwAutocompleteWrapperEH=rt,e.AwBubbleChartDS=Pe,e.AwBubbleChartEH=st,e.AwChartTippyDS=De,e.AwChartTippyEH=lt,e.AwEntitaLayoutComponent=pt,e.AwEntitaLayoutConfig=dt,e.AwEntitaLayoutDS=Ie,e.AwEntitaLayoutEH=Ce,e.AwEntitaMetadataViewerDS=$e,e.AwEntitaNavDS=Me,e.AwEntitaNavEH=Ze,e.AwGalleryLayoutComponent=mt,e.AwGalleryLayoutConfig=yt,e.AwGalleryLayoutDS=ft,e.AwGalleryLayoutEH=gt,e.AwGalleryResultsDS=Ne,e.AwGalleryResultsEH=it,e.AwHeroDS=Te,e.AwHeroEH=Ke,e.AwHomeAutocompleteDS=Re,e.AwHomeAutocompleteEH=Je,e.AwHomeFacetsWrapperDS=Fe,e.AwHomeFacetsWrapperEH=Qe,e.AwHomeHeroPatrimonioDS=Oe,e.AwHomeHeroPatrimonioEH=Ye,e.AwHomeItemTagsWrapperDS=Le,e.AwHomeItemTagsWrapperEH=Xe,e.AwHomeLayoutComponent=St,e.AwHomeLayoutConfig=wt,e.AwHomeLayoutDS=bt,e.AwHomeLayoutEH=vt,e.AwLinkedObjectsDS=Ee,e.AwLinkedObjectsEH=ot,e.AwMapDS=We,e.AwMapLayoutComponent=Et,e.AwMapLayoutConfig=Ct,e.AwMapLayoutDS=_t,e.AwMapLayoutEH=It,e.AwPatrimonioLayoutConfig=Dt,e.AwSchedaBreadcrumbsDS=je,e.AwSchedaImageDS=Be,e.AwSchedaInnerTitleDS=Ge,e.AwSchedaLayoutComponent=Tt,e.AwSchedaLayoutDS=xt,e.AwSchedaLayoutEH=Pt,e.AwSchedaMetadataDS=qe,e.AwSchedaSidebarEH=et,e.AwSearchLayoutComponent=Rt,e.AwSearchLayoutConfig=Lt,e.AwSearchLayoutDS=Ot,e.AwSearchLayoutEH=Ft,e.AwSearchLayoutTabsDS=Ve,e.AwSearchLayoutTabsEH=nt,e.AwSidebarHeaderDS=He,e.AwSidebarHeaderEH=tt,e.AwTableDS=Ae,e.AwTableEH=ct,e.AwTreeDS=ze,e.AwTreeEH=at,e.BreadcrumbsDS=Q,e.BreadcrumbsEH=ne,e.BubbleChartWrapperComponent=$t,e.ChartTippyComponent=Mt,e.CommunicationService=T,e.ConfigurationService=C,e.DataWidgetWrapperComponent=Bt,e.DatepickerWrapperComponent=Gt,e.DvDataWidgetDS=Wt,e.DvDatepickerWrapperDS=Ut,e.DvDatepickerWrapperEH=Jt,e.DvExampleLayoutComponent=ea,e.DvExampleLayoutConfig=Zt,e.DvExampleLayoutDS=Vt,e.DvExampleLayoutEH=Nt,e.DvGraphDS=Kt,e.DvInnerTitleDS=Qt,e.DvWidgetDS=Yt,e.DynamicPathGuard=Dn,e.FacetInput=L,e.FacetInputCheckbox=R,e.FacetInputLink=H,e.FacetInputSelect=j,e.FacetInputText=z,e.FacetsDS=Y,e.FacetsWrapperComponent=fe,e.FacetsWrapperDS=X,e.FacetsWrapperEH=ie,e.FooterDS=J,e.FooterEH=oe,e.HeaderDS=U,e.HeaderEH=te,e.JsonConfigService=F,e.LayoutsConfigurationService=E,e.MainLayoutComponent=le,e.MainLayoutConfig=ce,e.MainLayoutDS=O,e.MainLayoutEH=N,e.MainStateService=x,e.MrDummyEH=va,e.MrFiltersDS=ra,e.MrFiltersEH=wa,e.MrGlossaryLayoutComponent=Ea,e.MrGlossaryLayoutConfig=Ca,e.MrGlossaryLayoutDS=ia,e.MrGlossaryLayoutEH=oa,e.MrHeroDS=sa,e.MrHomeLayoutComponent=$a,e.MrHomeLayoutConfig=Da,e.MrHomeLayoutDS=xa,e.MrHomeLayoutEH=Pa,e.MrImageViewerDS=ca,e.MrInnerTitleDS=la,e.MrItemPreviewDS=ua,e.MrItemPreviewsDS=da,e.MrMenuService=Pn,e.MrMetadataDS=pa,e.MrNavDS=ha,e.MrNavEH=Sa,e.MrResourceLayoutComponent=Va,e.MrResourceLayoutConfig=ja,e.MrResourceLayoutDS=za,e.MrResourceLayoutEH=Ha,e.MrSearchFacetsLayoutComponent=fn,e.MrSearchLayoutComponent=wn,e.MrSearchLayoutConfig=bn,e.MrSearchLayoutDS=gn,e.MrSearchLayoutEH=mn,e.MrSearchPageTitleDS=fa,e.MrSearchResultsDS=ya,e.MrSearchResultsTitleDS=ga,e.MrSearchResultsTitleEH=_a,e.MrSearchTagsDS=ma,e.MrSearchTagsEH=ka,e.MrStaticLayoutComponent=In,e.MrStaticLayoutConfig=_n,e.MrStaticLayoutDS=Sn,e.MrStaticLayoutEH=kn,e.N7BoilerplateAriannaWebModule=qt,e.N7BoilerplateCommonModule=me,e.N7BoilerplateDataVizModule=aa,e.N7BoilerplateLibModule=xn,e.N7BoilerplateMurucaModule=En,e.Page404LayoutComponent=he,e.Page404LayoutConfig=pe,e.Page404LayoutDS=ue,e.Page404LayoutEH=de,e.RestProvider=D,e.SearchFacetsLayoutConfig=Xa,e.SearchFacetsLayoutDS=Na,e.SearchFacetsLayoutEH=Ya,e.SearchModel=G,e.SearchService=V,e.SmartBreadcrumbsComponent=zt,e.SmartPaginationComponent=ge,e.SmartPaginationDS=Z,e.SmartPaginationEH=re,e.SubnavDS=K,e.SubnavEH=ae,e.ɵa=le,e.ɵb=A,e.ɵba=$a,e.ɵbb=Va,e.ɵbc=fn,e.ɵbd=wn,e.ɵbe=Qa,e.ɵbf=yn,e.ɵbg=In,e.ɵc=C,e.ɵd=E,e.ɵe=x,e.ɵf=he,e.ɵg=fe,e.ɵh=ge,e.ɵi=T,e.ɵj=P,e.ɵk=D,e.ɵl=pt,e.ɵm=mt,e.ɵn=V,e.ɵo=St,e.ɵp=Et,e.ɵq=Tt,e.ɵr=Rt,e.ɵs=$t,e.ɵt=Mt,e.ɵu=zt,e.ɵv=Bt,e.ɵw=Gt,e.ɵx=ea,e.ɵy=na,e.ɵz=Ea,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=n7-frontend-boilerplate.umd.min.js.map