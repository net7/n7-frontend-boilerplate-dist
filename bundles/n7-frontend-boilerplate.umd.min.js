!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http"),require("@n7-frontend/components"),require("rxjs"),require("rxjs/operators"),require("@angular/router"),require("@angular/platform-browser"),require("@n7-frontend/core"),require("tippy.js")):"function"==typeof define&&define.amd?define("@n7-frontend/boilerplate",["exports","@angular/core","@angular/common","@angular/common/http","@n7-frontend/components","rxjs","rxjs/operators","@angular/router","@angular/platform-browser","@n7-frontend/core","tippy.js"],e):e(((t=t||self)["n7-frontend"]=t["n7-frontend"]||{},t["n7-frontend"].boilerplate={}),t.ng.core,t.ng.common,t.ng.common.http,t.components,t.rxjs,t.rxjs.operators,t.ng.router,t.ng.platformBrowser,t.core$1,t.tippy)}(this,function(t,e,n,a,i,o,r,s,l,c,u){"use strict";u=u&&u.hasOwnProperty("default")?u.default:u;var d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function p(t,e){function n(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var b=function(){return(b=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function h(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var a,i,o=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(a=o.next()).done;)r.push(a.value)}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return r}var f=function(){function t(t){var e=this;this.config=t,this.defaults={},this.get=function(t){return e.defaults[t]},this.set=function(t,n){return e.defaults[t]=n},this.config.global&&Object.keys(this.config.global).forEach(function(t){e.set(t,e.config.global[t])})}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["config"]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject("config"))},token:t,providedIn:"root"}),t}();var m=function(){function t(t){var e=this;this.config=t,this.defaults={},this.get=function(t){return e.defaults[t]},this.set=function(t,n){return e.defaults[t]=n},this.config.layouts&&Object.keys(this.config.layouts).forEach(function(t){e.set(t,e.config.layouts[t])})}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["config"]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject("config"))},token:t,providedIn:"root"}),t}();var y=function(){function t(){var t=this;this.custom={},this.default={headTitle:new o.ReplaySubject,pageTitle:new o.ReplaySubject,subnav:new o.ReplaySubject,breadcrumbs:new o.ReplaySubject,filters:new o.ReplaySubject},this.get$=function(e){return t._get("default",e)},this.getCustom$=function(e){return t._get("custom",e)},this.update=function(e,n){return t._update("default",e,n)},this.updateCustom=function(e,n){return t._update("custom",e,n)},this.has=function(e){return!!t.default[e]},this.hasCustom=function(e){return!!t.custom[e]}}return t.prototype.addCustom=function(t,e){if(this.custom[t])throw Error("custom stream "+t+" exists!");this.custom[t]=e},t.prototype._update=function(t,e,n){if(!this[t])throw Error(t+" stream group does not exists!");if(!this[t][e])throw Error(t+" stream "+e+" does not exists!");this[t][e].next(n)},t.prototype._get=function(t,e){if(!this[t])throw Error(t+" stream group does not exists!");if(!this[t][e])throw Error(t+" stream "+e+" does not exists!");return this[t][e]},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var g={getLastPosts:{queryName:"getLastPosts",queryBody:"\n      {\n        getLastPosts(__PARAMS__) {\n          id\n          title\n        }\n      }\n    "},getTree:{queryName:"getTreeOfItems",queryBody:'\n    {\n      getTreeOfItems(treeId: "patrimonioId" ) {\n        id\n        label\n        icon\n        branches {\n          label\n          id\n          icon\n          img\n          branches {\n            label\n            id\n            icon\n            img\n            branches {\n              label\n              id\n              icon\n              img\n            }\n          }\n        }\n      }\n    }\n    '},globalFilter:{queryName:"globalFilter",queryBody:"{\n      globalFilter(__PARAMS__){\n        entitiesData {\n          countData {\n            type {\n              id\n              label\n              configKey\n            }\n            count\n          }\n          entitiesCountData {\n            entity {\n              id\n              label\n              typeOfEntity {\n                id\n              }\n            }\n            count\n          }\n        }\n        itemsPagination {\n          totalCount\n          items {\n            item {\n              id\n              label\n              info {\n                key\n                value\n              }\n            }\n            thumbnail\n            relatedTOEData {\n              type {\n                id\n                label\n                configKey\n              }\n              count\n            }\n          }\n        }\n      }\n    }"},getEntityDetails:{queryName:"getEntityDetails",queryBody:"{\n      getEntityDetails(__PARAMS__){\n        overviewTab\n        entity {\n          label\n          id\n          typeOfEntity {\n            configKey\n          }\n        }\n        fieldsTab {\n          label\n          fields {\n            key\n            value\n          }\n        }\n        entities {\n          entity {\n            id\n            label\n            typeOfEntity {\n              configKey\n            }\n          }\n          count\n        }\n        extraTab\n        wikiTab {\n          text\n          url\n        }\n        items {\n          breadcrumbs {\n            link\n            label\n          }\n          item {\n            id\n            label\n            info {\n              key\n              value\n            }\n          }\n          thumbnail\n          relatedTOEData {\n            type {\n              id\n              configKey\n            }\n            count\n          }\n        }\n      }\n    }\n    "},getItemDetails:{queryName:"getItemDetails",queryBody:"{\n        getItemDetails(__PARAMS__){\n          title\n          text\n          subTitle\n          image\n           item {\n            id\n            icon\n          }\n          similarItems {\n            thumbnail\n              item {\n                label\n                icon\n                info {\n                  key\n                  value\n                }\n              }\n            relatedTOEData {\n              count\n              type {\n                label\n                configKey\n              }\n            }\n          }\n          connectedEntities {\n            count\n            entity{\n             id\n            label\n              typeOfEntity {\n                id\n                label\n                configKey\n              }\n            }\n          }\n          fields {\n            id\n            label\n            fields {\n              id\n              key\n              value\n            }\n          }\n          breadcrumbs {\n            label\n            link\n          }\n        }\n      }"},autoComplete:{queryName:"autoComplete",queryBody:"{\n      autoComplete(__PARAMS__){\n        totalCount\n        items {\n          item {\n            id\n            label\n            info {\n              key\n              value\n            }\n            icon\n          }\n          thumbnail\n          typeOfEntity {\n            id\n            configKey\n          }\n        }\n      }\n    }"}},v=function(){function t(t,e){this.config=t,this.http=e;try{this.providerConfig=this.config.get("communication").providers.apollo}catch(t){throw Error("No config found for apollo provider!")}}return t.prototype.request$=function(t,e){var n=e.params,a=e.method,i=e.httpOptions,o=g[t];this.providerConfig.config&&this.providerConfig.config[t]&&(o=this.providerConfig.config[t]);var s=(o=o||{}).queryName,l=o.queryBody;if(!s||!l)throw Error('No config found for requestId "'+t+'"');if(n){var c=this.makeParamsStr(n);l=l.replace("__PARAMS__",c)}else l=l.replace("(__PARAMS__)","");return(a&&"GET"===a?this.http.get(this.providerConfig.baseUrl):this.http.post(this.providerConfig.baseUrl,{query:l},i)).pipe(r.map(function(t){return t.data[s]}))},t.prototype.makeParamsStr=function(t){var e=this,n=[];return Object.keys(t).forEach(function(a){if(Array.isArray(t[a])){var i=[];t[a].forEach(function(t){if("object"==typeof t){var n=e.makeParamsStr(t);i.push("{ "+n+" }")}else isNaN(t)?i.push('"'+t+'"'):i.push(""+t)}),n.push(a+": ["+i.join(",")+"]")}else if("object"==typeof t[a]&&t[a]){var o=e.makeParamsStr(t[a]);n.push(a+": { "+o+" }")}else"string"==typeof t[a]&&0===a.indexOf("$")?n.push(a.replace("$","")+": "+t[a]):isNaN(t[a])?n.push(a+': "'+t[a]+'"'):n.push(a+": "+t[a])}),n.join(" ")},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:f},{type:a.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(f),e.ɵɵinject(a.HttpClient))},token:t,providedIn:"root"}),t}();var w={getLastPosts:"posts"},S=function(){function t(t,e){this.config=t,this.http=e;try{this.providerConfig=this.config.get("communication").providers.rest}catch(t){throw Error("No config found for rest provider!")}}return t.prototype.request$=function(t,e){void 0===e&&(e={});var n=e.params,a=e.method,i=e.httpOptions,o=w[t];if(a||(a=this.providerConfig.defaultMethod||"GET"),this.providerConfig.config&&this.providerConfig.config[t]&&(o=this.providerConfig.config[t]),!o)throw Error('No config found for requestId "'+t+'"');if("POST"===a||"PUT"===a)return this.http[a.toLowerCase()](this.providerConfig.baseUrl+o,n,i);if("GET"===a||"DELETE"===a)return this.http[a.toLowerCase()](this.providerConfig.baseUrl+o,i);throw Error("Rest method "+a+" not supported")},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:f},{type:a.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(f),e.ɵɵinject(a.HttpClient))},token:t,providedIn:"root"}),t}();var E=function(){function t(t,e,n){this.config=t,this.apollo=e,this.rest=n;try{this.communicationConfig=this.config.get("communication"),this.defaultProvider=this.communicationConfig.defaultProvider}catch(t){throw Error("No communications.defaultProvider setted in config")}}return t.prototype.request$=function(t,e,n){var a=this;if(void 0===e&&(e={}),!this[n=n||this.defaultProvider])throw Error("There is no "+n+" provider");var i=e.onError;return this[n].request$(t,e).pipe(r.catchError(function(t){return a.handleError(t,i)}))},t.prototype.handleError=function(t,e){return e?e(t):console.warn("No error handler for communication request",t),o.empty()},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:f},{type:v},{type:S}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(f),e.ɵɵinject(v),e.ɵɵinject(S))},token:t,providedIn:"root"}),t}();var _=function(){function t(t){this.config=t,this.widgets=this.config.widgets,this.lb=new c.LayoutBuilder(this.config.layoutId)}return t.prototype.initPayload=function(){},t.prototype.onInit=function(){var t=this;this.lb.ready$.subscribe(function(){t.lb.eventHandler.emitInner("init",t.initPayload())}),this.lb.init({widgetsConfig:this.widgets,widgetsDataSources:this.config.widgetsDataSources,widgetsEventHandlers:this.config.widgetsEventHandlers,dataSource:new this.config.layoutDS,eventHandler:new this.config.layoutEH})},t.prototype.onDestroy=function(){this.lb.eventHandler.emitInner("destroy")},t}();var I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(t){var e=this,n=t.configuration,a=t.mainState,i=t.router,o=t.options,r=t.titleService;this.configuration=n,this.mainState=a,this.router=i,this.titleService=r,this.options=o,this.one("header").update(this.configuration.get("header")),this.mainState.get$("headTitle").subscribe(function(t){return e.titleService.setTitle(t)}),this.mainState.get$("pageTitle").subscribe(function(t){return e.pageTitle=t}),this.mainState.get$("subnav").subscribe(function(t){return e.one("subnav").update(t)}),this.mainState.get$("breadcrumbs").subscribe(function(t){return e.one("breadcrumbs").update(t)})},e.prototype.onNavigate=function(t){if("router"===t.handler){if(!t.path)throw Error("onNavigate: no path for router navigate");this.router.navigate(t.path),this._onRouterNavigate()}},e.prototype._onRouterNavigate=function(){u.hideAll()},e}(c.LayoutDataSource);var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"main-layout.init":t.dataSource.onInit(a);break;case"main-layout.destroy":t.destroyed$.next()}}),c.EventHandler.globalEvents$.pipe(r.takeUntil(this.destroyed$)).subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"global.navigate":t.dataSource.onNavigate(a)}})},e}(c.EventHandler);var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e}(c.DataSource),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return{classes:"main-subnav",items:t}},e.prototype.setActive=function(t){this.output.items.forEach(function(e){e._meta.id===t?(e.classes="is-current",e._meta.isActive=!0):(e.classes="",e._meta.isActive=!1)})},e.prototype.getActive=function(){return this.output.items.filter(function(t){return t._meta.isActive})[0]||null},e}(c.DataSource),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e}(c.DataSource),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return i.FOOTER_MOCK},e}(c.DataSource),A=Object.freeze({HeaderDS:C,SubnavDS:D,BreadcrumbsDS:B,FooterDS:x}),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"header.click":t.emitGlobal("navigate",{handler:"router",path:[a]})}})},e}(c.EventHandler),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"subnav.click":"navigate"===a.source&&t.emitGlobal("navigate",a),t.emitGlobal(n,a)}})},e}(c.EventHandler),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"breadcrumbs.click":"navigate"===a.source&&t.emitGlobal("navigate",a),t.emitGlobal(n,a)}})},e}(c.EventHandler),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){this.innerEvents$.subscribe(function(t){var e=t.type;t.payload;console.warn("unhandled inner event of type",e)})},e}(c.EventHandler),j=Object.freeze({HeaderEH:H,SubnavEH:O,BreadcrumbsEH:T,FooterEH:P}),$={layoutId:"main-layout",widgets:[{id:"header"},{id:"subnav"},{id:"breadcrumbs"},{id:"footer",hasStaticData:!0}],layoutDS:I,layoutEH:k,widgetsDataSources:A,widgetsEventHandlers:j,options:{}},L=function(t){function n(e,n,a,i,o){var r=t.call(this,a.get("MainLayoutConfig")||$)||this;return r.router=e,r.configuration=n,r.layoutsConfiguration=a,r.mainState=i,r.titleService=o,r}return p(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,titleService:this.titleService,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"main-layout",template:'<div class="n7-main-layout" id="main-layout">\n    <div class="n7-page-content">\n        <n7-header\n            [data]="lb.widgets[\'header\'].ds.out$ | async"\n            [emit]="lb.widgets[\'header\'].emit">\n        </n7-header>\n        <main class="n7-content">\n            <div class="n7-top-page-bar">\n                <div class="n7-top-page-bar__main"></div>\n            </div>\n            <div class="n7-alert-bar">\n                \x3c!--<n7-alert\n                [attr.id]="\'main-layout-alert\'"\n                [data]="lb.dataSource.alertData$ | async"\n                [emit]="lb.dataSource.closeAlert.bind(lb.dataSource)"></n7-alert>--\x3e\n            </div>\n            <ng-content></ng-content>\n        </main>\n    </div>\n    <n7-footer \n        [data]="lb.widgets[\'footer\'].ds.out$ | async" \n        [emit]="lb.widgets[\'footer\'].emit">\n    </n7-footer>\n</div>'}]}],n.ctorParameters=function(){return[{type:s.Router},{type:f},{type:m},{type:y},{type:l.Title}]},n}(_);var q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(t){var e=t.options;this.options=e},e}(c.LayoutDataSource);var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"n7-page404-layout.init":t.dataSource.onInit(a);break;case"n7-page404-layout.destroy":t.destroyed$.next()}})},e}(c.EventHandler);var R={layoutId:"n7-page404-layout",widgets:[],layoutDS:q,layoutEH:M,widgetsDataSources:A,widgetsEventHandlers:j,options:{}},N=function(t){function n(e){return t.call(this,e.get("Page404LayoutConfig")||R)||this}return p(n,t),n.prototype.initPayload=function(){return{options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"n7-page404-layout",template:'<div class="n7-page404-layout">\n    PAGE404!!!\n</div>'}]}],n.ctorParameters=function(){return[{type:m}]},n}(_),F=[L,N],W=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[y,f,m,E,v,{provide:"config",useValue:e}]}},t.decorators=[{type:e.NgModule,args:[{declarations:F,imports:[n.CommonModule,a.HttpClientModule,i.DvComponentsLibModule],providers:[],exports:F}]}],t}(),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(t){},e}(c.LayoutDataSource),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){},e}(c.EventHandler),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){var e=this.options.configKeys;return this.pageSize=this.options.size,this.currentPage=Number(this.options.page),this.totalPages=Math.floor(t.length/Number(this.pageSize)),this.context=this.options.context,function(t,e,n,a,i,o){n&&e?t=t.slice(e*n-n,e*n):n&&(t=t.slice(0,n));var r=[];if(t.forEach(function(t){var e={image:t.thumbnail,title:t.item.label,payload:t.item.id,classes:"entita"==o?"is-fullwidth":"",metadata:[{classes:"n7-objects__metadata-artist",items:[{label:"Autore",value:t.item.info[0].value},{value:t.item.info[1].value}]},{classes:"n7-objects__metadata-linked",items:t.relatedTOEData.map(function(t){return{value:t.count,icon:a[t.type.configKey].icon,classes:"color-"+t.type.configKey}})}]};t.breadcrumbs&&(e.breadcrumbs={items:t.breadcrumbs.map(function(t){return{label:t.label,payload:t.link}})}),r.push(e)}),e){return{pagination:{first:{payload:"goto-1",classes:1==e?"is-disabled":""},prev:{payload:"goto-"+(e-1),classes:1==e?"is-disabled":""},next:{payload:"goto-"+(e+1),classes:e==i?"is-disabled":""},last:{payload:"goto-"+i,classes:e==i?"is-disabled":""},links:V(i,e),select:{label:"Numero di risultati",options:[10,25,50].map(function(t){return{text:t,selected:t==n}}),payload:"select-size"}},previews:r}}return r}(t,this.currentPage,this.pageSize,e,this.totalPages,this.context)},e}(c.DataSource);function V(t,e){var n=[];n.push({text:"1",payload:"page-1",classes:1==e?"is-active":""});for(var a=1;a<t;a++)n.push({text:String(a+1),payload:"page-"+String(a+1),classes:e==a+1?"is-active":""});return n}var U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){var e=t.key,n=t.response,a=new RegExp("(.*?)"+e+"(.*)"),i=[];return n.items.forEach(function(t){if(!(t.item.label.indexOf(e)<0)){var n=t.item.label.match(a),o=n[1],r=n[2];i.push({prefix:o,suffix:r,payload:t.item.id})}}),{typed:e,append:i}},e}(c.DataSource),Q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.thresholdShowTitle=50,e.thresholdShowValue=60,e.allBubbles=null,e.entityBubbleIdMap={},e.selectedBubbles=[],e.facetData=null,e.bubblePopup=null,e.currentHoverEntity=null,e._bubbleChart=null,e.maxBubblesSelectable=3,e.windowResizeSet=!1,e}return p(e,t),e.prototype.transform=function(t){var e=this;if(!t)return null;this.destroyTooltip(),this.facetData=t.facetData?t.facetData:[],this.tippy=u,t.bubbles=this.filterBubblesBasedOnFacetsEnabled();var n=document.getElementById(this.options.containerId),a=t.width?t.width:n.offsetWidth,i=700*a,o={containerId:this.options.bubbleContainerId,containerWidth:a,containerHeight:700,isForceSimulationEnabled:!0,maxBubblesSelected:3,bubblesData:[]},r=-1,s=-1,l=0;return t.bubbles.forEach(function(t){r<t.count&&(r=t.count),(s<0||s>t.count)&&(s=t.count),l++,t.count,t.selected&&0}),t.bubbles.forEach(function(t){var n=t.id,c=(t.count-s/3)/(3*r-s/3),u=Math.log(i)/10*(3*c)*(70-Math.sqrt(l)),d={id:n,texts:[{id:n+"_label0",label:function(n){return n.radius<e.thresholdShowTitle?null:t.entity.label},x_function:function(t){return t.x},y_function:function(t){var n=t.radius/9;return t.radius<e.thresholdShowValue&&(n=0),t.y-n},user_select:"none",fontSize_function:function(t){return t.radius/5},color:"white",classes:""},{id:n+"_label1",label:function(n){return n.radius<e.thresholdShowValue?null:t.count},x_function:function(t){return t.x},y_function:function(t){return t.y+t.radius/9},user_select:"none",fontSize_function:function(t){return t.radius/6},color:"white",classes:""}],x:a/2+50,y:400,radius:u,color:t.color,hasCloseIcon:!!t.selected&&t.selected,payload:{id:n}};o.bubblesData.push(d)}),o.forceSimulationData={xPull:a/2,xPullStrength:-.01,yPull:350,yPullStrength:-.01,collisionStrengh:.99,collisionIterations:1,velocityDecay:.65},t.reset&&(o.reset=t.reset),t.setUpdateReference&&(o.setUpdateReference=t.setUpdateReference),t.setBubbleChart&&(o.setBubbleChart=t.setBubbleChart),this.setWindowResize(),o},e.prototype.setAllBubblesFromApolloQuery=function(t,e){var n=this,a=t.source;if(this.allBubbles=[],t.selectedBubbles&&(this.selectedBubbles=t.selectedBubbles),a.entitiesData)for(var i=0;i<a.entitiesData.length;i++)for(var o=a.entitiesData[i],r=0;r<o.entitiesCountData.length;r++)this.allBubbles.push(b({},o.entitiesCountData[r],{color:this.options.configKeys[o.countData.type.configKey].color.hex}));else for(i=0;i<a.connectedEntities.length;i++){var s=this.options.configKeys[a.connectedEntities[i].entity.typeOfEntity.configKey]?this.options.configKeys[a.connectedEntities[i].entity.typeOfEntity.configKey].color.hex:"";this.allBubbles.push(b({id:this.convertEntityIdToBubbleId(a.connectedEntities[i].entity.id)},a.connectedEntities[i],{color:s}))}this.entityBubbleIdMap={},this.allBubbles.forEach(function(t){return t.id=n.convertEntityIdToBubbleId(t.entity.id),n.entityBubbleIdMap[t.id]=t.entity.id,t}),this.allBubbles.forEach(function(t){t.selected=!1;for(var e=0;e<n.selectedBubbles.length;e++)n.selectedBubbles[e].id===t.id&&(t.selected=!0)}),this.update(t)},e.prototype.convertEntityIdToBubbleId=function(t){return t?"B_"+t.replace(/-/g,"_"):null},e.prototype.filterBubblesBasedOnFacetsEnabled=function(){var t=this;return this.allBubbles.filter(function(e){for(var n=0;n<t.facetData.length;n++)if(e.entity.typeOfEntity.id===t.facetData[n].type.id&&!t.facetData[n].enabled)return!1;return!0})},e.prototype.onBubbleMouseEnter=function(t){var e=this;if(t&&t.bubble){for(var n=t.bubble.id,a=this.entityBubbleIdMap[t.bubble.id],i=0;i<this.allBubbles.length;i++){var o=this.allBubbles[i];if(o.entity.id===a){this.currentHoverEntity=o.entity,this.currentHoverEntity.count=o.count;break}}this.bubblePopup&&(this.bubblePopup.hide(),this.bubblePopup.destroy(),this.bubblePopup=null),setTimeout(function(){var t=document.getElementById("bubble-popup-menu").cloneNode(!0);t.style.display="inline-block",e.bubblePopup=e.tippy("#"+n,{content:t,allowHTML:!0,trigger:"manual",interactive:!0,arrow:!0,theme:"light-border no-padding",placement:"top",maxWidth:500})[0],setTimeout(function(){e.bubblePopup&&e.bubblePopup.show()},800)})}},e.prototype.destroyTooltip=function(){this.bubblePopup&&(this.bubblePopup.hide(),this.bubblePopup.destroy(),this.bubblePopup=null)},e.prototype.onBubbleTooltipClick=function(t,e){switch(t){case"select":if(!e)return;var n=this.convertEntityIdToBubbleId(e.entityId);if(!n)return;var a=null;if(e._bubbleChart&&(e._bubbleChart.selectAll("g").each(function(t){t.id===n&&(a=t)}),a))return a}},e.prototype.onBubbleSelected=function(t){t&&(this.selectedBubbles.includes(t)||this.selectedBubbles.length<this.maxBubblesSelectable&&this.selectedBubbles.push(t))},e.prototype.getBubbleFromId=function(t){var e=this.convertEntityIdToBubbleId(t);if(e){var n=null;return this._bubbleChart&&(this._bubbleChart.selectAll("g").each(function(t){t.id===e&&(n=t)}),n)?n:void 0}},e.prototype.getSelectedBubbles=function(){return this.selectedBubbles},e.prototype.getAllBubbles=function(){return this.allBubbles},e.prototype.getEntityIdMap=function(){return this.entityBubbleIdMap},e.prototype.setWindowResize=function(){var t=this;this.windowResizeSet||(o.fromEvent(window,"resize").pipe(r.debounce(function(){return o.interval(200)})).subscribe(function(){var e={width:document.getElementById(t.options.containerId).offsetWidth,reset:!0};t.update(e)}),this.windowResizeSet=!0)},e}(c.DataSource);var X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){var e=t.title,n=t.text,a=t.button,i=t.backgroundImage,o=t.input;return{title:e,text:n,backgroundImage:i,button:{text:a.text,payload:"cerca"},input:{placeholder:o.placeholder,payload:"cerca-in-maxxi"}}},e}(c.DataSource),J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return i.TABLE_MOCK},e}(c.DataSource),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return{title:t.title,backgroundImage:t.backgroundImage,image:t.image,text:t.text,button:{text:t.button.text,payload:"naviga-patrimonio"}}},e}(c.DataSource),Y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.thresholdShowTitle=50,e.thresholdShowValue=60,e}return p(e,t),e.prototype.transform=function(t){var e=this;if(!t)return null;var n=document.getElementById("bubble-chart-container").offsetWidth,a=700*n,i={containerId:"bubbleChartContainer",containerWidth:n,containerHeight:700,isForceSimulationEnabled:!0,maxBubblesSelected:3,bubblesData:[]},o=-1,r=-1,s=0;return t.bubbles.forEach(function(t){o<t.count&&(o=t.count),(r<0||r>t.count)&&(r=t.count),s++,t.count,t.selected&&0}),t.bubbles.forEach(function(t){var l=t.id,c=(t.count-r/3)/(3*o-r/3),u=Math.log(a)/10*(3*c)*(70-Math.sqrt(s)),d={id:l,texts:[{id:l+"_label0",label:function(n){return n.radius<e.thresholdShowTitle?null:t.entity.label},x_function:function(t){return t.x},y_function:function(t){var n=t.radius/9;return t.radius<e.thresholdShowValue&&(n=0),t.y-n},user_select:"none",fontSize_function:function(t){return t.radius/5},color:"white",classes:""},{id:l+"_label1",label:function(n){return n.radius<e.thresholdShowValue?null:t.count},x_function:function(t){return t.x},y_function:function(t){return t.y+t.radius/9},user_select:"none",fontSize_function:function(t){return t.radius/6},color:"white",classes:""}],x:n/2+50,y:400,radius:u,color:t.color,hasCloseIcon:!!t.selected&&t.selected,payload:{id:l}};i.bubblesData.push(d)}),i.forceSimulationData={xPull:n/2,xPullStrength:-.01,yPull:350,yPullStrength:-.01,collisionStrengh:.99,collisionIterations:1,velocityDecay:.65},t.reset&&(i.reset=t.reset),t.setUpdateReference&&(i.setUpdateReference=t.setUpdateReference),t.setBubbleChart&&(i.setBubbleChart=t.setBubbleChart),i},e}(c.DataSource);var tt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.autoComplete={},e.tippyMaker=function(t,n){if(!e.autoComplete[n]){e.autoComplete[n]={template:void 0,tippy:void 0,open:!0};var a=e.autoComplete[n];if(!a.tippy){var i="."+n;a.tippy=u(i,{content:"<span>Loading tippy</span>",trigger:"manual",interactive:!0,arrow:!1,appendTo:"parent",theme:"light-border aw-home__facet-tippy",placement:"bottom-start",maxWidth:"100%",onHidden:function(){a.open=!1},onShow:function(){var t=document.getElementsByClassName("aw-simple-autocomplete__"+n.replace("-search",""))[0];t&&(t.setAttribute("style","display: block"),a.tippy.setContent(t))}})[0]}}var o=e.autoComplete[n];t.totalCount>0?o.tippy.show():o.tippy.hide()},e}return p(e,t),e.prototype.transform=function(t){var e=[],n=[];t.forEach(function(t){var a=[],i=[t.icon];t.enabled||a.push("is-disabled"),t.type.configKey&&(a.push("color-"+t.type.configKey),i.push("color-"+t.type.configKey)),e.push({iconLeft:i.join(" "),text:t.label,additionalText:t.count,iconRight:t.enabled?"n7-icon-eye":"n7-icon-eye-slash",classes:a.join(" ")+(t.locked?" is-blocked":" not-blocked"),payload:t.type.id}),n.push({sections:[{inputs:[{type:"text",placeholder:t["input-placeholder"],icon:"n7-icon-search",disabled:!t.enabled,inputPayload:String(t.type.id)+"-search",iconPayload:String(t.type.id)+"-search",enterPayload:String(t.type.id)+"-search",classes:String(t.type.id)+"-search"}]}]})});var a=[];return e.map(function(t,e){a.push({header:t,input:n[e]})}),a},e}(c.DataSource);var et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e}(c.DataSource),nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){var e=t.items,n=t.totalCount,a=this.options.config,i=[],o={};return e.forEach(function(t){var e=t.item,n=t.typeOfEntity;if(!o[n.id]){var r=a[n.configKey],s=r.label,l=r.icon;o[n.id]={title:s,icon:l,classes:"color-"+n.configKey,items:[]}}if(-1===i.indexOf(e.id)){var c="";e.info.forEach(function(t){"author"===t.key&&(c="di "+t.value)}),o[n.id].items.push({label:e.label,value:c,payload:{source:"item",id:e.id}})}}),{results:Object.keys(o).map(function(t){return{group:b({},o[t])}}),actions:{showMore:{text:"Visualizza tutti i "+n+" risultati",payload:{source:"showMore"}}},fallback:"Spiacenti, non è stato trovato nessun risultato. <br> Riprova con una nuova ricerca."}},e}(c.DataSource),at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){if(t){var e=t.data,n=t.selected,a={items:[],payload:"entita-nav"};return a.items.push({text:"OVERVIEW",payload:"overview",classes:"overview"==n?"is-selected":""}),e.fieldsTab&&a.items.push({text:"CAMPI",payload:"campi",classes:"campi"==n?"is-selected":""}),e.items&&a.items.push({text:"OGGETTI-COLLEGATI",payload:"oggetti-collegati",classes:"oggetti-collegati"==n?"is-selected":""}),e.entities&&a.items.push({text:"ENTITÀ COLLEGATE",payload:"entita-collegate",classes:"entita-collegate"==n?"is-selected":""}),e.extraTab&&a.items.push({text:"MAXXI",payload:"maxxi",classes:"maxxi"==n?"is-selected":""}),e.wikiTab&&a.items.push({text:"WIKIPEDIA",payload:"wiki",classes:"wiki"==n?"is-selected":""}),a}},e}(c.DataSource),it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return{group:e.unpackFields(t)}},e.unpackFields=function(t){var n=[];if(!t)return[];for(var a=0;a<t.length;a++){var i=t[a],o=i.label,r=i.key,s=i.value,l=i.fields,c={};o&&(c.title=o),r&&s&&(c.label=r,c.value=s),l&&(l[0].key?c.items=e.unpackFields(l):c.group=e.unpackFields(l)),n.push(c)}return n},e}(c.DataSource),ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.toggleNav=function(){},e.prototype.transform=function(t){return t},e.prototype.updateTree=function(t,e,n){var a=this;t||(t=this.output),t.items.forEach(function(t){var i=t.classes;t._meta==n?i.indexOf("is-expanded")>-1?t.classes=i.replace(/is-expanded/g,"is-collapsed"):t.classes=i.replace(/is-collapsed/g,"is-expanded"):e.indexOf(t._meta)>=0&&(t.classes=i+" is-expanded"),void 0!==t.items&&t.items.length>0&&a.updateTree(t,e,n)}),this.update(t)},e.prototype.selectTreeItem=function(t,e){var n=this;e||(e=this.output),e.items.forEach(function(e){if(e._meta==t&&e.classes.indexOf("is-active")<0)e.classes=e.classes+" is-active",n.currentItem=e;else{var a=e.classes;e.classes=a.replace("is-active","")}void 0!==e.items&&e.items.length>0&&n.selectTreeItem(t,e)}),this.update(e)},e.prototype.toggleSidebar=function(){var t=this.output;"is-expanded"==t.classes?t.classes="is-collapsed":t.classes="is-expanded",this.update(t)},e.prototype.parseData=function(t){var e=this,n={items:[]};t.branches&&t.branches.forEach(function(t){n.items.push(e.parseTree(t,!1,[]))}),this.update(n)},e.prototype.parseTree=function(t,e,n){var a=this,i=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(h(arguments[e]));return t}(n),o={},r=e&&null!=t.branches;return r&&(o.toggle={icon:"n7-icon-angle-right",payload:{source:"toggle",id:t.id,parents:i}}),Object.keys(t).forEach(function(n){if("branches"!=n){switch(n){case"label":o.text=t[n];break;case"img":o.img=t[n];break;case"icon":r&&null!=t[n]?o.toggle.icon=t[n]:o.icon=t[n];break;case"id":o._meta=t[n],o.payload={source:"menuItem",id:t.id};break;default:t[n]}o.classes="is-collapsed"}else null!=t.branches&&(i.push(t.id),e||(o.payload.source="ToggleMenuItem",o.payload.parents=i),o.items=[],t[n].forEach(function(t){o.items.push(a.parseTree(t,!0,i))}))}),o},e}(c.DataSource);var rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e.prototype.toggleSidebar=function(){var t=this.output;"is-expanded"==t.classes?(t.classes="is-collapsed",t.iconRight="n7-icon-tree-icon"):(t.classes="is-expanded",t.iconRight="n7-icon-angle-left"),this.update(t)},e}(c.DataSource),st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e.prototype.toggleSidebar=function(){var t=this.output;"is-expanded"==t.classes?t.classes="is-collapsed":t.classes="is-expanded",this.update(t)},e}(c.DataSource),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e}(c.DataSource),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e}(c.DataSource),ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e}(c.DataSource),dt=Object.freeze({AwLinkedObjectsDS:G,AwAutocompleteWrapperDS:U,AwBubbleChartDS:Q,AwHeroDS:X,AwTableDS:J,AwHomeHeroPatrimonioDS:Z,AwHomeBubbleChartDS:Y,AwHomeFacetsWrapperDS:tt,AwHomeItemTagsWrapperDS:et,AwHomeAutocompleteDS:nt,AwEntitaNavDS:at,AwEntitaMetadataViewerDS:it,AwTreeDS:ot,AwSidebarHeaderDS:rt,AwSchedaBreadcrumbsDS:st,AwSchedaMetadataDS:lt,AwSchedaImageDS:ct,AwSchedaInnerTitleDS:ut}),pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-linked-objects.click":if(a.startsWith("page"))t.emitOuter("pagination",a);else if(a.startsWith("goto")){var i=Number(a.replace("goto-",""));if(i>t.dataSource.totalPages)return;if(i<1||i===t.dataSource.currentPage)return;t.emitOuter("goto",a)}else t.emitGlobal("navigate",{handler:"router",path:["aw/patrimonio/"+a]});break;case"aw-linked-objects.change":t.emitOuter("change",Number(a.value));break;default:console.warn("unhandled event type: ",n," with payload: ",a)}})},e}(c.EventHandler),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){this.innerEvents$.subscribe(function(t){var e=t.type;t.payload;console.warn("unhandled event of type:",e)})},e}(c.EventHandler),ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){switch(e.type){case"aw-bubble-chart.init":break;case"aw-bubble-chart.click":e.payload.entityIdmap=t.dataSource.getEntityIdMap(),e.payload.allBubbles=t.dataSource.getAllBubbles(),t.emitOuter("click",e.payload);break;case"aw-bubble-chart.mouse_enter":var n=t.dataSource.onBubbleMouseEnter({bubblePayload:e.payload.bubblePayload,bubble:e.payload.bubble});e.payload.currBubble=n,t.emitOuter("mouse_enter",e.payload);break;case"aw-bubble-chart.mouse_leave":t.emitOuter("mouse_leave",e.payload);break;case"aw-bubble-chart.bubble-tooltip-close-click":t.emitOuter("bubble-tooltip-close-click",e.payload);break;case"aw-bubble-chart.bubble-tooltip-goto-click":t.emitOuter("bubble-tooltip-goto-click",e.payload);break;case"aw-bubble-chart.bubble-tooltip-select-click":t.emitOuter("bubble-tooltip-select-click",e.payload)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-layout.bubble-tooltip-select-click":var i={bubble:t.dataSource.onBubbleTooltipClick("select",a),entityIdmap:t.dataSource.getEntityIdMap(),allBubbles:t.dataSource.getAllBubbles(),source:"bubble"};t.emitOuter("click",i);break;case"aw-home-layout.bubble-filter":t.emitOuter("bubble-filtered",{allBubbles:t.dataSource.getAllBubbles(),selected:t.dataSource.getSelectedBubbles()});break;case"aw-scheda-layout.filterbubbleresponse":case"aw-entita-layout.filterbubbleresponse":case"aw-home-layout.filterbubbleresponse":a.source?(t.dataSource.setAllBubblesFromApolloQuery(a),t.emitOuter("bubble-filtered",{allBubbles:t.dataSource.getAllBubbles(),selected:t.dataSource.getSelectedBubbles(),entityIdmap:t.dataSource.getEntityIdMap()})):t.dataSource.update(a)}})},e}(c.EventHandler),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-hero.click":break;case"aw-hero.change":t.emitOuter("change",a)}})},e}(c.EventHandler),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){switch(e.type){case"aw-home-bubble-chart.click":t.emitOuter("click",e.payload);break;case"aw-home-bubble-chart.mouse_enter":t.emitOuter("mouse_enter",e.payload);break;case"aw-home-bubble-chart.mouse_leave":t.emitOuter("mouse_leave",e.payload)}})},e}(c.EventHandler),yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-facets-wrapper.click":t.emitOuter("click",a);break;case"aw-home-facets-wrapper.change":t.emitOuter("change",a);break;case"aw-home-facets-wrapper.enter":t.emitOuter("enter",a);default:console.warn("unhandled inner event of type:",n)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-layout.facetswrapperresponse":t.dataSource.tippyMaker(a.response,a.facetId.inputPayload)}})},e}(c.EventHandler),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type;e.payload;switch(n){case"aw-home-hero-patrimonio.click":t.emitGlobal("navigate",{handler:"router",path:["aw/patrimonio"]})}})},e}(c.EventHandler),vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){switch(e.type){case"aw-home-item-tags-wrapper.click":t.emitOuter("click",e.payload)}})},e}(c.EventHandler),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-autocomplete.click":a&&"item"===a.source&&t.emitOuter("click",a)}})},e}(c.EventHandler),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-entita-nav.click":t.emitOuter("click",a);break;default:console.warn("unhandled event type")}})},e}(c.EventHandler),Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;"aw-sidebar-header.click"==n&&(t.dataSource.toggleSidebar(),t.emitOuter(n,a))})},e}(c.EventHandler),_t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;"aw-sidebar-header.click"==n&&(t.dataSource.toggleSidebar(),t.emitOuter("click",a))})},e}(c.EventHandler),It=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){e.type;var n=e.payload;if(n&&void 0!==n.source)switch(n.source){case"toggle":t.dataSource.updateTree(null,n.parents,n.id);break;case"ToggleMenuItem":t.dataSource.updateTree(null,n.parents,n.id);case"menuItem":t.dataSource.selectTreeItem(n.id),t.emitOuter("click",n.id)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-sidebar-header.click":t.dataSource.toggleSidebar();break;case"aw-scheda-layout.selectItem":t.dataSource.selectTreeItem(a),t.dataSource.updateTree(null,t.dataSource.currentItem.payload.parents,a);break;case"aw-scheda-layout.navigationresponse":t.dataSource.parseData(a)}})},e}(c.EventHandler),kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){},e}(c.EventHandler),Ct=Object.freeze({AwLinkedObjectsEH:pt,AwAutocompleteWrapperEH:bt,AwBubbleChartEH:ht,AwHeroEH:ft,AwHomeBubbleChartEH:mt,AwHomeFacetsWrapperEH:yt,AwHomeHeroPatrimonioEH:gt,AwHomeItemTagsWrapperEH:vt,AwHomeAutocompleteEH:wt,AwEntitaNavEH:St,AwSchedaSidebarEH:Et,AwSidebarHeaderEH:_t,AwTreeEH:It,AwTableEH:kt}),Dt={layoutId:"aw-about-layout",widgets:[],layoutDS:K,layoutEH:z,widgetsDataSources:dt,widgetsEventHandlers:Ct,layoutOptions:{}},Bt=function(t){function n(){return t.call(this,Dt)||this}return p(n,t),n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-about-layout",template:'<div class="" *ngIf="lb.dataSource">\n    About page!\n</div>'}]}],n.ctorParameters=function(){return[]},n}(_),xt=function(){function t(t,e){this.http=t,this.config=e}return t.prototype.load=function(t){var e=this;return this.http.get(t).pipe(r.catchError(function(t){return o.of({})}),r.tap(function(t){return e._handleResponse(t)})).toPromise()},t.prototype._handleResponse=function(t){var e=this;if(t&&(Object.keys(t).forEach(function(n){return e.config.set(n,t[n])}),t["config-keys"])){var n=document.querySelector("head"),a=document.createElement("style"),i=[];Object.keys(t["config-keys"]).forEach(function(e){var n=t["config-keys"][e]||{};n.color&&n.color.hex&&i.push("--color-"+e+": "+n.color.hex+";")}),i.length&&(i.unshift(":root {"),i.push("}"),a.appendChild(document.createTextNode(i.join("\n"))),n.appendChild(a))}},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:a.HttpClient},{type:f}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(a.HttpClient),e.ɵɵinject(f))},token:t,providedIn:"root"}),t}();var At=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.myResponse={},e.navHeader={},e.pageSize=10,e.handleNavUpdate=function(t){e.selectedTab=t,e.updateWidgets(e.myResponse)},e}return p(e,t),e.prototype.onInit=function(t){var e=t.configuration,n=t.mainState,a=t.router,i=t.options,o=t.titleService,r=t.communication;this.communication=r,this.configuration=e,this.mainState=n,this.options=i,this.router=a,this.titleService=o},e.prototype.getNavigation=function(t){return this.communication.request$("getEntityDetails",{onError:function(t){return console.error(t)},params:{entityId:t}})},e.prototype.updateWidgets=function(t){var e=this.selectedTab;this.one("aw-entita-nav").update({data:t,selected:e})},e.prototype.loadItem=function(t,e){if(t&&e)return this.currentId=t,this.selectedTab=e,this.communication.request$("getEntityDetails",{onError:function(t){return console.error(t)},params:{entityId:t}});this.pageTitle="Entità Test"},e.prototype.loadContent=function(t){switch(console.log("Apollo responded with: ",{res:t}),this.myResponse=t,this.navHeader={icon:this.configuration.get("config-keys")[this.myResponse.entity.typeOfEntity.configKey].icon,text:this.myResponse.entity.label,color:this.myResponse.entity.typeOfEntity.configKey},this.selectedTab){case"overview":this.one("aw-bubble-chart").updateOptions({context:"scheda",configKeys:this.configuration.get("config-keys"),bubbleContainerId:"overviewBubbleChartContainer",containerId:"bubble-chart-container-overview"}),this.one("aw-entita-metadata-viewer").updateOptions({context:this.selectedTab}),this.one("aw-entita-metadata-viewer").update(t.fieldsTab),this.one("aw-linked-objects").updateOptions({size:3,configKeys:this.configuration.get("config-keys"),context:"entita"}),this.one("aw-linked-objects").update(t.items);break;case"campi":this.one("aw-entita-metadata-viewer").updateOptions({context:this.selectedTab}),this.one("aw-entita-metadata-viewer").update(t.fieldsTab);break;case"oggetti-collegati":this.one("aw-linked-objects").updateOptions({context:this.selectedTab,configKeys:this.configuration.get("config-keys"),page:this.currentPage,size:this.pageSize}),this.one("aw-linked-objects").update(t.items);break;case"entita-collegate":this.one("aw-bubble-chart").updateOptions({context:"scheda",configKeys:this.configuration.get("config-keys"),bubbleContainerId:"bubbleChartContainer",containerId:"bubble-chart-container"});break;case"maxxi":case"wiki":break;default:console.warn("Unhandled navigation page")}},e}(c.LayoutDataSource);var Ht=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-entita-layout.init":t.dataSource.onInit(a),t.configuration=a.configuration,t.route=a.route,t.entityId=t.route.snapshot.params.id||"",t.dataSource.currentPage=t.route.snapshot.params.page||"",t.listenRoute(),t.loadNavigation(t.entityId);break;case"aw-entita-layout.destroy":t.destroyed$.next();break;case"aw-entita-layout.showmore":a&&t.emitGlobal("navigate",{path:[t.configuration.get("paths").entitaBasePath+"/"+t.entityId+"/"+a],handler:"router"})}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-entita-nav.click":a&&(t.dataSource.selectedTab=a,t.dataSource.handleNavUpdate(a),t.emitGlobal("navigate",{path:[t.configuration.get("paths").entitaBasePath+"/"+t.entityId+"/"+a],handler:"router"}));break;case"aw-linked-objects.pagination":t.dataSource.currentPage=a.split("-")[1],t.emitGlobal("navigate",{handler:"router",path:["aw/entita/"+t.route.snapshot.params.id+"/oggetti-collegati/"+a.split("-")[1]]});break;case"aw-linked-objects.goto":Number(a.replace("goto-",""));break;case"aw-linked-objects.change":t.dataSource.pageSize=a,t.listenRoute();case"aw-bubble-chart.bubble-tooltip-goto-click":if(!a||!a.entityId)return;t.emitGlobal("navigate",{handler:"router",path:["aw/entita/"+a.entityId+"/overview"]})}})},e.prototype.listenRoute=function(){var t=this;this.route.paramMap.subscribe(function(e){e.get("id")?t.dataSource.loadItem(e.get("id"),e.get("tab")).subscribe(function(e){if(e){t.dataSource.loadContent(e),e.connectedEntities=e.entities;var n={source:e};t.emitOuter("filterbubbleresponse",n)}}):t.dataSource.loadItem()})},e.prototype.loadNavigation=function(t){var e=this;console.log("LOAD NAVIGATION"),this.dataSource.getNavigation(t).subscribe(function(n){n&&e.dataSource.updateWidgets(n),t&&e.emitOuter("selectItem",t)})},e}(c.EventHandler);var Ot={layoutId:"aw-entita-layout",widgets:[{id:"aw-entita-nav",hasStaticData:!0},{id:"aw-entita-metadata-viewer"},{id:"aw-linked-objects"},{id:"aw-bubble-chart"}],layoutDS:At,layoutEH:Ht,widgetsDataSources:dt,widgetsEventHandlers:Ct,options:{}},Tt=function(t){function n(e,n,a,i,o,r,s){var l=t.call(this,i.get("AwEntitaLayoutConfig")||Ot)||this;return l.router=e,l.route=n,l.configuration=a,l.layoutsConfiguration=i,l.communication=o,l.mainState=r,l.titleService=s,l}return p(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-entita-layout",template:'<div class="aw-entity" *ngIf="lb.dataSource">\n\n    <div class="aw-entity__sidebar">\n        \x3c!-- Custom header --\x3e\n        <div class="aw-entity__sidebar-title-wrapper color-{{lb.dataSource.navHeader.color}}">\n            <h1 class="aw-entity__sidebar-title">\n                <span class="aw-entity__sidebar-title-icon {{lb.dataSource.navHeader.icon}}"></span>\n                <span class="aw-entity__sidebar-title-text">{{lb.dataSource.navHeader.text}}</span>\n            </h1>\n        </div>\n        \x3c!-- Navigation --\x3e\n        <n7-nav [data]="lb.widgets[\'aw-entita-nav\'].ds.out$ | async" [emit]="lb.widgets[\'aw-entita-nav\'].emit">\n        </n7-nav>\n    </div>\n\n    <div class="aw-entity__content" [ngSwitch]="lb.dataSource.selectedTab">\n        <ng-container *ngSwitchCase="\'overview\'">\n            <ng-container *ngTemplateOutlet="overview"></ng-container>\n        </ng-container>\n        <ng-container *ngSwitchCase="\'campi\'">\n            <ng-container *ngTemplateOutlet="campi"></ng-container>\n        </ng-container>\n        <ng-container *ngSwitchCase="\'oggetti-collegati\'">\n            <ng-container *ngTemplateOutlet="oggetti"></ng-container>\n        </ng-container>\n        <ng-container *ngSwitchCase="\'entita-collegate\'">\n            <ng-container *ngTemplateOutlet="entita"></ng-container>\n        </ng-container>\n        <ng-container *ngSwitchCase="\'maxxi\'">\n            <ng-container *ngTemplateOutlet="maxxi"></ng-container>\n        </ng-container>\n        <ng-container *ngSwitchCase="\'wiki\'">\n            <ng-container *ngTemplateOutlet="wiki"></ng-container>\n        </ng-container>\n    </div>\n</div>\n\n\x3c!-- navigation page content templates --\x3e\n<ng-template #overview>\n    <section>\n        <div class="aw-entity__content-section">\n            <div class="aw-entity__overview-description">\n                {{lb.dataSource.myResponse.extraTab}}\n            </div>\n            <div class="aw-entity-layout__button-wrapper">\n                <button *ngIf="lb.dataSource.myResponse.wikiTab" class="n7-btn n7-btn-light"\n                    (click)="lb.eventHandler.emitInner(\'showmore\', \'wiki\')">\n                    DESCRIZIONE WIKIPEDIA <i class="n7-icon-angle-right"></i>\n                </button>\n                <button *ngIf="lb.dataSource.myResponse.extraTab" class="n7-btn n7-btn-light"\n                    (click)="lb.eventHandler.emitInner(\'showmore\', \'maxxi\')">\n                    DESCRIZIONE MAXXI <i class="n7-icon-angle-right"></i>\n                </button>\n            </div>\n        </div>\n\n        <ng-container *ngIf="lb.widgets[\'aw-entita-metadata-viewer\'].ds.out$ | async as data">\n            <div class="aw-entity__content-section aw-entity__content-section-overview">\n                <div class="aw-entity__content-section-header">\n                    <h2 class="aw-entity__content-section-title">Campi</h2>\n                    <button class="n7-btn n7-btn-light" (click)="lb.eventHandler.emitInner(\'showmore\', \'campi\')">\n                        TUTTI I CAMPI <i class="n7-icon-angle-right"></i>\n                    </button>\n                </div>\n                <n7-metadata-viewer class="aw-entity-layout__metadata-viewer" [data]="data">\n                </n7-metadata-viewer>\n            </div>\n        </ng-container>\n\n        <div class="aw-entity__content-section aw-entity__content-section-overview">\n            <div class="aw-entity__content-section-header">\n                <h2 class="aw-entity__content-section-title">Oggetti collegati</h2>\n                <button class="n7-btn n7-btn-light"\n                    (click)="lb.eventHandler.emitInner(\'showmore\', \'oggetti-collegati\')">\n                    TUTTI GLI OGGETTI COLLEGATI <i class="n7-icon-angle-right"></i>\n                </button>\n            </div>\n            <ng-container *ngFor="let preview of lb.widgets[\'aw-linked-objects\'].ds.out$ | async">\n                <n7-breadcrumbs [data]="preview.breadcrumbs">\n                </n7-breadcrumbs>\n                <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                </n7-item-preview>\n            </ng-container>\n        </div>\n\n        <div class="aw-entity__content-section aw-entity__content-section-overview">\n            <div class="aw-entity__content-section-header">\n                <h2 class="aw-entity__content-section-title">Entità collegate</h2>\n                <button class="n7-btn n7-btn-light" (click)="lb.eventHandler.emitInner(\'showmore\', \'entita-collegate\')">\n                    TUTTE LE ENTITÀ COLLEGATE <i class="n7-icon-angle-right"></i>\n                </button>\n            </div>\n            <div  [style.overflow]="\'hidden\'">\n                <aw-bubble-chart-wrapper\n                [hover]="lb.widgets[\'aw-bubble-chart\'].ds.currentHoverEntity"\n                [emit]="lb.widgets[\'aw-bubble-chart\'].emit"\n                [container]="\'bubble-chart-container-overview\'"\n                [buttons]="[\'goto\']"\n                >\n                    <n7-bubble-chart\n                    [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                    </n7-bubble-chart>\n                </aw-bubble-chart-wrapper>\n            </div>\n        </div>\n    </section>\n</ng-template>\n\n<ng-template #campi>\n    <div class="aw-entity__content-section aw-entity__content-section-fields">\n        <ng-container *ngIf="lb.widgets[\'aw-entita-metadata-viewer\'].ds.out$ | async as data">\n            <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n                <h2 class="aw-entity__content-section-title">Campi</h2>\n            </div>\n            <n7-metadata-viewer class="aw-entita-layout__metadata-viewer" [data]="data">\n            </n7-metadata-viewer>\n        </ng-container>\n    </div>\n</ng-template>\n\n<ng-template #oggetti>\n    <div class="aw-entity__content-section aw-entity__content-section-objects">\n        <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n            <h2 class="aw-entity__content-section-title">Oggetti collegati</h2>\n        </div>\n        <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n            <n7-breadcrumbs [data]="preview.breadcrumbs">\n            </n7-breadcrumbs>\n            <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n            </n7-item-preview>\n        </ng-container>\n        <n7-pagination [data]="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.pagination"\n            [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n        </n7-pagination>\n    </div>\n</ng-template>\n\n<ng-template #entita>\n    <div class="aw-entity__content-section aw-entity__content-section-entities">\n        <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n            <h2 class="aw-entity__content-section-title">Entità collegate</h2>\n        </div>\n        <div  [style.overflow]="\'hidden\'">\n            <aw-bubble-chart-wrapper\n            [hover]="lb.widgets[\'aw-bubble-chart\'].ds.currentHoverEntity"\n            [emit]="lb.widgets[\'aw-bubble-chart\'].emit"\n            [container]="\'bubble-chart-container\'"\n            [buttons]="[\'goto\']"\n            >\n                <n7-bubble-chart\n                [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                </n7-bubble-chart>\n            </aw-bubble-chart-wrapper>\n        </div>\n    </div>\n</ng-template>\n\n<ng-template #maxxi>\n    <div class="aw-entity__content-section aw-entity__content-section-maxxi">\n        <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n            <h2 class="aw-entity__content-section-title">Descrizione Maxxi</h2>\n        </div>\n        <div>\n            {{lb.dataSource.myResponse.extraTab}}\n        </div>\n    </div>\n</ng-template>\n\n<ng-template #wiki>\n    <div class="aw-entity__content-section aw-entity__content-section-wiki">\n        <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n            <h2 class="aw-entity__content-section-title">Descrizione Wikipedia</h2>\n        </div>\n        <div>\n            {{lb.dataSource.myResponse.wikiTab.text}}\n        </div>\n        <a href="{{lb.dataSource.myResponse.wikiTabUrl}}">\n            {{lb.dataSource.myResponse.wikiTab.url}}\n        </a>\n    </div>\n</ng-template>'}]}],n.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:f},{type:m},{type:E},{type:y},{type:l.Title}]},n}(_);var Pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.facetData=null,e.facetInputs={},e.allBubbles=null,e.autocompletePopoverOpen=!1,e.autocompleteChanged$=new o.Subject,e.selectedBubbles=[],e.numOfItemsStr=null,e._bubbleChart=null,e.maxBubblesSelectable=3,e.entityBubbleIdMap={},e.lastWindowWidth=-1,e.bubblePopup=null,e.currentHoverEntity=null,e.hasScrollBackground=!1,e.loadingBubbles=!1,e.updateComponent=function(t,n){e.one(t).update(n)},e}return p(e,t),e.prototype.onInit=function(t){var e=t.communication,n=t.mainState,a=t.configuration,i=t.tippy;this.communication=e,this.tippy=i,this.mainState=n,this.configuration=a,this.lastWindowWidth=window.outerWidth,this.facetData=[],this.one("aw-hero").update(this.configuration.get("home-layout")["top-hero"]),this.one("aw-home-hero-patrimonio").update(this.configuration.get("home-layout")["bottom-hero"]),this.mainState.update("headTitle","Arianna Web > Home"),this.mainState.update("pageTitle","Arianna Web: Home Layout"),this._listenAutoCompleteChanges()},e.prototype.initialFilterRequest=function(){return this.communication.request$("globalFilter",{onError:function(t){return console.error(t)}})},e.prototype.parseInitialRequest=function(t){var e=this;t.entitiesData.forEach(function(t){var n=e.configuration.get("config-keys")[t.countData.type.configKey];n&&e.facetData.push(b({},t.countData,n,{enabled:!0}))}),this.one("aw-home-facets-wrapper").update(this.facetData),this.one("aw-bubble-chart").updateOptions({context:"home",configKeys:this.configuration.get("config-keys"),bubbleContainerId:"bubbleChartContainer",containerId:"bubble-chart-container"}),this.renderPreviewsFromApolloQuery(t)},e.prototype.renderPreviewsFromApolloQuery=function(t){if(t&&t.itemsPagination){var e=t.itemsPagination.totalCount;if(e>0){for(var n=0;e>999;)e-=1e3,n+=1;var a=e+"";e<10?a="00"+e:e<100&&(a="0"+e),this.numOfItemsStr=n>0?n+"."+a:e+""}else this.numOfItemsStr=null;this.one("aw-linked-objects").updateOptions({context:"home",configKeys:this.configuration.get("config-keys")}),this.one("aw-linked-objects").update(t.itemsPagination.items)}},e.prototype.onBubbleTooltipClick=function(t,e){switch(t){case"select":if(!e)return;var n=e.bubbleId;if(!n)return;var a=null;this._bubbleChart&&(this._bubbleChart.selectAll("g").each(function(t){t.id===n&&(a=t)}),a&&this.onBubbleSelected(a))}},e.prototype.onBubbleSelected=function(t){return t&&!this.selectedBubbles.includes(t)&&this.selectedBubbles.length<this.maxBubblesSelectable?(this.loadingBubbles=0==this.selectedBubbles.length,this.selectedBubbles.push(t),!0):null},e.prototype.onBubbleDeselected=function(t){if(t&&t.bubble&&(this.selectedBubbles=this.selectedBubbles.filter(function(e){return e.id!==t.bubble.id}),t.bubble.hasCloseIcon))return t.bubble.hasCloseIcon=!1,this.filterRequest()},e.prototype.getBubblePayload=function(t){var e=this;return{reset:!0,setBubbleChart:function(t){return e._bubbleChart=t},facetData:this.facetData,source:t,selectedBubbles:this.selectedBubbles}},e.prototype.filterRequest=function(){var t=this,e=[];return this.entityBubbleIdMap&&this.selectedBubbles.forEach(function(n){var a=t.entityBubbleIdMap[n.id];a&&e.push(a)}),this.communication.request$("globalFilter",{onError:function(t){return console.error(t)},params:{selectedEntitiesIds:e,itemsPagination:{offset:0,limit:this.configuration.get("home-layout")["results-limit"]}}})},e.prototype.updateBubbles=function(t,e){e||this.renderPreviewsFromApolloQuery(t)},e.prototype.updateBubbleFilter=function(t){this.allBubbles=t.allBubbles,this.entityBubbleIdMap=t.entityIdmap},e.prototype.updateTags=function(t){t||this.renderItemTags()},e.prototype.filterBubblesBasedOnFacetsEnabled=function(){var t=this;return this.allBubbles.filter(function(e){for(var n=0;n<t.facetData.length;n++)if(e.entity.typeOfEntity.id===t.facetData[n].type.id&&!t.facetData[n].enabled)return!1;return!0})},e.prototype.handleFacetSearchChange=function(t){var e=t.inputPayload,n=t.value;this.facetInputs[e]=n},e.prototype.handleFacetSearchEnter=function(t){var e=t.inputPayload;this.facetInputs[e]},e.prototype.handleFacetHeaderClick=function(t){var e=this,n=!1,a=this.facetData.filter(function(t){return t.enabled}).length-1;if(this.facetData.forEach(function(e){e.type.id===t&&!0===e.locked||(e.type.id===t?e.enabled&&a>=1?(e.enabled=!1,e.locked=!1,n=!0):(e.enabled=!0,e.locked=!1,n=!0):1===a&&e.enabled?e.locked=!0:e.locked=!1)}),this.one("aw-home-facets-wrapper").update(this.facetData),n){var i=[];if(this.facetData.forEach(function(t){t.enabled||i.push(t.type.id)}),i){var o=this.selectedBubbles.filter(function(t){for(var n="",a=0;a<e.allBubbles.length;a++)if(e.allBubbles[a].id===t.id){n=e.allBubbles[a].entity.typeOfEntity.id;break}return!i.includes(n)});o.length!=this.selectedBubbles.length&&(this.selectedBubbles=o)}this.allBubbles.forEach(function(t){t.selected=!1;for(var n=0;n<e.selectedBubbles.length;n++)e.selectedBubbles[n].id===t.id&&(t.selected=!0)}),this.one("aw-bubble-chart").update(this.getBubblePayload(null))}},e.prototype.renderItemTags=function(){var t=this,e=[];this.selectedBubbles.forEach(function(n){for(var a="",i=0;i<t.allBubbles.length;i++)if(t.allBubbles[i].id===n.id){a=t.allBubbles[i].entity.label,e.push({label:a,icon:"n7-icon-close",payload:n.id,classes:"tag-"+t.allBubbles[i].entity.typeOfEntity.id});break}}),this.one("aw-home-item-tags-wrapper").update(e)},e.prototype.onTagClicked=function(t){if(t){var e=t;return this._bubbleChart&&this._bubbleChart.selectAll("g").each(function(t){t.id===e&&(t.hasCloseIcon=!1)}),this.selectedBubbles=this.selectedBubbles.filter(function(e){return e.id!==t}),this.filterRequest()}},e.prototype.onHeroChange=function(t){this.autocompleteChanged$.next(t)},e.prototype._scrollBackgroundControl=function(){var t=this,e=document.getElementById("bubble-results-list"),n=o.fromEvent(document.getElementById("bubble-results-list"),"scroll");setTimeout(function(){t._setHasScrollBackground(e)},500),n.pipe(r.debounceTime(50)).subscribe(function(e){var n=e.target;t._setHasScrollBackground(n)})},e.prototype._setHasScrollBackground=function(t){var e=t.scrollTop,n=t.scrollHeight,a=t.clientHeight;this.hasScrollBackground=n>e+a},e.prototype._listenAutoCompleteChanges=function(){var t=this;this.one("aw-home-autocomplete").updateOptions({config:this.configuration.get("config-keys")}),this.autocompleteChanged$.pipe(r.debounceTime(500)).subscribe(function(e){e?t.communication.request$("autoComplete",{onError:function(t){return console.error(t)},params:{input:e,itemsPagination:{offset:0,limit:t.configuration.get("home-layout")["results-limit"]}}}).subscribe(function(e){t.one("aw-home-autocomplete").update(e),t.autocompletePopoverOpen||t._toggleAutocompletePopover()}):t._toggleAutocompletePopover()})},e.prototype._toggleAutocompletePopover=function(){var t=this;if(!this.autocompletePopover){var e=document.getElementById("aw-home-advanced-autocomplete-popover");e.style.display="block",this.autocompletePopover=this.tippy(".aw-home__top-hero .n7-hero__input",{content:e,trigger:"manual",interactive:!0,arrow:!1,appendTo:"parent",theme:"light-border",placement:"bottom-start",maxWidth:"100%",onHidden:function(){return t.autocompletePopoverOpen=!1}})[0]}this.autocompletePopoverOpen?this.autocompletePopover.hide():this.autocompletePopover.show(),this.autocompletePopoverOpen=!this.autocompletePopoverOpen},e.prototype.makeRequest$=function(t,e){return this.communication.request$(t,{onError:function(t){return console.error(t)},params:e})},e}(c.LayoutDataSource);var jt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-layout.init":t.dataSource.onInit(a),t.loadFilters(),t.configuration=a.configuration;break;case"aw-home-layout.destroy":t.destroyed$.next()}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-hero.change":t.dataSource.onHeroChange(a.value);break;case"aw-home-facets-wrapper.click":t.dataSource.handleFacetHeaderClick(a);break;case"aw-home-facets-wrapper.change":if(a.value){var i={input:a.value,typeOfConfigKey:a.inputPayload.replace("-search",""),itemsPagination:{offset:0,limit:t.configuration.get("home-layout")["results-limit"]}};t.dataSource.makeRequest$("autoComplete",i).subscribe(function(e){t.emitOuter("facetswrapperresponse",{facetId:a,response:e}),t.dataSource.updateComponent("aw-autocomplete-wrapper",{key:a.value,response:e})})}break;case"aw-home-facets-wrapper.enter":t.dataSource.handleFacetSearchEnter(a);break;case"aw-bubble-chart.bubble-tooltip-close-click":t.dataSource.onBubbleTooltipClick("close",a);break;case"aw-bubble-chart.bubble-tooltip-goto-click":if(!a||!a.entityId)return;t.emitGlobal("navigate",{handler:"router",path:["aw/entita/"+a.entityId+"/overview"]});break;case"aw-bubble-chart.bubble-tooltip-select-click":a._bubbleChart=t.dataSource._bubbleChart,t.emitOuter("bubble-tooltip-select-click",a);break;case"aw-bubble-chart.click":"bubble"===a.source?a.bubble&&(t.dataSource.updateBubbleFilter(a),t.dataSource.onBubbleSelected(a.bubble)&&t.dataSource.filterRequest().subscribe(function(e){e&&(t.emitOuter("filterbubbleresponse",t.dataSource.getBubblePayload(e)),t.dataSource.updateBubbles(e))})):"close"===a.source&&(t.dataSource.updateBubbleFilter(a),t.dataSource.onBubbleDeselected({bubblePayload:a.bubblePayload,bubble:a.bubble}).subscribe(function(e){e&&(t.emitOuter("filterbubbleresponse",t.dataSource.getBubblePayload(e)),t.dataSource.updateBubbles(e))}));break;case"aw-bubble-chart.bubble-filtered":t.dataSource.updateBubbleFilter(a),t.dataSource.updateTags();var o=t.dataSource;setTimeout(function(){o.loadingBubbles=!1},500);break;case"aw-home-item-tags-wrapper.click":t.dataSource.onTagClicked(a).subscribe(function(e){t.emitOuter("filterbubbleresponse",t.dataSource.getBubblePayload(e)),t.dataSource.updateBubbles(e),t.dataSource.renderItemTags()})}})},e.prototype.loadFilters=function(){var t=this;this.dataSource.initialFilterRequest().subscribe(function(e){if(e){t.dataSource.parseInitialRequest(e);var n={setBubbleChart:function(e){return t.dataSource._bubbleChart=e},source:e,reset:!1,facetData:t.dataSource.facetData};t.emitOuter("filterbubbleresponse",n)}})},e}(c.EventHandler);var $t={layoutId:"aw-home-layout",widgets:[{id:"aw-hero"},{id:"aw-home-hero-patrimonio"},{id:"aw-bubble-chart"},{id:"aw-home-facets-wrapper"},{id:"aw-home-item-tags-wrapper"},{id:"aw-home-autocomplete"},{id:"aw-linked-objects"},{id:"aw-autocomplete-wrapper"}],layoutDS:Pt,layoutEH:jt,widgetsDataSources:dt,widgetsEventHandlers:Ct,options:{}},Lt=function(t){function n(e,n,a,i,o){var r=t.call(this,e.get("AwHomeLayoutConfig")||$t)||this;return r.router=n,r.configuration=a,r.communication=i,r.mainState=o,r}return p(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,communication:this.communication,options:this.config.options||{},tippy:u}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-home-layout",template:'<div class="aw-home" *ngIf="lb.dataSource">\n    \x3c!-- Hero section at the top of the page --\x3e\n    <div class="aw-home__top-hero">\n        <n7-hero [data]="lb.widgets[\'aw-hero\'].ds.out$ | async" [emit]="lb.widgets[\'aw-hero\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- Bubble chart --\x3e\n    <div class="aw-home__bubble-wrapper" [ngClass]="{ \'has-results\' : lb.dataSource.selectedBubbles.length > 0 }">\n        <div class="aw-home__facets-wrapper">\n            <span class="aw-home__facet"\n                *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;">\n                <n7-facet-header [data]="widgetData.header" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet-header>\n                <n7-facet [data]="widgetData.input" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet>\n            </span>\n        </div>\n        <div\n            class="aw-home__bubble-chart-wrapper"\n            [style.overflow]="lb.dataSource.loadingBubbles ? \'visible\' : \'hidden\'"\n        >\n            <aw-bubble-chart-wrapper\n                [hover]="lb.widgets[\'aw-bubble-chart\'].ds.currentHoverEntity"\n                [emit]="lb.widgets[\'aw-bubble-chart\'].emit"\n                [container]="\'bubble-chart-container\'"\n                [buttons]="[\'select\', \'goto\']"\n            >\n                    <n7-bubble-chart\n                        [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                        [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                </n7-bubble-chart>\n            </aw-bubble-chart-wrapper>\n        </div>\n\n        \x3c!-- Linked objects --\x3e\n        \x3c!--<ng-container *ngIf="lb.dataSource.selectedBubbles.length>0"> --\x3e\n        <ng-container *ngIf="lb.dataSource.selectedBubbles.length > 0" >\n            <div class="aw-home__bubble-results"\n                id="home-bubble-results"\n                [ngStyle]="{ \'display\': \'flex\' , \'flex-direction\': \'column\', \'transition\': \'opacity 1s ease-in-out;\' }"\n                [style.opacity]="lb.dataSource.loadingBubbles ? \'0\' : \'1\'"\n            >\n                <div *ngIf="lb.dataSource.numOfItemsStr">\n                    <h1 class="aw-home__bubble-results-title"><strong class="aw-home__bubble-results-title-counter">\n                        {{ lb.dataSource.numOfItemsStr }}</strong> <span> Oggetti culturali</span>\n                    </h1>\n                </div>\n                <div class="aw-home__bubble-tags-wrapper">\n                    <h3 class="aw-home__bubble-tags-title">Collegati a </h3>\n                    <ng-container *ngFor="let widgetData of lb.widgets[\'aw-home-item-tags-wrapper\'].ds.out$ | async;">\n                        <n7-tag [data]="widgetData" [emit]="lb.widgets[\'aw-home-item-tags-wrapper\'].emit">\n                        </n7-tag>\n                        <br>\n                    </ng-container>\n                </div>\n                <div class="aw-home__bubble-results-list-wrapper" >\n                    <div class="aw-home__bubble-results-list" [attr.id]="\'bubble-results-list\'">\n                        <ng-container *ngFor="let widgetData of lb.widgets[\'aw-linked-objects\'].ds.out$ | async;">\n                            <n7-item-preview\n                                [data]="widgetData"\n                                [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                            </n7-item-preview>\n                        </ng-container>\n                    </div>\n                    <div *ngIf="lb.dataSource.hasScrollBackground" class="aw-home__bubble-results-list-wrapper-with-scroll"></div>\n\n                    <div class="aw-home__bubble-results-list-actions">\n                        <a class="n7-btn n7-btn-light n7-btn-l aw-home__bubble-results-list-view-all" href="">Vedi tutti</a>\n                        <a class="n7-btn n7-btn-light n7-btn-l aw-home__bubble-results-list-view-others" href="">Vedi altri</a>\n                    </div>\n\n                </div>\n\n            </div>\n        </ng-container>\n    </div>\n\n    \x3c!-- Hero section at the bottom of the page --\x3e\n    <div class="aw-home__bottom-hero">\n        <n7-hero [data]="lb.widgets[\'aw-home-hero-patrimonio\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-hero-patrimonio\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- adavanced autocomplete popover  --\x3e\n    <div id="aw-home-advanced-autocomplete-popover" style="display: none;">\n        <n7-advanced-autocomplete\n            [data]="lb.widgets[\'aw-home-autocomplete\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-autocomplete\'].emit">\n        </n7-advanced-autocomplete>\n    </div>\n\n    \x3c!-- simple autocomplete popover. DO NOT CHANGE parent div class! --\x3e\n    \x3c!-- creating one template for each facet --\x3e\n    \x3c!-- <div id="aw-simple-autocomplete__template">\n        <span>tippyJS</span>\n        <n7-simple-autocomplete\n            [data]="lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-autocomplete-wrapper\'].emit">\n        </n7-simple-autocomplete>\n    </div> --\x3e\n    <div *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;"\n         class="aw-simple-autocomplete__{{widgetData.header.payload}}"\n         style="display: none;">\n         <n7-simple-autocomplete\n            [data]="lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-autocomplete-wrapper\'].emit">\n        </n7-simple-autocomplete>\n    </div>\n</div>'}]}],n.ctorParameters=function(){return[{type:m},{type:s.Router},{type:f},{type:E},{type:y}]},n}(_);var qt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allBubbles=null,e.selectedBubbles=[],e}return p(e,t),e.prototype.onInit=function(t){var e=t.configuration,n=t.mainState,a=t.router,i=t.options,o=t.titleService,r=t.communication;this.configuration=e,this.mainState=n,this.router=a,this.titleService=o,this.communication=r,this.options=i,this.sidebarCollapsed=!1,this.bubbleChartSectionTitle=this.configuration.get("scheda-layout")["bubble-chart"].title,this.similarItemsSectionTitle=this.configuration.get("scheda-layout")["related-items"].title,this.metadataSectionTitle=this.configuration.get("scheda-layout").metadata.title,this.hasSimilarItems=!1,this.hasBubbles=!1},e.prototype.getNavigation=function(t){return this.communication.request$("getTree",{onError:function(t){return console.error(t)},params:{treeId:t}})},e.prototype.updateNavigation=function(t){var e={iconLeft:"n7-icon-tree-icon",text:t.label,iconRight:"n7-icon-angle-left",classes:"is-expanded",payload:"header"};this.one("aw-sidebar-header").update(e)},e.prototype.loadItem=function(t){if(t){var e=this.configuration.get("scheda-layout")["related-items"]["max-related-items"];return this.communication.request$("getItemDetails",{onError:function(t){return console.error(t)},params:{itemId:t,maxSimilarItems:e}})}this.pageTitle="Collezione d'Arte",this.contentParts=[{type:"text",title:"Collezione d'Arte",content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi gravida sagittis pulvinar. Etiam iaculis maximus metus, id tincidunt libero auctor et. Proin tempus turpis vel erat ultrices, id vestibulum ante cursus. Vestibulum lobortis, ante at eleifend consequat, massa libero bibendum justo, id fermentum magna odio ac nulla. Cras aliquet scelerisque malesuada. Mauris congue fermentum tristique. Nulla imperdiet accumsan dui, tristique lobortis metus eleifend non. Donec quis odio massa. Cras sit amet sem eu turpis molestie blandit vitae sed nibh. Pellentesque ornare enim nisl, et efficitur ante elementum a. Ut nec ex finibus, congue libero feugiat, aliquam ante. Cras sem neque, pellentesque eget mi at, auctor vulputate tellus. Sed aliquam mi a tortor ultricies interdum. Etiam tincidunt nunc commodo nulla porttitor semper. Etiam porta lacinia libero a mattis. Lorem ipsum dolor sit amet, consectetur adipiscing elit."},{type:"text",title:"Centro Archivi",content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi gravida sagittis pulvinar. Etiam iaculis maximus metus, id tincidunt libero auctor et. Proin tempus turpis vel erat ultrices, id vestibulum ante cursus. Vestibulum lobortis, ante at eleifend consequat, massa libero bibendum justo, id fermentum magna odio ac nulla. Cras aliquet scelerisque malesuada. Mauris congue fermentum tristique. Nulla imperdiet accumsan dui, tristique lobortis metus eleifend non. Donec quis odio massa. Cras sit amet sem eu turpis molestie blandit vitae sed nibh. Pellentesque ornare enim nisl, et efficitur ante elementum a. Ut nec ex finibus, congue libero feugiat, aliquam ante. Cras sem neque, pellentesque eget mi at, auctor vulputate tellus. Sed aliquam mi a tortor ultricies interdum. Etiam tincidunt nunc commodo nulla porttitor semper. Etiam porta lacinia libero a mattis. Lorem ipsum dolor sit amet, consectetur adipiscing elit."}];this.one("aw-scheda-breadcrumbs").update({items:[]})},e.prototype.loadContent=function(t){var e=this;if(t){this.contentParts=[];var n={};if(this.one("aw-bubble-chart").updateOptions({context:"scheda",configKeys:this.configuration.get("config-keys"),bubbleContainerId:"bubbleChartContainer",containerId:"bubble-chart-container"}),t.text&&(n.content=t.text),this.contentParts.push(n),t.image){var a=[{type:"image",url:t.image,buildPyramid:!1}];this.imageViewerIstance?this.imageViewerIstance.open(a):this.one("aw-scheda-image").update({viewerId:"scheda-layout-viewer",_setViewer:function(t){e.imageViewerIstance=t,t.open(a)}})}var i={icon:t.item.icon,title:{main:{text:t.title,classes:"bold"}},tools:t.subTitle,actions:{}};this.one("aw-scheda-inner-title").update(i);var o={group:[]};t.fields&&(this.hasMetadata=!0,t.fields.forEach(function(t){var e=[];t.fields.forEach(function(t){e.push({label:t.key,value:t.value})}),o.group.push({title:t.label,items:e})})),this.one("aw-scheda-metadata").update(o);var r={items:[]};t.breadcrumbs.forEach(function(t){r.items.push({label:t.label,payload:t.link})}),this.one("aw-scheda-breadcrumbs").update(r)}t.similarItems?(this.hasSimilarItems=!0,this.one("aw-linked-objects").updateOptions({context:"scheda",configKeys:this.configuration.get("config-keys")}),this.one("aw-linked-objects").update(t.similarItems)):(this.hasSimilarItems=!1,this.one("aw-linked-objects").update(null))},e.prototype.collapseSidebar=function(){this.sidebarCollapsed=!this.sidebarCollapsed},e.prototype.setAllBubblesFromApolloQuery=function(t,e){if(t&&t.connectedEntities){this.allBubbles=[];for(var n=0;n<t.connectedEntities.length;n++){var a=this.configuration.get("config-keys")[t.connectedEntities[n].entity.typeOfEntity.configKey]?this.configuration.get("config-keys")[t.connectedEntities[n].entity.typeOfEntity.configKey].color.hex:"";this.allBubbles.push(b({id:this.convertEntityIdToBubbleId(t.connectedEntities[n].entity.id)},t.connectedEntities[n],{color:a}))}this.one("aw-scheda-bubble-chart").update({containerId:"bubble-chart-container",width:window.innerWidth/1.8,bubbles:this.allBubbles,reset:e||!1})}},e.prototype.convertEntityIdToBubbleId=function(t){return t?"B_"+t.replace(/-/g,"_"):null},e}(c.LayoutDataSource);var Mt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-scheda-layout.init":t.dataSource.onInit(a),t.configuration=a.configuration,t.route=a.route;var i=t.route.snapshot.params.id||"";t.listenRoute(),t.loadNavigation(i);break;case"aw-scheda-layout.destroy":t.destroyed$.next()}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-tree.click":a&&t.emitGlobal("navigate",{path:[t.configuration.get("paths").schedaBasePath+a],handler:"router"});break;case"aw-sidebar-header.click":t.dataSource.collapseSidebar();break;case"aw-bubble-chart.bubble-tooltip-goto-click":if(!a||!a.entityId)return;t.emitGlobal("navigate",{handler:"router",path:["aw/entita/"+a.entityId+"/overview"]})}})},e.prototype.listenRoute=function(){var t=this;this.route.paramMap.subscribe(function(e){e.get("id")?t.dataSource.loadItem(e.get("id")).subscribe(function(e){if(e&&(t.dataSource.loadContent(e),e.connectedEntities)){t.dataSource.hasBubbles=!0;var n={source:e,connectedEntities:e.connectedEntities};t.emitOuter("filterbubbleresponse",n)}}):t.dataSource.loadItem()})},e.prototype.loadNavigation=function(t){var e=this;this.dataSource.getNavigation("patrimonio").subscribe(function(n){n&&(e.dataSource.updateNavigation(n),e.emitOuter("navigationresponse",n)),t&&e.emitOuter("selectItem",t)})},e}(c.EventHandler);var Rt={layoutId:"aw-scheda-layout",widgets:[{id:"aw-sidebar-header"},{id:"aw-tree"},{id:"aw-scheda-breadcrumbs"},{id:"aw-scheda-metadata"},{id:"aw-scheda-image"},{id:"aw-scheda-inner-title"},{id:"aw-bubble-chart"},{id:"aw-linked-objects"}],layoutDS:qt,layoutEH:Mt,widgetsDataSources:dt,widgetsEventHandlers:Ct,options:{}},Nt=function(t){function n(e,n,a,i,o,r,s){var l=t.call(this,i.get("AwPatrimonioLayoutConfig")||Rt)||this;return l.router=e,l.route=n,l.configuration=a,l.layoutsConfiguration=i,l.mainState=o,l.titleService=r,l.communication=s,l}return p(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-scheda-layout",template:'<div class="aw-scheda" id="scheda-layout" [style.overflow]="\'hidden\'">\n    <div class="aw-scheda__content"\n         [ngClass]="{ \'is-collapsed\' : lb.dataSource.sidebarCollapsed }">\n\n         \x3c!-- Left sidebar: tree --\x3e\n        <div class="aw-scheda__tree">\n            <n7-sidebar-header\n                [data]="lb.widgets[\'aw-sidebar-header\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-sidebar-header\'].emit"\n            ></n7-sidebar-header>\n            <n7-tree\n                [data]="lb.widgets[\'aw-tree\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-tree\'].emit"\n                [hidden]="lb.dataSource.sidebarCollapsed"\n            ></n7-tree>\n        </div>\n\n        \x3c!-- Scheda details --\x3e\n        <div class="aw-scheda__scheda-wrapper">\n            <n7-breadcrumbs\n                [data]="lb.widgets[\'aw-scheda-breadcrumbs\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-scheda-breadcrumbs\'].emit"\n            ></n7-breadcrumbs>\n\n            <n7-inner-title\n            [data]="lb.widgets[\'aw-scheda-inner-title\'].ds.out$ | async"\n            ></n7-inner-title>\n\n            <n7-image-viewer\n                [data]="lb.widgets[\'aw-scheda-image\'].ds.out$ | async"\n            >\n            </n7-image-viewer>\n\n            <section class="aw-scheda__description">\n                <div *ngFor="let part of lb.dataSource.contentParts">\n                    <div [innerHTML]="part.content"></div>\n                </div>\n            </section>\n\n            <section class="aw-scheda__metadata"\n                [hidden] = "!lb.hasMetadata"\n            >\n                <div class="aw-scheda__inner-title">{{lb.dataSource.metadataSectionTitle}}</div>\n                <n7-metadata-viewer\n                    [data]="lb.widgets[\'aw-scheda-metadata\'].ds.out$ | async">\n                </n7-metadata-viewer>\n            </section>\n\n            <section\n                class="aw-scheda__bubble-chart"\n            >\n                <div\n                    [hidden] = "!lb.dataSource.hasBubbles"\n                    class="aw-scheda__inner-title">{{lb.dataSource.bubbleChartSectionTitle}}\n                </div>\n                <div  [style.overflow]="\'hidden\'">\n                    <aw-bubble-chart-wrapper\n                    [hover]="lb.widgets[\'aw-bubble-chart\'].ds.currentHoverEntity"\n                    [emit]="lb.widgets[\'aw-bubble-chart\'].emit"\n                    [container]="\'bubble-chart-container\'"\n                    [buttons]="[\'goto\']"\n                    >\n                        <n7-bubble-chart\n                        [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                        [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                        </n7-bubble-chart>\n                    </aw-bubble-chart-wrapper>\n                </div>\n            </section>\n\n            <section\n                [hidden] = "!lb.dataSource.hasSimilarItems"\n                id="related-item-container" class="aw-scheda__related">\n                <div class="aw-scheda__inner-title">{{lb.dataSource.similarItemsSectionTitle}}</div>\n                <div class="aw-scheda__related-items">\n                    <ng-container *ngFor="let widgetData of lb.widgets[\'aw-linked-objects\'].ds.out$ | async;">\n                        <n7-item-preview\n                            [data]="widgetData"\n                            >\n                        </n7-item-preview>\n                    </ng-container>\n                </div>\n             </section>\n        </div>\n    </div>\n</div>\n'}]}],n.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:f},{type:m},{type:y},{type:l.Title},{type:E}]},n}(_);var Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(t){},e}(c.LayoutDataSource),Wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){},e}(c.EventHandler),Kt={layoutId:"aw-works-layout",widgets:[],layoutDS:Ft,layoutEH:Wt,widgetsDataSources:dt,widgetsEventHandlers:Ct,layoutOptions:{}},zt=function(t){function n(){return t.call(this,Kt)||this}return p(n,t),n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-works-layout",template:'<div class="" *ngIf="lb.dataSource">\n    Works page!\n</div>'}]}],n.ctorParameters=function(){return[]},n}(_),Gt=function(){function t(){}return t.prototype.onClick=function(t,e){this.emit(t,e)},t.decorators=[{type:e.Component,args:[{selector:"aw-bubble-chart-wrapper",template:'<div class="aw-bubble-chart-wrapper">\n    <button style="display: none;"\n            id="bubble-popup-menu_closebutton"\n            (click)="onClick(\'bubble-tooltip-close-click\',{entityId: (hover ? hover.id : null)} )"></button>\n    <button style="display: none;"\n            id="bubble-popup-menu_gotobutton"\n            (click)="onClick(\'bubble-tooltip-goto-click\',{entityId:(hover  ? hover.id : null)} )"></button>\n    <button style="display: none;"\n            id="bubble-popup-menu_selectbutton"\n            (click)="onClick(\'bubble-tooltip-select-click\',{entityId:(hover ? hover.id : null)} )"></button>\n    <div id="bubble-popup-menu" class="aw-bubble-popup-menu" style="display: none;">\n        <h2 class="aw-bubble-popup-menu__title">{{ ( hover ? hover.label : \'\' ) }}</h2>\n        <span class="n7-icon-close aw-bubble-popup-menu__close" onclick="document.getElementById(\'bubble-popup-menu_closebutton\').click();"></span>\n        <p class="aw-bubble-popup-menu__text">\n                {{ ( hover ? \'È collegato a \'+ hover.count + \' entità\' : \'\' ) }}\n        </p>\n        <div class="aw-bubble-popup-menu__actions">\n            <span\n            class="aw-bubble-popup-menu__link"\n            *ngIf="buttons.indexOf(\'goto\') >= 0"\n            onclick="document.getElementById(\'bubble-popup-menu_gotobutton\').click();">\n                Vai alla scheda\n            </span> <ng-container *ngIf="buttons.length > 1"> | </ng-container>\n            <span\n                class="aw-bubble-popup-menu__link"\n                *ngIf="buttons.indexOf(\'select\') >= 0"\n                onclick="document.getElementById(\'bubble-popup-menu_selectbutton\').click();">\n                    Seleziona\n            </span>\n        </div>\n    </div>\n    <div [id]="container">\n        <ng-content></ng-content>\n    </div>\n</div>'}]}],t.propDecorators={hover:[{type:e.Input}],emit:[{type:e.Input}],container:[{type:e.Input}],buttons:[{type:e.Input}]},t}();var Vt=[Bt,Tt,Lt,Nt,zt,Gt],Ut=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:Vt,imports:[n.CommonModule,i.DvComponentsLibModule,W],providers:[],exports:Vt}]}],t}(),Qt=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[n.CommonModule],providers:[],exports:[W,Ut]}]}],t}();t.AbstractLayout=_,t.ApolloProvider=v,t.ApolloProviderConfig=g,t.AwAboutLayoutComponent=Bt,t.AwAboutLayoutConfig=Dt,t.AwAboutLayoutDS=K,t.AwAboutLayoutEH=z,t.AwAutocompleteWrapperDS=U,t.AwAutocompleteWrapperEH=bt,t.AwBubbleChartDS=Q,t.AwBubbleChartEH=ht,t.AwEntitaLayoutComponent=Tt,t.AwEntitaLayoutConfig=Ot,t.AwEntitaLayoutDS=At,t.AwEntitaLayoutEH=Ht,t.AwEntitaMetadataViewerDS=it,t.AwEntitaNavDS=at,t.AwEntitaNavEH=St,t.AwHeroDS=X,t.AwHeroEH=ft,t.AwHomeAutocompleteDS=nt,t.AwHomeAutocompleteEH=wt,t.AwHomeBubbleChartDS=Y,t.AwHomeBubbleChartEH=mt,t.AwHomeFacetsWrapperDS=tt,t.AwHomeFacetsWrapperEH=yt,t.AwHomeHeroPatrimonioDS=Z,t.AwHomeHeroPatrimonioEH=gt,t.AwHomeItemTagsWrapperDS=et,t.AwHomeItemTagsWrapperEH=vt,t.AwHomeLayoutComponent=Lt,t.AwHomeLayoutConfig=$t,t.AwHomeLayoutDS=Pt,t.AwHomeLayoutEH=jt,t.AwLinkedObjectsDS=G,t.AwLinkedObjectsEH=pt,t.AwPatrimonioLayoutConfig=Rt,t.AwSchedaBreadcrumbsDS=st,t.AwSchedaImageDS=ct,t.AwSchedaInnerTitleDS=ut,t.AwSchedaLayoutComponent=Nt,t.AwSchedaLayoutDS=qt,t.AwSchedaLayoutEH=Mt,t.AwSchedaMetadataDS=lt,t.AwSchedaSidebarEH=Et,t.AwSidebarHeaderDS=rt,t.AwSidebarHeaderEH=_t,t.AwTableDS=J,t.AwTableEH=kt,t.AwTreeDS=ot,t.AwTreeEH=It,t.AwWorksLayoutComponent=zt,t.AwWorksLayoutConfig=Kt,t.AwWorksLayoutDS=Ft,t.AwWorksLayoutEH=Wt,t.BreadcrumbsDS=B,t.BreadcrumbsEH=T,t.BubbleChartWrapperComponent=Gt,t.CommunicationService=E,t.ConfigurationService=f,t.FooterDS=x,t.FooterEH=P,t.HeaderDS=C,t.HeaderEH=H,t.JsonConfigService=xt,t.LayoutsConfigurationService=m,t.MainLayoutComponent=L,t.MainLayoutConfig=$,t.MainLayoutDS=I,t.MainLayoutEH=k,t.MainStateService=y,t.N7BoilerplateAriannaWebModule=Ut,t.N7BoilerplateCommonModule=W,t.N7BoilerplateLibModule=Qt,t.Page404LayoutComponent=N,t.Page404LayoutConfig=R,t.Page404LayoutDS=q,t.Page404LayoutEH=M,t.RestProvider=S,t.RestProviderConfig=w,t.SubnavDS=D,t.SubnavEH=O,t.ɵa=E,t.ɵb=y,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=n7-frontend-boilerplate.umd.min.js.map