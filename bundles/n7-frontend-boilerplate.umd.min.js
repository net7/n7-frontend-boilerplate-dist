!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http"),require("@n7-frontend/components"),require("rxjs"),require("rxjs/operators"),require("@angular/router"),require("@angular/platform-browser"),require("@n7-frontend/core")):"function"==typeof define&&define.amd?define("@n7-frontend/boilerplate",["exports","@angular/core","@angular/common","@angular/common/http","@n7-frontend/components","rxjs","rxjs/operators","@angular/router","@angular/platform-browser","@n7-frontend/core"],e):e(((t=t||self)["n7-frontend"]=t["n7-frontend"]||{},t["n7-frontend"].boilerplate={}),t.ng.core,t.ng.common,t.ng.common.http,t.components,t.rxjs,t.rxjs.operators,t.ng.router,t.ng.platformBrowser,t.core$1)}(this,function(t,e,n,o,r,i,a,s,u,c){"use strict";var l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function p(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var d=function(){return(d=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};var f=function(){function t(t){var e=this;this.config=t,this.defaults={},this.get=function(t){return e.defaults[t]},this.set=function(t,n){return e.defaults[t]=n},this.config.global&&Object.keys(this.config.global).forEach(function(t){e.set(t,e.config.global[t])})}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["config"]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject("config"))},token:t,providedIn:"root"}),t}();var h=function(){function t(t){var e=this;this.config=t,this.defaults={},this.get=function(t){return e.defaults[t]},this.set=function(t,n){return e.defaults[t]=n},this.config.layouts&&Object.keys(this.config.layouts).forEach(function(t){e.set(t,e.config.layouts[t])})}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["config"]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject("config"))},token:t,providedIn:"root"}),t}();var y=function(){function t(){var t=this;this.custom={},this.default={headTitle:new i.ReplaySubject,pageTitle:new i.ReplaySubject,subnav:new i.ReplaySubject,breadcrumbs:new i.ReplaySubject,filters:new i.ReplaySubject},this.get$=function(e){return t._get("default",e)},this.getCustom$=function(e){return t._get("custom",e)},this.update=function(e,n){return t._update("default",e,n)},this.updateCustom=function(e,n){return t._update("custom",e,n)},this.has=function(e){return!!t.default[e]},this.hasCustom=function(e){return!!t.custom[e]}}return t.prototype.addCustom=function(t,e){if(this.custom[t])throw Error("custom stream "+t+" exists!");this.custom[t]=e},t.prototype._update=function(t,e,n){if(!this[t])throw Error(t+" stream group does not exists!");if(!this[t][e])throw Error(t+" stream "+e+" does not exists!");this[t][e].next(n)},t.prototype._get=function(t,e){if(!this[t])throw Error(t+" stream group does not exists!");if(!this[t][e])throw Error(t+" stream "+e+" does not exists!");return this[t][e]},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var m={getLastPosts:{queryName:"getLastPosts",queryBody:"\n      {\n        getLastPosts(__PARAMS__) {\n          id\n          title\n        }\n      }\n    "},globalFilter:{queryName:"globalFilter",queryBody:"{\n      globalFilter(__PARAMS__){\n        entitiesData {\n          countData {\n            type {\n              id\n              label\n              color\n              icon\n            }\n            count\n          }\n          entitiesCountData {\n            entity {\n              id\n              label\n              typeOfEntity {\n                id\n              }\n            }\n            count\n          }\n        }\n        itemsPagination {\n          totalCount\n          items {\n            item {\n              id\n              label\n              info {\n                key\n                value\n              }\n            }\n            thumbnail\n            relatedTOEData {\n              type {\n                id\n                label\n                icon\n                color\n              }\n              count\n            }\n          }\n        }\n      }\n    }"}},b=function(){function t(t,e){this.config=t,this.http=e;try{this.providerConfig=this.config.get("communication").providers.apollo}catch(t){throw Error("No config found for apollo provider!")}}return t.prototype.request$=function(t,e){var n=e.params,o=e.method,r=e.httpOptions,i=m[t];this.providerConfig.config&&this.providerConfig.config[t]&&(i=this.providerConfig.config[t]);var s=(i=i||{}).queryName,u=i.queryBody;if(!s||!u)throw Error('No config found for requestId "'+t+'"');if(n){var c=this.makeParamsStr(n);u=u.replace("__PARAMS__",c)}else u=u.replace("(__PARAMS__)","");return(o&&"GET"===o?this.http.get(this.providerConfig.baseUrl):this.http.post(this.providerConfig.baseUrl,{query:u},r)).pipe(a.map(function(t){return t.data[s]}))},t.prototype.makeParamsStr=function(t){var e=this,n=[];return Object.keys(t).forEach(function(o){if(Array.isArray(t[o])){var r=[];t[o].forEach(function(t){if("object"==typeof t){var n=e.makeParamsStr(t);r.push("{ "+n+" }")}else isNaN(t)?r.push('"'+t+'"'):r.push(""+t)}),n.push(o+": ["+r.join(",")+"]")}else if("object"==typeof t[o]&&t[o]){var i=e.makeParamsStr(t[o]);n.push(o+": { "+i+" }")}else"string"==typeof t[o]&&0===o.indexOf("$")?n.push(o.replace("$","")+": "+t[o]):isNaN(t[o])?n.push(o+': "'+t[o]+'"'):n.push(o+": "+t[o])}),n.join(" ")},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:f},{type:o.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(f),e.ɵɵinject(o.HttpClient))},token:t,providedIn:"root"}),t}();var g={getLastPosts:"posts"},v=function(){function t(t,e){this.config=t,this.http=e;try{this.providerConfig=this.config.get("communication").providers.rest}catch(t){throw Error("No config found for rest provider!")}}return t.prototype.request$=function(t,e){void 0===e&&(e={});var n=e.params,o=e.method,r=e.httpOptions,i=g[t];if(o||(o=this.providerConfig.defaultMethod||"GET"),this.providerConfig.config&&this.providerConfig.config[t]&&(i=this.providerConfig.config[t]),!i)throw Error('No config found for requestId "'+t+'"');if("POST"===o||"PUT"===o)return this.http[o.toLowerCase()](this.providerConfig.baseUrl+i,n,r);if("GET"===o||"DELETE"===o)return this.http[o.toLowerCase()](this.providerConfig.baseUrl+i,r);throw Error("Rest method "+o+" not supported")},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:f},{type:o.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(f),e.ɵɵinject(o.HttpClient))},token:t,providedIn:"root"}),t}();var w=function(){function t(t,e,n){this.config=t,this.apollo=e,this.rest=n;try{this.communicationConfig=this.config.get("communication"),this.defaultProvider=this.communicationConfig.defaultProvider}catch(t){throw Error("No communications.defaultProvider setted in config")}}return t.prototype.request$=function(t,e,n){var o=this;if(void 0===e&&(e={}),!this[n=n||this.defaultProvider])throw Error("There is no "+n+" provider");var r=e.onError;return this[n].request$(t,e).pipe(a.catchError(function(t){return o.handleError(t,r)}))},t.prototype.handleError=function(t,e){return e?e(t):console.warn("No error handler for communication request",t),i.empty()},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:f},{type:b},{type:v}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(f),e.ɵɵinject(b),e.ɵɵinject(v))},token:t,providedIn:"root"}),t}();var S=function(){function t(t){this.config=t,this.widgets=this.config.widgets,this.lb=new c.LayoutBuilder(this.config.layoutId)}return t.prototype.initPayload=function(){},t.prototype.onInit=function(){var t=this;this.lb.ready$.subscribe(function(){t.lb.eventHandler.emitInner("init",t.initPayload())}),this.lb.init({widgetsConfig:this.widgets,widgetsDataSources:this.config.widgetsDataSources,widgetsEventHandlers:this.config.widgetsEventHandlers,dataSource:new this.config.layoutDS,eventHandler:new this.config.layoutEH})},t.prototype.onDestroy=function(){this.lb.eventHandler.emitInner("destroy")},t}();var I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(t){var e=this,n=t.configuration,o=t.mainState,r=t.router,i=t.options,a=t.titleService;this.configuration=n,this.mainState=o,this.router=r,this.titleService=a,this.options=i,this.one("header").update(this.configuration.get("header")),this.mainState.get$("headTitle").subscribe(function(t){return e.titleService.setTitle(t)}),this.mainState.get$("pageTitle").subscribe(function(t){return e.pageTitle=t}),this.mainState.get$("subnav").subscribe(function(t){return e.one("subnav").update(t)}),this.mainState.get$("breadcrumbs").subscribe(function(t){return e.one("breadcrumbs").update(t)})},e.prototype.onNavigate=function(t){if("router"===t.handler){if(!t.path)throw Error("onNavigate: no path for router navigate");this.router.navigate(t.path)}},e}(c.LayoutDataSource);var E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new i.Subject,e}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"main-layout.init":t.dataSource.onInit(o);break;case"main-layout.destroy":t.destroyed$.next()}}),c.EventHandler.globalEvents$.pipe(a.takeUntil(this.destroyed$)).subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"global.navigate":t.dataSource.onNavigate(o)}})},e}(c.EventHandler);var D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){if(console.log("header",t),t)return delete t.actions,d({},t,{logo:{image:"https://i.imgur.com/kTND3Do.png",payload:"aw/home"},nav:{items:[{text:"Home",payload:"aw/home",icon:"n7-icon-home"},{text:"Patrimonio",payload:"aw/patrimonio",icon:"n7-icon-tree-icon"},{text:"Galleria",payload:"aw/galleria",icon:"n7-icon-th"},{text:"Ricerca",payload:"aw/ricerca",icon:"n7-icon-search"},{text:"Utenti",payload:"aw/utenti",icon:"n7-icon-facebook"}]},user:{img:"https://placeimg.com/150/150/any/people",name:"Giorgio Spinosa"},menuToggle:{open:{payload:"mobile-open"},close:{payload:"mobile-close"}}})},e}(c.DataSource),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return{classes:"main-subnav",items:t}},e.prototype.setActive=function(t){this.output.items.forEach(function(e){e._meta.id===t?(e.classes="is-current",e._meta.isActive=!0):(e.classes="",e._meta.isActive=!1)})},e.prototype.getActive=function(){return this.output.items.filter(function(t){return t._meta.isActive})[0]||null},e}(c.DataSource),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e}(c.DataSource),C=Object.freeze({HeaderDS:D,SubnavDS:H,BreadcrumbsDS:A}),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"header.click":t.emitGlobal("navigate",{handler:"router",path:[o]})}})},e}(c.EventHandler),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"subnav.click":"navigate"===o.source&&t.emitGlobal("navigate",o),t.emitGlobal(n,o)}})},e}(c.EventHandler),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"breadcrumbs.click":"navigate"===o.source&&t.emitGlobal("navigate",o),t.emitGlobal(n,o)}})},e}(c.EventHandler),x=Object.freeze({HeaderEH:P,SubnavEH:_,BreadcrumbsEH:j}),k={layoutId:"main-layout",widgets:[{id:"header"},{id:"subnav"},{id:"breadcrumbs"}],layoutDS:I,layoutEH:E,widgetsDataSources:C,widgetsEventHandlers:x,options:{}},L=function(t){function n(e,n,o,r,i){var a=t.call(this,o.get("MainLayoutConfig")||k)||this;return a.router=e,a.configuration=n,a.layoutsConfiguration=o,a.mainState=r,a.titleService=i,a}return p(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,titleService:this.titleService,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"main-layout",template:'<div class="n7-main-layout" id="main-layout">\n    <div class="n7-page-content">\n        <n7-header\n        [emit]="lb.widgets[\'header\'].emit"\n        [data]="lb.widgets[\'header\'].ds.out$ | async"></n7-header>\n\n        \x3c!-- <n7-nav \n        *ngIf="!lb.dataSource.options.sidebar"\n        [emit]="lb.widgets[\'subnav\'].emit"\n        [data]="lb.widgets[\'subnav\'].ds.out$ | async">\n        </n7-nav> --\x3e\n\n        <main class="n7-content">\n            <div class="n7-top-page-bar">\n                <div class="n7-top-page-bar__main">\n                    \x3c!-- <h1 \n                    *ngIf="lb.dataSource.pageTitle"\n                    class="n7-top-page-bar__title">{{ lb.dataSource.pageTitle }}</h1>\n                    <n7-breadcrumbs \n                    [emit]="lb.widgets[\'breadcrumbs\'].emit"\n                    [data]="lb.widgets[\'breadcrumbs\'].ds.out$ | async">\n                    </n7-breadcrumbs> --\x3e\n                </div>\n                \x3c!--<div *ngIf="lb.dataSource.pageTools" class="n7-top-page-bar__tools">\n                    <a *ngFor="let tool of lb.dataSource.pageTools" \n                    (click)="lb.eventHandler.emitInner(\'tools-click\', tool.payload)" \n                    class="n7-btn {{ tool.classes || \'\' }}">\n                        {{ tool.label | translate }}\n                    </a>\n                </div>--\x3e\n            </div>\n            \n            <div class="n7-alert-bar">\n                \x3c!--<n7-alert\n                [attr.id]="\'main-layout-alert\'"\n                [data]="lb.dataSource.alertData$ | async"\n                [emit]="lb.dataSource.closeAlert.bind(lb.dataSource)"></n7-alert>--\x3e\n            </div>\n            <ng-content></ng-content>\n        </main>\n    </div>\n\n    <div class="n7-footer-wrapper"></div>\n</div>'}]}],n.ctorParameters=function(){return[{type:s.Router},{type:f},{type:h},{type:y},{type:u.Title}]},n}(S);var B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(t){var e=t.options;this.options=e},e}(c.LayoutDataSource);var O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new i.Subject,e}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"n7-page404-layout.init":t.dataSource.onInit(o);break;case"n7-page404-layout.destroy":t.destroyed$.next()}})},e}(c.EventHandler);var $={layoutId:"n7-page404-layout",widgets:[],layoutDS:B,layoutEH:O,widgetsDataSources:C,widgetsEventHandlers:x,options:{}},T=function(t){function n(e){return t.call(this,e.get("Page404LayoutConfig")||$)||this}return p(n,t),n.prototype.initPayload=function(){return{options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"n7-page404-layout",template:'<div class="n7-page404-layout">\n    PAGE404!!!\n</div>'}]}],n.ctorParameters=function(){return[{type:h}]},n}(S),M=[L,T],q=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[y,f,h,w,b,{provide:"config",useValue:e}]}},t.decorators=[{type:e.NgModule,args:[{declarations:M,imports:[n.CommonModule,o.HttpClientModule,r.DvComponentsLibModule],providers:[],exports:M}]}],t}(),F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.facetData=null,e.facetInputs={},e.allBubbles=null,e.selectedBubbleIds=[],e.numOfItemsStr=null,e}return p(e,t),e.prototype.onInit=function(t){var e=this,n=t.communication,o=t.mainState;this.communication=n,this.mainState=o,this.one("aw-hero").update({}),this.communication.request$("globalFilter",{onError:function(t){return console.log(t)}}).subscribe(function(t){console.log("apollo-response",{response:t}),e.facetData=[],t.entitiesData.forEach(function(t){e.facetData.push(d({},t.countData,{enabled:!0}))}),e.one("aw-home-facets-wrapper").update(e.facetData),e.renderBubblesFromApolloQuery(t),e.renderPreviewsFromApolloQuery(t)}),this.mainState.update("headTitle","Arianna Web > Home"),this.mainState.update("pageTitle","Arianna Web: Home Layout")},e.prototype.renderPreviewsFromApolloQuery=function(t){if(t&&t.itemsPagination){var e=t.itemsPagination.totalCount;if(e>0){for(var n=0;e>999;)e-=1e3,n+=1;this.numOfItemsStr=n>0?n+"."+e:e+""}else this.numOfItemsStr=null;this.one("aw-home-item-preview-wrapper").update(t.itemsPagination.items)}},e.prototype.onBubbleSelected=function(t){t&&t.id&&(this.selectedBubbleIds.includes(t.id)||this.selectedBubbleIds.push(t.id)),this.updateItemPreviews()},e.prototype.onBubbleDeselected=function(t){t&&t.id&&(this.selectedBubbleIds=this.selectedBubbleIds.filter(function(e){return e!==t.id})),this.updateItemPreviews()},e.prototype.updateItemPreviews=function(){var t=this;this.communication.request$("globalFilter",{onError:function(t){return console.log(t)},params:{selectedEntitiesIds:this.selectedBubbleIds,itemsPagination:{offset:0,limit:4}}}).subscribe(function(e){t.renderPreviewsFromApolloQuery(e),t.renderItemTags()})},e.prototype.renderBubblesFromApolloQuery=function(t){if(t&&t.entitiesData){this.allBubbles=[];for(var e=0;e<t.entitiesData.length;e++)for(var n=t.entitiesData[e],o=0;o<n.entitiesCountData.length;o++)this.allBubbles.push(d({},n.entitiesCountData[o],{color:n.countData.type.color}));this.allBubbles.map(function(t){return t.entity.id="B_"+t.entity.id.replace(/-/g,"_"),t}),this.one("aw-home-bubble-chart").update({width:window.innerWidth/1.8,bubbles:this.allBubbles})}},e.prototype.handleFacetSearchChange=function(t){var e=t.inputPayload,n=t.value;this.facetInputs[e]=n,console.log("changed: "+e+" with value: "+n)},e.prototype.handleFacetSearchEnter=function(t){var e=t.inputPayload,n=this.facetInputs[e];console.log("entered: "+e+" with value: "+n)},e.prototype.handleFacetHeaderClick=function(t){var e=this,n=!1,o=this.facetData.filter(function(t){return t.enabled}).length;if(this.facetData.forEach(function(e){e.type.id===t&&(e.enabled?o>1&&(e.enabled=!1,n=!0):(e.enabled=!0,n=!0))}),this.one("aw-home-facets-wrapper").update(this.facetData),n){var r=[];if(this.facetData.forEach(function(t){t.enabled||r.push(t.type.id)}),r){var i=this.selectedBubbleIds.filter(function(t){for(var n="",o=0;o<e.allBubbles.length;o++)if(e.allBubbles[o].entity.id===t){n=e.allBubbles[o].entity.typeOfEntity.id;break}return!r.includes(n)});i.length!=this.selectedBubbleIds.length&&(this.selectedBubbleIds=i,this.updateItemPreviews())}var a=this.allBubbles.filter(function(t){for(var n=0;n<e.facetData.length;n++)if(t.entity.typeOfEntity.id===e.facetData[n].type.id&&!e.facetData[n].enabled)return!1;return!0});a.forEach(function(t){t.selected=!1,e.selectedBubbleIds.includes(t.entity.id)&&(t.selected=!0)}),this.one("aw-home-bubble-chart").update({width:window.innerWidth/1.8,bubbles:a,reset:!0})}},e.prototype.renderItemTags=function(){var t=this,e=[];this.selectedBubbleIds.forEach(function(n){for(var o="",r=0;r<t.allBubbles.length;r++)if(t.allBubbles[r].entity.id===n){o=t.allBubbles[r].entity.label;break}e.push({label:o})}),this.one("aw-home-item-tags-wrapper").update(e)},e.prototype._getSubnav=function(){return["home","results","single"].map(function(t){return{text:t.toUpperCase(),payload:{source:"navigate",handler:"router",path:["aw/"+t],id:t},_meta:{id:t}}})},e.prototype._getBreadcrumbs=function(){return{items:[{label:"Arianna Web",payload:{source:"navigate",handler:"router",path:["aw/home"]}},{label:"Home Layout",payload:{source:"navigate",handler:"router",path:["aw/home"]}}]}},e}(c.LayoutDataSource);var N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new i.Subject,e}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"aw-home-layout.init":t.dataSource.onInit(o);break;case"aw-home-layout.destroy":t.destroyed$.next()}}),this.outerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"aw-hero.change":o.inputPayload,o.value;break;case"aw-home-facets-wrapper.click":t.dataSource.handleFacetHeaderClick(o);break;case"aw-home-facets-wrapper.change":t.dataSource.handleFacetSearchChange(o);break;case"aw-home-facets-wrapper.enter":t.dataSource.handleFacetSearchEnter(o);break;case"aw-home-bubble-chart.click":"bubble"===o.source?t.dataSource.onBubbleSelected(o.bubblePayload):"close"===o.source&&t.dataSource.onBubbleDeselected(o.bubblePayload)}})},e}(c.EventHandler);var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){console.log({data:t});return{title:"Arte, architettura e fotografia nel XXII secolo",text:"Consulta il patrimonio completo del polo nazionale per l'arte e l'architettura contemporanee.",button:{text:"CERCA",payload:"cerca"},backgroundImage:"https://i.imgur.com/FgsxSYR.png",input:{placeholder:"Cerca in MAXXI",payload:"cerca-in-maxxi"}}},e}(c.DataSource),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return r.TABLE_MOCK},e}(c.DataSource),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return{title:"IL MAXXI",backgroundImage:"https://www.solidbackgrounds.com/images/2560x1440/2560x1440-gray-solid-color-background.jpg",image:"https://i.imgur.com/8BgHOBi.png",text:"La storia del MAXXI inizia nell'autunno del 1997 quando l'allora Ministero per i beni culturali ottiene dal Ministero della Difesa la cessione di un'ampia area nel quartiene Flaminio di Roma, occupata da officine e padiglioni della ex Caserma Montello, in disuso da tempo, con il fine di creare un nuovo polo mseale nazionale dedicato alle arti contemporanee per la cui progettazione, nel 1998, viene bandito un concorso internazionale di idee in due fasi. Il bando di concorso prevedeva un piano funzionale complesso, con la presenza di vari poli museali: un museo per l'architettura e uno per le arti del XXI secolo, uno spazio per le produzioni sperimentali, la biblioteca, l'auditorium, spazi per eventi dal vivo e infine spazi didattici.",button:{text:"NAVIGA IL PATRIMONIO",payload:"naviga-patrimonio"}}},e}(c.DataSource),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){if(!t)return null;var e=t.width?t.width:1e3,n={containerId:"bubbleChartContainer",containerWidth:e,containerHeight:700,isForceSimulationEnabled:!0,maxBubblesSelected:3,bubblesData:[]};return t.bubbles.forEach(function(t){var o=t.entity.id,r={id:t.entity.id,texts:[{id:o+"_label0",label:t.entity.label,x_function:function(t){return t.x},y_function:function(t){return t.y-t.radius/9},user_select:"none",fontSize_function:function(t){return t.radius/5},color:"white",classes:""},{id:o+"_label1",label:t.count,x_function:function(t){return t.x},y_function:function(t){return t.y+t.radius/9},user_select:"none",fontSize_function:function(t){return t.radius/6},color:"white",classes:""}],x:e/2+50,y:400,radius:t.count/55,color:t.color,hasCloseIcon:!1,payload:{id:o},selectable:!0,selected:!!t.selected&&t.selected};n.bubblesData.push(r)}),n.forceSimulationData={xPull:e/2,xPullStrength:-.01,yPull:350,yPullStrength:-.01,collisionStrengh:.99,collisionIterations:1,velocityDecay:.65},t.reset&&(n.reset=t.reset),n},e}(c.DataSource),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){var e=[],n=[];t.forEach(function(t){e.push({iconLeft:t.type.icon,text:t.type.label,additionalText:t.count,iconRight:t.enabled?"n7-icon-eye":"n7-icon-eye-slash",classes:"",payload:t.type.id}),n.push({input:{placeholder:"Search",icon:"n7-icon-search",payload:String(t.type.id)+"-search"}})});var o=[];return e.map(function(t,e){o.push({header:t,input:n[e]})}),o},e}(c.DataSource),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){var e=[];return t.forEach(function(t){var n=[{label:"Autore",value:""},{label:"",value:""}];t.item.info.forEach(function(t){"author"===t.key?n[0].value=t.value:"short_description"===t.key&&(n[1].value=t.value)});var o=t.relatedTOEData.map(function(t){return{label:t.type.label,value:t.count,icon:t.type.icon}}),r=[{items:n},{items:o}];e.push({image:t.thumbnail,title:t.item.label,metadata:r,payload:t.item.id})}),e},e}(c.DataSource),Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.transform=function(t){return t},e}(c.DataSource),V=Object.freeze({AwHeroDS:R,AwTableDS:W,AwHomeHeroPatrimonioDS:z,AwHomeBubbleChartDS:G,AwHomeFacetsWrapperDS:X,AwHomeItemPreviewWrapperDS:U,AwHomeItemTagsWrapperDS:Q}),J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){},e}(c.EventHandler),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"aw-hero.click":break;case"aw-hero.change":t.emitOuter("change",o)}})},e}(c.EventHandler),Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type;e.payload;switch(n){case"aw-home-hero-patrimonio.click":t.emitGlobal("navigate",{handler:"router",path:["aw/patrimonio"]})}})},e}(c.EventHandler),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){switch(e.type){case"aw-home-bubble-chart.click":t.emitOuter("click",e.payload)}})},e}(c.EventHandler),tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"aw-home-facets-wrapper.click":t.emitOuter("click",o);break;case"aw-home-facets-wrapper.change":t.emitOuter("change",o);break;case"aw-home-facets-wrapper.enter":t.emitOuter("enter",o)}})},e}(c.EventHandler),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){},e}(c.EventHandler),nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){},e}(c.EventHandler),ot=Object.freeze({AwTableEH:J,AwHeroEH:K,AwHomeHeroPatrimonioEH:Y,AwHomeBubbleChartEH:Z,AwHomeFacetsWrapperEH:tt,AwHomeItemPreviewWrapperEH:et,AwHomeItemTagsWrapperEH:nt}),rt={layoutId:"aw-home-layout",widgets:[{id:"aw-hero"},{id:"aw-home-hero-patrimonio",hasStaticData:!0},{id:"aw-home-bubble-chart"},{id:"aw-home-facets-wrapper"},{id:"aw-home-item-tags-wrapper"},{id:"aw-home-item-preview-wrapper"}],layoutDS:F,layoutEH:N,widgetsDataSources:V,widgetsEventHandlers:ot,options:{}},it=function(){function t(t,e){this.http=t,this.config=e}return t.prototype.load=function(t){var e=this;return this.http.get(t).pipe(a.catchError(function(t){return i.of({})}),a.tap(function(t){return e._handleResponse(t)})).toPromise()},t.prototype._handleResponse=function(t){var e=this;t&&Object.keys(t).forEach(function(n){return e.config.set(n,t[n])})},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:o.HttpClient},{type:f}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(o.HttpClient),e.ɵɵinject(f))},token:t,providedIn:"root"}),t}();var at=function(t){function n(e,n,o,r,i){var a=t.call(this,e.get("AwHomeLayoutConfig")||rt)||this;return a.router=n,a.configuration=o,a.communication=r,a.mainState=i,a}return p(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,communication:this.communication,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-home-layout",template:'<div class="aw-home" *ngIf="lb.dataSource">\n    \x3c!-- Hero section at the top of the page --\x3e\n    <div class="aw-home__top-hero">\n        <n7-hero\n            [data]="lb.widgets[\'aw-hero\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-hero\'].emit">\n        </n7-hero>\n    </div>\n    \n    \x3c!-- Bubble chart --\x3e\n    <div class="aw-home__bubble-wrapper"\n         [ngClass]="{ \'has-results\' : lb.dataSource.selectedBubbleIds.length>0 }">\n        <div class="aw-home__facets-wrapper">\n            <span class="aw-home__facet"\n                  *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;">\n                <n7-facet-header\n                    [data]="widgetData.header"\n                    [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet-header>\n                <n7-facet\n                    [data]="widgetData.input"\n                    [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet>\n            </span>\n        </div>\n\n        <div class="aw-home__bubble-chart">\n            <n7-bubble-chart\n                [data]="lb.widgets[\'aw-home-bubble-chart\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-home-bubble-chart\'].emit">\n            </n7-bubble-chart>\n        </div>\n\n        <ng-container *ngIf="lb.dataSource.selectedBubbleIds.length>0">\n            <div class="aw-home__results-wrapper">\n                <div *ngIf="lb.dataSource.numOfItemsStr"> <h1>{{ lb.dataSource.numOfItemsStr }} <span>Oggetti culturali</span></h1></div>\n                    <h3>Collegati a </h3>\n                    <ng-container *ngFor="let widgetData of lb.widgets[\'aw-home-item-tags-wrapper\'].ds.out$ | async;">\n                            <n7-tag\n                                [data]="widgetData"\n                                [emit]="lb.widgets[\'aw-home-item-tags-wrapper\'].emit">\n                            </n7-tag>\n                            <br>\n                    </ng-container>\n                <ng-container *ngFor="let widgetData of lb.widgets[\'aw-home-item-preview-wrapper\'].ds.out$ | async;">\n                    <n7-item-preview\n                        [data]="widgetData"\n                        [emit]="lb.widgets[\'aw-home-item-preview-wrapper\'].emit">\n                    </n7-item-preview>\n                </ng-container>\n            </div>\n        </ng-container>\n    </div>\n\n    \x3c!-- Hero section at the bottom of the page --\x3e\n    <div class="aw-home__bottom-hero">\n        <n7-hero\n            [data]="lb.widgets[\'aw-home-hero-patrimonio\'].ds.out$ | async" \n            [emit]="lb.widgets[\'aw-home-hero-patrimonio\'].emit">\n        </n7-hero>\n    </div>\n\n</div>'}]}],n.ctorParameters=function(){return[{type:h},{type:s.Router},{type:f},{type:w},{type:y}]},n}(S);var st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(t){},e}(c.LayoutDataSource),ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){},e}(c.EventHandler),ct={layoutId:"aw-about-layout",widgets:[],layoutDS:st,layoutEH:ut,widgetsDataSources:V,widgetsEventHandlers:ot,layoutOptions:{}},lt=function(t){function n(){return t.call(this,ct)||this}return p(n,t),n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-about-layout",template:'<div class="" *ngIf="lb.dataSource">\n    About page!\n</div>'}]}],n.ctorParameters=function(){return[]},n}(S),pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(t){},e}(c.LayoutDataSource),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.listen=function(){},e}(c.EventHandler),ft={layoutId:"aw-works-layout",widgets:[],layoutDS:pt,layoutEH:dt,widgetsDataSources:V,widgetsEventHandlers:ot,layoutOptions:{}},ht=function(t){function n(){return t.call(this,ft)||this}return p(n,t),n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-works-layout",template:'<div class="" *ngIf="lb.dataSource">\n    Works page!\n</div>'}]}],n.ctorParameters=function(){return[]},n}(S),yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(t){var e=t.configuration,n=t.mainState,o=t.router,r=t.options,i=t.titleService;this.configuration=e,this.mainState=n,this.router=o,this.titleService=i,this.options=r},e}(c.LayoutDataSource);var mt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new i.Subject,e}return p(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,o=e.payload;switch(n){case"aw-patrimonio-layout.init":t.dataSource.onInit(o);break;case"aw-patrimonio-layout.destroy":t.destroyed$.next()}})},e}(c.EventHandler);var bt={layoutId:"n7-new-layout",widgets:[],layoutDS:yt,layoutEH:mt,widgetsDataSources:V,widgetsEventHandlers:ot,options:{}},gt=function(t){function n(e,n,o,r,i){var a=t.call(this,o.get("AwPatrimonioLayoutConfig")||bt)||this;return a.router=e,a.configuration=n,a.layoutsConfiguration=o,a.mainState=r,a.titleService=i,a}return p(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,titleService:this.titleService,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-patrimonio-layout",template:'<div class="aw-patrimonio-layout" id="patrimonio-layout">\n    Layout patrimonio!\n</div>'}]}],n.ctorParameters=function(){return[{type:s.Router},{type:f},{type:h},{type:y},{type:u.Title}]},n}(S);var vt=[at,lt,ht,gt],wt=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:vt,imports:[n.CommonModule,r.DvComponentsLibModule,q],providers:[],exports:vt}]}],t}(),St=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[n.CommonModule],providers:[],exports:[q,wt]}]}],t}();t.AbstractLayout=S,t.ApolloProvider=b,t.ApolloProviderConfig=m,t.AwAboutLayoutComponent=lt,t.AwAboutLayoutConfig=ct,t.AwAboutLayoutDS=st,t.AwAboutLayoutEH=ut,t.AwHeroDS=R,t.AwHeroEH=K,t.AwHomeBubbleChartDS=G,t.AwHomeBubbleChartEH=Z,t.AwHomeFacetsWrapperDS=X,t.AwHomeFacetsWrapperEH=tt,t.AwHomeHeroPatrimonioDS=z,t.AwHomeHeroPatrimonioEH=Y,t.AwHomeItemPreviewWrapperDS=U,t.AwHomeItemPreviewWrapperEH=et,t.AwHomeItemTagsWrapperDS=Q,t.AwHomeItemTagsWrapperEH=nt,t.AwHomeLayoutComponent=at,t.AwHomeLayoutConfig=rt,t.AwHomeLayoutDS=F,t.AwHomeLayoutEH=N,t.AwPatrimonioLayoutComponent=gt,t.AwPatrimonioLayoutConfig=bt,t.AwPatrimonioLayoutDS=yt,t.AwPatrimonioLayoutEH=mt,t.AwTableDS=W,t.AwTableEH=J,t.AwWorksLayoutComponent=ht,t.AwWorksLayoutConfig=ft,t.AwWorksLayoutDS=pt,t.AwWorksLayoutEH=dt,t.BreadcrumbsDS=A,t.BreadcrumbsEH=j,t.CommunicationService=w,t.ConfigurationService=f,t.HeaderDS=D,t.HeaderEH=P,t.JsonConfigService=it,t.LayoutsConfigurationService=h,t.MainLayoutComponent=L,t.MainLayoutConfig=k,t.MainLayoutDS=I,t.MainLayoutEH=E,t.MainStateService=y,t.N7BoilerplateAriannaWebModule=wt,t.N7BoilerplateCommonModule=q,t.N7BoilerplateLibModule=St,t.Page404LayoutComponent=T,t.Page404LayoutConfig=$,t.Page404LayoutDS=B,t.Page404LayoutEH=O,t.RestProvider=v,t.RestProviderConfig=g,t.SubnavDS=H,t.SubnavEH=_,t.ɵa=w,t.ɵb=y,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=n7-frontend-boilerplate.umd.min.js.map