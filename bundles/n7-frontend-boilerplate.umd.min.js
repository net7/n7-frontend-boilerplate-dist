!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http"),require("@n7-frontend/components"),require("rxjs"),require("rxjs/operators"),require("@angular/router"),require("@angular/platform-browser"),require("@n7-frontend/core"),require("tippy.js"),require("lodash")):"function"==typeof define&&define.amd?define("@n7-frontend/boilerplate",["exports","@angular/core","@angular/common","@angular/common/http","@n7-frontend/components","rxjs","rxjs/operators","@angular/router","@angular/platform-browser","@n7-frontend/core","tippy.js","lodash"],e):e(((t=t||self)["n7-frontend"]=t["n7-frontend"]||{},t["n7-frontend"].boilerplate={}),t.ng.core,t.ng.common,t.ng.common.http,t.components,t.rxjs,t.rxjs.operators,t.ng.router,t.ng.platformBrowser,t.core$1,t.tippy,t.lodash)}(this,function(t,e,n,a,i,o,r,s,c,l,u,d){"use strict";var p="default"in u?u.default:u,h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var b=function(){return(b=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function g(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var a,i,o=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(a=o.next()).done;)r.push(a.value)}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return r}var y=function(){function t(t){var e=this;this.config=t,this.defaults={},this.get=function(t){return e.defaults[t]},this.set=function(t,n){return e.defaults[t]=n},this.config.global&&Object.keys(this.config.global).forEach(function(t){e.set(t,e.config.global[t])})}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["config"]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject("config"))},token:t,providedIn:"root"}),t}();var m=function(){function t(t){var e=this;this.config=t,this.defaults={},this.get=function(t){return e.defaults[t]},this.set=function(t,n){return e.defaults[t]=n},this.config.layouts&&Object.keys(this.config.layouts).forEach(function(t){e.set(t,e.config.layouts[t])})}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["config"]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject("config"))},token:t,providedIn:"root"}),t}();var v=function(){function t(){var t=this;this.custom={},this.default={headTitle:new o.ReplaySubject,pageTitle:new o.ReplaySubject,subnav:new o.ReplaySubject,breadcrumbs:new o.ReplaySubject,filters:new o.ReplaySubject},this.get$=function(e){return t._get("default",e)},this.getCustom$=function(e){return t._get("custom",e)},this.update=function(e,n){return t._update("default",e,n)},this.updateCustom=function(e,n){return t._update("custom",e,n)},this.has=function(e){return!!t.default[e]},this.hasCustom=function(e){return!!t.custom[e]}}return t.prototype.addCustom=function(t,e){if(this.custom[t])throw Error("custom stream "+t+" exists!");this.custom[t]=e},t.prototype._update=function(t,e,n){if(!this[t])throw Error(t+" stream group does not exists!");if(!this[t][e])throw Error(t+" stream "+e+" does not exists!");this[t][e].next(n)},t.prototype._get=function(t,e){if(!this[t])throw Error(t+" stream group does not exists!");if(!this[t][e])throw Error(t+" stream "+e+" does not exists!");return this[t][e]},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var w={getLastPosts:{queryName:"getLastPosts",queryBody:"\n      {\n        getLastPosts(__PARAMS__) {\n          id\n          title\n        }\n      }\n    "},getTree:{queryName:"getTreeOfItems",queryBody:"\n    {\n      getTreeOfItems{\n        id\n        label\n        icon\n        branches {\n          label\n          id\n          img\n          branches {\n            label\n            id\n            icon\n            img\n            branches {\n              label\n              id\n              icon\n              img\n              branches {\n                label\n                id\n                icon\n                img\n                branches {\n                  label\n                  id\n                  icon\n                  img\n                  branches {\n                    label\n                    id\n                    icon\n                    img\n                    branches {\n                      label\n                      id\n                      icon\n                      img\n                      branches {\n                        label\n                        id\n                        icon\n                        img\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    "},globalFilter:{queryName:"globalFilter",queryBody:"{\n      globalFilter(__PARAMS__){\n        entitiesData {\n          entity {\n              id\n              label\n              typeOfEntity\n          } count\n        }\n        typeOfEntityData {\n          type\n          count\n        }\n        itemsPagination {\n          totalCount\n          items {\n            thumbnail\n            item {\n              id\n              label\n              fields\n              {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n              breadcrumbs {\n                label\n                link\n              }\n            }\n            relatedTypesOfEntity {\n              type\n              count\n            }\n          }\n        }\n      }\n      }"},getEntityDetails:{queryName:"getEntity",queryBody:"{\n      getEntity(__PARAMS__){\n        overviewTab\n        label\n        id\n        typeOfEntity\n        fields {\n          ...\n          on KeyValueField {\n            key\n            value\n          }\n          ... on\n          KeyValueFieldGroup {\n            label\n            fields\n            {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n            }\n          }\n        }\n        extraTab\n        wikiTab {\n          text\n          url\n        }\n        relatedItems {\n          thumbnail\n          item {\n            label\n            id\n            fields\n            {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n            }\n            breadcrumbs {\n              label\n              link\n            }\n          }\n          relatedTypesOfEntity {\n            type\n            count\n          }\n        }\n        relatedEntities {\n          entity {\n              id\n              label\n              typeOfEntity\n          }\n          count\n        }\n      }\n    }\n    "},getItem:{queryName:"getItem",queryBody:"{\n      getItem(__PARAMS__) {\n        id\n        label\n        icon\n        title\n        subTitle\n        image\n        text\n        fields {\n          ...\n          on KeyValueField {\n            key\n            value\n          }\n          ... on KeyValueFieldGroup {\n            label\n            fields {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n            }\n          }\n          }\n          relatedEntities {\n            count\n            entity{\n              id\n              label\n              typeOfEntity\n            }\n          }\n          relatedItems {\n            thumbnail\n            item {\n              label\n              id\n          }\n          relatedTypesOfEntity {\n            type\n            count\n          }\n        }\n        breadcrumbs {\n          label\n          link\n        }\n      }\n    }"},getNode:{queryName:"getNode",queryBody:"{\n      getNode(__PARAMS__) {\n        ... on Item {\n          id\n          label\n          icon\n          title\n          subTitle\n          image\n          text\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on KeyValueFieldGroup {\n              label\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n          relatedEntities {\n              count\n              entity{\n                id\n                label\n                typeOfEntity\n              }\n          }\n          relatedItems {\n              thumbnail\n              item {\n                label\n                id\n            }\n            relatedTypesOfEntity {\n              type\n              count\n            }\n          }\n          breadcrumbs {\n            label\n            link\n          }\n        }\n        ... on Node {\n          id\n          label\n          img\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on KeyValueFieldGroup {\n              label\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n        }\n      }\n    }"},autoComplete:{queryName:"autoComplete",queryBody:"{\n      autoComplete(__PARAMS__){\n        totalCount\n        results {\n          ... on EntityCountData {\n            count\n            entity {\n              id\n              label\n              typeOfEntity\n              fields {\n                ... on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ... on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n          ... on ItemListing {\n            item {\n              id\n              label\n              fields {\n                ... on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ... on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }"},search:{queryName:"search",queryBody:"{\n      search(__PARAMS__){\n        totalCount\n        facets {\n          id\n          type\n          operator\n          limit\n          order\n          data {\n            label\n            value\n            counter\n            searchData {\n              key\n              value\n            }\n          }\n        }\n        results {\n          order{\n            type\n            key\n            direction\n          }\n          fields\n          {\n            id\n            highlight\n            limit\n          }\n          items {\n            ... on Entity {\n              id\n              label\n              typeOfEntity\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n                ... on\n                KeyValueFieldGroup {\n                  label\n                  fields\n                  {\n                    ...\n                    on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n            ... on Item {\n              id\n              label\n              icon\n              title\n              subTitle\n              image\n              text\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n                ... on KeyValueFieldGroup {\n                  label\n                  fields {\n                    ...\n                    on KeyValueField {\n                      key\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }"},getMissingBubble:{queryName:"getEntity",queryBody:"{\n      getEntity(__PARAMS__){\n        label\n        id\n        typeOfEntity\n      }\n    }"}},S=function(){function t(t,e){this.config=t,this.http=e;try{this.providerConfig=this.config.get("communication").providers.apollo}catch(t){throw Error("No config found for apollo provider!")}}return t.prototype.request$=function(t,e){var n=e.params,a=e.method,i=e.httpOptions,o=w[t];this.providerConfig.config&&this.providerConfig.config[t]&&(o=this.providerConfig.config[t]);var s=(o=o||{}).queryName,c=o.queryBody;if(!s||!c)throw Error("No config found for requestId '"+t+"'");if(n){var l=this.makeParamsStr(n);c=c.replace("__PARAMS__",l)}else c=c.replace("(__PARAMS__)","");return(a&&"GET"===a?this.http.get(this.providerConfig.baseUrl):this.http.post(this.providerConfig.baseUrl,{query:c},i)).pipe(r.map(function(t){return t.data[s]}))},t.prototype.makeParamsStr=function(t){var e=this,n=[];return Object.keys(t).forEach(function(a){if(Array.isArray(t[a])){var i=[];t[a].forEach(function(t){if("object"==typeof t){var n=e.makeParamsStr(t);i.push("{ "+n+" }")}else"number"==typeof t||"boolean"==typeof t||null===t?i.push(""+t):i.push('"'+t+'"')}),n.push(a+": ["+i.join(",")+"]")}else if("object"==typeof t[a]&&t[a]){var o=e.makeParamsStr(t[a]);n.push(a+": { "+o+" }")}else"string"==typeof t[a]&&0===a.indexOf("$")?n.push(a.replace("$","")+": "+t[a]):"number"==typeof t[a]||"boolean"==typeof t[a]||null===t[a]?n.push(a+": "+t[a]):n.push(a+': "'+t[a]+'"')}),n.join(" ")},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:y},{type:a.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(y),e.ɵɵinject(a.HttpClient))},token:t,providedIn:"root"}),t}();var k={getLastPosts:"posts"},_=function(){function t(t,e){this.config=t,this.http=e;try{this.providerConfig=this.config.get("communication").providers.rest}catch(t){throw Error("No config found for rest provider!")}}return t.prototype.request$=function(t,e){void 0===e&&(e={});var n=e.params,a=e.method,i=e.httpOptions,o=e.urlParams,r=void 0===o?"":o,s=k[t];if(a||(a=this.providerConfig.defaultMethod||"GET"),this.providerConfig.config&&this.providerConfig.config[t]&&(s=this.providerConfig.config[t]),!s)throw Error('No config found for requestId "'+t+'"');if("POST"===a||"PUT"===a)return this.http[a.toLowerCase()](this.providerConfig.baseUrl+s,n,i);if("GET"===a||"DELETE"===a)return this.http[a.toLowerCase()](this.providerConfig.baseUrl+s+r,i);throw Error("Rest method "+a+" not supported")},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:y},{type:a.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(y),e.ɵɵinject(a.HttpClient))},token:t,providedIn:"root"}),t}();var I=function(){function t(t,e,n){this.config=t,this.apollo=e,this.rest=n;try{this.communicationConfig=this.config.get("communication"),this.defaultProvider=this.communicationConfig.defaultProvider}catch(t){throw Error("No communications.defaultProvider setted in config")}}return t.prototype.request$=function(t,e,n){var a=this;if(void 0===e&&(e={}),!this[n=n||this.defaultProvider])throw Error("There is no "+n+" provider");var i=e.onError;return this[n].request$(t,e).pipe(r.catchError(function(t){return a.handleError(t,i)}))},t.prototype.handleError=function(t,e){return e?e(t):console.warn("No error handler for communication request",t),o.empty()},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:y},{type:S},{type:_}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(y),e.ɵɵinject(S),e.ɵɵinject(_))},token:t,providedIn:"root"}),t}();var E=function(){function t(t){this.config=t,this.widgets=this.config.widgets,this.lb=new l.LayoutBuilder(this.config.layoutId)}return t.prototype.initPayload=function(){},t.prototype.onInit=function(){var t=this;this.lb.ready$.subscribe(function(){t.lb.eventHandler.emitInner("init",t.initPayload())}),this.lb.init({widgetsConfig:this.widgets,widgetsDataSources:this.config.widgetsDataSources,widgetsEventHandlers:this.config.widgetsEventHandlers,dataSource:new this.config.layoutDS,eventHandler:new this.config.layoutEH})},t.prototype.onDestroy=function(){this.lb.eventHandler.emitInner("destroy")},t}();var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.onInit=function(t){var e=this,n=t.configuration,a=t.mainState,i=t.router,r=t.options,s=t.titleService,c=t.route;this.configuration=n,this.mainState=a,this.router=i,this.route=c,this.titleService=s,this.options=r,this.mainState.addCustom("currentNav",new o.Subject),this.configuration.get("header")&&this.one("header").update({items:this.configuration.get("header")}),this.configuration.get("footer")&&this.one("footer").update({items:this.configuration.get("footer")}),this.mainState.get$("headTitle").subscribe(function(t){return e.titleService.setTitle(t)}),this.mainState.get$("pageTitle").subscribe(function(t){return e.pageTitle=t}),this.mainState.get$("subnav").subscribe(function(t){return e.one("subnav").update(t)}),this.mainState.get$("breadcrumbs").subscribe(function(t){return e.one("breadcrumbs").update(t)}),this.mainState.getCustom$("currentNav").subscribe(function(t){return e.one("header").update({items:e.configuration.get("header"),selected:t})})},e.prototype.onNavigate=function(t){if("router"===t.handler){var e=t.path,n=t.queryParams;if(!e)throw Error("onNavigate: no path for router navigate");n?this.router.navigate(e,{relativeTo:this.route,queryParams:n,queryParamsHandling:"merge"}):this.router.navigate(e),this._onRouterNavigate()}},e.prototype._onRouterNavigate=function(){u.hideAll()},e}(l.LayoutDataSource);var x=function(){function t(t,e){this.http=t,this.config=e}return t.prototype.load=function(t){var e=this;return this.http.get(t).pipe(r.catchError(function(t){return o.of({})}),r.tap(function(t){return e._handleResponse(t)})).toPromise()},t.prototype._handleResponse=function(t){var e=this;if(t&&(Object.keys(t).forEach(function(n){return e.config.set(n,t[n])}),t["config-keys"])){var n=document.querySelector("head"),a=document.createElement("style"),i=[];Object.keys(t["config-keys"]).forEach(function(e){var n=t["config-keys"][e]||{};n.color&&n.color.hex&&i.push("--color-"+e+": "+n.color.hex+";")}),i.length&&(i.unshift(":root {"),i.push("}"),a.appendChild(document.createTextNode(i.join("\n"))),n.appendChild(a))}},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:a.HttpClient},{type:y}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(a.HttpClient),e.ɵɵinject(y))},token:t,providedIn:"root"}),t}();var D=function(){function t(e){var n=this;this.update=function(){return n.output=n.transform()},this.getId=function(){return n.id},this.getData=function(){return n.data},this.getConfig=function(){return n.config},this.getFacetId=function(){return n.config.facetId},this.getInputIndex=function(){return n.config.inputIndex},this.getSectionIndex=function(){return n.config.sectionIndex},this.getContext=function(){return n.config.filterConfig.context||"external"},this.getTarget=function(){return n.config.filterConfig.target||null},this.getSearchIn=function(){return n.config.filterConfig.searchIn||null},this.getType=function(){return n.config.type},this.getOutput=function(){return n.output},this.setData=function(t){return n.data=t},this.config=e,this._setId(),t.index++}return t.prototype._setId=function(){this.id="facet-input-"+this.getType()+"-"+t.index},t.index=0,t}();var A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(){var t=this,e=this.getFacetId();return this.data.map(function(n,a){var i=n.label,o=n.value;return o=""+o,{type:"checkbox",id:t.getId()+"-"+a,label:i,payload:{facetId:e,source:"input-checkbox",value:o},_meta:{facetId:e,value:o}}})},e.prototype.setActive=function(t){var e=this.config.filterConfig.isArray;this.output.forEach(function(n){e&&Array.isArray(t)&&-1!==t.indexOf(n._meta.value)?n.checked=!0:t===n._meta.value?n.checked=!0:n.checked=!1})},e}(D),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(){var t=this.getFacetId(),e={facetId:t,source:"input-text"};return{type:"text",id:this.getId(),label:this.config.label,disabled:this.config.disabled,placeholder:this.config.placeholder,icon:this.config.icon,inputPayload:b({},e,{trigger:"input"}),enterPayload:b({},e,{trigger:"enter"}),iconPayload:b({},e,{trigger:"icon"}),_meta:{facetId:t}}},e.prototype.setActive=function(t){this.output.value=t||null},e}(D),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(){var t=this,e=this.getFacetId();return this.data.map(function(n){var a=n.label,i=n.value,o=n.counter,r=n.hidden,s=n.options;i=""+i;var c=[];return(s=s||{}).classes&&c.push(s.classes),r&&c.push("is-hidden"),t._isActive(t.facetValue,i)&&c.push("is-active"),{type:"link",id:t.getId(),text:a,counter:o,payload:{facetId:e,source:"input-link",value:i},icon:s.icon||null,classes:c.join(" "),_meta:{facetId:e,value:i}}})},e.prototype.setActive=function(t){var e=this;this.output.forEach(function(n){var a=e._isActive(t,n._meta.value),i=n.classes?n.classes.split(" "):[];a?-1===i.indexOf("is-active")&&i.push("is-active"):i=i.filter(function(t){return"is-active"!==t}),n.classes=i.join(" ")})},e.prototype._isActive=function(t,e){return this.facetValue=t,Array.isArray(t)&&-1!==t.indexOf(e)||t===e},e}(D);var T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(){var t=this.getFacetId();return{type:"select",id:this.getId(),label:this.config.label,disabled:this.config.disabled,options:this.data?this.data.map(function(t){return{value:""+t.value,label:t.label}}):[],payload:{facetId:t,source:"input-select"},_meta:{facetId:t}}},e.prototype.setActive=function(t){this.output.options.filter(function(e){return e.value===t}).forEach(function(t){return t.selected=!0})},e}(D),F={checkbox:A,text:P,link:O,select:T},H={"=":"_filterDataEquals",">":"_filterDataGreaterThan","<":"_filterDataLessThan",">=":"_filterDataGreaterOrEquals","<=":"_filterDataLessOrEquals","<>":"_filterDataNotEqual",LIKE:"_filterDataLike"};var j=function(){function t(t,e){var n=this;this._filters=[],this._facets=[],this._inputs=[],this._results$=new o.Subject,this.getId=function(){return n._id},this.getFilters=function(){return n._filters},this.getFacets=function(){return n._facets},this.getInputs=function(){return n._inputs},this.getConfig=function(){return n._config},this.getTotalCount=function(){return n._totalCount},this.getFields=function(){return n._config.fields},this.getResults$=function(){return n._results$},this.setResults=function(t){return n._results$.next(t)},this._id=t,this._config=e,this._setFilters(),this._setFacets(),this._setPage(),this._setInputs(),this._setInputsData(),this._setTotalCount(),L.queryParams&&(this.updateFiltersFromQueryParams(L.queryParams),L.queryParams=null)}return t.prototype.updateFilter=function(t,e,n){this.getFiltersByFacetId(t).forEach(function(t){Array.isArray(t.value)&&n?t.value=t.value.filter(function(t){return t!==e}):Array.isArray(t.value)&&-1===t.value.indexOf(e)?t.value.push(e):t.value=n?null:e})},t.prototype.updateFiltersFromQueryParams=function(t){var e=this;this._facets.forEach(function(n){var a=n.id,i=e.getFiltersByFacetId(a),o=t[a];"internal"===e.getInputByFacetId(a).getContext()||i.forEach(function(t){t.isArray?t.value=o?o.split(","):[]:t.value=o||null})})},t.prototype.updateInputsFromFilters=function(){var t=this;this._filters.forEach(function(e){var n=e.facetId,a=e.value;t.getInputByFacetId(n).setActive(a)})},t.prototype.updateFacets=function(t){var e=this;t.forEach(function(t){var n=t.id,a=t.data;return e.updateFacet(n,a)}),this._setInputsData()},t.prototype.updateTotalCount=function(t){this._totalCount=t},t.prototype.updateFacet=function(t,e){var n=this._facets.filter(function(e){return e.id===t});if(!n.length)throw Error("Facet with id '"+t+"' does not exists");n.forEach(function(t){return t.data=e})},t.prototype.reset=function(){this._filters.forEach(function(t){return t.value=null})},t.prototype.getRequestParams=function(){return{facets:this._getRequestFacets(),page:this._page,results:this._config.results,filters:this._filters.filter(function(t){return"internal"!==t.context}).map(function(t){return{facetId:t.facetId,value:t.value,searchIn:t.searchIn}})}},t.prototype.getInternalFilters=function(){return this._filters.filter(function(t){return"internal"===t.context&&(Array.isArray(t.value)&&t.value.length||!Array.isArray(t.value)&&t.value)}).map(function(t){return{facetId:t.facetId,value:t.value,searchIn:t.searchIn}})},t.prototype.filtersAsQueryParams=function(t){var e={};return t.forEach(function(t){return e[t.facetId]=Array.isArray(t.value)?t.value.join(","):t.value}),e},t.prototype.getFiltersByFacetId=function(t){return this._filters.filter(function(e){return e.facetId===t})},t.prototype.getInputByFacetId=function(t){return this._inputs.filter(function(e){return e.getFacetId()===t})[0]},t.prototype.setInputData=function(t,e){this.getInputByFacetId(t).setData(e)},t.prototype.filterTarget=function(t){var e=this,n=this._inputs.filter(function(e){return e.getTarget()===t}),a=this.getInputByFacetId(t),i=this._facets.filter(function(e){return e.id===t})[0].data,o=[];n.forEach(function(t){var n=e.getFiltersByFacetId(t.getFacetId())[0],a=t.getSearchIn(),i=n.value;o.push([a,i])}),i.forEach(function(t){return e._filterData(o,t)}),a.setData(i),a.update()},t.prototype.setSearchConfigOrderBy=function(t){this._config.results.order.key=t},t.prototype.setSearchConfigDirection=function(t){this._config.results.order.direction=t},t.prototype.setPageConfigOffset=function(t){this._config.page.offset=t},t.prototype.setPageConfigLimit=function(t){this._config.page.limit=t},t.prototype._filterData=function(t,e){var n=this;e.hidden=!1,t.forEach(function(t){var a=g(t,2),i=a[0],o=a[1];i.forEach(function(t){var a=t.key,i=t.operator;if(!e.hidden){var r=d.get(e,a,null);if(-1!==a.indexOf("searchData")&&Array.isArray(e.searchData)){var s=a.replace("searchData.","");e.searchData.forEach(function(t){var e=t.key,n=t.value;e===s&&(r=n)})}null===r?e.hidden=!0:H[i]?e.hidden=n[H[i]](o,r):console.warn("SearchIn: operator "+i+" not supported")}})})},t.prototype._filterDataEquals=function(t,e){if(Array.isArray(e)){if(Array.isArray(t)){var n=0===t.length;return e.forEach(function(e){-1!==t.indexOf(e)&&(n=!0)}),!n}return!(t&&-1!==e.indexOf(t))}return Array.isArray(t)?!(!t.length||-1!==t.indexOf(e)):!(t&&t===e)},t.prototype._filterDataGreaterThan=function(t,e){return!Array.isArray(t)&&!(t&&t>e)},t.prototype._filterDataLessThan=function(t,e){return!Array.isArray(t)&&!(t&&t<e)},t.prototype._filterDataGreaterOrEquals=function(t,e){return!Array.isArray(t)&&!(t&&t>=e)},t.prototype._filterDataLessOrEquals=function(t,e){return!Array.isArray(t)&&!(t&&t<=e)},t.prototype._filterDataNotEqual=function(t,e){return!Array.isArray(t)&&!(t&&t!==e)},t.prototype._filterDataLike=function(t,e){if(t&&e&&"string"==typeof t&&"string"==typeof e){var n=e.toLowerCase(),a=t.toLocaleLowerCase();return!(-1!==n.indexOf(a))}return!1},t.prototype._setFilters=function(){var t=this;this._config.fields.forEach(function(e){e.inputs.forEach(function(e){return t._filters.push(b({},e.filterConfig,{facetId:e.facetId,value:e.filterConfig.isArray?[]:null}))})})},t.prototype._setFacets=function(){this._facets=this._config.facets},t.prototype._setPage=function(){this._page=this._config.page},t.prototype._setTotalCount=function(){this._totalCount=this._config.totalCount},t.prototype._setInputs=function(){var t=this;this._config.fields.forEach(function(e,n){e.inputs.forEach(function(e,a){var i=F[e.type];if(!i)throw Error("Input type "+e.type+" not supported");t._inputs.push(new i(b({},e,{inputIndex:a,sectionIndex:n})))})})},t.prototype._setInputsData=function(){var t=this;this._facets.forEach(function(e){return t.setInputData(e.id,e.data)})},t.prototype._getRequestFacets=function(){var t=[];return this._facets.forEach(function(e){var n=b({},e);e.hasStaticData||delete n.data,delete n.hasStaticData,Array.isArray(n.data)&&n.data.filter(function(t){return void 0!==t.searchData}).forEach(function(t){delete t.searchData}),t.push(n)}),t},t}();var L=function(){function t(){this._models={}}return t.prototype.add=function(t,e){if(this._models[t])throw Error("Search model '"+t+"' already exists!");this._models[t]=new j(t,e)},t.prototype.remove=function(t){this._models[t]&&delete this._models[t]},t.prototype.model=function(t){return this._models[t]||null},t.queryParams=null,t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var $=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"main-layout.init":t.dataSource.onInit(a),t.route=a.route,t.router=a.router,t._listenRouterChanges();break;case"main-layout.destroy":t.destroyed$.next()}}),l.EventHandler.globalEvents$.pipe(r.takeUntil(this.destroyed$)).subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"global.navigate":t.dataSource.onNavigate(a)}})},e.prototype._listenRouterChanges=function(){var t=this;this.route.queryParams.pipe(r.filter(function(t){return!!Object.keys(t).length})).subscribe(function(e){t.emitGlobal("queryparams",e),L.queryParams=e})},e}(l.EventHandler);var M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return t.selected&&this.selectNavItem(t.selected),t.items},e.prototype.selectNavItem=function(t){this.output.nav.items.forEach(function(e){e.classes="",e.payload==t&&(e.classes="is-current")}),this.update({items:this.output})},e}(l.DataSource),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return{classes:"main-subnav",items:t}},e.prototype.setActive=function(t){this.output.items.forEach(function(e){e._meta.id===t?(e.classes="is-current",e._meta.isActive=!0):(e.classes="",e._meta.isActive=!1)})},e.prototype.getActive=function(){return this.output.items.filter(function(t){return t._meta.isActive})[0]||null},e}(l.DataSource),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){var e=t.fields,n=this.options.searchModel;return this.searchModel=n,e},e}(l.DataSource);var N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getRequestParams=function(){return e.searchModel.getRequestParams()},e.filtersAsQueryParams=function(t){return e.searchModel.filtersAsQueryParams(t)},e.updateFiltersFromQueryParams=function(t){return e.searchModel.updateFiltersFromQueryParams(t)},e.getInputByFacetId=function(t){return e.searchModel.getInputByFacetId(t)},e.filterTarget=function(t){return e.searchModel.filterTarget(t)},e.updateInputsFromFilters=function(){return e.searchModel.updateInputsFromFilters()},e}return f(e,t),e.prototype.transform=function(t){var e=this;this.searchModel||(this.searchModel=t.searchModel);var n=this.searchModel.getId(),a=this.searchModel.getFields(),i=[];return a.forEach(function(t,a){var o="group-"+n+"-"+a,r=e._headerConfig(t.header,o),s=[];e.searchModel.getInputs().filter(function(t){return t.getSectionIndex()===a}).map(function(t){return t.update(),{facetId:t.getFacetId(),type:t.getType(),output:t.getOutput()}}).forEach(function(t){var n=t.type,a=t.output,i=t.facetId;s.push({classes:e._getSectionClasses(n),inputs:Array.isArray(a)?a:[a],_meta:{facetId:i}})}),i.push({header:r,facet:{sections:s},classes:"n7-facets-wrapper__"+o,isOpen:!0,_meta:{groupId:o}})}),{groups:i,classes:"n7-facets-wrapper__"+this.searchModel.getId()}},e.prototype.toggleGroup=function(t){var e=t.eventPayload;this.output.groups.forEach(function(t){t._meta.groupId===e.groupId&&(t.isOpen=!t.isOpen,t.header.iconRight=t.isOpen?"n7-icon-angle-down":"n7-icon-angle-right")})},e.prototype.onFacetChange=function(t){var e=t.eventPayload,n=e.inputPayload,a=n.facetId,i=n.source,o=n.trigger,r=(this.searchModel.getFiltersByFacetId(a)[0]||{}).value,s=!1,c=e.inputPayload.value||e.value;c=""+c,s=Array.isArray(r)?-1!==r.indexOf(c):r===c,"input-text"===i&&-1!==["enter","icon"].indexOf(o)||(this.searchModel.updateFilter(a,c,s),this.searchModel.updateInputsFromFilters())},e.prototype.updateFilteredTarget=function(t){var e=this.searchModel.getInputByFacetId(t);this.output.groups.map(function(t){return t.facet}).map(function(t){return t.sections}).map(function(n){n.forEach(function(n){if(n._meta.facetId===t){var a=e.getOutput();n.inputs=Array.isArray(a)?a:[a]}})})},e.prototype.updateInputLinks=function(){var t=this,e=this.searchModel.getInputs().filter(function(t){return"link"===t.getType()}).map(function(t){return t.getFacetId()});this.output.groups.map(function(t){return t.facet}).map(function(t){return t.sections}).map(function(n){n.forEach(function(n){if(-1!==e.indexOf(n._meta.facetId)){var a=t.searchModel.getInputByFacetId(n._meta.facetId);a.update();var i=a.getOutput();n.inputs=Array.isArray(i)?i:[i]}})})},e.prototype._getSectionClasses=function(t){return"n7-facet__section-input-"+{text:"text",checkbox:"checkboxes",link:"links",select:"select"}[t]},e.prototype._headerConfig=function(t,e){return t?{text:t.label,iconRight:"n7-icon-angle-down",classes:t.classes,payload:{source:"group-header",id:e+"-header",groupId:e},_meta:{id:e+"-header"}}:null},e}(l.DataSource);var z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){if(t)return t.items},e}(l.DataSource),G=Object.freeze({HeaderDS:M,SubnavDS:q,BreadcrumbsDS:B,FacetsDS:R,FacetsWrapperDS:N,FooterDS:z}),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"header.click":t.dataSource.selectNavItem(a),t.emitGlobal("navigate",{handler:"router",path:[a]})}})},e}(l.EventHandler),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"subnav.click":"navigate"===a.source&&t.emitGlobal("navigate",a),t.emitGlobal(n,a)}})},e}(l.EventHandler),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"breadcrumbs.click":"navigate"===a.source&&t.emitGlobal("navigate",a),t.emitGlobal(n,a)}})},e}(l.EventHandler),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){this.innerEvents$.subscribe(function(t){var e=t.type;t.payload})},e}(l.EventHandler),Q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._facetsChanged=!1,e.internalFacetsChange$=new o.Subject,e.externalFacetsChange$=new o.Subject,e}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"facets-wrapper.facet":var i=a.eventPayload.inputPayload.facetId,o=t.dataSource.getInputByFacetId(i),r=o.getContext();t._facetsChanged=!0,t.dataSource.onFacetChange(a),"internal"===r?t.internalFacetsChange$.next(o.getTarget()):t.externalFacetsChange$.next();break;case"facets-wrapper.facetheader":t.dataSource.toggleGroup(a)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;-1!==n.indexOf("queryparamschange")&&t.dataSource.searchModel&&(t.dataSource.updateFiltersFromQueryParams(a),t.dataSource.updateInputsFromFilters())}),l.EventHandler.globalEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"global.searchresponse":if(t.dataSource.searchModel&&t.dataSource.searchModel.getId()===a)t.dataSource.updateInputLinks(),t.dataSource.searchModel.getInternalFilters().forEach(function(e){var n=t.dataSource.searchModel.getInputByFacetId(e.facetId).getTarget();t.dataSource.filterTarget(n),t.dataSource.updateFilteredTarget(n)})}}),this.internalFacetsChange$.pipe(r.debounceTime(500)).subscribe(function(e){t.dataSource.filterTarget(e),t.dataSource.updateFilteredTarget(e)}),this.externalFacetsChange$.pipe(r.debounceTime(500)).subscribe(function(){var e=t.dataSource.getRequestParams(),n=t.dataSource.filtersAsQueryParams(e.filters);Object.keys(n).forEach(function(t){return n[t]=n[t]||null}),t.emitOuter("facetschange"),t.emitGlobal("navigate",{handler:"router",path:[],queryParams:n})})},e}(l.EventHandler);var X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){this.innerEvents$.subscribe(function(t){var e=t.type;t.payload;console.warn("unhandled inner event of type",e)})},e}(l.EventHandler),Y=Object.freeze({HeaderEH:V,SubnavEH:W,BreadcrumbsEH:K,FacetsEH:U,FacetsWrapperEH:Q,FooterEH:X}),Z={layoutId:"main-layout",widgets:[{id:"header"},{id:"subnav"},{id:"breadcrumbs"},{id:"footer"}],layoutDS:C,layoutEH:$,widgetsDataSources:G,widgetsEventHandlers:Y,options:{}},J=function(t){function n(e,n,a,i,o,r){var s=t.call(this,i.get("MainLayoutConfig")||Z)||this;return s.router=e,s.route=n,s.configuration=a,s.layoutsConfiguration=i,s.mainState=o,s.titleService=r,s}return f(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"main-layout",template:'<div class="n7-main-layout" id="main-layout">\n    <div class="n7-page-content">\n        <n7-header\n            [data]="lb.widgets[\'header\'].ds.out$ | async"\n            [emit]="lb.widgets[\'header\'].emit">\n        </n7-header>\n        <main class="n7-content">\n            <div class="n7-top-page-bar">\n                <div class="n7-top-page-bar__main"></div>\n            </div>\n            <div class="n7-alert-bar">\n                \x3c!--<n7-alert\n                [attr.id]="\'main-layout-alert\'"\n                [data]="lb.dataSource.alertData$ | async"\n                [emit]="lb.dataSource.closeAlert.bind(lb.dataSource)"></n7-alert>--\x3e\n            </div>\n            <ng-content></ng-content>\n        </main>\n    </div>\n    <n7-footer \n        [data]="lb.widgets[\'footer\'].ds.out$ | async" \n        [emit]="lb.widgets[\'footer\'].emit">\n    </n7-footer>\n</div>'}]}],n.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:y},{type:m},{type:v},{type:c.Title}]},n}(E);var tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.onInit=function(t){var e=t.options;this.options=e},e}(l.LayoutDataSource);var et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"n7-page404-layout.init":t.dataSource.onInit(a);break;case"n7-page404-layout.destroy":t.destroyed$.next()}})},e}(l.EventHandler);var nt={layoutId:"n7-page404-layout",widgets:[],layoutDS:tt,layoutEH:et,widgetsDataSources:G,widgetsEventHandlers:Y,options:{}},at=function(t){function n(e){return t.call(this,e.get("Page404LayoutConfig")||nt)||this}return f(n,t),n.prototype.initPayload=function(){return{options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"n7-page404-layout",template:'<div class="n7-page404-layout">\n    404 - Resource not found\n</div>'}]}],n.ctorParameters=function(){return[{type:m}]},n}(E),it=function(){function t(){}return t.prototype.headerEmit=function(t,e){this.emit&&this.emit("facetheader",{eventType:t,eventPayload:e})},t.prototype.facetEmit=function(t,e){this.emit&&this.emit("facet",{eventType:t,eventPayload:e})},t.decorators=[{type:e.Component,args:[{selector:"n7-facets-wrapper",template:'<div *ngIf="data" class="n7-facets-wrapper {{ data.classes || \'\' }}">\n    <div *ngFor="let group of data.groups" class="n7-facets-wrapper__group {{ group.classes || \'\' }}">\n        <n7-facet-header\n            [data]="group.header"\n            [emit]="headerEmit.bind(this)"\n        ></n7-facet-header>\n\n        <n7-facet\n            *ngIf="group.isOpen"\n            [data]="group.facet"\n            [emit]="facetEmit.bind(this)"\n        ></n7-facet>\n    </div>\n</div>'}]}],t.propDecorators={data:[{type:e.Input}],emit:[{type:e.Input}]},t}();var ot=[J,at,it],rt=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[v,y,m,I,S,{provide:"config",useValue:e}]}},t.decorators=[{type:e.NgModule,args:[{declarations:ot,imports:[n.CommonModule,a.HttpClientModule,i.DvComponentsLibModule],providers:[],exports:ot}]}],t}(),st=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showFields=!1,e.myResponse={},e.navHeader={},e.pageSize=10,e.bubblesSize=10,e.updateComponent=function(t,n,a){a&&e.one(t).updateOptions(a),e.one(t).update(n)},e.handlePageNavigation=function(){e.one("aw-linked-objects").updateOptions({context:e.selectedTab,config:e.configuration,page:e.currentPage,pagination:!0,size:e.pageSize}),e.one("aw-linked-objects").update({items:e.myResponse.relatedItems}),e.location.go(""+e.configuration.get("paths").entitaBasePath+e.currentId+"/oggetti-collegati/"+e.currentPage)},e.handleNavUpdate=function(t){e.selectedTab=t,e.updateWidgets(e.myResponse);var n="oggetti-collegati"==t?"/1":"";"oggetti-collegati"==t?(e.one("aw-linked-objects").updateOptions({context:e.selectedTab,config:e.configuration,page:e.currentPage,pagination:!0,size:e.pageSize}),e.one("aw-linked-objects").update({items:e.myResponse.relatedItems})):"overview"==t&&(e.one("aw-linked-objects").updateOptions({size:3,config:e.configuration,context:"entita"}),e.one("aw-linked-objects").update({items:e.myResponse.relatedItems})),"overview"!=t&&"entita-collegate"!=t||setTimeout(function(){e.updateBubbes(e.myResponse)},800),e.location.go(""+e.configuration.get("paths").entitaBasePath+e.currentId+"/"+t+n)},e}return f(e,t),e.prototype.onInit=function(t){var e=t.configuration,n=t.mainState,a=t.router,i=t.route,o=t.location,r=t.options,s=t.titleService,c=t.communication;this.route=i,this.communication=c,this.configuration=e,this.mainState=n,this.options=r,this.router=a,this.location=o,this.titleService=s,this.currentId="",this.currentPage=+this.route.snapshot.params.page,this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.bubblesSize=this.configuration.get("entita-layout")?this.configuration.get("entita-layout")["max-bubble-num"]:this.bubblesSize,this.one("aw-bubble-chart").updateOptions({simple:!0,config:this.configuration})},e.prototype.getNavigation=function(t){return this.communication.request$("getEntityDetails",{onError:function(t){return console.error(t)},params:{entityId:t,entitiesListSize:this.bubblesSize}})},e.prototype.updateWidgets=function(t){var e=this.selectedTab;this.one("aw-entita-nav").update({data:t,selected:e}),this.updateComponent("aw-entita-metadata-viewer",this.myResponse.fields,{context:this.selectedTab,config:this.configuration,labels:this.configuration.get("labels")})},e.prototype.updateBubbes=function(t){this.one("aw-bubble-chart").update(t.relatedEntities)},e.prototype.loadItem=function(t,e){if(t&&e)return this.currentId=t,this.selectedTab=e,this.communication.request$("getEntityDetails",{onError:function(t){return console.error(t)},params:{entityId:t,entitiesListSize:this.bubblesSize}});this.pageTitle="Entità Test"},e.prototype.loadContent=function(t){var e=this;this.myResponse=t,(t.fields||[]).filter(function(t){return((e.configuration.get("entita-layout")||{}).overview||{}).campi.includes(t.key)}).length>0?this.showFields=!0:this.showFields=!1,this.navHeader={icon:this.configuration.get("config-keys")[this.myResponse.typeOfEntity]?this.configuration.get("config-keys")[this.myResponse.typeOfEntity].icon:"",text:this.myResponse.label,color:this.myResponse.typeOfEntity.replace(/ /g,"-")},this.one("aw-entita-nav").updateOptions({bubblesEnabled:this.bubblesEnabled}),this.one("aw-entita-metadata-viewer").updateOptions({context:this.selectedTab,labels:this.configuration.get("labels"),config:this.configuration}),this.one("aw-entita-metadata-viewer").update(t.fields),"oggetti-collegati"==this.selectedTab?this.one("aw-linked-objects").updateOptions({context:this.selectedTab,config:this.configuration,page:this.currentPage,pagination:!0,size:this.pageSize}):this.one("aw-linked-objects").updateOptions({size:3,config:this.configuration,context:"entita"}),this.one("aw-linked-objects").update({items:t.relatedItems})},e}(l.LayoutDataSource);var ct=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-entita-layout.init":t.dataSource.onInit(a),t.configuration=a.configuration,t.route=a.route,t.entityId=t.route.snapshot.params.id||"",t.dataSource.currentPage=t.route.snapshot.params.page||1,t.listenRoute(t.entityId);break;case"aw-entita-layout.destroy":t.destroyed$.next();break;case"aw-entita-layout.showmore":a&&(t.dataSource.handleNavUpdate(a),t.emitGlobal("navigate",{path:[t.configuration.get("paths").entitaBasePath+"/"+t.entityId+"/"+a],handler:"router"}))}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-entita-nav.click":a&&(t.dataSource.selectedTab=a,t.dataSource.handleNavUpdate(a));break;case"aw-linked-objects.pagination":console.log(a),t.dataSource.currentPage=+a.split("-")[1],t.dataSource.handlePageNavigation();break;case"aw-linked-objects.goto":console.log(a),t.dataSource.currentPage=+a.replace("goto-",""),t.dataSource.handlePageNavigation();break;case"aw-linked-objects.change":t.dataSource.pageSize=a,t.dataSource.currentPage=1;var i={context:t.dataSource.selectedTab,config:t.dataSource.configuration,page:t.dataSource.currentPage,pagination:!0,size:t.dataSource.pageSize};t.dataSource.updateComponent("aw-linked-objects",{items:t.dataSource.myResponse.relatedItems},i);break;case"aw-bubble-chart.bubble-tooltip-goto-click":if(!a||!a.entityId)return;t.emitGlobal("navigate",{handler:"router",path:["aw/entita/"+a.entityId]});break;case"aw-bubble-chart.bubble-filtered":"overview"!=t.dataSource.selectedTab&&"entita-collegate"!=t.dataSource.selectedTab||t.emitOuter("filterbubbleresponse",a.relatedEntities);break;case"aw-linked-objects.click":var o=t.configuration.get("paths");t.emitGlobal("navigate",{handler:"router",path:[null==a.type?o.schedaBasePath:o.entitaBasePath,a.id]})}})},e.prototype.listenRoute=function(t,e){var n=this;void 0===t&&(t=""),void 0===e&&(e=!1),this.route.paramMap.subscribe(function(a){if(a.get("id")){if(n.dataSource.currentId==a.get("id")&&!e)return;n.dataSource.loadItem(a.get("id"),a.get("tab")).subscribe(function(e){if(e){n.dataSource.loadContent(e);var i=e.relatedEntities.filter(function(t){return t.id!==a.get("id")});n.emitOuter("filterbubbleresponse",i),n.dataSource.updateWidgets(e),t&&n.emitOuter("selectItem",t)}})}else n.dataSource.loadItem()})},e}(l.EventHandler);var lt={prettifySnakeCase:function(t,e){var n=this;return e||(t||"").split("_").map(function(t,e){return 0===e?n.ucFirst(t):t}).join(" ")},ucFirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},ut=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadingData=!1,e.checkForMore=function(t){e.loadedData.actions&&(void 0===t?e.loadedData.result.length>=e.totalObjects?e.loadedData.actions[1].disabled=!0:e.loadedData.actions[1].disabled=!1:e.loadedData.actions[1].disabled=!t)},e.handleIncomingData=function(t){e.currentPage+=1;var n=e.unpackData(t.itemsPagination);e.loadedData.result=e.loadedData.result.concat(n.result),e.checkForMore(),e.loadedData.isLoading=!1},e.addPagination=function(t,n,a){e.loadedData.pagination={first:{payload:"goto-1",classes:1===t?"is-disabled":""},prev:{payload:"goto-"+(t/1-1),classes:1===t?"is-disabled":""},next:{payload:"goto-"+(t/1+1),classes:t===n?"is-disabled":""},last:{payload:"goto-"+n,classes:t===n?"is-disabled":""},links:e.makePagination(n,t),select:{label:"Numero di risultati",options:[10,25,50].map(function(t){return{text:t,selected:t===a}}),payload:"select-size"}}},e.makePagination=function(t,n){var a=[],i=e.paths.paginationLimit-1;if(t<=i&&(i=t-1),i){var o=void 0,r=void 0;n>Math.floor(i/2)?2===t?(o=t,r=1):n<t-Math.floor(i/2)?(o=n/1+Math.floor(i/2),r=n/1-Math.floor(i/2)):(o=t,r=n-i+(t-n)):(o=i+1,r=1);for(var s=r;s<=o;s++)a.push({text:String(s),payload:"page-"+String(s),classes:n===s?"is-active":""})}else{a.push({text:"1",payload:"page-1",classes:1===n?"is-active":""});for(s=1;s<t;s++)a.push({text:String(s+1),payload:"page-"+String(s+1),classes:n===s+1?"is-active":""})}return a},e.unpackData=function(t){var n,a,i=e.options.config,o=i.get("item-preview"),r=t.totalCount,s=(e.totalPages,e.currentPage),c=e.context,l=e.pageSize,u=i.get("labels"),p=e.options.dynamicPagination,h=i?i.get("config-keys"):{},f=t.items?t.items:t.relatedItems;i&&i.get(c+"-layout")&&(n=i.get(c+"-layout")["max-item-length"],a=i.get(c+"-layout")["results-limit"]),!p&&l&&s?f=f.slice(s*l-l,s*l):l&&(f=f.slice(0,l));var b=[],g=o.metadata.info.selection.map(function(t){return t.key});return f.forEach(function(t){var e=d.get(t,o.metadata.info.data,t.item.fields),n=e?e.filter(function(t){return-1!==g.indexOf(t.key)}):[],a=d.get(t,o.metadata.toe.data,t.relatedTypesOfEntity),i=d.get(t,o.metadata.breadcrumbs.data,t.breadcrumbs),r={image:d.get(t,o.image,t.image),title:+o.title.maxLength&&d.get(t,o.title,t.item.label).length>+o.title.maxLength?d.get(t,o.title,t.item.label).slice(0,+o.title.maxLength)+"…":d.get(t,o.title,t.item.label),text:o.text?+o.text.maxLength&&d.get(t,o.text.data,t.item.text).length>+o.text.maxLength?d.get(t,o.text.data,t.item.text).slice(0,+o.text.maxLength)+"…":d.get(t,o.text.data,t.item.text):null,payload:{id:d.get(t,o.payload,t.item.id),type:t.item.typeOfEntity},classes:["entita","search"].includes(c)?"is-fullwidth":"",metadata:n.length||a?[]:null,breadcrumbs:null};n.length&&r.metadata.push({classes:"n7-objects__metadata-artist",items:n.map(function(t){return{label:lt.prettifySnakeCase(t.key,u[t.key]),value:t.value}})}),a&&r.metadata.push({classes:"n7-objects__metadata-linked",items:a.map(function(t){return{value:d.get(t,o.metadata.toe.value,t.count),icon:h[d.get(t,o.metadata.toe.icon,t.type).replace(" ","-")]?h[d.get(t,o.metadata.toe.icon,t.type).replace(" ","-")].icon:"",classes:"color-"+d.get(t,o.metadata.toe.icon,t.type).replace(" ","-")}})}),i&&(r.breadcrumbs={items:d.get(t,o.metadata.breadcrumbs.data,t.breadcrumbs).map(function(t){return{label:d.get(t,o.metadata.breadcrumbs.label,t.label),payload:d.get(t,o.metadata.breadcrumbs.payload,t.link)}})}),b.push(r)}),"home"===c?{result:b,actions:[{label:"Mostra Tutti ("+r+")"},n?{label:"Mostra Altri ("+a+")",disabled:!1}:null],isLoading:!1,fallback:i.get("home-layout")["linked-objects-fallback"]}:{previews:b}},e}return f(e,t),e.prototype.transform=function(t){return this.paths=this.options.config.get("item-preview"),this.pageSize=this.options.size,this.totalObjects=t.totalCount,this.currentPage=this.options.page?+this.options.page:1,this.options.dynamicPagination&&this.options.dynamicPagination.total?this.totalPages=Math.ceil(this.options.dynamicPagination.total/this.pageSize):t.items?this.totalPages=Math.ceil(t.items.length/this.pageSize):t.relatedItems&&(this.totalPages=Math.ceil(t.relatedItems.length/this.pageSize)),this.context=this.options.context,this.loadedData=this.unpackData(t),this.options.pagination&&this.addPagination(this.currentPage,this.totalPages,this.pageSize),this.checkForMore(),this.loadedData.loaderData={},this.loadedData},e}(l.DataSource);var dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){var e=t.key,n=t.response,a=new RegExp("(.*?)"+e+"(.*)","i"),i=[],o=this.options.config.get("home-layout")["max-item-length"]/2;return n.results.filter(function(t){return"object"==typeof t.entity}).forEach(function(t){if("fallback"==t.entity.id)return i.push({match:"",payload:"fallback-simple-autocomplete",prefix:t.entity.label,suffix:""}),{suggestion:i};var n=a.exec(t.entity.label);if(n){var r=n[1],s=n[2];o&&r.length>o&&(r="..."+r.slice(r.length-o,r.length)),o&&s.length>o&&(s=s.slice(0,o)+"..."),i.push({match:n.input.slice(n[1].length,n[1].length+e.length),prefix:r,suffix:s,payload:t.entity.id})}}),{suggestion:i}},e}(l.DataSource),pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chartData=[],e.draw=null,e.selected=[],e.filters=[],e.closedEyes=[],e.tippyList=[],e.updateChart=function(t){t?e.chartData=t:null===t&&(t=e.chartData),e.filters.length>0&&(t=e.chartData.filter(function(t){return!e.filters.includes(t.entity.typeOfEntity.replace(/ /g,"-"))})),e.draw?(e.output.data=t,e.output.selected=e.selected,e.draw()):e.update(t)},e.handleBubbleClick=function(t){var n=t;e.selected.includes(n)?e.selected.splice(e.selected.indexOf(n),1):e.selected.push(n)},e.tippyMaker=function(t){e.tippyList.forEach(function(t){t&&t.destroy()}),e.tippyList=[];var n=function(t){var n=document.getElementsByClassName("bubble-chart__tippy-template")[0].cloneNode(!0);n.getElementsByClassName("aw-bubble-popup-menu__text")[0].innerHTML="È collegato a "+t.count+" entità",n.getElementsByClassName("aw-bubble-popup-menu__title")[0].innerHTML=""+t.entity.label;var a=n.getElementsByClassName("aw-bubble-popup-menu__link")[1];if(e.options.simple)a&&a.remove();else{var i=e.selected.includes(t.entity.id)?"Deseleziona":"Seleziona";a.innerHTML=i}return n.innerHTML};e.filters.length>0&&(t=t.filter(function(t){return!e.filters.includes(t.entity.typeOfEntity.replace(/ /g,"-"))})),t.forEach(function(t){var a=document.getElementById(t.entity.id).parentElement;e.tippyList.push(p(a,{content:n(t),interactive:!0,appendTo:document.body,arrow:!0,flip:!1,theme:"light-border no-padding",placement:"top",delay:[150,30],updateDuration:400,onMount:function(){var n;n=t.entity.id,e.focusedBubble=n}}))})},e}return f(e,t),e.prototype.transform=function(t){var e=this,n=this.options.config,a=n.get("bubble-chart"),i=a.fontRendering,o=a.transition,r=a.shuffle,s=[],c=[],l=n.get("config-keys");return Object.keys(l).forEach(function(t){s.push(t.replace(/-/g," ")),c.push(((l[t]||{}).color||{}).hex)}),t.response&&t.response.entitiesData&&(this.chartData=t.response.entitiesData),{fontRendering:i,containerId:"bubbleChartContainer",width:500,height:500,shuffle:r,transition:o,sizeRange:[.5,500],selected:this.selected,colorMatch:{domain:s,range:c},data:this.chartData,setDraw:function(t){return e.draw=t}}},e}(l.DataSource);var ht=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentInputValue="",e}return f(e,t),e.prototype.transform=function(t){var e=t.title,n=t.text,a=t.button,i=t.backgroundImage,o=t.input;return{title:e,text:n,backgroundImage:i,button:{text:a.text,payload:"cerca"},input:{placeholder:o.placeholder,payload:"cerca-in-maxxi"}}},e}(l.DataSource);var ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return i.TABLE_MOCK},e}(l.DataSource),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return{title:t.title,backgroundImage:t.backgroundImage,image:t.image,text:t.text,button:{text:t.button.text,payload:"naviga-patrimonio"}}},e}(l.DataSource),gt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.autoComplete={},e.lockedFacets={},e.lastData={},e.closedEyes=[],e.tippyMaker=function(t,n){if(n=n.replace(/ /g,"-"),!e.autoComplete[n]){e.autoComplete[n]={tippy:void 0,open:!0};var a=e.autoComplete[n];if(!a.tippy){var i=document.getElementsByClassName(n)[1];a.tippy=p(i,{content:(o=document.getElementsByClassName("aw-simple-autocomplete__template")[0],o.setAttribute("style","display: block"),o),trigger:"manual",interactive:!0,arrow:!1,flip:!1,appendTo:"parent",theme:"light-border aw-home__facet-tippy",placement:"bottom-start",maxWidth:"100%"})}}var o,r=e.autoComplete[n];t.results.length>0&&r.tippy?r.tippy.show():r.tippy.hide()},e}return f(e,t),e.prototype.transform=function(t){var e=this;this.lastData=t;var n=[],a=[],i=t,o=this.lockedFacets,r=this.closedEyes;Object.keys(this.autoComplete).forEach(function(t){e.autoComplete[t]&&e.autoComplete[t].tippy&&e.autoComplete[t].tippy.destroy()}),this.autoComplete={},i.forEach(function(t,e){if(Object.keys(o).forEach(function(t){var e=o[t].indexOf("LOCK_LAST");e>=0&&o[t].splice(e,1)}),r){if(r.length==i.length-1){var s=i.find(function(t){return!r.includes(t.type.replace(/ /g,"-"))});s&&(r[s.type]?o[s.type].push("LOCK_LAST"):o[s.type]=["LOCK_LAST"])}r.includes(t.type.replace(/ /g,"-"))?t.enabled=!1:t.enabled=!0}Object.keys(o).length&&(o[t.type]&&o[t.type].length>0?t.locked=!0:t.locked=!1);var c=[],l=[t.icon];t.enabled||c.push("is-disabled"),t.configKey&&(c.push("color-"+t.configKey),l.push("color-"+t.configKey)),n.push({iconLeft:l.join(" "),text:t.label,additionalText:t.count,iconRight:t.enabled?"n7-icon-eye":"n7-icon-eye-slash",classes:c.join(" ")+(t.locked?" is-blocked":" not-blocked"),payload:!0===t.locked?null:t.type.replace(/ /g,"-")}),a.push({sections:[{inputs:[{id:t.type.replace(/ /g,"-")+"-"+e,type:"text",placeholder:t["input-placeholder"],icon:"n7-icon-search",disabled:!t.enabled,inputPayload:String(t.type.replace(/ /g,"-"))+"-search",iconPayload:String(t.type.replace(/ /g,"-"))+"-search",enterPayload:String(t.type.replace(/ /g,"-"))+"-search",classes:String(t.type.replace(" ","-"))+"-search"}]}]})});var s=[];return n.map(function(t,e){s.push({header:t,input:a[e]})}),s},e}(l.DataSource);var yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){var e=t.results,n=t.totalCount,a=this.options,i=a.keys,o=a.config,r=this.options.labels||{},s=[],c={};return e.forEach(function(t){var e=t.item,n=t.entity,a=n?n.typeOfEntity.replace(" ","-"):"oggetto-culturale",o=i[a],l=o["main-metadata"],u=e||n;if(!c[a]){var d=o.label,p=o.icon;c[a]={title:d,icon:p,classes:"color-"+a,items:[],type:a}}if(-1===s.indexOf(u.id)){var h=[];u.fields&&u.fields.forEach(function(t){var e=t.key,n=t.value;l&&e===l&&h.push({key:lt.prettifySnakeCase(e,r[e]),value:n})}),c[a].items.push({title:u.label,metadata:h,payload:{source:"item",id:u.id,type:(c[a]||{}).type}})}}),{results:Object.keys(c).map(function(t){return{group:{title:c[t].title,icon:c[t].icon,classes:c[t].classes},items:c[t].items}}),actions:{showMore:{text:"Visualizza tutti i "+n+" risultati",payload:{source:"showMore"}}},fallback:((o.get("home-layout")||{})["top-hero"]||{}).fallback}},e}(l.DataSource),vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){if(t){var e=t.data,n=t.selected,a={items:[],payload:"entita-nav"};return a.items.push({text:"OVERVIEW",payload:"overview",classes:"overview"==n?"is-selected":""}),e.fields&&e.fields.length>0&&a.items.push({text:"CAMPI",payload:"campi",classes:"campi"==n?"is-selected":""}),e.relatedItems&&a.items.push({text:"OGGETTI-COLLEGATI",payload:"oggetti-collegati",classes:"oggetti-collegati"==n?"is-selected":""}),e.relatedEntities&&this.options.bubblesEnabled&&a.items.push({text:"ENTITÀ COLLEGATE",payload:"entita-collegate",classes:"entita-collegate"==n?"is-selected":""}),e.extraTab&&a.items.push({text:"MAXXI",payload:"maxxi",classes:"maxxi"==n?"is-selected":""}),e.wikiTab&&a.items.push({text:"WIKIPEDIA",payload:"wiki",classes:"wiki"==n?"is-selected":""}),a}},e}(l.DataSource),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){var n=this.options,a=n.context,i=n.labels,o=n.config;i=i||{};var r=[];if("overview"==a){var s=((o.get("entita-layout")||{}).overview||{}).campi,c=t.filter(function(t){return s.includes(t.key)});r=e.unpackFields(c)}else r=e.unpackFields(t);return r.forEach(function(t){t.items.filter(function(t){return t.label}).forEach(function(t){return t.label=lt.prettifySnakeCase(t.label,i[t.label])})}),{group:r}},e.unpackFields=function(t){var n=[];if(t instanceof Array)return[{items:n=t.map(function(t){return{label:t.key,value:t.value}})}];if(!t)return[];for(var a=0;a<t.length;a++){var i=t[a],o=i.label,r=i.key,s=i.value,c=i.fields,l={};o&&(l.title=o),r&&s&&(l.label=r,l.value=s),c&&(c[0].key?l.items=e.unpackFields(c):l.group=e.unpackFields(c)),n.push(l)}return n},e}(l.DataSource),St=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n._getCachedData=function(){return e.dataCache[n.rootId]},n._normalize=function(t){var e=t.id,a=t.label,i=t.icon,o=t.img,r=t.branches,s=!(!Array.isArray(r)||!r.length);n._getCachedData().flatData[e]={id:e,label:a,icon:i,img:o,hasBranches:s},s&&r.forEach(function(t){n._getCachedData().flatIds.push([e,t.id]),n._normalize(t)})},n._getParent=function(t){return n._getCachedData().flatIds.filter(function(e){return g(e,2)[1]===t}).map(function(t){return g(t,1)[0]})[0]||null},n._getTreePath=function(t){for(var e=[t],a=t;a;){var i=n._getParent(a);i&&e.push(i),a=i}return e.reverse()},n._getTree=function(t){var e={},a=0,i=function(e,o){var r=t[a+=1];o.items=[],n._getCachedData().flatIds.filter(function(t){return g(t,1)[0]===e}).forEach(function(t,e){var a=g(t,2)[1],s=a===r,c=n._getTreeItem(a,s);o.items.push(c),s&&i(a,o.items[e])})};return i(t[0],e),e},n._getTreeItem=function(t,e){var a=n._getCachedData().flatData[t],i=a.label,o=a.icon,r=a.img,s=a.hasBranches,c=e?"n7-icon-angle-down":"n7-icon-angle-right",l=[];return e&&l.push("is-expanded"),n.activeId===t&&l.push("is-active"),{classes:l.join(" "),text:i||null,img:r||null,icon:o||null,toggle:s?{icon:o||c,payload:{source:"toggle",id:t}}:null,meta:t,payload:{id:t,source:"menuitem"}}},n}return f(e,t),e.prototype.transform=function(t){if(t)return t},e.prototype.load=function(t){var n=t.tree;this.rootId=n.id,e.dataCache[this.rootId]||(e.dataCache[this.rootId]={flatIds:[],flatData:{}},this._normalize(n))},e.prototype.build=function(t){var e=this._getTreePath(t),n=this._getTreePath(this.currentId).indexOf(t);if(n>0)e.splice(n),this.currentId=null;else if(this.currentId===t){var a=e.indexOf(this.currentId);e.splice(a),this.currentId=null}else this.currentId=t;var i=this._getTree(e);this.update(i)},e.prototype.setActive=function(t){this.activeId=t},e.prototype.highlightActive=function(){var t=this,e=function(n){n.forEach(function(n){var a,i=n.meta===t.activeId;-1===n.classes.indexOf("is-active")||i||((a=n.classes.split(" ")).splice(a.indexOf("is-active"),1),n.classes=a.join(" "));i&&(-1===(a=n.classes.split(" ")).indexOf("is-active")&&a.push("is-active"),n.classes=a.join(" "));Array.isArray(n.items)&&n.items.length&&e(n.items)})};e(this.output.items)},e.dataCache={},e}(l.DataSource);var kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return t},e.prototype.toggleSidebar=function(){var t=this.output;"is-expanded"==t.classes?(t.classes="is-collapsed",t.iconRight="n7-icon-tree-icon"):(t.classes="is-expanded",t.iconRight="n7-icon-angle-left"),this.update(t)},e}(l.DataSource),_t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return t},e.prototype.toggleSidebar=function(){var t=this.output;"is-expanded"==t.classes?t.classes="is-collapsed":t.classes="is-expanded",this.update(t)},e}(l.DataSource),It=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){var e=this.options.labels;e=e||{};var n={group:[]};return t.fields&&t.fields.forEach(function(t){var a=[];t.fields?(t.fields.forEach(function(t){a.push({label:lt.prettifySnakeCase(t.key,e[t.key]),value:t.value})}),n.group.push({title:t.label,items:a})):(a.push({label:lt.prettifySnakeCase(t.key,e[t.key]),value:t.value}),n.group.push({items:a}))}),n},e}(l.DataSource),Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),Ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),xt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selected="list",e}return f(e,t),e.prototype.transform=function(t){return{items:[{text:"LISTA",payload:"list",classes:"list"===this.selected?"is-selected":""},{text:"GRAFICO",payload:"chart",classes:"chart"===this.selected?"is-selected":""},{text:"TIMELINE",payload:"timeline",classes:"timeline"===this.selected?"is-selected":""}]}},e.prototype.setSelected=function(t){this.selected=t},e}(l.DataSource);var Dt=Object.freeze({AwLinkedObjectsDS:ut,AwAutocompleteWrapperDS:dt,AwBubbleChartDS:pt,AwHeroDS:ht,AwTableDS:ft,AwHomeHeroPatrimonioDS:bt,AwHomeFacetsWrapperDS:gt,AwHomeItemTagsWrapperDS:yt,AwHomeAutocompleteDS:mt,AwEntitaNavDS:vt,AwEntitaMetadataViewerDS:wt,AwTreeDS:St,AwSidebarHeaderDS:kt,AwSchedaBreadcrumbsDS:_t,AwSchedaMetadataDS:It,AwSchedaImageDS:Et,AwSchedaInnerTitleDS:Ct,AwSearchLayoutTabsDS:xt}),At=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handleScroll=function(t){var n=e.dataSource,a=n.totalObjects,i=n.loadedData;(Array.isArray(i.result)?i.result.length:0)>=a||t.scrollTop+t.clientHeight>=t.scrollHeight-150&&0==e.dataSource.loadedData.isLoading&&(e.dataSource.loadedData.isLoading=!0,e.emitOuter("datarequest",{currentPage:e.dataSource.currentPage}))},e}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-linked-objects.click":if("string"==typeof a){if(a.startsWith("page"))t.emitOuter("pagination",a);else if(a.startsWith("goto")){var i=+a.replace("goto-","");if(i>t.dataSource.totalPages)return;if(i<1||i===t.dataSource.currentPage)return;t.emitOuter("goto",a)}}else t.emitOuter("click",a);break;case"aw-linked-objects.change":t.emitOuter("change",+a.value);break;default:console.warn("unhandled event type: ",n," with payload: ",a)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-layout.viewmore":t.dataSource.checkForMore(!1),t.emitOuter("datarequest",{currentPage:t.dataSource.currentPage});break;case"aw-home-layout.dataresponse":var i=a.res;t.dataSource.handleIncomingData(i);case"aw-home-layout.scroll":t.handleScroll(a)}})},e}(l.EventHandler);var Pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-autocomplete-wrapper.click":"fallback-simple-autocomplete"!=a&&t.emitOuter("clickresult",a);break;default:console.warn("unhandled event of type:",n)}})},e}(l.EventHandler),Ot=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toggleSelection=function(t){e.dataSource.handleBubbleClick(t),e.emitOuter("selection",e.dataSource.selected)},e.toggleFilter=function(t){e.dataSource.filters.includes(t)?e.dataSource.filters.splice(e.dataSource.filters.indexOf(t),1):e.dataSource.filters.push(t),e.dataSource.updateChart(null)},e}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-bubble-chart.click":t.toggleSelection(a),t.emitOuter("lockfilter",t.dataSource.chartData.find(function(t){return a==t.entity.id}));break;case"aw-bubble-chart.d3end":t.dataSource.tippyMaker(t.dataSource.chartData);break;case"aw-bubble-chart.bubble-tooltip-goto-click":t.emitGlobal("navigate",{handler:"router",path:["aw/entita/"+t.dataSource.focusedBubble]});break;case"aw-bubble-chart.bubble-tooltip-select-click":t.toggleSelection(t.dataSource.focusedBubble),t.emitOuter("lockfilter",t.dataSource.chartData.find(function(e){return t.dataSource.focusedBubble==e.entity.id}));break;default:console.warn("unhandled inner event of type",n,"with payload",a)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-layout.tagclick":case"aw-home-layout.facetclick":t.toggleSelection(a);break;case"aw-home-layout.togglefilter":t.toggleFilter(a);break;case"aw-home-layout.clearselection":t.dataSource.selected=[],t.emitOuter("selection",[]);break;case"aw-scheda-layout.filterbubbleresponse":case"aw-entita-layout.filterbubbleresponse":case"aw-home-layout.filterbubbleresponse":t.dataSource.updateChart(a)}})},e}(l.EventHandler);var Tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-hero.click":t.emitOuter("click",t.dataSource.currentInputValue);break;case"aw-hero.change":t.dataSource.currentInputValue=a,t.emitOuter("change",a);break;case"aw-hero.enter":t.emitOuter("enter",a);break;default:console.log("(hero) unhandled event of type",n)}})},e}(l.EventHandler),Ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.changedInput$=new o.Subject,e.handleEyeClick=function(t){if(e.dataSource.closedEyes){var n=e.dataSource.closedEyes.indexOf(t);n>=0?e.dataSource.closedEyes.splice(n,1):e.dataSource.closedEyes.push(t)}else e.dataSource.closedEyes=[t];e.dataSource.update(e.dataSource.lastData)},e.updateFilters=function(t){t.entity.id.replace(/ /g,"-");var n=t.entity,a=n.id,i=n.typeOfEntity;if(e.dataSource.lockedFacets[i]||(e.dataSource.lockedFacets[i]=[]),e.dataSource.lockedFacets[i].includes(a)){var o=e.dataSource.lockedFacets[i].indexOf(a);e.dataSource.lockedFacets[i].splice(o,1)}else e.dataSource.lockedFacets[i].push(a);e.dataSource.update(e.dataSource.lastData)},e}return f(e,t),e.prototype.listen=function(){var t=this;this.changedInput$.pipe(r.debounceTime(500)).subscribe(function(e){t.emitOuter("change",e)}),this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-facets-wrapper.click":if(null===a)break;t.emitOuter("click",a),t.handleEyeClick(a);break;case"aw-home-facets-wrapper.change":t.changedInput$.next(a);break;case"aw-home-facets-wrapper.enter":t.emitOuter("enter",a);break;default:console.warn("unhandled inner event of type:",n)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-layout.facetswrapperresponse":t.dataSource.tippyMaker(a.response,a.facetId.inputPayload);break;case"aw-home-layout.lockfilter":t.updateFilters(a);break;case"aw-home-layout.tagclick":Object.keys(t.dataSource.lockedFacets).forEach(function(e){t.dataSource.lockedFacets[e].includes(a)&&t.dataSource.lockedFacets[e].splice(t.dataSource.lockedFacets[e].indexOf(a),1)}),t.dataSource.update(t.dataSource.lastData);break;case"aw-home-layout.clearselection":case"aw-home-layout.facetclick":t.dataSource.update(t.dataSource.lastData)}})},e}(l.EventHandler);var Ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type;e.payload;switch(n){case"aw-home-hero-patrimonio.click":t.emitGlobal("navigate",{handler:"router",path:["aw/patrimonio"]})}})},e}(l.EventHandler),jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){switch(e.type){case"aw-home-item-tags-wrapper.click":t.emitOuter("click",e.payload)}})},e}(l.EventHandler),Lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-autocomplete.click":t.emitOuter("click",a)}})},e}(l.EventHandler),$t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-entita-nav.click":t.emitOuter("click",a);break;default:console.warn("unhandled event type")}})},e}(l.EventHandler),Mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;"aw-sidebar-header.click"==n&&(t.dataSource.toggleSidebar(),t.emitOuter(n,a))})},e}(l.EventHandler),qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;"aw-sidebar-header.click"==n&&(t.dataSource.toggleSidebar(),t.emitOuter("click",a))})},e}(l.EventHandler),Bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){e.type;var n=e.payload;switch(n.source){case"toggle":t.dataSource.build(n.id);break;case"menuitem":t.dataSource.setActive(n.id),t.dataSource.highlightActive(),t.emitOuter("click",n.id)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-sidebar-header.click":t.dataSource.toggleSidebar();break;case"aw-scheda-layout.selectItem":t.dataSource.build(a);break;case"aw-scheda-layout.navigationresponse":a.currentItem&&t.dataSource.setActive(a.currentItem);var i=a.currentItem||a.tree.id;t.dataSource.load(a),t.dataSource.build(i)}})},e}(l.EventHandler),Rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){},e}(l.EventHandler),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){},e}(l.EventHandler),zt=Object.freeze({AwLinkedObjectsEH:At,AwAutocompleteWrapperEH:Pt,AwBubbleChartEH:Ot,AwHeroEH:Tt,AwHomeFacetsWrapperEH:Ft,AwHomeHeroPatrimonioEH:Ht,AwHomeItemTagsWrapperEH:jt,AwHomeAutocompleteEH:Lt,AwEntitaNavEH:$t,AwSchedaSidebarEH:Mt,AwSidebarHeaderEH:qt,AwTreeEH:Bt,AwSearchLayoutTabsEH:Rt,AwTableEH:Nt}),Gt={layoutId:"aw-entita-layout",widgets:[{id:"aw-entita-nav",hasStaticData:!0},{id:"aw-entita-metadata-viewer"},{id:"aw-linked-objects"},{id:"aw-bubble-chart"}],layoutDS:st,layoutEH:ct,widgetsDataSources:Dt,widgetsEventHandlers:zt,options:{}},Vt=function(t){function a(e,n,a,i,o,r,s,c){var l=t.call(this,o.get("AwEntitaLayoutConfig")||Gt)||this;return l.router=e,l.route=n,l.location=a,l.configuration=i,l.layoutsConfiguration=o,l.communication=r,l.mainState=s,l.titleService=c,l}return f(a,t),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,location:this.location,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"aw-entita-layout",template:'<div class="aw-entity n7-side-auto-padding" *ngIf="lb.dataSource">\n    <div class="aw-entity__sidebar">\n        \x3c!-- Custom header --\x3e\n        <div class="aw-entity__sidebar-title-wrapper color-{{lb.dataSource.navHeader.color}}">\n            <h1 class="aw-entity__sidebar-title">\n                <span class="aw-entity__sidebar-title-icon {{lb.dataSource.navHeader.icon}}"></span>\n                <span class="aw-entity__sidebar-title-text">{{lb.dataSource.navHeader.text}}</span>\n            </h1>\n        </div>\n        \x3c!-- Navigation --\x3e\n        <n7-nav [data]="lb.widgets[\'aw-entita-nav\'].ds.out$ | async" [emit]="lb.widgets[\'aw-entita-nav\'].emit">\n        </n7-nav>\n    </div>\n    \x3c!-- lb.dataSource.selectedTab --\x3e\n    <div class="aw-entity__content">\n        <section>\n            <div *ngIf="lb.dataSource.myResponse.wikiTab || lb.dataSource.myResponse.extraTab"\n                class="aw-entity__content-section" [hidden]="lb.dataSource.selectedTab != \'overview\'">\n                <div class="aw-entity__overview-description">\n                    {{lb.dataSource.myResponse.extraTab}}\n                </div>\n                <div class="aw-entity-layout__button-wrapper">\n                    <button *ngIf="lb.dataSource.myResponse.wikiTab" class="n7-btn n7-btn-light"\n                        (click)="lb.eventHandler.emitInner(\'showmore\', \'wiki\')">\n                        DESCRIZIONE WIKIPEDIA <i class="n7-icon-angle-right"></i>\n                    </button>\n                    <button *ngIf="lb.dataSource.myResponse.extraTab" class="n7-btn n7-btn-light"\n                        (click)="lb.eventHandler.emitInner(\'showmore\', \'maxxi\')">\n                        DESCRIZIONE MAXXI <i class="n7-icon-angle-right"></i>\n                    </button>\n                </div>\n            </div>\n\n            <ng-container *ngIf="\n            ((lb.dataSource.myResponse.fields || []).length > 0 && lb.dataSource.selectedTab == \'campi\') ||\n            (lb.dataSource.showFields && lb.dataSource.selectedTab == \'overview\')">\n                <div class="aw-entity__content-section aw-entity__content-section-overview"\n                    [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'campi\'">\n                    <div class="aw-entity__content-section-header">\n                        <h2 class="aw-entity__content-section-title">Campi</h2>\n                        <button class="n7-btn n7-btn-light" (click)="lb.eventHandler.emitInner(\'showmore\', \'campi\')">\n                            TUTTI I CAMPI <i class="n7-icon-angle-right"></i>\n                        </button>\n                    </div>\n                    <n7-metadata-viewer class="aw-entity-layout__metadata-viewer"\n                        [data]="lb.widgets[\'aw-entita-metadata-viewer\'].ds.out$ | async ">\n                    </n7-metadata-viewer>\n                </div>\n            </ng-container>\n\n            <div class="aw-entity__content-section aw-entity__content-section-overview"\n                *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews"\n                [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'oggetti-collegati\'">\n                <div class="aw-entity__content-section-header">\n                    <h2 class="aw-entity__content-section-title">Oggetti collegati</h2>\n\n                    <button class="n7-btn n7-btn-light" *ngIf="lb.dataSource.selectedTab == \'overview\'"\n                        (click)="lb.eventHandler.emitInner(\'showmore\', \'oggetti-collegati\')">\n                        TUTTI GLI OGGETTI COLLEGATI <i class="n7-icon-angle-right"></i>\n                    </button>\n                </div>\n                <div class="aw-entity__content-item-previews">\n                    <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                        </n7-smart-breadcrumbs>\n                        <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                        </n7-item-preview>\n                    </ng-container>\n                </div>\n                <n7-pagination [data]="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.pagination"\n                    [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                </n7-pagination>\n            </div>\n\n            <div class="aw-entity__content-section aw-entity__content-section-overview"\n                *ngIf="lb.dataSource.bubblesEnabled"\n                [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'entita-collegate\'">\n                <div class="aw-entity__content-section-header">\n                    <h2 class="aw-entity__content-section-title">Entità collegate</h2>\n                    <button class="n7-btn n7-btn-light"\n                        (click)="lb.eventHandler.emitInner(\'showmore\', \'entita-collegate\')"\n                        *ngIf="lb.dataSource.selectedTab == \'overview\'">\n                        TUTTE LE ENTITÀ COLLEGATE <i class="n7-icon-angle-right"></i>\n                    </button>\n                </div>\n                <div class="aw-home__bubble-chart-wrapper">\n                    <aw-bubble-chart-wrapper [emit]="lb.widgets[\'aw-bubble-chart\'].emit"\n                        [container]="\'bubble-chart-container\'" [buttons]="[\'select\', \'goto\']">\n                        <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                            [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                        </n7-bubble-chart>\n                    </aw-bubble-chart-wrapper>\n                </div>\n            </div>\n            <div class="aw-entity__content-section aw-entity__content-section-maxxi"\n                *ngIf="lb.dataSource.myResponse.extraTab" [hidden]="lb.dataSource.selectedTab != \'maxxi\'">\n                <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n                    <h2 class="aw-entity__content-section-title">Descrizione Maxxi</h2>\n                </div>\n                <div>\n                    {{lb.dataSource.myResponse.extraTab}}\n                </div>\n            </div>\n            <div class="aw-entity__content-section aw-entity__content-section-wiki"\n                *ngIf="lb.dataSource.myResponse.wikiTab" [hidden]="lb.dataSource.selectedTab != \'wiki\'">\n                <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n                    <h2 class="aw-entity__content-section-title">Descrizione Wikipedia</h2>\n                </div>\n                <div>\n                    {{lb.dataSource.myResponse.wikiTab.text}}\n                </div>\n                <a href="{{lb.dataSource.myResponse.wikiTabUrl}}">\n                    {{lb.dataSource.myResponse.wikiTab.url}}\n                </a>\n            </div>\n        </section>\n    </div>\n</div>'}]}],a.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:n.Location},{type:y},{type:m},{type:I},{type:v},{type:c.Title}]},a}(E);var Wt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.facetInputs={},e.autocompletePopoverOpen=!1,e.autocompleteChanged$=new o.Subject,e.numOfItemsStr=null,e.currentHoverEntity=null,e.hasScrollBackground=!1,e.resultsLimit=-1,e.selectedEntitiesIds=[],e.destroyed$=new o.Subject,e.bubblesEnabled=!1,e.selectedBubbles=[],e.updateComponent=function(t,n,a){a&&e.one(t).updateOptions(a),e.one(t).update(n)},e}return f(e,t),e.prototype.onInit=function(t){var e=t.communication,n=t.mainState,a=t.configuration,i=t.tippy;this.communication=e,this.configuration=a,this.mainState=n,this.tippy=i,this.resultsLimit=this.configuration.get("home-layout")["results-limit"],this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.one("aw-hero").update(this.configuration.get("home-layout")["top-hero"]),this.one("aw-home-hero-patrimonio").update(this.configuration.get("home-layout")["bottom-hero"]),this.mainState.update("headTitle","Arianna Web > Home"),this.mainState.update("pageTitle","Arianna Web: Home Layout"),this.mainState.updateCustom("currentNav","aw/home"),this._listenAutoCompleteChanges(),this.outerLinks=this.configuration.get("home-layout")["outer-links"].test,this.outerLinksTitle=this.configuration.get("home-layout")["outer-links"].title,this.one("aw-bubble-chart").updateOptions({config:this.configuration})},e.prototype.onDestroy=function(){this.destroyed$.next()},e.prototype.makeRequest$=function(t,e){return this.communication.request$(t,{onError:function(t){return console.error(t)},params:e})},e.prototype.initialFilterRequest=function(){return this.communication.request$("globalFilter",{onError:function(t){return console.error(t)},params:{entitiesListSize:this.configuration.get("home-layout")["max-bubble-num"]}})},e.prototype.parseInitialRequest=function(t){var e=this;this.firstBubbleResponse=t.entitiesData;var n=[];t.typeOfEntityData.forEach(function(t){var a=e.configuration.get("config-keys")[t.type.replace(" ","-")];n.push(b({},t,{enabled:!0,locked:!1,configKey:t.type.replace(" ","-")},a))}),this.one("aw-home-facets-wrapper").update(n)},e.prototype.renderPreviewsFromApolloQuery=function(t){if(t&&t.itemsPagination){var e=t.itemsPagination.totalCount;if(e>0){for(var n=0;e>999;)e-=1e3,n+=1;var a=e+"";e<10?a="00"+e:e<100&&(a="0"+e),this.numOfItemsStr=n>0?n+"."+a:e+""}else this.numOfItemsStr="0";this.one("aw-linked-objects").updateOptions({context:"home",config:this.configuration}),this.one("aw-linked-objects").update(t.itemsPagination)}},e.prototype.updateTags=function(t){t||this.renderItemTags()},e.prototype.handleFacetSearchChange=function(t){var e=t.inputPayload,n=t.value;this.facetInputs[e]=n},e.prototype.handleFacetSearchEnter=function(t){var e=t.inputPayload;this.facetInputs[e]},e.prototype.renderItemTags=function(){var t=this,e=[],n=[];this.selectedBubbles.forEach(function(a){var i=t.firstBubbleResponse.find(function(t){return t.entity.id==a});if(i)n.push({label:i.entity.label,icon:"n7-icon-close",payload:a,classes:"tag-"+i.entity.typeOfEntity.replace(/ /g,"-")});else{var o={entityId:a,entitiesListSize:1};e.push(t.makeRequest$("getMissingBubble",o))}}),e.length>0?o.forkJoin(e).subscribe(function(e){e.forEach(function(t){n.push({label:t.label,icon:"n7-icon-close",payload:t.id,classes:"tag-"+t.typeOfEntity.replace(/ /g,"-")})}),t.one("aw-home-item-tags-wrapper").update(n)}):this.one("aw-home-item-tags-wrapper").update(n)},e.prototype.onHeroChange=function(t){this.autocompleteChanged$.next(t)},e.prototype._scrollBackgroundControl=function(){var t=this,e=document.getElementById("bubble-results-list"),n=o.fromEvent(document.getElementById("bubble-results-list"),"scroll");setTimeout(function(){t._setHasScrollBackground(e)},500),n.pipe(r.debounceTime(50)).subscribe(function(e){var n=e.target;t._setHasScrollBackground(n)})},e.prototype._setHasScrollBackground=function(t){var e=t.scrollTop,n=t.scrollHeight,a=t.clientHeight;this.hasScrollBackground=n>e+a},e.prototype._listenAutoCompleteChanges=function(){var t=this;this.one("aw-home-autocomplete").updateOptions({keys:this.configuration.get("config-keys"),config:this.configuration,labels:this.configuration.get("labels")}),this.autocompleteChanged$.pipe(r.debounceTime(500),r.takeUntil(this.destroyed$)).subscribe(function(e){e?t.communication.request$("autoComplete",{onError:function(t){return console.error(t)},params:{input:e,itemsPagination:{offset:0,limit:t.configuration.get("home-layout")["results-limit"]}}}).subscribe(function(e){t.one("aw-home-autocomplete").update(e),t.autocompletePopoverOpen||t._toggleAutocompletePopover()}):t._toggleAutocompletePopover()})},e.prototype._toggleAutocompletePopover=function(){var t=this;if(!this.autocompletePopover){var e=document.getElementById("aw-home-advanced-autocomplete-popover");e.style.display="block",this.autocompletePopover=this.tippy(".aw-home__top-hero .n7-hero__input",{content:e,trigger:"manual",interactive:!0,arrow:!1,flip:!1,appendTo:"parent",theme:"light-border",placement:"bottom-start",maxWidth:"100%",onHidden:function(){return t.autocompletePopoverOpen=!1}})[0]}this.autocompletePopoverOpen?this.autocompletePopover.hide():this.autocompletePopover.show(),this.autocompletePopoverOpen=!this.autocompletePopoverOpen},e}(l.LayoutDataSource);var Kt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e.handleSimpleAutocompleteClick=function(t){e.emitOuter("facetclick",t)},e.handleChartSelection=function(t){var n=t;e.dataSource.selectedBubbles=t,e.dataSource.makeRequest$("globalFilter",{selectedEntitiesIds:n,entitiesListSize:e.configuration.get("home-layout")["max-bubble-num"]}).subscribe(function(t){if(t&&t.entitiesData.length>0)e.dataSource.lastBubbleResponse=t.entitiesData,e.emitOuter("filterbubbleresponse",t.entitiesData),e.dataSource.renderPreviewsFromApolloQuery(t),e.dataSource.renderItemTags();else{var n=[];e.dataSource.selectedBubbles.forEach(function(t){var a={entityId:t,entitiesListSize:1};n.push(e.dataSource.makeRequest$("getMissingBubble",a))}),o.forkJoin(n).subscribe(function(n){var a=[];n.forEach(function(t){a.push({count:0,entity:t})}),e.emitOuter("filterbubbleresponse",a),e.dataSource.renderPreviewsFromApolloQuery(t),e.dataSource.renderItemTags()})}})},e}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-home-layout.init":t.dataSource.onInit(a),t.loadFilters(),t.configuration=a.configuration;break;case"aw-home-layout.outerlinkclick":t.emitGlobal("navigate",{handler:"router",path:a});break;case"aw-home-layout.destroy":t.dataSource.onDestroy();break;case"aw-home-layout.bubbleresultsviewallclick":var i=t.dataSource.selectedBubbles.join(","),o=t.configuration.get("paths").searchBasePath;t.emitGlobal("navigate",{handler:"router",path:[o],queryParams:{"entity-links":i}});break;case"aw-home-layout.clearselection":t.emitOuter("clearselection");break;default:console.warn("(home) unhandled inner event of type: ",n)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-hero.enter":case"aw-hero.click":var i=a.value;t.emitGlobal("navigate",{handler:"router",path:[t.configuration.get("paths").searchBasePath],queryParams:{query:i}});break;case"aw-hero.change":t.dataSource.autocompleteValue=a.value,t.dataSource.onHeroChange(a.value);break;case"aw-home-facets-wrapper.click":t.emitOuter("togglefilter",a);break;case"aw-home-facets-wrapper.change":if(a.value){var o={input:a.value,typeOfEntity:a.inputPayload.replace(/-search/g,"").replace(/-/g," "),itemsPagination:{offset:0,limit:t.configuration.get("home-layout")["results-limit"]}};t.dataSource.makeRequest$("autoComplete",o).subscribe(function(e){if(e.results.length<1){var n={totalcount:0,results:[{entity:{id:"fallback",label:t.configuration.get("home-layout")["autocomplete-fallback"]?t.configuration.get("home-layout")["autocomplete-fallback"]:"Nessun risultato trovato"}}]};t.emitOuter("facetswrapperresponse",{facetId:a,response:n}),t.dataSource.updateComponent("aw-autocomplete-wrapper",{key:a.value,response:n},{config:t.configuration})}else t.emitOuter("facetswrapperresponse",{facetId:a,response:e}),t.dataSource.updateComponent("aw-autocomplete-wrapper",{key:a.value,response:e},{config:t.configuration})})}break;case"aw-home-facets-wrapper.enter":t.dataSource.handleFacetSearchEnter(a);break;case"aw-home-item-tags-wrapper.click":t.emitOuter("tagclick",a);break;case"aw-linked-objects.datarequest":var r=a.currentPage,s={selectedEntitiesIds:t.dataSource.selectedBubbles,itemsPagination:{offset:r*t.dataSource.resultsLimit,limit:t.dataSource.resultsLimit}};t.dataSource.makeRequest$("globalFilter",s).subscribe(function(e){e?t.emitOuter("dataresponse",{res:e}):console.log("Unable to fetch additional data.")});break;case"aw-linked-objects.click":t.emitGlobal("navigate",{handler:"router",path:[t.configuration.get("paths").schedaBasePath,a.id]});break;case"aw-autocomplete-wrapper.clickresult":t.handleSimpleAutocompleteClick(a);break;case"aw-home-autocomplete.click":var c=a.source,l=a.type,u=void 0;if("item"===c)u="oggetto-culturale"===l?t.configuration.get("paths").schedaBasePath:t.configuration.get("paths").entitaBasePath,t.emitGlobal("navigate",{handler:"router",path:[u,a.id]});else if("showMore"===c){var d=t.dataSource.homeAutocompleteQuery;u=t.configuration.get("paths").searchBasePath,t.emitGlobal("navigate",{handler:"router",path:[u],queryParams:{query:d}})}break;case"aw-bubble-chart.selection":t.handleChartSelection(a);break;case"aw-bubble-chart.lockfilter":t.emitOuter("lockfilter",a)}})},e.prototype.loadFilters=function(){var t=this;this.dataSource.initialFilterRequest().subscribe(function(e){e&&(t.dataSource.parseInitialRequest(e),t.dataSource.bubblesEnabled&&t.emitOuter("filterbubbleresponse",{response:e,facetData:t.dataSource.facetData}))})},e.prototype.outerLinkClick=function(t,e){window.open(e,"_blank")},e}(l.EventHandler);var Ut={layoutId:"aw-home-layout",widgets:[{id:"aw-hero"},{id:"aw-home-hero-patrimonio"},{id:"aw-bubble-chart"},{id:"aw-home-facets-wrapper"},{id:"aw-home-item-tags-wrapper"},{id:"aw-home-autocomplete"},{id:"aw-linked-objects"},{id:"aw-autocomplete-wrapper"}],layoutDS:Wt,layoutEH:Kt,widgetsDataSources:Dt,widgetsEventHandlers:zt,options:{}},Qt=function(t){function n(e,n,a,i,o){var r=t.call(this,e.get("AwHomeLayoutConfig")||Ut)||this;return r.router=n,r.configuration=a,r.communication=i,r.mainState=o,r}return f(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,communication:this.communication,options:this.config.options||{},tippy:p}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-home-layout",template:'<div class="aw-home" *ngIf="lb.dataSource">\n    \x3c!-- Hero section at the top of the page --\x3e\n    <div class="aw-home__top-hero">\n        <n7-hero [data]="lb.widgets[\'aw-hero\'].ds.out$ | async" [emit]="lb.widgets[\'aw-hero\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- Bubble chart --\x3e\n    <div class="aw-home__bubble-wrapper n7-side-auto-padding"\n        [ngClass]="{ \'has-results\' : lb.dataSource.selectedBubbles.length > 0 }" *ngIf="lb.dataSource.bubblesEnabled">\n        <div class="aw-home__facets-wrapper">\n            <span class="aw-home__facet"\n                *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;">\n                <n7-facet-header [data]="widgetData.header" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet-header>\n                <n7-facet [data]="widgetData.input" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet>\n            </span>\n        </div>\n        <div class="aw-home__bubble-chart-wrapper"\n            [style.overflow]="lb.dataSource.loadingBubbles ? \'visible\' : \'hidden\'">\n            <aw-bubble-chart-wrapper [emit]="lb.widgets[\'aw-bubble-chart\'].emit" [container]="\'bubble-chart-container\'"\n                [buttons]="[\'select\', \'goto\']">\n                <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                </n7-bubble-chart>\n            </aw-bubble-chart-wrapper>\n        </div>\n\n        \x3c!-- Linked objects --\x3e\n        <ng-container *ngIf="(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)?.selected.length > 0;">\n            <div class="aw-home__bubble-results" id="home-bubble-results">\n                <div *ngIf="lb.dataSource.numOfItemsStr" class="aw-home__bubble-results-title-wrapper">\n                    <h1 class="aw-home__bubble-results-title"><strong class="aw-home__bubble-results-title-counter">\n                            {{ lb.dataSource.numOfItemsStr }}</strong> <span> Oggetti culturali</span>\n                    </h1>\n                </div>\n                <div class="aw-home__bubble-tags-wrapper">\n                    <h3 class="aw-home__bubble-tags-title">Collegati a </h3>\n                    <ng-container *ngFor="let widgetData of lb.widgets[\'aw-home-item-tags-wrapper\'].ds.out$ | async;">\n                        <n7-tag [data]="widgetData" [emit]="lb.widgets[\'aw-home-item-tags-wrapper\'].emit">\n                        </n7-tag>\n                        <br>\n                    </ng-container>\n                </div>\n                <div class="aw-home__bubble-results-list-wrapper">\n                    <div class="aw-home__bubble-results-list" [attr.id]="\'bubble-results-list\'"\n                        (scroll)="lb.eventHandler.emitOuter(\'scroll\', $event.target)">\n\n                        <div class="aw-home__bubble-results-fallback"\n                            *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result.length < 1;">\n                            <p class="aw-home__bubble-results-fallback-text">\n                                {{ (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.fallback }}\n                            </p>\n                            <button class="n7-btn aw-home__bubble-results-reset"\n                                (click)="lb.eventHandler.emitInner(\'clearselection\')">\n                                Resetta la ricerca\n                            </button>\n                        </div>\n\n                        <ng-container\n                            *ngFor="let widgetData of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result;">\n                            <n7-item-preview [data]="widgetData" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                            </n7-item-preview>\n                        </ng-container>\n\n                        <ng-container *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.isLoading">\n                            <div class="aw-home__bubble-results-list-loader">\n                                <n7-loader [data]="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.loaderData">\n                                </n7-loader>\n                            </div>\n                        </ng-container>\n                    </div>\n                    <div *ngIf="lb.dataSource.hasScrollBackground"\n                        class="aw-home__bubble-results-list-wrapper-with-scroll"></div>\n                    \x3c!-- aw-linked-objects__actions --\x3e\n                    <ng-container *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result.length > 0;">\n                        <div *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.actions as action"\n                            class="aw-home__bubble-results-list-actions">\n                            <button (click)="lb.eventHandler.emitInner(\'bubbleresultsviewallclick\')"\n                                class="n7-btn n7-btn-light n7-btn-l aw-home__bubble-results-list-view-all">\n                                {{action[0].label}}\n                            </button>\n                        </div>\n                    </ng-container>\n                </div>\n\n            </div>\n        </ng-container>\n    </div>\n\n    \x3c!-- Outer links --\x3e\n    <div *ngIf="lb.dataSource.outerLinks && lb.dataSource.outerLinks.length > 0" class="aw-home__outer-links">\n        <section class="aw-home__outer-links-wrapper n7-side-auto-padding">\n            <h2 class="aw-home__outer-links-title" *ngIf="lb.dataSource.outerLinksTitle">\n                {{ lb.dataSource.outerLinksTitle }}\n            </h2>\n            <div class="aw-home__outer-links-items">\n                \x3c!-- Item preview --\x3e\n                <n7-item-preview *ngFor="let outerLink of lb.dataSource.outerLinks" [data]="outerLink"\n                    [emit]="lb.eventHandler.outerLinkClick.bind(lb.eventHandler)">\n                </n7-item-preview>\n                \x3c!-- END // Item preview --\x3e\n            </div>\n        </section>\n    </div>\n    \x3c!-- END // Outer links --\x3e\n\n    \x3c!-- Hero section at the bottom of the page --\x3e\n    <div class="aw-home__bottom-hero">\n        <n7-hero [data]="lb.widgets[\'aw-home-hero-patrimonio\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-hero-patrimonio\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- Adavanced autocomplete popover  --\x3e\n    <div id="aw-home-advanced-autocomplete-popover" style="display: none;">\n        <n7-advanced-autocomplete [data]="lb.widgets[\'aw-home-autocomplete\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-autocomplete\'].emit">\n        </n7-advanced-autocomplete>\n    </div>\n\n    \x3c!-- Simple autocomplete popover. DO NOT CHANGE parent div class! --\x3e\n    \x3c!-- Creating one template for each facet --\x3e\n    <div *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;"\n        class="aw-simple-autocomplete__template" style="display: none;">\n        <div class="aw-simple-autocomplete__tippy-wrapper">\n            <n7-simple-autocomplete [data]="lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-autocomplete-wrapper\'].emit">\n            </n7-simple-autocomplete>\n        </div>\n    </div>\n</div>'}]}],n.ctorParameters=function(){return[{type:m},{type:s.Router},{type:y},{type:I},{type:v}]},n}(E);var Xt=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.destroyed$=new o.Subject,n.stickyControlTrigger$=new o.Subject,n.contentParts={},n.sidebarIsSticky=!1,n.treeMaxHeight="100%",n.getTree=function(){return e.tree},n}return f(e,t),e.prototype.onInit=function(t){var e=t.configuration,n=t.mainState,a=t.router,i=t.options,o=t.titleService,r=t.communication;this.configuration=e,this.mainState=n,this.router=a,this.titleService=o,this.communication=r,this.options=i,this.sidebarCollapsed=!1,this.bubbleChartSectionTitle=this.configuration.get("scheda-layout")["bubble-chart"].title,this.similarItemsSectionTitle=this.configuration.get("scheda-layout")["related-items"].title,this.metadataSectionTitle=this.configuration.get("scheda-layout").metadata.title,this.hasSimilarItems=!1,this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.one("aw-bubble-chart").updateOptions({simple:!0,config:this.configuration}),this.mainState.update("headTitle","Arianna Web > Patrimonio"),this.mainState.update("pageTitle","Arianna Web: patrimonio Layout"),this.mainState.updateCustom("currentNav","aw/patrimonio"),this._sidebarStickyControl()},e.prototype.onDestroy=function(){this.destroyed$.next()},e.prototype.getNavigation=function(t){return e.tree?o.of(e.tree):this.communication.request$("getTree",{onError:function(t){return console.error(t)},params:{treeId:t}})},e.prototype.setTree=function(t){e.tree=t},e.prototype.updateNavigation=function(t){var e={iconLeft:"n7-icon-tree-icon",text:t.label,iconRight:"n7-icon-angle-left",classes:"is-expanded",payload:"header"};this.one("aw-sidebar-header").update(e)},e.prototype.loadItem=function(t){if(t){var e=this.configuration.get("scheda-layout")["related-items"]["max-related-items"];return this.communication.request$("getNode",{onError:function(t){return console.error(t)},params:{id:t,maxSimilarItems:e}})}this.pageTitle="Collezione d'Arte",this.contentParts=[{type:"text",title:"Collezione d'Arte",content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi gravida sagittis pulvinar. Etiam iaculis maximus metus, id tincidunt libero auctor et. Proin tempus turpis vel erat ultrices, id vestibulum ante cursus. Vestibulum lobortis, ante at eleifend consequat, massa libero bibendum justo, id fermentum magna odio ac nulla. Cras aliquet scelerisque malesuada. Mauris congue fermentum tristique. Nulla imperdiet accumsan dui, tristique lobortis metus eleifend non. Donec quis odio massa. Cras sit amet sem eu turpis molestie blandit vitae sed nibh. Pellentesque ornare enim nisl, et efficitur ante elementum a. Ut nec ex finibus, congue libero feugiat, aliquam ante. Cras sem neque, pellentesque eget mi at, auctor vulputate tellus. Sed aliquam mi a tortor ultricies interdum. Etiam tincidunt nunc commodo nulla porttitor semper. Etiam porta lacinia libero a mattis. Lorem ipsum dolor sit amet, consectetur adipiscing elit."},{type:"text",title:"Centro Archivi",content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi gravida sagittis pulvinar. Etiam iaculis maximus metus, id tincidunt libero auctor et. Proin tempus turpis vel erat ultrices, id vestibulum ante cursus. Vestibulum lobortis, ante at eleifend consequat, massa libero bibendum justo, id fermentum magna odio ac nulla. Cras aliquet scelerisque malesuada. Mauris congue fermentum tristique. Nulla imperdiet accumsan dui, tristique lobortis metus eleifend non. Donec quis odio massa. Cras sit amet sem eu turpis molestie blandit vitae sed nibh. Pellentesque ornare enim nisl, et efficitur ante elementum a. Ut nec ex finibus, congue libero feugiat, aliquam ante. Cras sem neque, pellentesque eget mi at, auctor vulputate tellus. Sed aliquam mi a tortor ultricies interdum. Etiam tincidunt nunc commodo nulla porttitor semper. Etiam porta lacinia libero a mattis. Lorem ipsum dolor sit amet, consectetur adipiscing elit."}];this.one("aw-scheda-breadcrumbs").update({items:[]})},e.prototype.loadContent=function(t){var e=this;if(t){this.contentParts=[];var n={};if(t.text&&(n.content=t.text),this.contentParts.push(n),t.image){var a=[{type:"image",url:t.image,buildPyramid:!1}];this.imageViewerIstance?this.imageViewerIstance.open(a):this.one("aw-scheda-image").update({viewerId:"scheda-layout-viewer",_setViewer:function(t){e.imageViewerIstance=t,t.open(a)}})}var i={icon:t.icon,title:{main:{text:t.title||t.label,classes:"bold"}},tools:t.subTitle,actions:{}};this.one("aw-scheda-inner-title").update(i),this.hasMetadata=null!=t.fields,this.one("aw-scheda-metadata").updateOptions({labels:this.configuration.get("labels")}),this.one("aw-scheda-metadata").update(t);var o={items:[]};t.breadcrumb&&(t.breadcrumbs.forEach(function(t){o.items.push({label:t.label,payload:t.link})}),this.one("aw-scheda-breadcrumbs").update(o))}t.relatedItems?(this.hasSimilarItems=!0,this.one("aw-linked-objects").updateOptions({context:"scheda",config:this.configuration}),this.one("aw-linked-objects").update(t)):this.hasSimilarItems=!1,setTimeout(function(){e.stickyControlTrigger$.next()})},e.prototype.collapseSidebar=function(){this.sidebarCollapsed=!this.sidebarCollapsed},e.prototype._sidebarStickyControl=function(){var t=this,e=o.fromEvent(window,"scroll");o.merge(e,this.stickyControlTrigger$).pipe(r.takeUntil(this.destroyed$)).subscribe(function(){var e=window.pageYOffset,n=window.scrollY+window.innerHeight,a=document.getElementsByClassName("sticky-parent")[0],i=a.offsetTop,o=i+a.clientHeight;t.sidebarIsSticky=i<=e,t.sidebarIsSticky&&n<o?t.treeMaxHeight=n-e-50+"px":t.sidebarIsSticky&&n>=o?t.treeMaxHeight=o-e-50+"px":t.treeMaxHeight=n<o?n-i-50+"px":o-i-50+"px"})},e.tree=null,e}(l.LayoutDataSource);var Yt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-scheda-layout.init":t.dataSource.onInit(a),t.configuration=a.configuration,t.route=a.route;var i=t.route.snapshot.params.id||"";t.listenRoute(),t.loadNavigation(i);break;case"aw-scheda-layout.destroy":t.destroyed$.next(),t.dataSource.onDestroy()}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-tree.click":a&&t.emitGlobal("navigate",{path:[t.configuration.get("paths").schedaBasePath+a],handler:"router"});break;case"aw-sidebar-header.click":t.dataSource.collapseSidebar();break;case"aw-bubble-chart.bubble-tooltip-goto-click":if(!a||!a.entityId)return;t.emitGlobal("navigate",{handler:"router",path:["aw/entita/"+a.entityId+"/overview"]});break;case"aw-linked-objects.click":var i=t.configuration.get("paths");t.emitGlobal("navigate",{handler:"router",path:[i.schedaBasePath,a.id]})}})},e.prototype.listenRoute=function(){var t=this;this.route.paramMap.subscribe(function(e){var n=e.get("id");n?t.dataSource.loadItem(n).subscribe(function(e){e&&(t.dataSource.loadContent(e),e.relatedEntities&&(t.dataSource.hasBubbles=!0,t.dataSource.bubblesEnabled&&t.emitOuter("filterbubbleresponse",e.relatedEntities)))}):t.dataSource.loadItem()})},e.prototype.loadNavigation=function(t){var e=this;this.dataSource.getNavigation("patrimonio").subscribe(function(n){n&&(e.dataSource.setTree(n),e.dataSource.updateNavigation(e.dataSource.getTree()),e.emitOuter("navigationresponse",{tree:e.dataSource.getTree(),currentItem:t}))})},e}(l.EventHandler);var Zt={layoutId:"aw-scheda-layout",widgets:[{id:"aw-sidebar-header"},{id:"aw-tree"},{id:"aw-scheda-breadcrumbs"},{id:"aw-scheda-metadata"},{id:"aw-scheda-image"},{id:"aw-scheda-inner-title"},{id:"aw-bubble-chart"},{id:"aw-linked-objects"}],layoutDS:Xt,layoutEH:Yt,widgetsDataSources:Dt,widgetsEventHandlers:zt,options:{}},Jt=function(t){function n(e,n,a,i,o,r,s){var c=t.call(this,i.get("AwPatrimonioLayoutConfig")||Zt)||this;return c.router=e,c.route=n,c.configuration=a,c.layoutsConfiguration=i,c.mainState=o,c.titleService=r,c.communication=s,c}return f(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-scheda-layout",template:'<div class="aw-scheda" id="scheda-layout">\n    <div class="aw-scheda__content n7-side-auto-padding sticky-parent"\n        [ngClass]="{ \'is-collapsed\' : lb.dataSource.sidebarCollapsed }">\n        \x3c!-- Left sidebar: tree --\x3e\n        <div class="aw-scheda__tree sticky-target" [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <n7-sidebar-header [data]="lb.widgets[\'aw-sidebar-header\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-sidebar-header\'].emit"></n7-sidebar-header>\n            <div class="aw-scheda__tree-content" \n                [ngStyle]="{ \n                    \'max-height\': lb.dataSource.treeMaxHeight, \n                    \'overflow\': \'auto\' \n                }"\n            >\n                <n7-tree [data]="lb.widgets[\'aw-tree\'].ds.out$ | async" [emit]="lb.widgets[\'aw-tree\'].emit"\n                    *ngIf="!lb.dataSource.sidebarCollapsed"></n7-tree>\n            </div>\n        </div>\n\n        \x3c!-- Scheda details --\x3e\n        <div class="aw-scheda__scheda-wrapper">\n            <n7-breadcrumbs [data]="lb.widgets[\'aw-scheda-breadcrumbs\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-scheda-breadcrumbs\'].emit">\n            </n7-breadcrumbs>\n\n            <n7-inner-title [data]="lb.widgets[\'aw-scheda-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n\n            <n7-image-viewer [data]="lb.widgets[\'aw-scheda-image\'].ds.out$ | async">\n            </n7-image-viewer>\n\n            <section class="aw-scheda__description" *ngIf="lb.dataSource.contentParts.content">\n                <div *ngFor="let part of lb.dataSource.contentParts">\n                    <div [innerHTML]="part.content"></div>\n                </div>\n            </section>\n\n            <section class="aw-scheda__metadata" *ngIf="lb.dataSource.hasMetadata">\n                <div class="aw-scheda__inner-title">\n                    {{lb.dataSource.metadataSectionTitle}}\n                </div>\n                <n7-metadata-viewer [data]="lb.widgets[\'aw-scheda-metadata\'].ds.out$ | async">\n                </n7-metadata-viewer>\n            </section>\n\n            <section class="aw-scheda__bubble-chart" *ngIf="lb.dataSource.bubblesEnabled">\n                <div *ngIf="lb.dataSource.hasBubbles" class="aw-scheda__inner-title">\n                    {{lb.dataSource.bubbleChartSectionTitle}}\n                </div>\n                <aw-bubble-chart-wrapper [emit]="lb.widgets[\'aw-bubble-chart\'].emit"\n                    [container]="\'bubble-chart-container\'" [buttons]="[\'goto\']">\n                    <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                        [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                    </n7-bubble-chart>\n                </aw-bubble-chart-wrapper>\n            </section>\n\n            <section *ngIf="lb.dataSource.hasSimilarItems" id="related-item-container" class="aw-scheda__related">\n                <div class="aw-scheda__inner-title">{{lb.dataSource.similarItemsSectionTitle}}</div>\n                <div class="aw-scheda__related-items">\n                    \x3c!--<ng-container *ngFor="let widgetData of lb.widgets[\'aw-linked-objects\'].ds.out$ | async;">--\x3e\n                    <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                        </n7-item-preview>\n                    </ng-container>\n                </div>\n            </section>\n        </div>\n    </div>\n</div>'}]}],n.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:y},{type:m},{type:v},{type:c.Title},{type:I}]},n}(E);var te={totalCount:0,facets:[{id:"query",type:"value"},{id:"query-all",type:"value",hasStaticData:!0,data:[{value:"1",label:"Cerca in tutti campi delle schede"}]},{id:"query-links",type:"value"},{id:"entity-types",type:"value",operator:"OR",limit:10,order:"count"},{id:"entity-search",type:"value"},{id:"entity-links",type:"value",searchData:["entity-type"]}],fields:[{inputs:[{type:"text",facetId:"query",placeholder:"Cerca...",filterConfig:{delay:500,minChars:3,searchIn:[{key:"label",operator:"LIKE"}]}},{type:"checkbox",facetId:"query-all",filterConfig:{searchIn:[{key:"query-all",operator:"="}]}},{type:"link",facetId:"query-links",filterConfig:{isArray:!0,searchIn:[{key:"source.entityType",operator:"="}]}}]},{header:{label:"Relazione con",classes:"related-class"},inputs:[{type:"checkbox",facetId:"entity-types",filterConfig:{isArray:!0,context:"internal",target:"entity-links",searchIn:[{key:"searchData.entity-type",operator:"="}]}},{type:"text",facetId:"entity-search",placeholder:"Cerca entità",filterConfig:{delay:500,minChars:3,context:"internal",target:"entity-links",searchIn:[{key:"label",operator:"LIKE"}]}},{type:"link",facetId:"entity-links",filterConfig:{isArray:!0,limit:20,searchIn:[{key:"relatedEntities.id",operator:"="}]}}]}],results:{order:{type:"text",key:"label",direction:"ASC"},fields:[{id:"description",highlight:!0,limit:200}]},page:{offset:0,limit:10}},ee="aw-search-layout",ne=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e.resetButtonEnabled=!0,e.currentPage=1,e.pageSize=10,e.sidebarIsSticky=!1,e.isFirstLoading=!0,e.orderByLabel="Ordina per",e.orderByOptions=[{value:"label_ASC",label:"Ordine alfabetico (A→Z)"},{value:"label_DESC",label:"Ordine alfabetico (Z→A)"}],e.getSearchModelId=function(){return ee},e}return f(e,t),e.prototype.onInit=function(t){var e=t.configuration,n=t.mainState,a=t.options,i=t.communication,o=t.search;this.configuration=e,this.mainState=n,this.communication=i,this.search=o,this.options=a,this.prettifyLabels=this.configuration.get("labels"),this.configKeys=this.configuration.get("config-keys"),this.fallback=this.configuration.get("search-layout").fallback,this.pageTitle=this.configuration.get("search-layout").title,this.search.model(ee)&&this.search.remove(ee),this.search.add(ee,d.cloneDeep(te)),this.searchModel=this.search.model(ee),L.queryParams&&(this.searchModel.updateFiltersFromQueryParams(L.queryParams),L.queryParams=null),this._sidebarStickyControl()},e.prototype.onDestroy=function(){this.destroyed$.next(),L.queryParams=null},e.prototype.onSearchResponse=function(){this.resetButtonEnabled=!0,this.isFirstLoading&&(this.isFirstLoading=!1,this.one("facets-wrapper").update({searchModel:this.searchModel}),this.searchModel.updateInputsFromFilters())},e.prototype.onOrderByChange=function(t){var e=g(t.split("_"),2),n=e[0],a=e[1];this.searchModel.setSearchConfigOrderBy(n),this.searchModel.setSearchConfigDirection(a)},e.prototype.onPaginationChange=function(t){var e=t.replace("page-","");return this._updateSearchPage(e)},e.prototype.onPaginationGoToChange=function(t){var e=t.replace("goto-","");return this._updateSearchPage(e)},e.prototype.resetPagination=function(){this._updateSearchPage(1)},e.prototype.onResultsLimitChange=function(t){this.pageSize=t,this.searchModel.setPageConfigLimit(t),this.currentPage=1,this.searchModel.setPageConfigOffset(0)},e.prototype.doSearchRequest$=function(){var t=this,e=this.searchModel.getRequestParams(),n={searchParameters:b({totalCount:100},e)};return this.communication.request$("search",{onError:function(t){return console.error(t)},params:n}).pipe(r.tap(function(e){var n=e.totalCount,a=e.results,i=e.facets;t.totalCount=n;var o=0;t.totalCount>1?o=2:1===t.totalCount&&(o=1),t.resultsTitle=t.configuration.get("search-layout").results[o],t._addFacetsLabels(i),t._addFacetsOptions(i),t.searchModel.updateFacets(i),t.searchModel.updateTotalCount(n),t.one("aw-linked-objects").updateOptions({context:"search",config:t.configuration,page:t.currentPage,pagination:!0,dynamicPagination:{total:n},size:t.pageSize}),t.one("aw-linked-objects").update({items:t._normalizeItems(a.items)})}))},e.prototype._updateSearchPage=function(t){if(+t===this.currentPage)return o.of(!1);this.currentPage=+t;var e=this.searchModel.getConfig().page.limit,n=(this.currentPage-1)*e;return this.searchModel.setPageConfigOffset(n),o.of(!0)},e.prototype._addFacetsLabels=function(t){var e=this;t.filter(function(t){return Array.isArray(t.data)}).forEach(function(t){t.data.forEach(function(t){var n=t.label;t.label=lt.prettifySnakeCase(n,e.prettifyLabels[n])})})},e.prototype._addFacetsOptions=function(t){var e=this;t.filter(function(t){return"query-links"===t.id}).forEach(function(t){t.data.forEach(function(t){var n=t.value.replace(" ","-"),a=e.configKeys[n];a&&(t.options={icon:a.icon,classes:"color-"+n})})})},e.prototype._normalizeItems=function(t){return t.map(function(t){return{item:b({},t)}})},e.prototype._sidebarStickyControl=function(){var t=this;o.fromEvent(window,"scroll").pipe(r.takeUntil(this.destroyed$)).subscribe(function(){var e=window.pageYOffset,n=document.getElementsByClassName("sticky-parent")[0].offsetTop;t.sidebarIsSticky=n<=e})},e}(l.LayoutDataSource);var ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new o.Subject,e.facetsChange$=new o.Subject,e}return f(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"aw-search-layout.init":t.route=a.route,t.configuration=a.configuration,t.dataSource.onInit(a),t._listenToFacetsChange(),t._listenToRouterChanges();break;case"aw-search-layout.destroy":t.dataSource.onDestroy(),t.destroyed$.next();break;case"aw-search-layout.orderbychange":t.dataSource.onOrderByChange(a),t.facetsChange$.next();break;case"aw-search-layout.searchreset":t.dataSource.resetButtonEnabled=!1,t.emitGlobal("navigate",{handler:"router",path:[t.configuration.get("paths").searchBasePath]});break;default:console.warn("(search) unhandled inner event of type",n)}}),this.outerEvents$.subscribe(function(e){var n=e.type,a=e.payload;switch(n){case"facets-wrapper.facetschange":t.dataSource.resetPagination();break;case"aw-linked-objects.pagination":t.dataSource.onPaginationChange(a).subscribe(function(e){e&&t.facetsChange$.next()});break;case"aw-linked-objects.change":t.dataSource.onResultsLimitChange(a),t.facetsChange$.next();break;case"aw-linked-objects.goto":t.dataSource.onPaginationGoToChange(a).subscribe(function(e){e&&t.facetsChange$.next()});break;case"aw-linked-objects.click":var i=t.dataSource.configuration.get("paths");t.emitGlobal("navigate",{handler:"router",path:[null==a.type?i.schedaBasePath:i.entitaBasePath,a.id]})}})},e.prototype._listenToFacetsChange=function(){var t=this;this.facetsChange$.pipe(r.debounceTime(500)).subscribe(function(){t.dataSource.doSearchRequest$().subscribe(function(){t.dataSource.onSearchResponse(),t.emitGlobal("searchresponse",t.dataSource.getSearchModelId())})})},e.prototype._listenToRouterChanges=function(){var t=this;this.route.queryParams.pipe(r.takeUntil(this.destroyed$)).subscribe(function(e){t.emitOuter("queryparamschange",e),t.facetsChange$.next()})},e}(l.EventHandler);var ie={layoutId:"aw-search-layout",widgets:[{id:"facets-wrapper",dataSource:N,eventHandler:Q},{id:"aw-linked-objects"},{id:"aw-search-layout-tabs",hasStaticData:!0}],layoutDS:ne,layoutEH:ae,widgetsDataSources:Dt,widgetsEventHandlers:zt,options:{}},oe=function(t){function n(e,n,a,i,o,r){var s=t.call(this,n.get("AwSearchLayoutConfig")||ie)||this;return s.configuration=e,s.layoutsConfiguration=n,s.mainState=a,s.communication=i,s.search=o,s.route=r,s}return f(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,communication:this.communication,search:this.search,route:this.route,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-search-layout",template:'<div class="aw-search n7-side-auto-padding" id="search-layout">\n    <div class="aw-search__header">\n        <div class="aw-search__header-left">\n            <h1 class="aw-search__header-title">{{ lb.dataSource.pageTitle }}</h1>\n        </div>\n        \x3c!--\n        <div class="aw-search__header-right">\n            <n7-nav\n                [data]="lb.widgets[\'aw-search-layout-tabs\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-search-layout-tabs\'].emit">\n            </n7-nav>\n        </div>\n        --\x3e\n    </div>\n    <div class="aw-search__content-wrapper sticky-parent">\n        \x3c!-- Left sidebar: facets --\x3e\n        <div class="aw-search__sidebar sticky-target" [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <div class="aw-search__facets">\n                <n7-facets-wrapper [data]="lb.widgets[\'facets-wrapper\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'facets-wrapper\'].emit">\n                </n7-facets-wrapper>\n            </div>\n        </div>\n        <div class="aw-search__content">\n            <div class="aw-search__results-header">\n                <div class="aw-search__results-header-left">\n                    <h3 class="aw-search__total">\n                        <span class="aw-search__total-number">{{ lb.dataSource.totalCount }}</span>&nbsp;\n                        <span class="aw-search__total-title">{{ lb.dataSource.resultsTitle }}</span>\n                    </h3>\n                </div>\n                <div class="aw-search__results-header-right">\n                    <label class="aw-search__results-select-orderby-label"\n                        for="aw-search__results-select-orderby">{{ lb.dataSource.orderByLabel }}</label>\n                    <select (change)="lb.eventHandler.emitInner(\'orderbychange\', $event.target.value)"\n                        id="aw-search__results-select-orderby">\n                        <option *ngFor="let option of lb.dataSource.orderByOptions" [value]="option.value">\n                            {{ option.label }}</option>\n                    </select>\n                </div>\n            </div>\n            \x3c!-- Search details --\x3e\n            <div class="aw-search__results-wrapper">\n                <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                    <n7-breadcrumbs [data]="preview.breadcrumbs">\n                    </n7-breadcrumbs>\n                    <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                    </n7-item-preview>\n                </ng-container>\n                <ng-container *ngIf="lb.dataSource.totalCount == 0">\n                    <div class="aw-search__fallback">\n                        <p class="aw-search__fallback-string">\n                            {{ lb.dataSource.fallback }}\n                        </p>\n                        <button [disabled]="!lb.dataSource.resetButtonEnabled" class="n7-btn aw-search__fallback-button" (click)="lb.eventHandler.emitInner(\'searchreset\', {})">\n                            Resetta la ricerca\n                        </button>\n                    </div>\n                </ng-container>\n                <n7-pagination *ngIf="lb.dataSource.totalCount > 10"\n                    [data]="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.pagination"\n                    [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                </n7-pagination>\n            </div>\n        </div>\n    </div>\n</div>'}]}],n.ctorParameters=function(){return[{type:y},{type:m},{type:v},{type:I},{type:L},{type:s.ActivatedRoute}]},n}(E);var re=function(){function t(){}return t.prototype.onClick=function(t,e){this.emit(t,e)},t.decorators=[{type:e.Component,args:[{selector:"aw-bubble-chart-wrapper",template:'<div class="aw-bubble-chart-wrapper">\n    <div class="bubble-chart__tippy-template" style="display: none;">\n        \x3c!-- <button id="bubble-popup-menu_closebutton" style="display: none;"\n            (click)="onClick(\'bubble-tooltip-close-click\')"></button> --\x3e\n        <button id="bubble-popup-menu_gotobutton" class="bubble-popup-menu_gotobutton" style="display: none;"\n            (click)="onClick(\'bubble-tooltip-goto-click\', {})"></button>\n        <button id="bubble-popup-menu_selectbutton" style="display: none;"\n            (click)="onClick(\'bubble-tooltip-select-click\', {})"></button>\n        <div id="bubble-popup-menu" class="aw-bubble-popup-menu">\n            <h2 class="aw-bubble-popup-menu__title">\n                \x3c!-- Set by tippy builder fuction --\x3e\n            </h2>\n            \x3c!-- <span class="n7-icon-close aw-bubble-popup-menu__close"\n                onclick="document.getElementById(\'bubble-popup-menu_closebutton\').click();">\n            </span> --\x3e\n            <p class="aw-bubble-popup-menu__text">\n                \x3c!-- Set by tippy builder fuction --\x3e\n            </p>\n            <div class="aw-bubble-popup-menu__actions">\n                <span class="aw-bubble-popup-menu__link" *ngIf="buttons.indexOf(\'goto\') >= 0"\n                    onclick="document.getElementById(\'bubble-popup-menu_gotobutton\').click();">Vai alla scheda</span>\n                <ng-container>\n                    <span class="aw-bubble-popup-menu__link" *ngIf="buttons.indexOf(\'select\') >= 0"\n                        onclick="document.getElementById(\'bubble-popup-menu_selectbutton\').click();">\n                        \x3c!-- Set by tippy builder function --\x3e\n                    </span>\n                </ng-container>\n            </div>\n        </div>\n    </div>\n\n    <ng-content></ng-content>\n</div>'}]}],t.propDecorators={emit:[{type:e.Input}],container:[{type:e.Input}],buttons:[{type:e.Input}]},t}();var se=function(){function t(){var t=this;this.ngAfterViewInit=function(){var e=t.bcdiv.nativeElement.clientWidth,n=t.bcol.nativeElement.clientWidth,a=t.bcol.nativeElement.children;if(e===n){var i=document.createElement("ol"),o=1;for(i.className="n7-smart-breadcrumbs__tippy-content";e===n&&o<a.length-1;)o>1?i.appendChild(a[o]):(i.appendChild(a[o]),a[o].children[0].innerText="…"),t.tippyBuilder(a[o],i),o++,e=t.bcdiv.nativeElement.clientWidth,n=t.bcol.nativeElement.clientWidth}},this.tippyBuilder=function(t,e){document.body.appendChild(e),p(t,{content:e,interactive:!0,arrow:!0,theme:"light-border no-padding"})}}return t.prototype.onClick=function(t){this.emit&&this.emit("click",t)},t.decorators=[{type:e.Component,args:[{selector:"n7-smart-breadcrumbs",template:'<div *ngIf="data" class="n7-breadcrumbs {{ data.classes || \'\' }}" #bcdiv>\n    <nav class="n7-breadcrumbs__nav">\n        <ol class="n7-breadcrumbs__list" #bcol>\n            <li *ngFor="let item of data.items" class="n7-breadcrumbs__item {{ item.classes || \'\' }}">\n                <a class="n7-breadcrumbs__label" (click)="onClick(item.payload)">{{ item.label }}</a>\n            </li>\n        </ol>\n    </nav>\n</div>'}]}],t.propDecorators={data:[{type:e.Input}],emit:[{type:e.Input}],bcol:[{type:e.ViewChild,args:["bcol",{read:e.ElementRef,static:!1}]}],bcdiv:[{type:e.ViewChild,args:["bcdiv",{read:e.ElementRef,static:!1}]}]},t}();var ce=[Vt,Qt,Jt,oe,re,se],le=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:ce,imports:[n.CommonModule,i.DvComponentsLibModule,rt],providers:[],exports:ce}]}],t}();var ue=function(){function t(){}return t.decorators=[{type:e.Component,args:[{selector:"dv-data-widget-wrapper",template:'<div class="dv-data-widget-wrapper">\n    <ng-content></ng-content>\n</div>'}]}],t.propDecorators={data:[{type:e.Input}],emit:[{type:e.Input}]},t}();var de=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e}(l.LayoutDataSource),pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){},e}(l.EventHandler),he=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){if(!t)return null},e}(l.DataSource),fe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return{containerId:"test-Chart",libOptions:{chart:{height:550,width:1500,type:"area",toolbar:{show:!0}},dataLabels:{enabled:!1},colors:["rgba(15,200,255)"],fill:{colors:["#0fc8ff"],gradient:{opacityFrom:.5,opacityTo:.1}},stroke:{curve:"straight",width:[2,1]},series:[{name:"Reddish value",data:[["2019-08-01","770.17"],["2019-08-02","645.03"],["2019-08-03","709.32"],["2019-08-04","708.11"],["2019-08-05","706.59"],["2019-08-06","607.28"],["2019-08-07","494.59"],["2019-08-08","636.81"],["2019-08-09","709.04"],["2019-08-10","717.31"],["2019-08-11","805.61"],["2019-08-12","758.60"],["2019-08-13","612.82"],["2019-08-14","608.90"],["2019-08-15","734.68"],["2019-08-16","838.54"],["2019-08-17","692.88"]]}],grid:{borderColor:"#e7e7e7",strokeDashArray:3,xaxis:{lines:{show:!0}}},markers:{size:3,hover:{size:6}},xaxis:{axisBorder:{show:!0,color:"#f4f6fc"},labels:{},type:"datetime",tickAmount:6},yaxis:[{show:!0,showAlways:!1,opposite:!1,reversed:!1,logarithmic:!1,forceNiceScale:!1,floating:!1,labels:{show:!0,minWidth:0,maxWidth:160,offsetX:0,offsetY:0,rotate:0,padding:20,style:{colors:[],fontSize:"11px",cssClass:""}},axisBorder:{show:!0,color:"#f4f6fc",offsetX:0,offsetY:0},axisTicks:{show:!1,color:"#78909C",width:6,offsetX:0,offsetY:0},title:{text:"P Totale °C",rotate:90,offsetY:0,offsetX:0,style:{fontSize:"11px",cssClass:""}},tooltip:{enabled:!1,offsetX:0},crosshairs:{show:!0,position:"front",stroke:{color:"#b6b6b6",width:1,dashArray:0}}}],legend:{show:!0},tooltip:{},annotations:{yaxis:[],xaxis:[],points:[]}}}},e}(l.DataSource),be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return{title:{main:{text:"Dipendenti",classes:"n7-main-widget-title"},secondary:{text:"Dipendeti al 10/10/10",classes:"n7-secondary-widget-title"}}}},e}(l.DataSource),ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.transform=function(t){return i.DATA_WIDGET_MOCK},e}(l.DataSource),ye=Object.freeze({DvDataWidgetDS:he,DvGraphDS:fe,DvInnerTitleDS:be,DvWidgetDS:ge}),me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.listen=function(){console.log("....")},e}(l.EventHandler),ve={layoutId:"dv-example-layout",widgets:[{id:"dv-inner-title",hasStaticData:!0},{id:"dv-widget",hasStaticData:!0},{id:"dv-graph",hasStaticData:!0}],layoutDS:de,layoutEH:pe,widgetsDataSources:ye,widgetsEventHandlers:Object.freeze({DvDataWidgetEH:me}),options:{}},we=function(t){function n(){return t.call(this,ve)||this}return f(n,t),n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"dv-example-layout",template:'<div class="dv-example-layout" id="example-layout">\n    <dv-data-widget-wrapper>\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-chart\n                    [data]="lb.widgets[\'dv-graph\'].ds.out$ | async">\n                </n7-chart>\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n</div>'}]}],n.ctorParameters=function(){return[]},n}(E),Se=[ue,we],ke=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:Se,imports:[n.CommonModule,i.DvComponentsLibModule,rt],providers:[],exports:Se}]}],t}(),_e=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[n.CommonModule],providers:[],exports:[rt,le,ke]}]}],t}();t.AbstractLayout=E,t.ApolloProvider=S,t.ApolloProviderConfig=w,t.AwAutocompleteWrapperDS=dt,t.AwAutocompleteWrapperEH=Pt,t.AwBubbleChartDS=pt,t.AwBubbleChartEH=Ot,t.AwEntitaLayoutComponent=Vt,t.AwEntitaLayoutConfig=Gt,t.AwEntitaLayoutDS=st,t.AwEntitaLayoutEH=ct,t.AwEntitaMetadataViewerDS=wt,t.AwEntitaNavDS=vt,t.AwEntitaNavEH=$t,t.AwHeroDS=ht,t.AwHeroEH=Tt,t.AwHomeAutocompleteDS=mt,t.AwHomeAutocompleteEH=Lt,t.AwHomeFacetsWrapperDS=gt,t.AwHomeFacetsWrapperEH=Ft,t.AwHomeHeroPatrimonioDS=bt,t.AwHomeHeroPatrimonioEH=Ht,t.AwHomeItemTagsWrapperDS=yt,t.AwHomeItemTagsWrapperEH=jt,t.AwHomeLayoutComponent=Qt,t.AwHomeLayoutConfig=Ut,t.AwHomeLayoutDS=Wt,t.AwHomeLayoutEH=Kt,t.AwLinkedObjectsDS=ut,t.AwLinkedObjectsEH=At,t.AwPatrimonioLayoutConfig=Zt,t.AwSchedaBreadcrumbsDS=_t,t.AwSchedaImageDS=Et,t.AwSchedaInnerTitleDS=Ct,t.AwSchedaLayoutComponent=Jt,t.AwSchedaLayoutDS=Xt,t.AwSchedaLayoutEH=Yt,t.AwSchedaMetadataDS=It,t.AwSchedaSidebarEH=Mt,t.AwSearchLayoutComponent=oe,t.AwSearchLayoutConfig=ie,t.AwSearchLayoutDS=ne,t.AwSearchLayoutEH=ae,t.AwSearchLayoutTabsDS=xt,t.AwSearchLayoutTabsEH=Rt,t.AwSidebarHeaderDS=kt,t.AwSidebarHeaderEH=qt,t.AwTableDS=ft,t.AwTableEH=Nt,t.AwTreeDS=St,t.AwTreeEH=Bt,t.BreadcrumbsDS=B,t.BreadcrumbsEH=K,t.BubbleChartWrapperComponent=re,t.CommunicationService=I,t.ConfigurationService=y,t.DataWidgetWrapperComponent=ue,t.DvDataWidgetDS=he,t.DvDataWidgetEH=me,t.DvExampleLayoutComponent=we,t.DvExampleLayoutConfig=ve,t.DvExampleLayoutDS=de,t.DvExampleLayoutEH=pe,t.DvGraphDS=fe,t.DvInnerTitleDS=be,t.DvWidgetDS=ge,t.FacetInput=D,t.FacetInputCheckbox=A,t.FacetInputLink=O,t.FacetInputSelect=T,t.FacetInputText=P,t.FacetsDS=R,t.FacetsEH=U,t.FacetsWrapperComponent=it,t.FacetsWrapperDS=N,t.FacetsWrapperEH=Q,t.FooterDS=z,t.FooterEH=X,t.HeaderDS=M,t.HeaderEH=V,t.JsonConfigService=x,t.LayoutsConfigurationService=m,t.MainLayoutComponent=J,t.MainLayoutConfig=Z,t.MainLayoutDS=C,t.MainLayoutEH=$,t.MainStateService=v,t.N7BoilerplateAriannaWebModule=le,t.N7BoilerplateCommonModule=rt,t.N7BoilerplateDataVizModule=ke,t.N7BoilerplateLibModule=_e,t.Page404LayoutComponent=at,t.Page404LayoutConfig=nt,t.Page404LayoutDS=tt,t.Page404LayoutEH=et,t.RestProvider=_,t.RestProviderConfig=k,t.SearchModel=j,t.SearchService=L,t.SmartBreadcrumbsComponent=se,t.SubnavDS=q,t.SubnavEH=W,t.ɵa=J,t.ɵb=E,t.ɵc=y,t.ɵd=m,t.ɵe=v,t.ɵf=at,t.ɵg=it,t.ɵh=I,t.ɵi=S,t.ɵj=_,t.ɵk=Vt,t.ɵl=I,t.ɵm=v,t.ɵn=Qt,t.ɵo=Jt,t.ɵp=oe,t.ɵq=y,t.ɵr=m,t.ɵs=L,t.ɵt=re,t.ɵu=se,t.ɵv=ue,t.ɵw=we,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=n7-frontend-boilerplate.umd.min.js.map