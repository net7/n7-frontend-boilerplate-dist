!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http"),require("@n7-frontend/components"),require("rxjs"),require("rxjs/operators"),require("@angular/router"),require("@angular/platform-browser"),require("@n7-frontend/core"),require("@n7-frontend/core/dist/layout-data-source"),require("tippy.js"),require("lodash"),require("slugify"),require("@n7-frontend/core/dist/data-source")):"function"==typeof define&&define.amd?define("@n7-frontend/boilerplate",["exports","@angular/core","@angular/common","@angular/common/http","@n7-frontend/components","rxjs","rxjs/operators","@angular/router","@angular/platform-browser","@n7-frontend/core","@n7-frontend/core/dist/layout-data-source","tippy.js","lodash","slugify","@n7-frontend/core/dist/data-source"],e):e(((t=t||self)["n7-frontend"]=t["n7-frontend"]||{},t["n7-frontend"].boilerplate={}),t.ng.core,t.ng.common,t.ng.common.http,t.components,t.rxjs,t.rxjs.operators,t.ng.router,t.ng.platformBrowser,t.core$1,t.layoutDataSource,t.tippy,t.lodash,t.slugify,t.dataSource)}(this,(function(t,e,a,n,i,r,o,s,c,l,u,d,p,h,f){"use strict";var g="default"in d?d.default:d;h=h&&h.hasOwnProperty("default")?h.default:h;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)};function m(t,e){function a(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}var b=function(){return(b=Object.assign||function(t){for(var e,a=1,n=arguments.length;a<n;a++)for(var i in e=arguments[a])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function v(t){var e="function"==typeof Symbol&&Symbol.iterator,a=e&&t[e],n=0;if(a)return a.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(t,e){var a="function"==typeof Symbol&&t[Symbol.iterator];if(!a)return t;var n,i,r=a.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o}var S=function(){function t(){var t=this;this.defaults={},this.get=function(e){return t.defaults[e]},this.set=function(e,a){t.defaults[e]=a}}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var _=function(){function t(t){var e=this;this.config=t,this.defaults={},this.get=function(t){return e.defaults[t]},this.set=function(t,a){e.defaults[t]=a},this.config.layouts&&Object.keys(this.config.layouts).forEach((function(t){e.set(t,e.config.layouts[t])}))}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["config"]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject("config"))},token:t,providedIn:"root"}),t}();var k=function(){function t(){var t=this;this.custom={},this.default={headTitle:new r.ReplaySubject,pageTitle:new r.ReplaySubject,subnav:new r.ReplaySubject,breadcrumbs:new r.ReplaySubject,filters:new r.ReplaySubject},this.get$=function(e){return t._get("default",e)},this.getCustom$=function(e){return t._get("custom",e)},this.update=function(e,a){return t._update("default",e,a)},this.updateCustom=function(e,a){return t._update("custom",e,a)},this.has=function(e){return!!t.default[e]},this.hasCustom=function(e){return!!t.custom[e]}}return t.prototype.addCustom=function(t,e){if(this.custom[t])throw Error("custom stream "+t+" exists!");this.custom[t]=e},t.prototype._update=function(t,e,a){if(!this[t])throw Error(t+" stream group does not exists!");if(!this[t][e])throw Error(t+" stream "+e+" does not exists!");this[t][e].next(a)},t.prototype._get=function(t,e){if(!this[t])throw Error(t+" stream group does not exists!");if(!this[t][e])throw Error(t+" stream "+e+" does not exists!");return this[t][e]},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var I=function(){function t(t){this.http=t}return t.prototype.request$=function(t,e,a){var n,i=a.params,r=a.method,s=a.httpOptions;t.config&&t.config[e]&&(n=t.config[e]);var c=(n=n||{}).queryName,l=n.queryBody;if(!c||!l)throw Error("No config found for requestId '"+e+"'");if(i){var u=this.makeParamsStr(i);l=l.replace("__PARAMS__",u)}else l=l.replace("(__PARAMS__)","");return(r&&"GET"===r?this.http.get(t.baseUrl):this.http.post(t.baseUrl,{query:l},s)).pipe(o.map((function(t){return t.data[c]})))},t.prototype.makeParamsStr=function(t){var e=this,a=[];return Object.keys(t).forEach((function(n){if(Array.isArray(t[n])){var i=[];t[n].forEach((function(t){if("object"==typeof t){var a=e.makeParamsStr(t);i.push("{ "+a+" }")}else"number"==typeof t||"boolean"==typeof t||null===t?i.push(""+t):i.push('"'+t+'"')})),a.push(n+": ["+i.join(",")+"]")}else if("object"==typeof t[n]&&t[n]){var r=e.makeParamsStr(t[n]);a.push(n+": { "+r+" }")}else"string"==typeof t[n]&&0===n.indexOf("$")?a.push(n.replace("$","")+": "+t[n]):"number"==typeof t[n]||"boolean"==typeof t[n]||null===t[n]?a.push(n+": "+t[n]):a.push(n+': "'+t[n]+'"')})),a.join(" ")},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:n.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient))},token:t,providedIn:"root"}),t}();var E=function(){function t(t){this.http=t}return t.prototype.request$=function(t,e,a){void 0===a&&(a={});var n,i=a.params,r=a.httpOptions,o=a.urlParams,s=void 0===o?"":o,c=a.method;if(c||(c=t.defaultMethod||"GET"),t.config&&t.config[e]&&(n=t.config[e]),!n)throw Error('No config found for requestId "'+e+'"');if("POST"===c||"PUT"===c)return this.http[c.toLowerCase()](t.baseUrl+n,i,r);if("GET"===c||"DELETE"===c)return this.http[c.toLowerCase()](t.baseUrl+n+s,r);throw Error("Rest method "+c+" not supported")},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:n.HttpClient}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient))},token:t,providedIn:"root"}),t}();var C=function(){function t(t,e,a){this.config=t,this.apollo=e,this.rest=a;try{this.communicationConfig=this.config.get("communication"),this.defaultProvider=this.communicationConfig.defaultProvider}catch(t){throw Error("No communications.defaultProvider setted in config")}}return t.prototype.request$=function(t,e,a){var n=this;void 0===e&&(e={});var i=a||this.defaultProvider,r=this.communicationConfig.providers[i];if(!r)throw Error('There is no config for "'+i+'" provider');var s=r.type||i;if(!this[s])throw Error('There is no "'+s+'" provider type');var c=e.onError;return this[s].request$(r,t,e).pipe(o.catchError((function(t){return n.handleError(t,c)})))},t.prototype.handleError=function(t,e){return e?e(t):console.warn("No error handler for communication request",t),r.empty()},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:S},{type:I},{type:E}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(S),e.ɵɵinject(I),e.ɵɵinject(E))},token:t,providedIn:"root"}),t}();var x=function(){function t(t){this.config=t,this.widgets=this.config.widgets,this.lb=new l.LayoutBuilder(this.config.layoutId)}return t.prototype.onInit=function(){var t=this;this.lb.ready$.subscribe((function(){t.lb.eventHandler.emitInner("init",t.initPayload())}));var e=this.config.layoutDS,a=this.config.layoutEH;this.lb.init({widgetsConfig:this.widgets,widgetsDataSources:this.config.widgetsDataSources,widgetsEventHandlers:this.config.widgetsEventHandlers,dataSource:new e,eventHandler:new a})},t.prototype.onDestroy=function(){this.lb.eventHandler.emitInner("destroy")},t}();var D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.onInit=function(t){var e=this,a=t.configuration,n=t.mainState,i=t.router,r=t.options,o=t.titleService,s=t.route;this.configuration=a,this.mainState=n,this.router=i,this.route=s,this.titleService=o,this.options=r,this.configuration.get("header")&&this.one("header").update({items:this.configuration.get("header")}),this.configuration.get("footer")&&this.one("footer").update({items:this.configuration.get("footer")}),this.mainState.get$("headTitle").subscribe((function(t){return e.titleService.setTitle(t)})),this.mainState.get$("pageTitle").subscribe((function(t){e.pageTitle=t})),this.mainState.get$("subnav").subscribe((function(t){return e.one("subnav").update(t)})),this.mainState.get$("breadcrumbs").subscribe((function(t){return e.one("breadcrumbs").update(t)}))},e.prototype.onNavigate=function(t){if("router"===t.handler){var e=t.path,a=t.queryParams;if(!e)throw Error("onNavigate: no path for router navigate");a?this.router.navigate(e,{relativeTo:this.route,queryParams:a,queryParamsHandling:"merge"}):this.router.navigate(e),this._onRouterNavigate()}},e.prototype.onRouterChanged=function(){d.hideAll()},e.prototype._onRouterNavigate=function(){d.hideAll()},e}(u.LayoutDataSource);var P=function(){function t(t,e){this.http=t,this.config=e}return t.prototype.load=function(t,e){var a=this;return this.http.get(t).pipe(o.catchError((function(){return r.of({})})),o.tap((function(t){return a._handleResponse(t,e)}))).toPromise()},t.prototype._handleResponse=function(t,e){var a=this;if(e&&Object.keys(e).forEach((function(t){return a.config.set(t,e[t])})),t&&(Object.keys(t).forEach((function(e){return a.config.set(e,t[e])})),t["config-keys"])){var n=document.querySelector("head"),i=document.createElement("style"),r=[];Object.keys(t["config-keys"]).forEach((function(e){var a=t["config-keys"][e]||{},n=a["class-name"];a.color&&a.color.hex&&r.push("--color-"+n+": "+a.color.hex+";")})),r.length&&(r.unshift(":root {"),r.push("}"),i.appendChild(document.createTextNode(r.join("\n"))),n.appendChild(i))}},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:n.HttpClient},{type:S}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient),e.ɵɵinject(S))},token:t,providedIn:"root"}),t}();var O=function(){function t(e){var a=this;this.isEmpty=!1,this.update=function(){a.output=a.transform()},this.getId=function(){return a.id},this.getData=function(){return a.data},this.getConfig=function(){return a.config},this.getFacetId=function(){return a.config.facetId},this.getInputIndex=function(){return a.config.inputIndex},this.getSectionIndex=function(){return a.config.sectionIndex},this.getContext=function(){return a.config.filterConfig.context||"external"},this.getTarget=function(){return a.config.filterConfig.target||null},this.getSearchIn=function(){return a.config.filterConfig.searchIn||null},this.getType=function(){return a.config.type},this.getOutput=function(){return a.output},this.setIsEmpty=function(t){a.isEmpty=t},this.setData=function(t){a.data=t},this.config=e,this._setId(),t.index+=1}return t.prototype.clear=function(){return null},t.prototype._setId=function(){this.id="facet-input-"+this.getType()+"-"+t.index},t.index=0,t}();var A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(){var t=this,e=this.getFacetId();return this.data.map((function(a,n){var i=a.label,r=a.value;return{type:"checkbox",id:t.getId()+"-"+n,label:i,payload:{facetId:e,source:"input-checkbox",value:""+r},_meta:{facetId:e,value:""+r}}}))},e.prototype.setActive=function(t){var e=this.config.filterConfig.isArray;this.output.forEach((function(a){e&&Array.isArray(t)&&-1!==t.indexOf(a._meta.value)?a.checked=!0:t===a._meta.value?a.checked=!0:a.checked=!1}))},e}(O),T=new DOMParser,L={prettifySnakeCase:function(t,e){var a=this;return"string"==typeof e?e:(t||"").split("_").map((function(t,e){return 0===e?a.ucFirst(t):t})).join(" ")},ucFirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},slugify:function(t){if(!t)return"";var e=T.parseFromString(t,"text/html").body.textContent||"";return h(e,{remove:/[*+~.()'"!:@,]/g,lower:!0})},browserIsIE:function(){return window.navigator.userAgent.match(/(MSIE|Trident)/)},escapeDoubleQuotes:function(t){return t.search(/\\?(")([\w\s]+)\\?(")/g)>=0?t.replace(/\\?(")([\w\s]+)\\?(")/g,"\\$1$2\\$3"):t.replace(/\\([\s\S])|(")/g,"\\\\\\$1$2")},unescapeDoubleQuotes:function(t){return t&&""!==t?t.replace(/\\*(")/g,"$1"):t}},F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(){var t=this.getFacetId(),e={facetId:t,source:"input-text"};return{type:"text",id:this.getId(),label:this.config.label,disabled:this.config.disabled,placeholder:this.config.placeholder,icon:this.config.icon,inputPayload:b({},e,{trigger:"input"}),enterPayload:b({},e,{trigger:"enter"}),iconPayload:b({},e,{trigger:"icon"}),_meta:{facetId:t}}},e.prototype.setActive=function(t){this.output.value=L.unescapeDoubleQuotes(t)||null},e}(O),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(){var t,e,a=this.getFacetId(),n=[],i=0;try{for(var r=v(this.data),o=r.next();!o.done;o=r.next()){var s=o.value,c=s.label,l=s.counter,u=s.hidden,d=s.value,p=s.options;if(!u){if((i+=1)>1e3)break;d=""+d;var h=[];(p=p||{}).classes&&h.push(p.classes),this._isActive(this.facetValue,d)&&h.push("is-active"),n.push({type:"link",id:this.getId(),text:c,counter:l,payload:{facetId:a,source:"input-link",value:d},icon:p.icon||null,classes:h.join(" "),_meta:{facetId:a,value:d}})}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}var f=n.filter((function(t){return"empty"===t.id}))[0];if(this.isEmpty)if(f)f.classes="empty-text-link";else{c=this.getConfig().emptyState.label;n.push({type:"link",id:"empty-link",text:c,classes:"empty-text-link",_meta:{facetId:"empty-link",value:null}})}else f&&(f.classes="empty-text-link is-hidden");return n},e.prototype.setActive=function(t){var e=this;this.output.forEach((function(a){var n=e._isActive(t,a._meta.value),i=a.classes?a.classes.split(" "):[];n?-1===i.indexOf("is-active")&&i.push("is-active"):i=i.filter((function(t){return"is-active"!==t})),a.classes=i.join(" ")}))},e.prototype._isActive=function(t,e){return this.facetValue=t,Array.isArray(t)&&-1!==t.indexOf(e)||t===e},e.prototype.clear=function(){this.facetValue=[]},e}(O);var $=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(){var t=this.getFacetId();return{type:"select",id:this.getId(),label:this.config.label,disabled:this.config.disabled,options:this.data?this.data.map((function(t){return{value:""+t.value,label:t.label}})):[],payload:{facetId:t,source:"input-select"},_meta:{facetId:t}}},e.prototype.setActive=function(t){this.output.options.filter((function(e){return e.value===t})).forEach((function(t){t.selected=!0}))},e}(O),M={checkbox:A,text:F,link:H,select:$},j={"=":"_filterDataEquals",">":"_filterDataGreaterThan","<":"_filterDataLessThan",">=":"_filterDataGreaterOrEquals","<=":"_filterDataLessOrEquals","<>":"_filterDataNotEqual",LIKE:"_filterDataLike"};var q=function(){function t(t,e){var a=this;this._filters=[],this._facets=[],this._inputs=[],this._results$=new r.Subject,this.getId=function(){return a._id},this.getFilters=function(){return a._filters},this.getFacets=function(){return a._facets},this.getInputs=function(){return a._inputs},this.getConfig=function(){return a._config},this.getTotalCount=function(){return a._totalCount},this.getFields=function(){return a._config.fields},this.getResults$=function(){return a._results$},this.setResults=function(t){return a._results$.next(t)},this._id=t,this._config=e,this._setFilters(),this._setFacets(),this._setPage(),this._setInputs(),this._setInputsData(),this._setTotalCount(),B.queryParams&&(this.updateFiltersFromQueryParams(B.queryParams),B.queryParams=null)}return t.prototype.updateFilter=function(t,e,a){this.getFiltersByFacetId(t).forEach((function(t){Array.isArray(t.value)&&a?t.value=t.value.filter((function(t){return t!==e})):Array.isArray(t.value)&&-1===t.value.indexOf(e)?t.value.push(e):t.value=a?null:L.escapeDoubleQuotes(e)}))},t.prototype.clear=function(){this.updateFiltersFromQueryParams({},!0),this._clearInputs()},t.prototype.updateFiltersFromQueryParams=function(t,e){var a=this;void 0===e&&(e=!1),this._facets.forEach((function(n){var i=n.id,r=a.getFiltersByFacetId(i),o=t[i];"internal"===a.getInputByFacetId(i).getContext()&&!e||r.forEach((function(t){t.isArray?t.value=o?o.split(","):[]:t.value=o||null}))}))},t.prototype.updateInputsFromFilters=function(){var t=this;this._filters.forEach((function(e){var a=e.facetId,n=e.value;t.getInputByFacetId(a).setActive(n)}))},t.prototype.updateFacets=function(t){var e=this;t.forEach((function(t){var a=t.id,n=t.data;return e.updateFacet(a,n)})),this._setInputsData()},t.prototype.updateTotalCount=function(t){this._totalCount=t},t.prototype.updateFacet=function(t,e){var a=this._facets.filter((function(e){return e.id===t}));if(!a.length)throw Error("Facet with id '"+t+"' does not exists");a.forEach((function(t){t.data=e}))},t.prototype.reset=function(){this._filters.forEach((function(t){t.value=null}))},t.prototype.getRequestParams=function(){return{facets:this._getRequestFacets(),page:this._page,results:this._config.results,filters:this._filters.filter((function(t){return"internal"!==t.context})).map((function(t){return{facetId:t.facetId,value:t.value,searchIn:t.searchIn}}))}},t.prototype.getInternalFilters=function(){return this._filters.filter((function(t){return"internal"===t.context&&(Array.isArray(t.value)&&t.value.length||!Array.isArray(t.value)&&t.value)})).map((function(t){return{facetId:t.facetId,value:t.value,searchIn:t.searchIn}}))},t.prototype.filtersAsQueryParams=function(t){var e={};return t.forEach((function(t){e[t.facetId]=Array.isArray(t.value)?t.value.join(","):t.value})),e},t.prototype.getFiltersByFacetId=function(t){return this._filters.filter((function(e){return e.facetId===t}))},t.prototype.getInputByFacetId=function(t){return this._inputs.filter((function(e){return e.getFacetId()===t}))[0]},t.prototype.setInputData=function(t,e){this.getInputByFacetId(t).setData(e)},t.prototype.filterTarget=function(t){var e=this,a=this._inputs.filter((function(e){return e.getTarget()===t})),n=this.getInputByFacetId(t),i=this._facets.filter((function(e){return e.id===t}))[0].data,r=[];if(a.forEach((function(t){var a=e.getFiltersByFacetId(t.getFacetId())[0],n=t.getSearchIn(),i=a.value;r.push([n,i])})),i.forEach((function(t){return e._filterData(r,t)})),n.setData(i),n.getConfig().emptyState){var o=!i.filter((function(t){return!t.hidden})).length;n.setIsEmpty(o)}n.update()},t.prototype.setSearchConfigOrderBy=function(t){this._config.results.order.key=t},t.prototype.setSearchConfigDirection=function(t){this._config.results.order.direction=t},t.prototype.setSearchConfigType=function(t){this._config.results.order.type=t},t.prototype.setPageConfigOffset=function(t){this._config.page.offset=t},t.prototype.setPageConfigLimit=function(t){this._config.page.limit=t},t.prototype._clearInputs=function(){this._inputs.forEach((function(t){}))},t.prototype._filterData=function(t,e){var a=this;e.hidden=!1,t.forEach((function(t){var n=w(t,2),i=n[0],r=n[1];i.forEach((function(t){var n=t.key,i=t.operator;if(!e.hidden){var o=p.get(e,n,null);if(-1!==n.indexOf("searchData")&&Array.isArray(e.searchData)){var s=n.replace("searchData.","");e.searchData.forEach((function(t){var e=t.key,a=t.value;e===s&&(o=a)}))}null===o?e.hidden=!0:j[i]?e.hidden=a[j[i]](r,o):console.warn("SearchIn: operator "+i+" not supported")}}))}))},t.prototype._filterDataEquals=function(t,e){if(Array.isArray(e)){if(Array.isArray(t)){var a=0===t.length;return e.forEach((function(e){-1!==t.indexOf(e)&&(a=!0)})),!a}return!(t&&-1!==e.indexOf(t))}return Array.isArray(t)?!(!t.length||-1!==t.indexOf(e)):!(t&&t===e)},t.prototype._filterDataGreaterThan=function(t,e){return!Array.isArray(t)&&!(t&&t>e)},t.prototype._filterDataLessThan=function(t,e){return!Array.isArray(t)&&!(t&&t<e)},t.prototype._filterDataGreaterOrEquals=function(t,e){return!Array.isArray(t)&&!(t&&t>=e)},t.prototype._filterDataLessOrEquals=function(t,e){return!Array.isArray(t)&&!(t&&t<=e)},t.prototype._filterDataNotEqual=function(t,e){return!Array.isArray(t)&&!(t&&t!==e)},t.prototype._filterDataLike=function(t,e){if(t&&"string"==typeof t&&"string"==typeof e){var a=e.toLowerCase(),n=t.toLocaleLowerCase();return!(-1!==a.indexOf(n))}return!1},t.prototype._setFilters=function(){var t=this;this._config.fields.forEach((function(e){e.inputs.forEach((function(e){return t._filters.push(b({},e.filterConfig,{facetId:e.facetId,value:e.filterConfig.isArray?[]:null}))}))}))},t.prototype._setFacets=function(){this._facets=this._config.facets},t.prototype._setPage=function(){this._page=this._config.page},t.prototype._setTotalCount=function(){this._totalCount=this._config.totalCount},t.prototype._setInputs=function(){var t=this;this._config.fields.forEach((function(e,a){e.inputs.forEach((function(e,n){var i=M[e.type];if(!i)throw Error("Input type "+e.type+" not supported");t._inputs.push(new i(b({},e,{inputIndex:n,sectionIndex:a})))}))}))},t.prototype._setInputsData=function(){var t=this;this._facets.forEach((function(e){return t.setInputData(e.id,e.data)}))},t.prototype._getRequestFacets=function(){var t=[];return this._facets.forEach((function(e){var a=b({},e);e.hasStaticData||delete a.data,delete a.hasStaticData,Array.isArray(a.data)&&a.data.filter((function(t){return void 0!==t.searchData})).forEach((function(t){delete t.searchData})),t.push(a)})),t},t}();var B=function(){function t(){this._models={}}return t.prototype.add=function(t,e){if(this._models[t])throw Error("Search model '"+t+"' already exists!");this._models[t]=new q(t,e)},t.prototype.remove=function(t){this._models[t]&&delete this._models[t]},t.prototype.model=function(t){return this._models[t]||null},t.queryParams=null,t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new r.Subject,e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"main-layout.init":t.dataSource.onInit(n),t.mainState=n.mainState,t.route=n.route,t.router=n.router,t._listenRouterChanges(),t._listenMainStateChanges();break;case"main-layout.destroy":t.destroyed$.next()}})),l.EventHandler.globalEvents$.pipe(o.takeUntil(this.destroyed$)).subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"global.navigate":t.dataSource.onNavigate(n)}}))},e.prototype._listenRouterChanges=function(){var t=this;this.route.queryParams.pipe(o.filter((function(t){return!!Object.keys(t).length}))).subscribe((function(e){t.emitGlobal("queryparams",e),B.queryParams=e})),this.router.events.pipe(o.filter((function(t){return t instanceof s.NavigationStart}))).subscribe((function(){window.scrollTo(0,0),t.dataSource.onRouterChanged()}))},e.prototype._listenMainStateChanges=function(){var t=this;this.mainState.addCustom("currentNav",new r.Subject),this.mainState.getCustom$("currentNav").subscribe((function(e){t.emitOuter("currentnavchange",e)}))},e}(l.EventHandler);var N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return t.items},e.prototype.onCurrentNavChange=function(t){this.output.nav.items.forEach((function(e){e._meta.id===t?e.classes="is-current":e.classes=""}))},e}(l.DataSource),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return{classes:"main-subnav",items:t}},e.prototype.setActive=function(t){this.output.items.forEach((function(e){e._meta.id===t?(e.classes="is-current",e._meta.isActive=!0):(e.classes="",e._meta.isActive=!1)}))},e.prototype.getActive=function(){return this.output.items.filter((function(t){return t._meta.isActive}))[0]||null},e}(l.DataSource),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){var e=t.fields,a=this.options.searchModel;return this.searchModel=a,e},e}(l.DataSource);var W=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getRequestParams=function(){return e.searchModel.getRequestParams()},e.filtersAsQueryParams=function(t){return e.searchModel.filtersAsQueryParams(t)},e.updateFiltersFromQueryParams=function(t){e.searchModel.updateFiltersFromQueryParams(t)},e.getInputByFacetId=function(t){return e.searchModel.getInputByFacetId(t)},e.filterTarget=function(t){e.searchModel.filterTarget(t)},e.updateInputsFromFilters=function(){e.searchModel.updateInputsFromFilters()},e}return m(e,t),e.prototype.transform=function(t){var e=this;this.searchModel||(this.searchModel=t.searchModel);var a=this.searchModel.getId(),n=this.searchModel.getFields(),i=[];return n.forEach((function(t,n){var r="group-"+a+"-"+n,o=e._headerConfig(t.header,r),s=[];e.searchModel.getInputs().filter((function(t){return t.getSectionIndex()===n})).map((function(t){return t.update(),{facetId:t.getFacetId(),type:t.getType(),output:t.getOutput()}})).forEach((function(t){var a=t.type,n=t.output,i=t.facetId;s.push({classes:e._getSectionClasses(a),inputs:Array.isArray(n)?n:[n],_meta:{facetId:i}})})),i.push({header:o,facet:{sections:s},classes:"n7-facets-wrapper__"+r,isOpen:!0,_meta:{groupId:r}})})),{groups:i,classes:"n7-facets-wrapper__"+this.searchModel.getId()}},e.prototype.toggleGroup=function(t){var e=t.eventPayload;this.output.groups.forEach((function(t){t._meta.groupId===e.groupId&&(t.isOpen=!t.isOpen,t.header.iconRight=t.isOpen?"n7-icon-angle-down":"n7-icon-angle-right")}))},e.prototype.onFacetChange=function(t){var e=t.eventPayload,a=e.inputPayload,n=a.facetId,i=a.source,r=a.trigger,o=(this.searchModel.getFiltersByFacetId(n)[0]||{value:null}).value,s=!1,c=e.inputPayload.value||e.value;c=""+c,s=Array.isArray(o)?-1!==o.indexOf(c):o===c,"input-text"===i&&-1!==["enter","icon"].indexOf(r)||(this.searchModel.updateFilter(n,c,s),this.searchModel.updateInputsFromFilters())},e.prototype.updateFilteredTarget=function(t){var e=this.searchModel.getInputByFacetId(t);this.output.groups.map((function(t){return t.facet})).map((function(t){return t.sections})).forEach((function(a){a.forEach((function(a){if(a._meta.facetId===t){var n=e.getOutput();a.inputs=Array.isArray(n)?n:[n]}}))}))},e.prototype.updateInputLinks=function(){var t=this,e=this.searchModel.getInputs().filter((function(t){return"link"===t.getType()})).map((function(t){return t.getFacetId()}));this.output.groups.map((function(t){return t.facet})).map((function(t){return t.sections})).forEach((function(a){a.forEach((function(a){if(-1!==e.indexOf(a._meta.facetId)){var n=t.searchModel.getInputByFacetId(a._meta.facetId);n.update();var i=n.getOutput();a.inputs=Array.isArray(i)?i:[i]}}))}))},e.prototype._getSectionClasses=function(t){return"n7-facet__section-input-"+{text:"text",checkbox:"checkboxes",link:"links",select:"select"}[t]},e.prototype._headerConfig=function(t,e){return t?{text:t.label,iconRight:"n7-icon-angle-down",classes:t.classes,payload:{source:"group-header",id:e+"-header",groupId:e},_meta:{id:e+"-header"}}:null},e}(l.DataSource);var K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return t?t.items:null},e}(l.DataSource),U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.paginationBuilder=function(t,a,n,i,r,o){var s=[],c=n;if(t<=c&&(c=t-1),c){var l=void 0,u=void 0;a>Math.floor(c/2)?2===t?(l=t,u=1):a<t-Math.floor(c/2)?(l=a/1+Math.floor(c/2),u=a/1-Math.floor(c/2)):(l=t,u=a-c+(t-a)):(l=c+1,u=1);for(var d=u;d<=l;d+=1)s.push({text:String(d),classes:a===d?"is-active":"",anchor:a!==d?e._getPaginationAnchor(d,i,r,o):null})}else{s.push({text:"1",classes:1===a?"is-active":"",anchor:1!==a?e._getPaginationAnchor(1,i,r,o):null});for(d=1;d<t;d+=1)s.push({text:String(d+1),classes:a===d+1?"is-active":"",anchor:a!==d+1?e._getPaginationAnchor(d+1,i,r,o):null})}return{links:s,first:{classes:1===a?"is-disabled":"",anchor:1!==a?e._getPaginationAnchor(1,i,r,o):null},prev:{classes:1===a?"is-disabled":"",anchor:1!==a?e._getPaginationAnchor(a/1-1,i,r,o):null},next:{classes:a===t?"is-disabled":"",anchor:a!==t?e._getPaginationAnchor(a/1+1,i,r,o):null},last:{classes:a===t?"is-disabled":"",anchor:a!==t?e._getPaginationAnchor(t,i,r,o):null}}},e}return m(e,t),e.prototype.transform=function(t){var e=t.totalPages,a=t.currentPage,n=t.pageLimit,i=t.sizes,r=this.options,o=r.mode,s=r.href,c=r.queryParams;["href","payload"].includes(o)||console.warn('(smart-pagination) The "mode" option is incorrect. Please specify "href" or "payload" as the mode option.');var l=this.paginationBuilder(e,+a,n,o,s,c),u=l.links;return{first:l.first,prev:l.prev,next:l.next,last:l.last,links:u,select:i?{label:"Numero di risultati",options:i.list.map((function(t){return{text:t,selected:t===i.active}})),payload:"select-size"}:null}},e.prototype._getPaginationAnchor=function(t,e,a,n){switch(e){case"payload":return{payload:{source:"pagination",page:t}};case"href":return{href:n?a:a+t,queryParams:n?b({},n,{page:t}):null}}return{}},e}(l.DataSource);var Q=Object.freeze({__proto__:null,HeaderDS:N,SubnavDS:z,BreadcrumbsDS:V,FacetsDS:G,FacetsWrapperDS:W,FooterDS:K,SmartPaginationDS:U}),Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"main-layout.currentnavchange":t.dataSource.onCurrentNavChange(n)}}))},e}(l.EventHandler),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"subnav.click":"navigate"===n.source&&t.emitGlobal("navigate",n),t.emitGlobal(a,n)}}))},e}(l.EventHandler),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"breadcrumbs.click":"navigate"===n.source&&t.emitGlobal("navigate",n),t.emitGlobal(a,n)}}))},e}(l.EventHandler),J=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._facetsChanged=!1,e.internalFacetsChange$=new r.Subject,e.externalFacetsChange$=new r.Subject,e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"facets-wrapper.facet":if(!n.eventPayload.inputPayload)return;var i=n.eventPayload.inputPayload.facetId,r=t.dataSource.getInputByFacetId(i),o=r.getContext();t._facetsChanged=!0,t.dataSource.onFacetChange(n),"internal"===o?t.internalFacetsChange$.next(r.getTarget()):t.externalFacetsChange$.next();break;case"facets-wrapper.facetheader":t.dataSource.toggleGroup(n)}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;-1!==a.indexOf("queryparamschange")&&t.dataSource.searchModel&&(t.dataSource.updateFiltersFromQueryParams(n),t.dataSource.updateInputsFromFilters())})),l.EventHandler.globalEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"global.searchresponse":if(t.dataSource.searchModel&&t.dataSource.searchModel.getId()===n)t.dataSource.updateInputLinks(),t.dataSource.searchModel.getInternalFilters().forEach((function(e){var a=t.dataSource.searchModel.getInputByFacetId(e.facetId).getTarget();t.dataSource.filterTarget(a),t.dataSource.updateFilteredTarget(a)}))}})),this.internalFacetsChange$.pipe(o.debounceTime(500)).subscribe((function(e){t.dataSource.filterTarget(e),t.dataSource.updateFilteredTarget(e)})),this.externalFacetsChange$.pipe(o.debounceTime(500)).subscribe((function(){var e=t.dataSource.getRequestParams(),a=t.dataSource.filtersAsQueryParams(e.filters);Object.keys(a).forEach((function(t){a[t]=a[t]||null})),t.emitOuter("facetschange"),a.page=1,t.emitGlobal("navigate",{handler:"router",path:[],queryParams:a})}))},e}(l.EventHandler);var tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){},e}(l.EventHandler),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"n7-smart-pagination.change":t.emitOuter("change",n);break;case"n7-smart-pagination.click":t.emitOuter("click",n);break;default:console.warn("unhandled inner event of type",a)}}))},e}(l.EventHandler),at=Object.freeze({__proto__:null,HeaderEH:Y,SubnavEH:X,BreadcrumbsEH:Z,FacetsWrapperEH:J,FooterEH:tt,SmartPaginationEH:et}),nt={layoutId:"main-layout",widgets:[{id:"header"},{id:"subnav"},{id:"breadcrumbs"},{id:"footer"}],layoutDS:D,layoutEH:R,widgetsDataSources:Q,widgetsEventHandlers:at,options:{}},it=function(t){function a(e,a,n,i,r,o){var s=t.call(this,i.get("MainLayoutConfig")||nt)||this;return s.router=e,s.route=a,s.configuration=n,s.layoutsConfiguration=i,s.mainState=r,s.titleService=o,s}return m(a,t),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"main-layout",template:'<div class="n7-main-layout" id="main-layout">\n    <div class="n7-page-content">\n        <n7-header\n            [data]="lb.widgets[\'header\'].ds.out$ | async"\n            [emit]="lb.widgets[\'header\'].emit">\n        </n7-header>\n        <main class="n7-content">\n            <div class="n7-top-page-bar">\n                <div class="n7-top-page-bar__main"></div>\n            </div>\n            <div class="n7-alert-bar">\n                \x3c!--<n7-alert\n                [attr.id]="\'main-layout-alert\'"\n                [data]="lb.dataSource.alertData$ | async"\n                [emit]="lb.dataSource.closeAlert.bind(lb.dataSource)"></n7-alert>--\x3e\n            </div>\n            <ng-content></ng-content>\n        </main>\n    </div>\n    <n7-footer\n        [data]="lb.widgets[\'footer\'].ds.out$ | async" \n        [emit]="lb.widgets[\'footer\'].emit">\n    </n7-footer>\n</div>\n'}]}],a.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:S},{type:_},{type:k},{type:c.Title}]},a}(x);var rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.onInit=function(t){var e=t.options;this.options=e},e}(u.LayoutDataSource);var ot=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new r.Subject,e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"n7-page404-layout.init":t.dataSource.onInit(n);break;case"n7-page404-layout.destroy":t.destroyed$.next()}}))},e}(l.EventHandler);var st={layoutId:"n7-page404-layout",widgets:[],layoutDS:rt,layoutEH:ot,widgetsDataSources:Q,widgetsEventHandlers:at,options:{}},ct=function(t){function a(e){return t.call(this,e.get("Page404LayoutConfig")||st)||this}return m(a,t),a.prototype.initPayload=function(){return{options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"n7-page404-layout",template:'<div class="n7-page404-layout">\n    404 - Resource not found\n</div>'}]}],a.ctorParameters=function(){return[{type:_}]},a}(x),lt=function(){function t(){}return t.prototype.headerEmit=function(t,e){this.emit&&this.emit("facetheader",{eventType:t,eventPayload:e})},t.prototype.facetEmit=function(t,e){this.emit&&this.emit("facet",{eventType:t,eventPayload:e})},t.decorators=[{type:e.Component,args:[{selector:"n7-facets-wrapper",template:'<div *ngIf="data" class="n7-facets-wrapper {{ data.classes || \'\' }}">\n    <div *ngFor="let group of data.groups" class="n7-facets-wrapper__group {{ group.classes || \'\' }}">\n        <n7-facet-header\n            [data]="group.header"\n            [emit]="headerEmit.bind(this)"\n        ></n7-facet-header>\n\n        <n7-facet\n            *ngIf="group.isOpen"\n            [data]="group.facet"\n            [emit]="facetEmit.bind(this)"\n        ></n7-facet>\n    </div>\n</div>'}]}],t.propDecorators={data:[{type:e.Input}],emit:[{type:e.Input}]},t}();var ut=function(){function t(){this.handlePaginationEvent.bind(this)}return t.prototype.handlePaginationEvent=function(t,e){this.emit&&this.emit("change",e)},t.decorators=[{type:e.Component,args:[{selector:"n7-smart-pagination",template:'<div class="n7-smart-pagination" *ngIf="data">\n  <n7-pagination\n    [data]="data"\n    [emit]="emit">\n  </n7-pagination>\n</div>'}]}],t.ctorParameters=function(){return[]},t.propDecorators={data:[{type:e.Input}],emit:[{type:e.Input}]},t}();var dt=[it,ct,lt,ut],pt=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[k,S,_,C,{provide:"config",useValue:e}]}},t.decorators=[{type:e.NgModule,args:[{declarations:dt,imports:[a.CommonModule,n.HttpClientModule,i.DvComponentsLibModule],providers:[],exports:dt}]}],t}(),ht=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showFields=!1,e.navHeader={},e.pageSize=10,e.bubblesSize=10,e.updateComponent=function(t,a,n){n&&e.one(t).updateOptions(n),e.one(t).update(a)},e.drawPagination=function(){var t=e._getPaginationParams(),a=t.href,n=t.queryParams;e.one("n7-smart-pagination").updateOptions({mode:"href",href:a,queryParams:n}),e.one("n7-smart-pagination").update({totalPages:Math.ceil(e.myResponse.relatedItems.length/e.pageSize),currentPage:e.currentPage,pageLimit:5,sizes:{list:[10,25,50],active:e.pageSize}})},e.handlePageNavigation=function(){if(e.myResponse){var t=e._getPaginationParams(),a=t.href,n=t.queryParams;e.drawPagination(),e.one("aw-linked-objects").updateOptions({paginationParams:{href:a,queryParams:n},context:e.selectedTab,config:e.configuration,page:e.currentPage,pagination:!0,size:e.pageSize}),e.one("aw-linked-objects").update({items:e.myResponse.relatedItems})}},e.handleNavUpdate=function(t){e.selectedTab=t,e.updateWidgets(e.myResponse),"oggetti-collegati"===t?(e.one("aw-linked-objects").updateOptions({context:e.selectedTab,config:e.configuration,page:e.currentPage,pagination:!0,paginationParams:e._getPaginationParams(),size:e.pageSize}),e.one("aw-linked-objects").update({items:e.myResponse.relatedItems})):"overview"===t&&(e.one("aw-linked-objects").updateOptions({size:3,config:e.configuration,context:"entita"}),e.one("aw-linked-objects").update({items:e.myResponse.relatedItems})),"overview"!==t&&"entita-collegate"!==t||setTimeout((function(){e.updateBubbes(e.myResponse.relatedEntities)}),800)},e}return m(e,t),e.prototype.onInit=function(t){var e=t.configuration,a=t.mainState,n=t.router,i=t.route,r=t.location,o=t.options,s=t.titleService,c=t.communication;this.route=i,this.communication=c,this.configuration=e,this.mainState=a,this.options=o,this.router=n,this.location=r,this.titleService=s,this.currentId="",this.currentPage=+this.route.snapshot.queryParams.page,this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.bubblesSize=this.configuration.get("entita-layout")?this.configuration.get("entita-layout").entitiesQuerySize:this.bubblesSize,this.one("aw-bubble-chart").updateOptions({selectable:!1,simple:!0,config:this.configuration,limit:this.configuration.get("bubble-chart").bubbleLimit,smallChartSize:this.configuration.get("entita-layout").overview.smallChartSize}),this.one("aw-chart-tippy").updateOptions({basePath:this.configuration.get("paths").entitaBasePath}),this.mainState.updateCustom("currentNav","entita"),this.mainState.update("headTitle","Arianna Web > Entità")},e.prototype.getNavigation=function(t){return this.communication.request$("getEntityDetails",{onError:function(t){return console.error(t)},params:{entityId:t,entitiesListSize:this.bubblesSize}})},e.prototype.updateWidgets=function(t){var e=this.selectedTab;Object.keys(t).forEach((function(e){Array.isArray(t[e])&&0===t[e].length&&(t[e]=null)})),this.one("aw-entita-nav").update({data:t,selected:e,basePath:this.getNavBasePath()}),this.updateComponent("aw-entita-metadata-viewer",this.myResponse.fields,{context:this.selectedTab,config:this.configuration,labels:this.configuration.get("labels")}),this.drawPagination()},e.prototype.updateBubbes=function(t){this.one("aw-bubble-chart").update(t)},e.prototype.loadItem=function(t,e,a){return t&&a?(this.currentId=t,this.currentSlug=e,this.selectedTab=a,this.communication.request$("getEntityDetails",{onError:function(t){return console.error(t)},params:{entityId:t,entitiesListSize:this.bubblesSize}})):(this.pageTitle="Entità Test",r.of(null))},e.prototype.loadContent=function(t){var e=this,a=this.configuration.get("config-keys")[t.typeOfEntity];this.myResponse=t,(t.fields||[]).filter((function(t){return((e.configuration.get("entita-layout")||{}).overview||{}).campi.includes(t.key)})).length>0?this.showFields=!0:this.showFields=!1,this.navHeader={icon:a?a.icon:"",text:this.myResponse.label,color:a["class-name"]},this.one("aw-entita-nav").updateOptions({bubblesEnabled:this.bubblesEnabled}),this.one("aw-entita-metadata-viewer").updateOptions({context:this.selectedTab,labels:this.configuration.get("labels"),config:this.configuration}),this.one("aw-entita-metadata-viewer").update(t.fields),"oggetti-collegati"===this.selectedTab?this.one("aw-linked-objects").updateOptions({context:this.selectedTab,config:this.configuration,page:this.currentPage,pagination:!0,paginationParams:this._getPaginationParams(),size:this.pageSize}):this.one("aw-linked-objects").updateOptions({size:3,config:this.configuration,context:"entita"}),t.relatedItems.forEach((function(e){e.relationName=t.label.length>30?t.label.substr(0,30)+"... ":t.label})),this.one("aw-linked-objects").update({items:t.relatedItems}),this.drawPagination(),this.mainState.update("headTitle","Arianna Web > Entità > "+this.myResponse.label)},e.prototype._getPaginationParams=function(){return{href:[this.configuration.get("paths").entitaBasePath,this.currentId+"/",this.currentSlug,"/oggetti-collegati/"].join(""),queryParams:{page:this.currentPage}}},e.prototype.getNavBasePath=function(){return[this.configuration.get("paths").entitaBasePath,this.currentId+"/",this.currentSlug].join("")},e}(u.LayoutDataSource);var ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new r.Subject,e.handlePageSizeChange=function(t){e.dataSource.pageSize=t,e.dataSource.handleNavUpdate("oggetti-collegati")},e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-entita-layout.init":t.dataSource.onInit(n),t.configuration=n.configuration,t.route=n.route,t.entityId=t.route.snapshot.params.id||"",t.dataSource.currentPage=t.route.snapshot.params.page||1,t.listenRoute(t.entityId);break;case"aw-entita-layout.destroy":t.destroyed$.next();break;case"aw-entita-layout.showmore":n&&t.dataSource.handleNavUpdate(n)}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-bubble-chart.d3end":t.emitOuter("d3end",n);break;case"aw-entita-nav.click":n&&(t.dataSource.selectedTab=n,t.dataSource.handleNavUpdate(n));break;case"aw-linked-objects.change":t.dataSource.pageSize=n,t.dataSource.currentPage=1;var i={context:t.dataSource.selectedTab,config:t.dataSource.configuration,page:t.dataSource.currentPage,pagination:!0,size:t.dataSource.pageSize};t.dataSource.updateComponent("aw-linked-objects",{items:t.dataSource.myResponse.relatedItems},i);break;case"aw-bubble-chart.bubble-tooltip-goto-click":var r=n.id,o=n.label;t.emitGlobal("navigate",{handler:"router",path:[t.configuration.get("paths").entitaBasePath,r,L.slugify(o),"overview"]});break;case"aw-bubble-chart.bubble-filtered":"overview"!==t.dataSource.selectedTab&&"entita-collegate"!==t.dataSource.selectedTab||t.emitOuter("filterbubbleresponse",n.relatedEntities);break;case"n7-smart-pagination.change":t.handlePageSizeChange(n.value)}}))},e.prototype.listenRoute=function(t,e){var a=this;void 0===t&&(t=""),void 0===e&&(e=!1),this.route.queryParams.pipe(o.map((function(t){return t.page}))).subscribe((function(t){a.dataSource.currentPage!==t&&(a.dataSource.currentPage=t,a.dataSource.handlePageNavigation())})),this.route.paramMap.subscribe((function(n){if(n.get("id")){if(a.dataSource.currentId===n.get("id")&&!e)return void(a.dataSource.selectedTab!==n.get("tab")&&a.dataSource.handleNavUpdate(n.get("tab")));a.dataSource.loadItem(n.get("id"),n.get("slug"),n.get("tab")).subscribe((function(e){if(e){a.dataSource.loadContent(e);var i=e.relatedEntities.filter((function(t){return t.id!==n.get("id")}));a.dataSource.updateWidgets(e),t&&a.emitOuter("selectItem",t),a.emitOuter("filterbubbleresponse",i)}}))}else a.dataSource.loadItem()}))},e}(l.EventHandler);var gt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadingData=!1,e.checkForMore=function(t){e.loadedData.actions&&(void 0===t?e.loadedData.result.length>=e.totalObjects?e.loadedData.actions[1].disabled=!0:e.loadedData.actions[1].disabled=!1:e.loadedData.actions[1].disabled=!t)},e.handleIncomingData=function(t){e.currentPage+=1;var a=e.unpackData(t.itemsPagination);e.loadedData.result=e.loadedData.result.concat(a.result),e.checkForMore(),e.loadedData.isLoading=!1},e.unpackData=function(t){var a,n,i=e.options.config,r=i.get("item-preview"),o=t.totalCount,s=e.currentPage,c=e.context,l=e.pageSize,u=i.get("labels"),d=e.options.dynamicPagination,h=i?i.get("config-keys"):{},f=t.items?t.items:t.relatedItems;i&&i.get(c+"-layout")&&(a=i.get(c+"-layout")["max-item-length"],n=i.get(c+"-layout")["results-limit"]),!d&&l&&s?f=f.slice(s*l-l,s*l):l&&(f=f.slice(0,l));var g=[],y=r.metadata.info.selection.map((function(t){return t.key}));return f.forEach((function(t){var e=t.item?t.item:t,a=p.get(t,r.metadata.info.data,e.fields),n=a?a.filter((function(t){return-1!==y.indexOf(t.key)})):[],o=p.get(t,r.metadata.toe.data,e.relatedTypesOfEntity),s=p.get(t,r.metadata.breadcrumbs.data,e.breadcrumbs);["entita","search","gallery"].includes(c)&&e.typeOfEntity&&""!==e.typeOfEntity&&n.push({key:"Tipo di entità",value:h[e.typeOfEntity]["singular-label"]});var l=["entita","search","oggetti-collegati"].includes(c)?"is-fullwidth":"";l+=e.typeOfEntity?" is-"+i.get("config-keys")[e.typeOfEntity]["class-name"]:" is-oggetto-culturale","gallery"===c&&(l+=" is-vertical has-image");var d=p.get(t,r.title,e.label).match(/<em>/g)?9*p.get(t,r.title,e.label).match(/<em>/g).length:0,f=+r.title.maxLength&&p.get(t,r.title,e.label).length>+r.title.maxLength+d?p.get(t,r.title,e.label).slice(0,+r.title.maxLength+d)+"…":p.get(t,r.title,e.label),m=p.get(t,r.payload,e.id),b=[e.typeOfEntity?i.get("paths").entitaBasePath:i.get("paths").schedaBasePath,m,L.slugify(f)].join("/"),v={text:r.text?+r.text.maxLength&&p.get(t,r.text.data,e.text).length>+r.text.maxLength?p.get(t,r.text.data,e.text).slice(0,+r.text.maxLength)+"…":p.get(t,r.text.data,e.text):null,classes:l,breadcrumbs:s,image:p.get(t,r.image,e.image),title:f,anchor:{href:b,target:"search"===c?"_blank":"_self"},relation:{key:t.relationName,value:t.relation},metadata:n.length||o?[]:null};n.length&&v.metadata.push({classes:"aw-item-preview_metadata",items:n.map((function(t){return{label:L.prettifySnakeCase(t.key,u[t.key]),value:t.value}}))}),o&&v.metadata.push({classes:"aw-item-preview-entities",items:o.map((function(t){return{value:p.get(t,r.metadata.toe.value,t.count),icon:h[p.get(t,r.metadata.toe.icon,t.type)]?h[p.get(t,r.metadata.toe.icon,t.type)].icon:"",classes:"color-"+h[p.get(t,r.metadata.toe.icon,t.type)]["class-name"]}}))}),s&&(v.breadcrumbs={items:p.get(t,r.metadata.breadcrumbs.data,t.item.breadcrumbs).map((function(t){return{label:p.get(t,r.metadata.breadcrumbs.label,t.label),anchor:{href:b}}}))}),g.push(v)})),"home"===c?{result:g,actions:[{label:"Mostra Tutti ("+o+")"},a?{label:"Mostra Altri ("+n+")",disabled:!1}:null],isLoading:!1,fallback:i.get("home-layout")["linked-objects-fallback"]}:{previews:g}},e}return m(e,t),e.prototype.transform=function(t){return this.paths=this.options.config.get("item-preview"),this.pageSize=this.options.size,this.totalObjects=t.totalCount,this.currentPage=this.options.page?+this.options.page:1,this.options.dynamicPagination&&this.options.dynamicPagination.total?this.totalPages=Math.ceil(this.options.dynamicPagination.total/this.pageSize):t.items?this.totalPages=Math.ceil(t.items.length/this.pageSize):t.relatedItems&&(this.totalPages=Math.ceil(t.relatedItems.length/this.pageSize)),this.context=this.options.context,this.loadedData=this.unpackData(t),this.checkForMore(),this.loadedData.loaderData={},this.loadedData},e}(l.DataSource);var yt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stringTrim=function(t,e){return t.length>e?t.slice(0,e)+"…":t},e}return m(e,t),e.prototype.transform=function(t){var e=this,a=t.response;if(!a)return{suggestion:[],loading:!0};var n=[],i=this.options.config.get("home-layout")["max-item-length"]||20;return a.results.filter((function(t){return"object"==typeof t.entity})).forEach((function(t){if("fallback"===t.entity.id)return n.push({text:t.entity.label,payload:"fallback-simple-autocomplete"}),{suggestion:n};var a=e.stringTrim(t.entity.label,i);n.push({text:a,anchor:{payload:t.entity.id}})})),{suggestion:n}},e}(f.DataSource);var mt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chartData=[],e.draw=null,e.selected=[],e.filters=[],e.closedEyes=[],e.tippyList=[],e.updateChart=function(t){var a=t;null===t?a=e.chartData:e.chartData=t,e.filters.length>0&&(a=e.chartData.filter((function(t){return!e.filters.includes(t.entity.typeOfEntity.replace(/ /g,"-"))}))),e.draw?(e.output.selected=e.selected,e.output.data=e.smartSlice(a),e.output.smallView.data=e.smartSlice(a,e.options.smallChartSize),e.draw()):e.update(e.smartSlice(a))},e.smartSlice=function(t,a){var n=a||e.options.limit;return n&&n<t.length?t.slice(0,n):t},e.handleBubbleClick=function(t){var a=t;e.selected.includes(a)?e.selected.splice(e.selected.indexOf(a),1):e.selected.push(a)},e}return m(e,t),e.prototype.transform=function(t){var e=this,a=this.options,n=a.config,i=a.smallChartSize,r=n.get("bubble-chart"),o=r.fontRendering,s=r.transition,c=r.shuffle,l=[],u=[],d=n.get("config-keys");Object.keys(d).forEach((function(t){l.push(t.replace(/-/g," ")),u.push(((d[t]||{}).color||{}).hex)}));var p={containerId:"bubbleChartContainer",setDraw:function(t){e.draw=t},colorMatch:{domain:l,range:u},selected:this.selected,sizeRange:[.5,500],fontRendering:o,height:500,width:500,transition:s,shuffle:c};return b({},p,{anchorData:{href:"/placeholder/"},data:this.smartSlice(t),smallView:b({},p,{data:this.smartSlice(t,i)})})},e}(l.DataSource);var bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){var e=t.bubbles,a=t.selected,n=this.options,i=n.basePath,r=n.selectable;return e.map((function(t){var e=t.count,n=t.entity,o=n.id,s=n.label,c=n.relation,l=n.relationName;return{id:o,selectable:r,title:s,text:"È collegato a "+e+" oggetti culturali",isSelected:a.includes(o),anchorData:{href:""+i+o+"/"+L.slugify(s)},relation:{key:l,value:c}}}))},e}(l.DataSource),vt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentInputValue="",e}return m(e,t),e.prototype.transform=function(t){var e=t.title,a=t.text,n=t.button,i=t.backgroundImage,r=t.input;return{title:e,text:a,backgroundImage:i,button:{text:n.text,anchor:{payload:"cerca"}},input:{placeholder:r.placeholder,payload:"cerca-in-maxxi"}}},e}(l.DataSource);var wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(){return i.TABLE_MOCK},e}(l.DataSource),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),_t=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.autoComplete={},e.lockedFacets={},e.lastData={},e.closedEyes=[],e.openTippy="",e.tippyMaker=function(t){var a,n=t.replace(/ /g,"-");if(!e.autoComplete[n]){e.autoComplete[n]={tippy:void 0,open:!0};var i=e.autoComplete[n];if(!i.tippy){var r=document.getElementsByClassName(n)[1];i.tippy=g(r,{content:(a=document.getElementsByClassName("aw-simple-autocomplete__template")[0],a.setAttribute("style","display: block"),a),trigger:"manual",interactive:!0,arrow:!1,flip:!1,appendTo:"parent",theme:"light-border aw-home__facet-tippy",placement:"bottom-start",maxWidth:"100%"})}}var o=e.autoComplete[n];o.tippy&&o.tippy.show()},e.tippyClose=function(t){var a=t.replace(/ /g,"-");if(e.autoComplete[a]){var n=e.autoComplete[a];n.tippy&&n.tippy.hide()}},e}return m(e,t),e.prototype.transform=function(t){var e=this;this.lastData=t;var a=[],n=[],i=t,r=this.lockedFacets,o=this.closedEyes;return Object.keys(this.autoComplete).forEach((function(t){e.autoComplete[t]&&e.autoComplete[t].tippy&&e.autoComplete[t].tippy.destroy()})),this.autoComplete={},i.forEach((function(t,e){if(Object.keys(r).forEach((function(t){var e=r[t].indexOf("LOCK_LAST");e>=0&&r[t].splice(e,1)})),o){if(o.length===i.length-1){var s=i.find((function(t){return!o.includes(t.type.replace(/ /g,"-"))}));s&&(o[s.type]?r[s.type].push("LOCK_LAST"):r[s.type]=["LOCK_LAST"])}o.includes(t.type.replace(/ /g,"-"))?t.enabled=!1:t.enabled=!0}Object.keys(r).length&&r[t.type]&&r[t.type].length>0?t.locked=!0:t.locked=!1;var c=[],l=[t.icon];t.enabled||c.push("is-disabled"),t["class-name"]&&(c.push("color-"+t["class-name"]),l.push("color-"+t["class-name"])),a.push({iconLeft:l.join(" "),text:t.label,additionalText:t.count,iconRight:t.enabled?"n7-icon-eye":"n7-icon-eye-slash",classes:c.join(" ")+(t.locked?" is-blocked":" not-blocked"),payload:!0===t.locked?null:t.type.replace(/ /g,"-")}),n.push({sections:[{inputs:[{id:t.type.replace(/ /g,"-")+"-"+e,type:"text",placeholder:t["input-placeholder"],icon:"n7-icon-search",disabled:!t.enabled,inputPayload:String(t.type.replace(/ /g,"-"))+"-search",iconPayload:String(t.type.replace(/ /g,"-"))+"-search",enterPayload:String(t.type.replace(/ /g,"-"))+"-search",classes:String(t.type.replace(" ","-"))+"-search"}]}]})})),a.map((function(t,e){return{header:t,input:n[e]}}))},e}(l.DataSource);var kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),It=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){var e=t.response,a=t.query,n=e.results,i=e.totalCount,r=this.options,o=r.keys,s=r.config,c=r.paths,l=this.options.labels||{},u=[],d={};n.forEach((function(t){var e=t.item,a=t.entity,n=a?a.typeOfEntity:e.document_type,i=o[n],r=i["main-metadata"],s=e||a;if(!d[n]){var p=i.label,h=i.icon;d[n]={title:p,icon:h,classes:"color-"+i["class-name"],items:[],type:n}}if(-1===u.indexOf(s.id)){var f=[];s.fields&&s.fields.forEach((function(t){var e=t.key,a=t.value;r&&e===r&&f.push({key:L.prettifySnakeCase(e,l[e]),value:a})})),d[n].items.push({title:s.label,metadata:f,anchor:{href:c[a?"entitaBasePath":"schedaBasePath"]+"/"+s.id+"/"+L.slugify(s.label)}})}}));var p=Object.keys(d).map((function(t){return{group:{title:d[t].title,icon:d[t].icon,classes:d[t].classes},items:d[t].items}}));return{results:p,actions:p.length>0?{showMore:{text:"Visualizza tutti i "+i+" risultati",anchor:{href:c.searchBasePath,queryParams:{query:a}}}}:{showMore:{text:"Cerca in tutti i campi",anchor:{href:c.searchBasePath,queryParams:{query:a,"query-all":1}}}},fallback:((s.get("home-layout")||{})["top-hero"]||{}).fallback}},e}(l.DataSource),Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){if(!t)return null;var e=t.data,a=t.selected,n={items:[],payload:"entita-nav"};return n.items.push({text:"OVERVIEW",anchor:{href:t.basePath+"/overview"},classes:"overview"===a?"is-selected":""}),e.fields&&e.fields.length>0&&n.items.push({text:"CAMPI",anchor:{href:t.basePath+"/campi"},classes:"campi"===a?"is-selected":""}),e.relatedItems&&n.items.push({text:"OGGETTI COLLEGATI",anchor:{href:t.basePath+"/oggetti-collegati",queryParams:{page:1}},classes:"oggetti-collegati"===a?"is-selected":""}),e.relatedEntities&&this.options.bubblesEnabled&&n.items.push({text:"ENTITÀ COLLEGATE",anchor:{href:t.basePath+"/entita-collegate"},classes:"entita-collegate"===a?"is-selected":""}),e.extraTab&&n.items.push({text:"MAXXI",anchor:{href:t.basePath+"/maxxi"},classes:"maxxi"===a?"is-selected":""}),e.wikiTab&&n.items.push({text:"WIKIPEDIA",anchor:{href:t.basePath+"/wiki"},classes:"wiki"===a?"is-selected":""}),n},e}(l.DataSource),Ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){var a=this.options,n=a.context,i=a.config,r=this.options.labels||{},o=(i.get("entita-layout")||{})["metadata-to-exclude"],s=[];if("overview"===n&&t){var c=((i.get("entita-layout")||{}).overview||{}).campi,l=t.filter((function(t){return c.includes(t.key)}));s=e.unpackFields(l,o)}else s=e.unpackFields(t,o);return s.forEach((function(t){t.items.filter((function(t){return t.label})).forEach((function(t){t.label=L.prettifySnakeCase(t.label,r[t.label])}))})),{group:s}},e.unpackFields=function(t,a){var n=[];if(t instanceof Array)return[{items:n=t.filter((function(t){return!Array.isArray(a)||!a.length||-1===a.indexOf(t.key)})).map((function(t){return{label:t.key,value:t.value}}))}];if(!t)return[];for(var i=0;i<t.length;i+=1){var r=t[i],o=r.label,s=r.key,c=r.value,l=r.fields,u={};o&&(u.title=o),s&&c&&(u.label=s,u.value=c),l&&(l[0].key?u.items=e.unpackFields(l):u.group=e.unpackFields(l)),n.push(u)}return n},e}(l.DataSource),xt=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.transform=function(t){return t},a._getCachedData=function(){return e.dataCache[a.rootId]},a._normalize=function(t){var e=t.id,n=t.label,i=t.icon,r=t.img,o=t.branches,s=t.document_type,c=t.document_classification,l=!(!Array.isArray(o)||!o.length);a._getCachedData().flatData[e]={id:e,label:n,icon:i,img:r,hasBranches:l,type:s,classification:c},l&&o.forEach((function(t){a._getCachedData().flatIds.push([e,t.id]),a._normalize(t)}))},a._getParent=function(t){return a._getCachedData().flatIds.filter((function(e){return w(e,2)[1]===t})).map((function(t){return w(t,1)[0]}))[0]||null},a._getTreePath=function(t){for(var e=[t],n=t;n;){var i=a._getParent(n);i&&e.push(i),n=i}return e.reverse()},a._getTree=function(t){var e={},n=0,i=function(e,r){var o=t[n+=1];r.items=[],a._getCachedData().flatIds.filter((function(t){return w(t,1)[0]===e})).forEach((function(t,e){var n=w(t,2)[1],s=n===o,c=a._getTreeItem(n,s);r.items.push(c),s&&i(n,r.items[e])}))};return i(t[0],e),e},a._getTreeItem=function(t,e){var n=a._getCachedData().flatData[t],i=n.label,r=n.img,o=n.hasBranches,s=n.type,c=n.classification,l=(a.options.config[s]||{icon:null}).icon,u="",d=/.*\.(\w+)$/;if(c&&d.test(c)){var p=c.match(d)[1].toUpperCase();u=a.options.config[s].classifications[p].icon}var h=e?"n7-icon-angle-down":"n7-icon-angle-right",f=[];return e&&f.push("is-expanded"),a.activeId===t&&f.push("is-active"),{classes:f.join(" "),text:i||null,img:r||null,icon:u||l,toggle:o?{icon:h,payload:{source:"toggle",id:t}}:null,meta:t,anchor:{href:a.basePath+"/"+t+"/"+L.slugify(i)}}},a}return m(e,t),e.prototype.load=function(t){var a=t.tree,n=t.basePath;this.rootId=a.id,this.basePath=n,e.dataCache[this.rootId]||(e.dataCache[this.rootId]={flatIds:[],flatData:{}},this._normalize(a))},e.prototype.build=function(t){var e=this._getTreePath(t),a=this._getTreePath(this.currentId).indexOf(t);if(a>0)e.splice(a),this.currentId=null;else if(this.currentId===t){var n=e.indexOf(this.currentId);e.splice(n),this.currentId=null}else this.currentId=t;var i=this._getTree(e);this.update(i)},e.prototype.setActive=function(t){this.activeId=t},e.prototype.highlightActive=function(){var t=this,e=function(a){a.forEach((function(a){var n,i=a.meta===t.activeId;-1===a.classes.indexOf("is-active")||i||((n=a.classes.split(" ")).splice(n.indexOf("is-active"),1),a.classes=n.join(" "));i&&(-1===(n=a.classes.split(" ")).indexOf("is-active")&&n.push("is-active"),a.classes=n.join(" "));Array.isArray(a.items)&&a.items.length&&e(a.items)}))};e(this.output.items)},e.dataCache={},e}(f.DataSource);var Dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return{iconLeft:"n7-icon-tree-icon",text:t.text||"",iconRight:"n7-icon-angle-left",classes:"is-expanded",payload:"header"}},e.prototype.toggleSidebar=function(){var t=this.output;"is-expanded"===t.classes?(t.classes="is-collapsed",t.iconRight="n7-icon-angle-right"):(t.classes="is-expanded",t.iconRight="n7-icon-angle-left")},e}(l.DataSource),Pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transform=function(t){return t},e}return m(e,t),e.prototype.toggleSidebar=function(){var t=this.output;"is-expanded"===t.classes?t.classes="is-collapsed":t.classes="is-expanded",this.update(t)},e}(l.DataSource);var Ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){var e=this.options,a=e.labels,n=e.metadataToExclude;a=a||{},n=(n=n||{})[t.document_type]||[];var i={group:[]};return t.fields&&t.fields.forEach((function(t){var e=[];t.fields?(t.fields.filter((function(t){return-1===n.indexOf(t.key)})).forEach((function(t){e.push({label:L.prettifySnakeCase(t.key,a[t.key]),value:t.value})})),i.group.push({items:e,title:t.label})):-1===n.indexOf(t.key)&&(e.push({label:L.prettifySnakeCase(t.key,a[t.key]),value:t.value.replace(/(\|\|\|)/g,"\n")}),i.group.push({items:e}))})),i},e}(l.DataSource),At=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){var e=this;return{images:[],viewerId:"scheda-layout-viewer",libOptions:{tileSources:this.getTileSources(t.images),sequenceMode:!0,showReferenceStrip:!0,autoHideControls:!1,showNavigator:!1},_setViewer:function(t){e.instance=t}}},e.prototype.hasInstance=function(){return!!this.instance},e.prototype.updateImages=function(t){var e=this;this.instance&&(this.instance.world.removeAll(),setTimeout((function(){var a=e.getTileSources(t.images);console.warn("images",a.length,a),e.instance.open(a)})))},e.prototype.getTileSources=function(t){return t.map((function(t){return t.replace("FIF","Deepzoom").replace(".tif",".tif.dzi")}))},e}(l.DataSource);var Tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),Lt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selected="list",e}return m(e,t),e.prototype.transform=function(){return{items:[{text:"LISTA",payload:"list",classes:"list"===this.selected?"is-selected":""},{text:"GRAFICO",payload:"chart",classes:"chart"===this.selected?"is-selected":""},{text:"TIMELINE",payload:"timeline",classes:"timeline"===this.selected?"is-selected":""}]}},e.prototype.setSelected=function(t){this.selected=t},e}(l.DataSource);var Ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.addPagination=function(t,a,n){e.pagination={first:{payload:"goto-1",classes:1===t?"is-disabled":""},prev:{payload:"goto-"+(t/1-1),classes:1===t?"is-disabled":""},next:{payload:"goto-"+(t/1+1),classes:t===a?"is-disabled":""},last:{payload:"goto-"+a,classes:t===a?"is-disabled":""},links:e.makePagination(a,t),select:{label:"Numero di risultati",options:[12,24,48].map((function(t){return{text:t,selected:t===n}})),payload:"select-size"}}},e.makePagination=function(t,e){var a=[],n=4;if(t<=n&&(n=t-1),n){var i=void 0,r=void 0;e>Math.floor(n/2)?2===t?(i=t,r=1):e<t-Math.floor(n/2)?(i=e/1+Math.floor(n/2),r=e/1-Math.floor(n/2)):(i=t,r=e-n+(t-e)):(i=n+1,r=1);for(var o=r;o<=i;o++)a.push({text:String(o),payload:"page-"+String(o),classes:e===o?"is-active":""})}else{a.push({text:"1",payload:"page-1",classes:1===e?"is-active":""});for(o=1;o<t;o++)a.push({text:String(o+1),payload:"page-"+String(o+1),classes:e===o+1?"is-active":""})}return a},e}return m(e,t),e.prototype.transform=function(t){if(!t)return null;var e=this.options,a=e.pageSize,n=e.currentPage;return t.length>a&&this.addPagination(n,Math.ceil(t.length/a),a),{res:t.slice(0,a),pagination:this.pagination}},e.prototype.chunks=function(t,e){for(var a=[];t.length;)a.push(t.splice(0,e));return a},e}(l.DataSource);var Ht=Object.freeze({__proto__:null,AwLinkedObjectsDS:gt,AwAutocompleteWrapperDS:yt,AwBubbleChartDS:mt,AwChartTippyDS:bt,AwHeroDS:vt,AwTableDS:wt,AwHomeHeroPatrimonioDS:St,AwHomeFacetsWrapperDS:_t,AwHomeItemTagsWrapperDS:kt,AwHomeAutocompleteDS:It,AwEntitaNavDS:Et,AwEntitaMetadataViewerDS:Ct,AwTreeDS:xt,AwSidebarHeaderDS:Dt,AwSchedaBreadcrumbsDS:Pt,AwSchedaMetadataDS:Ot,AwSchedaImageDS:At,AwSchedaInnerTitleDS:Tt,AwSearchLayoutTabsDS:Lt,AwGalleryResultsDS:Ft}),$t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-hero.click":"cerca"===n&&t.dataSource.currentInputValue&&t.emitOuter("enter",t.dataSource.currentInputValue);break;case"aw-hero.change":t.dataSource.currentInputValue=n,t.emitOuter("change",n);break;case"aw-hero.enter":t.emitOuter("enter",n);break;default:console.warn("(hero) unhandled event of type",a)}}))},e}(l.EventHandler),Mt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.changedInput$=new r.Subject,e.handleEyeClick=function(t){if(e.dataSource.closedEyes){var a=e.dataSource.closedEyes.indexOf(t);a>=0?e.dataSource.closedEyes.splice(a,1):e.dataSource.closedEyes.push(t)}else e.dataSource.closedEyes=[t];e.dataSource.update(e.dataSource.lastData)},e.updateFilters=function(t){t.entity.id.replace(/ /g,"-");var a=t.entity,n=a.id,i=a.typeOfEntity;if(e.dataSource.lockedFacets[i]||(e.dataSource.lockedFacets[i]=[]),e.dataSource.lockedFacets[i].includes(n)){var r=e.dataSource.lockedFacets[i].indexOf(n);e.dataSource.lockedFacets[i].splice(r,1)}else e.dataSource.lockedFacets[i].push(n);e.dataSource.update(e.dataSource.lastData)},e}return m(e,t),e.prototype.listen=function(){var t=this;this.changedInput$.pipe(o.debounceTime(500)).subscribe((function(e){t.emitOuter("change",e)})),this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-home-facets-wrapper.click":if(null===n)break;t.emitOuter("click",n),t.handleEyeClick(n);break;case"aw-home-facets-wrapper.change":t.dataSource.openTippy=n.inputPayload.replace("-search",""),t.changedInput$.next(n);break;case"aw-home-facets-wrapper.enter":t.emitOuter("enter",n);break;default:console.warn("unhandled inner event of type:",a)}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-home-layout.facetswrapperrequest":t.dataSource.tippyMaker(n.facetId.inputPayload);break;case"aw-home-layout.facetswrapperclose":t.dataSource.tippyClose(n.facetId.inputPayload);break;case"aw-home-layout.facetswrapperresponse":break;case"aw-home-layout.lockfilter":t.updateFilters(n);break;case"aw-home-layout.tagclick":Object.keys(t.dataSource.lockedFacets).forEach((function(e){t.dataSource.lockedFacets[e].includes(n)&&t.dataSource.lockedFacets[e].splice(t.dataSource.lockedFacets[e].indexOf(n),1)})),t.dataSource.update(t.dataSource.lastData);break;case"aw-home-layout.clearselection":t.dataSource.lockedFacets={},t.dataSource.closedEyes=[],t.dataSource.update(t.dataSource.lastData);break;case"aw-home-layout.facetclick":var i=t.dataSource.openTippy;t.dataSource.lockedFacets[i]?-1===t.dataSource.lockedFacets[i].indexOf(n)&&t.dataSource.lockedFacets[i].push(n):t.dataSource.lockedFacets[i]=[n],t.dataSource.update(t.dataSource.lastData)}}))},e}(l.EventHandler);var jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){},e}(l.EventHandler),qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){switch(e.type){case"aw-home-item-tags-wrapper.click":t.emitOuter("click",e.payload)}}))},e}(l.EventHandler),Bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-home-autocomplete.click":t.emitOuter("click",n)}}))},e}(l.EventHandler),Rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-entita-nav.click":t.emitOuter("click",n);break;default:console.warn("unhandled event type")}}))},e}(l.EventHandler),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;"aw-sidebar-header.click"===a&&(t.dataSource.toggleSidebar(),t.emitOuter(a,n))}))},e}(l.EventHandler),zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;"aw-sidebar-header.click"===a&&(t.dataSource.toggleSidebar(),t.emitOuter("click",n))}))},e}(l.EventHandler),Vt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetOffset=new r.ReplaySubject,e.targetIsOpen=!1,e.scrollOpenedIntoView=function(){e.dataSource.out$.pipe(o.filter((function(t){return!!t})),o.first(),o.withLatestFrom(e.targetOffset)).subscribe((function(t){var e=w(t,2)[1];setTimeout((function(){var t=document.querySelector(".aw-scheda__tree-content"),a=document.getElementsByClassName("n7-tree__item is-expanded"),n=a.length?a[a.length-1]:null;if(n){var i=document.querySelector(".n7-tree"),r=t.getBoundingClientRect(),o=e-r.top;i.style.marginBottom="1000px",n.scrollIntoView(),t.scrollTop-=o,window.scrollTo(0,0),i.style.marginBottom="0px"}}),200)}))},e.scrollLeafIntoView=function(){var t=document.querySelector("div.aw-scheda__tree");setTimeout((function(){var a=t.querySelector(".is-active");a&&!e.isInViewport(a)&&(a.scrollIntoView(),window.scrollTo(0,0))}),200)},e.isInViewport=function(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-tree.click":"toggle"===n.source&&setTimeout((function(){t.dataSource.build(n.id),t.targetIsOpen&&t.scrollOpenedIntoView()}))}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-sidebar-header.click":t.dataSource.toggleSidebar();break;case"aw-scheda-layout.selectItem":t.dataSource.build(n);break;case"aw-scheda-layout.navigationresponse":n.currentItem&&t.dataSource.setActive(n.currentItem);var i=n.currentItem||n.tree.id;t.dataSource.load(n),t.dataSource.build(i);break;case"aw-scheda-layout.routechanged":t.dataSource.output&&(t.dataSource.build(n),t.dataSource.setActive(n),t.dataSource.highlightActive(),t.scrollLeafIntoView());break;case"aw-scheda-layout.viewleaf":t.dataSource.out$.pipe(o.filter((function(t){return!!t})),o.first()).subscribe((function(){t.scrollLeafIntoView()}));break;case"aw-scheda-layout.treeposition":var r=n.target,s=r.getBoundingClientRect();t.targetIsOpen=-1!==r.className.indexOf("n7-icon-angle-right"),t.targetOffset.next(s.top)}}))},e}(l.EventHandler);var Gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){},e}(l.EventHandler),Wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-gallery-results.change":t.emitOuter("change",+n.value);break;case"aw-gallery-results.click":if("string"==typeof n){if(n.startsWith("page"))t.emitOuter("pagination",n);else if(n.startsWith("goto")){var i=+n.replace("goto-","");if(i>t.dataSource.totalPages)return;if(i<1||i===t.dataSource.currentPage)return;t.emitOuter("goto",n)}}else t.emitOuter("click",n);break;default:console.warn("(gallery-results) unhandled inner event of type",a)}}))},e}(l.EventHandler),Kt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handleScroll=function(t){var a=e.dataSource,n=a.totalObjects,i=a.loadedData;(Array.isArray(i.result)?i.result.length:0)>=n||t.scrollTop+t.clientHeight>=t.scrollHeight-150&&!1===e.dataSource.loadedData.isLoading&&(e.dataSource.loadedData.isLoading=!0,e.emitOuter("datarequest",{currentPage:e.dataSource.currentPage}))},e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-linked-objects.change":t.emitOuter("change",+n.value);break;default:console.warn("unhandled event type: ",a," with payload: ",n)}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-home-layout.viewmore":t.dataSource.checkForMore(!1),t.emitOuter("datarequest",{currentPage:t.dataSource.currentPage});break;case"aw-home-layout.dataresponse":var i=n.res;t.dataSource.handleIncomingData(i);break;case"aw-home-layout.scroll":t.handleScroll(n)}}))},e}(l.EventHandler);var Ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-autocomplete-wrapper.click":"fallback-simple-autocomplete"!==n&&t.emitOuter("clickresult",n);break;default:console.warn("unhandled event of type:",a)}}))},e}(l.EventHandler),Qt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.initialLoad=!1,e.toggleSelection=function(t){e.dataSource.handleBubbleClick(t),e.emitOuter("selection",e.dataSource.selected)},e.toggleFilter=function(t){e.dataSource.filters.includes(t)?e.dataSource.filters.splice(e.dataSource.filters.indexOf(t),1):e.dataSource.filters.push(t),e.dataSource.updateChart(null)},e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-bubble-chart.click":!1!==t.dataSource.options.selectable&&t.toggleSelection(n),t.emitOuter("lockfilter",t.dataSource.chartData.find((function(t){return n===t.entity.id})));break;case"aw-bubble-chart.d3end":var i=void 0;i=t.dataSource.filters.length>0?t.dataSource.chartData.filter((function(e){return!t.dataSource.filters.includes(e.entity.typeOfEntity.replace(/ /g,"-"))})):t.dataSource.chartData,t.emitOuter("d3end",{bubbles:t.dataSource.smartSlice(i),selected:t.dataSource.selected});break;default:console.warn("unhandled inner event of type",a,"with payload",n)}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-home-layout.select":var i=n.id;t.toggleSelection(i);var r=t.dataSource.chartData.find((function(t){return i===t.entity.id}));r?t.emitOuter("lockfilter",r):console.warn("Unable to determine which bubble was selected.");break;case"aw-home-layout.tagclick":t.toggleSelection(n);break;case"aw-home-layout.facetclick":t.dataSource.selected.includes(n)||t.toggleSelection(n);break;case"aw-home-layout.togglefilter":t.toggleFilter(n);break;case"aw-home-layout.clearselection":t.dataSource.selected=[],t.emitOuter("selection",[]);break;case"aw-scheda-layout.filterbubbleresponse":case"aw-entita-layout.filterbubbleresponse":case"aw-home-layout.filterbubbleresponse":t.dataSource.updateChart(n)}}))},e}(l.EventHandler);var Yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){},e}(l.EventHandler),Xt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tippyList=[],e.tippyMaker=function(t){e.tippyList.forEach((function(t){t&&t.destroy()})),e.tippyList=[],t.forEach((function(t){var a=document.getElementById("g_"+t.entity.id);a&&e.tippyList.push(g(a,{content:document.getElementById("template__"+t.entity.id),interactive:!0,appendTo:document.body,arrow:!0,flip:!1,theme:"light-border no-padding",placement:"top",delay:[150,30],updateDuration:400}))}))},e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-chart-tippy.select":t.emitOuter("select",n);break;default:console.warn("(chart-tippy) unhandled inner event of type",a)}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-home-layout.d3end":case"aw-entita-layout.d3end":case"aw-scheda-layout.d3end":t.dataSource.update(n),setTimeout((function(){t.tippyMaker(n.bubbles)}))}}))},e}(l.EventHandler);var Zt=Object.freeze({__proto__:null,AwHeroEH:$t,AwHomeFacetsWrapperEH:Mt,AwHomeHeroPatrimonioEH:jt,AwHomeItemTagsWrapperEH:qt,AwHomeAutocompleteEH:Bt,AwEntitaNavEH:Rt,AwSchedaSidebarEH:Nt,AwSidebarHeaderEH:zt,AwTreeEH:Vt,AwSearchLayoutTabsEH:Gt,AwGalleryResultsEH:Wt,AwLinkedObjectsEH:Kt,AwAutocompleteWrapperEH:Ut,AwBubbleChartEH:Qt,AwTableEH:Yt,AwChartTippyEH:Xt}),Jt={layoutId:"aw-entita-layout",widgets:[{id:"aw-entita-nav",hasStaticData:!0},{id:"aw-entita-metadata-viewer"},{id:"aw-linked-objects"},{id:"aw-bubble-chart"},{id:"aw-chart-tippy"},{id:"n7-smart-pagination",dataSource:U,eventHandler:et}],layoutDS:ht,layoutEH:ft,widgetsDataSources:Ht,widgetsEventHandlers:Zt,options:{}},te=function(t){function n(e,a,n,i,r,o,s,c){var l=t.call(this,r.get("AwEntitaLayoutConfig")||Jt)||this;return l.router=e,l.route=a,l.location=n,l.configuration=i,l.layoutsConfiguration=r,l.communication=o,l.mainState=s,l.titleService=c,l}return m(n,t),n.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,location:this.location,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},n.prototype.ngOnInit=function(){this.onInit()},n.prototype.ngOnDestroy=function(){this.onDestroy()},n.decorators=[{type:e.Component,args:[{selector:"aw-entita-layout",template:'<div class="aw-entity n7-side-auto-padding" *ngIf="lb.dataSource">\n\n    <div class="aw-entity__sidebar">\n        \x3c!-- Custom header --\x3e\n        <div *ngIf="!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__sidebar-title-wrapper-loading">\n            <n7-content-placeholder [data]="{\n                blocks: [{\n                    classes: \'entity-placeholder-title\'\n                }]\n            }">\n            </n7-content-placeholder>\n        </div>\n        <div *ngIf="!!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)"\n            class="aw-entity__sidebar-title-wrapper color-{{lb.dataSource.navHeader.color}}">\n            <h1 class="aw-entity__sidebar-title">\n                <span class="aw-entity__sidebar-title-icon {{lb.dataSource.navHeader.icon}}"></span>\n                <span class="aw-entity__sidebar-title-text">{{lb.dataSource.navHeader.text}}</span>\n            </h1>\n        </div>\n        \x3c!-- Navigation --\x3e\n        <div *ngIf="!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__sidebar-nav-loading">\n            <n7-content-placeholder *ngFor="let n of [0,1,2]"\n            [data]="{\n                blocks: [{\n                    classes: \'entity-placeholder-nav\'\n                }]\n            }">\n            </n7-content-placeholder>\n        </div>\n        <n7-nav [data]="lb.widgets[\'aw-entita-nav\'].ds.out$ | async" [emit]="lb.widgets[\'aw-entita-nav\'].emit">\n        </n7-nav>\n    </div>\n\n    \x3c!-- lb.dataSource.selectedTab --\x3e\n    <div *ngIf="!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__content-loading">\n        <div class="aw-entity__content-loading-title">\n            <n7-content-placeholder [data]="{\n                blocks: [{\n                    classes: \'entity-placeholder-title\'\n                }]\n            }"></n7-content-placeholder>\n        </div>\n\n        <div class="aw-entity__content-loading-items">\n            <n7-content-placeholder *ngFor="let n of [0,1,2,3]"\n            [data]="{\n                blocks: [\n                {\n                    classes: \'entity-placeholder-item-preview\'\n                }\n                ]\n            }"></n7-content-placeholder>\n        </div>\n    </div>\n\n    <div *ngIf="!!(lb.widgets[\'aw-entita-nav\'].ds.out$ | async)" class="aw-entity__content">\n        <section>\n            <div *ngIf="lb.dataSource.myResponse.wikiTab || lb.dataSource.myResponse.extraTab"\n                class="aw-entity__content-section" [hidden]="lb.dataSource.selectedTab != \'overview\'">\n                <div class="aw-entity__overview-description">\n                    {{lb.dataSource.myResponse.extraTab}}\n                </div>\n                <div class="aw-entity-layout__button-wrapper">\n                    <a *ngIf="lb.dataSource.myResponse.wikiTab" class="n7-btn n7-btn-light"\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/wiki\']">\n                        DESCRIZIONE WIKIPEDIA <i class="n7-icon-angle-right"></i>\n                    </a>\n                    <a *ngIf="lb.dataSource.myResponse.extraTab" class="n7-btn n7-btn-light"\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/maxxi\']">\n                        DESCRIZIONE MAXXI <i class="n7-icon-angle-right"></i>\n                    </a>\n                </div>\n            </div>\n\n            <ng-container *ngIf="\n            ((lb.dataSource.myResponse.fields || []).length > 0 && lb.dataSource.selectedTab == \'campi\') ||\n            (lb.dataSource.showFields && lb.dataSource.selectedTab == \'overview\')">\n                <div class="aw-entity__content-section aw-entity__content-section-overview"\n                    [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'campi\'">\n                    <div class="aw-entity__content-section-header">\n                        <h2 class="aw-entity__content-section-title">Campi</h2>\n                        <a class="n7-btn n7-btn-light" [routerLink]="[lb.dataSource.getNavBasePath() + \'campi\']">\n                            TUTTI I CAMPI <i class="n7-icon-angle-right"></i>\n                        </a>\n                    </div>\n                    <n7-metadata-viewer class="aw-entity-layout__metadata-viewer"\n                        [data]="lb.widgets[\'aw-entita-metadata-viewer\'].ds.out$ | async ">\n                    </n7-metadata-viewer>\n                </div>\n            </ng-container>\n\n            <div class="aw-entity__content-section aw-entity__content-section-overview"\n                *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews"\n                [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'oggetti-collegati\'">\n                <div class="aw-entity__content-section-header">\n                    <h2 class="aw-entity__content-section-title">Oggetti collegati</h2>\n\n                    <a *ngIf="lb.dataSource.selectedTab === \'overview\' "\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/oggetti-collegati/\']"\n                        [queryParams]="{ page: 1 }" class="n7-btn n7-btn-light">\n                        TUTTI GLI OGGETTI COLLEGATI <i class="n7-icon-angle-right"></i>\n                    </a>\n                </div>\n                <div class="aw-entity__content-item-previews">\n                    <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <div class="aw-entity__content-item-preview-wrapper">\n                            <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                            </n7-smart-breadcrumbs>\n                            <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                            </n7-item-preview>\n                            \x3c!-- relation --\x3e\n                            <div class="aw-entity__relation" *ngIf="preview.relation.value">\n                                <p class="aw-entity__relation-description">Relazione con \n                                <span class="aw-entity__relation-key">{{preview.relation.key}}</span>:\n                                <span class="aw-entity__relation-value"> {{preview.relation.value}}</span>\n                                </p>\n                            </div>\n                        </div>\n                    </ng-container>\n                </div>\n                <n7-smart-pagination \n                    *ngIf="lb.dataSource.selectedTab === \'oggetti-collegati\'"\n                    [data]="lb.widgets[\'n7-smart-pagination\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'n7-smart-pagination\'].emit">\n                </n7-smart-pagination>\n            </div>\n\n            <div class="aw-entity__content-section aw-entity__content-section-overview aw-bubble-chart__{{lb.dataSource.selectedTab}}"\n                *ngIf="lb.dataSource.bubblesEnabled && lb.dataSource.myResponse.relatedEntities"\n                [hidden]="lb.dataSource.selectedTab != \'overview\' && lb.dataSource.selectedTab != \'entita-collegate\'">\n                <div class="aw-entity__content-section-header">\n                    <h2 class="aw-entity__content-section-title">Entità collegate</h2>\n                    <a *ngIf="lb.dataSource.selectedTab == \'overview\'" class="n7-btn n7-btn-light"\n                        [routerLink]="[lb.dataSource.getNavBasePath() + \'/entita-collegate\']">\n                        TUTTE LE ENTITÀ COLLEGATE <i class="n7-icon-angle-right"></i>\n                    </a>\n                </div>\n                \x3c!-- Small Bubble Chart --\x3e\n                <div class="aw-entity__bubble-chart-wrapper-small" *ngIf="lb.dataSource.selectedTab == \'overview\'">\n                    <aw-bubble-chart-wrapper>\n                        \x3c!-- Tippy template moved to end of HTML --\x3e\n                        <n7-bubble-chart [data]="(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)?.smallView"\n                            [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                        </n7-bubble-chart>\n                    </aw-bubble-chart-wrapper>\n                </div>\n                \x3c!-- Big Bubble Chart --\x3e\n                <div class="aw-entity__bubble-chart-wrapper" *ngIf="lb.dataSource.selectedTab == \'entita-collegate\'">\n                    <aw-bubble-chart-wrapper>\n                        \x3c!-- Tippy template moved to end of HTML --\x3e\n                        <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                            [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                        </n7-bubble-chart>\n                    </aw-bubble-chart-wrapper>\n                </div>\n            </div>\n            <div class="aw-entity__content-section aw-entity__content-section-maxxi"\n                *ngIf="lb.dataSource.myResponse.extraTab" [hidden]="lb.dataSource.selectedTab != \'maxxi\'">\n                <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n                    <h2 class="aw-entity__content-section-title">Descrizione Maxxi</h2>\n                </div>\n                <div>\n                    {{lb.dataSource.myResponse.extraTab}}\n                </div>\n            </div>\n            <div class="aw-entity__content-section aw-entity__content-section-wiki"\n                *ngIf="lb.dataSource.myResponse.wikiTab" [hidden]="lb.dataSource.selectedTab != \'wiki\'">\n                <div class="aw-entity__content-section-header aw-entity__content-section-header-decorated">\n                    <h2 class="aw-entity__content-section-title">Descrizione Wikipedia</h2>\n                </div>\n                <div>\n                    {{lb.dataSource.myResponse.wikiTab.text}}\n                </div>\n                <a href="{{lb.dataSource.myResponse.wikiTabUrl}}">\n                    {{ lb.dataSource.myResponse.wikiTab.url }}\n                </a>\n            </div>\n        </section>\n    </div>\n    \x3c!-- Template for bubble chart tooltips --\x3e\n    <aw-chart-tippy [data]="lb.widgets[\'aw-chart-tippy\'].ds.out$ | async" [emit]="lb.widgets[\'aw-chart-tippy\'].emit">\n    </aw-chart-tippy>\n</div>'}]}],n.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:a.Location},{type:S},{type:_},{type:C},{type:k},{type:c.Title}]},n}(x);var ee=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.facetInputs={},e.autocompletePopoverOpen=!1,e.autocompleteChanged$=new r.Subject,e.numOfItemsStr=null,e.currentHoverEntity=null,e.hasScrollBackground=!1,e.resultsLimit=-1,e.selectedEntitiesIds=[],e.destroyed$=new r.Subject,e.homeAutocompleteIsLoading=!1,e.resultsListIsLoading=!1,e.bubblesEnabled=!1,e.selectedBubbles=[],e.updateComponent=function(t,a,n){n&&e.one(t).updateOptions(n),e.one(t).update(a)},e}return m(e,t),e.prototype.onInit=function(t){var e=t.communication,a=t.mainState,n=t.configuration,i=t.tippy;this.communication=e,this.configuration=n,this.mainState=a,this.tippy=i,this.resultsLimit=this.configuration.get("home-layout")["results-limit"],this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.one("aw-hero").update(this.configuration.get("home-layout")["top-hero"]),this.one("aw-home-hero-patrimonio").update(this.configuration.get("home-layout")["bottom-hero"]),this.mainState.update("headTitle","Arianna Web > Home"),this.mainState.update("pageTitle","Arianna Web: Home Layout"),this.mainState.updateCustom("currentNav","home"),this._listenAutoCompleteChanges(),this.outerLinks=this.configuration.get("home-layout")["outer-links"].test,this.outerLinksTitle=this.configuration.get("home-layout")["outer-links"].title,this.one("aw-bubble-chart").updateOptions({selectable:!0,config:this.configuration,limit:this.configuration.get("bubble-chart").bubbleLimit}),this.one("aw-chart-tippy").updateOptions({basePath:this.configuration.get("paths").entitaBasePath,selectable:!0})},e.prototype.onDestroy=function(){this.destroyed$.next()},e.prototype.makeRequest$=function(t,e){return this.communication.request$(t,{onError:function(t){return console.error(t)},params:e})},e.prototype.initialFilterRequest=function(){return this.communication.request$("globalFilter",{onError:function(t){return console.error(t)},params:{entitiesListSize:this.configuration.get("bubble-chart").bubbleLimit}})},e.prototype.parseInitialRequest=function(t){var e=this;this.firstBubbleResponse=t.entitiesData;var a=[];t.typeOfEntityData.forEach((function(t){var n=e.configuration.get("config-keys")[t.type];a.push(b({},t,{enabled:!0,locked:!1},n))})),this.one("aw-home-facets-wrapper").update(a)},e.prototype.renderPreviewsFromApolloQuery=function(t){var e=this;if(t&&t.itemsPagination){var a=t.itemsPagination.totalCount;if(a>0){for(var n=0;a>999;)a-=1e3,n+=1;var i=""+a;a<10?i="00"+a:a<100&&(i="0"+a),this.numOfItemsStr=n>0?n+"."+i:""+a}else this.numOfItemsStr="0";this.one("aw-linked-objects").updateOptions({context:"home",config:this.configuration}),this.one("aw-linked-objects").update(t.itemsPagination),setTimeout((function(){e._scrollBackgroundControl()}))}},e.prototype.updateTags=function(t){t||this.renderItemTags()},e.prototype.handleFacetSearchChange=function(t){var e=t.inputPayload,a=t.value;this.facetInputs[e]=a},e.prototype.renderItemTags=function(){var t=this,e=[],a=[];this.selectedBubbles.forEach((function(n){var i=t.firstBubbleResponse.find((function(t){return t.entity.id===n}));if(i){var r=t.configuration.get("config-keys")[i.entity.typeOfEntity];a.push({label:i.entity.label,icon:"n7-icon-close",payload:n,classes:"tag-"+r["class-name"]})}else{var o={entityId:n,entitiesListSize:1};e.push(t.makeRequest$("getMissingBubble",o))}})),e.length>0?r.forkJoin(e).subscribe((function(e){e.forEach((function(e){var n=t.configuration.get("config-keys")[e.typeOfEntity];a.push({label:e.label,icon:"n7-icon-close",payload:e.id,classes:"tag-"+n["class-name"]})})),t.one("aw-home-item-tags-wrapper").update(a)})):this.one("aw-home-item-tags-wrapper").update(a)},e.prototype.onHeroChange=function(t){if(t){var e=L.escapeDoubleQuotes(t);this.autocompleteChanged$.next(e),this.homeAutocompleteIsLoading=!0,this.homeAutocompleteQuery=e,this.autocompletePopoverOpen||this._toggleAutocompletePopover()}else this.autocompletePopoverOpen&&this._toggleAutocompletePopover()},e.prototype._scrollBackgroundControl=function(){var t=this,e=document.getElementById("bubble-results-list");if(e){var a=r.fromEvent(e,"scroll");setTimeout((function(){t._setHasScrollBackground(e)}),500),a.pipe(o.debounceTime(50)).subscribe((function(e){var a=e.target;t._setHasScrollBackground(a)}))}},e.prototype._setHasScrollBackground=function(t){this.hasScrollBackground=!!t&&t.scrollHeight>t.scrollTop+t.clientHeight},e.prototype._listenAutoCompleteChanges=function(){var t=this;this.one("aw-home-autocomplete").updateOptions({keys:this.configuration.get("config-keys"),config:this.configuration,labels:this.configuration.get("labels"),paths:this.configuration.get("paths")}),this.autocompleteChanged$.pipe(o.debounceTime(500),o.takeUntil(this.destroyed$)).subscribe((function(e){t.communication.request$("autoComplete",{onError:function(t){return console.error(t)},params:{input:e,itemsPagination:{offset:0,limit:t.configuration.get("home-layout")["results-limit"]}}}).subscribe((function(a){t.homeAutocompleteIsLoading=!1,t.one("aw-home-autocomplete").update({response:a,query:e})}))}))},e.prototype._toggleAutocompletePopover=function(){var t=this;if(!this.autocompletePopover){var e=document.getElementById("aw-home-advanced-autocomplete-popover");e.style.display="block";var a=w(this.tippy(".aw-home__top-hero .n7-hero__input",{content:e,trigger:"manual",interactive:!0,arrow:!1,flip:!1,appendTo:"parent",theme:"light-border",placement:"bottom-start",maxWidth:"100%",onHidden:function(){t.autocompletePopoverOpen=!1}}),1)[0];this.autocompletePopover=a}this.autocompletePopoverOpen?this.autocompletePopover.hide():this.autocompletePopover.show(),this.autocompletePopoverOpen=!this.autocompletePopoverOpen},e}(u.LayoutDataSource);var ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new r.Subject,e.handleSimpleAutocompleteClick=function(t){e.emitOuter("facetclick",t)},e.handleChartSelection=function(t){var a=t;e.dataSource.selectedBubbles=t,e.dataSource.resultsListIsLoading=!0,e.dataSource.makeRequest$("globalFilter",{selectedEntitiesIds:a,entitiesListSize:e.configuration.get("bubble-chart").bubbleLimit}).subscribe((function(t){if(e.dataSource.resultsListIsLoading=!1,t&&t.entitiesData.length>0)e.dataSource.lastBubbleResponse=t.entitiesData,e.emitOuter("filterbubbleresponse",t.entitiesData),e.dataSource.renderPreviewsFromApolloQuery(t),e.dataSource.renderItemTags();else{var a=[];e.dataSource.selectedBubbles.forEach((function(t){var n={entityId:t,entitiesListSize:1};a.push(e.dataSource.makeRequest$("getMissingBubble",n))})),r.forkJoin(a).subscribe((function(a){var n=[];a.forEach((function(t){n.push({count:0,entity:t})})),e.emitOuter("filterbubbleresponse",n),e.dataSource.renderPreviewsFromApolloQuery(t),e.dataSource.renderItemTags()}))}}))},e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-home-layout.init":t.dataSource.onInit(n),t.loadFilters(),t.configuration=n.configuration;break;case"aw-home-layout.outerlinkclick":t.emitGlobal("navigate",{handler:"router",path:n});break;case"aw-home-layout.destroy":t.dataSource.onDestroy();break;case"aw-home-layout.bubbleresultsviewallclick":var i=t.dataSource.selectedBubbles.join(","),r=t.configuration.get("paths").searchBasePath;t.emitGlobal("navigate",{handler:"router",path:[r],queryParams:{"entity-links":i}});break;case"aw-home-layout.clearselection":t.emitOuter("clearselection");break;default:console.warn("(home) unhandled inner event of type: ",a)}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-bubble-chart.d3end":t.emitOuter("d3end",n);break;case"aw-chart-tippy.select":t.emitOuter("select",n);break;case"aw-hero.enter":var i=n.value;t.emitGlobal("navigate",{handler:"router",path:[t.configuration.get("paths").searchBasePath],queryParams:{query:i}});break;case"aw-hero.change":t.dataSource.autocompleteValue=n.value,t.dataSource.onHeroChange(n.value);break;case"aw-home-facets-wrapper.click":t.emitOuter("togglefilter",n);break;case"aw-home-facets-wrapper.change":if(!n.value||"string"==typeof n.value&&0===n.value.trim().length)t.emitOuter("facetswrapperclose",{facetId:n});else if(n.value){t.emitOuter("facetswrapperrequest",{facetId:n}),t.dataSource.updateComponent("aw-autocomplete-wrapper",{key:n.value,response:null});var r={input:n.value,typeOfEntity:n.inputPayload.replace(/-search/g,"").replace(/-/g," "),itemsPagination:{offset:0,limit:t.configuration.get("home-layout")["results-limit"]}};t.dataSource.makeRequest$("autoComplete",r).subscribe((function(e){if(e.results.length<1){var a={totalcount:0,results:[{entity:{id:"fallback",label:t.configuration.get("home-layout")["autocomplete-fallback"]?t.configuration.get("home-layout")["autocomplete-fallback"]:"Nessun risultato trovato"}}]};t.dataSource.updateComponent("aw-autocomplete-wrapper",{key:n.value,response:a},{config:t.configuration})}else t.dataSource.updateComponent("aw-autocomplete-wrapper",{key:n.value,response:e},{config:t.configuration})}))}break;case"aw-home-item-tags-wrapper.click":t.emitOuter("tagclick",n);break;case"aw-linked-objects.datarequest":var o=n.currentPage;r={selectedEntitiesIds:t.dataSource.selectedBubbles,itemsPagination:{offset:o*t.dataSource.resultsLimit,limit:t.dataSource.resultsLimit}};t.dataSource.makeRequest$("globalFilter",r).subscribe((function(e){e?t.emitOuter("dataresponse",{res:e}):console.warn("Unable to fetch additional data.")}));break;case"aw-autocomplete-wrapper.clickresult":t.handleSimpleAutocompleteClick(n);break;case"aw-home-autocomplete.click":var s=n.source,c=n.type,l=void 0;if("item"===s)l="oggetto-culturale"===c?t.configuration.get("paths").schedaBasePath:t.configuration.get("paths").entitaBasePath,t.emitGlobal("navigate",{handler:"router",path:[l,n.id,L.slugify(n.title)]});else if("showMore"===s){i=t.dataSource.homeAutocompleteQuery;l=t.configuration.get("paths").searchBasePath,t.emitGlobal("navigate",{handler:"router",path:[l],queryParams:{query:i}})}else"extendsearch"===s&&t.emitGlobal("navigate",{handler:"router",path:[t.configuration.get("paths").searchBasePath],queryParams:{query:t.dataSource.autocompleteValue,"query-all":1}});break;case"aw-bubble-chart.selection":t.handleChartSelection(n);break;case"aw-bubble-chart.lockfilter":t.emitOuter("lockfilter",n)}}))},e.prototype.loadFilters=function(){var t=this;this.dataSource.initialFilterRequest().subscribe((function(e){e&&(t.dataSource.parseInitialRequest(e),t.dataSource.bubblesEnabled&&t.emitOuter("filterbubbleresponse",e.entitiesData))}))},e.prototype.outerLinkClick=function(t,e){window.open(e,"_blank")},e}(l.EventHandler);var ne={layoutId:"aw-home-layout",widgets:[{id:"aw-hero"},{id:"aw-home-hero-patrimonio"},{id:"aw-bubble-chart"},{id:"aw-home-facets-wrapper"},{id:"aw-home-item-tags-wrapper"},{id:"aw-home-autocomplete"},{id:"aw-linked-objects"},{id:"aw-autocomplete-wrapper"},{id:"aw-chart-tippy"}],layoutDS:ee,layoutEH:ae,widgetsDataSources:Ht,widgetsEventHandlers:Zt,options:{}},ie=function(t){function a(e,a,n,i,r){var o=t.call(this,e.get("AwHomeLayoutConfig")||ne)||this;return o.router=a,o.configuration=n,o.communication=i,o.mainState=r,o}return m(a,t),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,communication:this.communication,options:this.config.options||{},tippy:g}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"aw-home-layout",template:'<div class="aw-home" *ngIf="lb.dataSource">\n    \x3c!-- Hero section at the top of the page --\x3e\n    <div class="aw-home__top-hero">\n        <n7-hero [data]="lb.widgets[\'aw-hero\'].ds.out$ | async" [emit]="lb.widgets[\'aw-hero\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- Bubble chart --\x3e\n    <div class="aw-home__bubble-wrapper n7-side-auto-padding"\n        [ngClass]="{ \'has-results\' : lb.dataSource.selectedBubbles.length > 0 }" *ngIf="lb.dataSource.bubblesEnabled">\n        <div class="aw-home__facets-wrapper-loading" *ngIf="!(lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async)">\n            <n7-content-placeholder *ngFor="let i of [0,1,2,3]" [data]="{\n                blocks: [{\n                    classes: \'facet-placeholder-header\'\n                }, {\n                    classes: \'facet-placeholder-input\'\n                }] \n            }"></n7-content-placeholder>\n        </div>\n        <div class="aw-home__facets-wrapper" *ngIf="!!(lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async)">\n            <span class="aw-home__facet"\n                *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;">\n                <n7-facet-header [data]="widgetData.header" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet-header>\n                <n7-facet [data]="widgetData.input" [emit]="lb.widgets[\'aw-home-facets-wrapper\'].emit">\n                </n7-facet>\n            </span>\n        </div>\n\n        <div class="aw-home__bubble-chart-wrapper-loading" *ngIf="!(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)">\n            <n7-content-placeholder [data]="{\n                blocks: [\n                    {\n                        classes: \'facet-placeholder-item-1\'\n                    }\n                ]\n            }"></n7-content-placeholder>\n        </div>\n        <div class="aw-home__bubble-chart-wrapper" *ngIf="!!(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)"\n            [style.overflow]="lb.dataSource.loadingBubbles ? \'visible\' : \'hidden\'">\n            <aw-bubble-chart-wrapper>\n                <aw-chart-tippy \n                    [data]="lb.widgets[\'aw-chart-tippy\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'aw-chart-tippy\'].emit">\n                </aw-chart-tippy>\n                <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                </n7-bubble-chart>\n            </aw-bubble-chart-wrapper>\n        </div>\n\n        \x3c!-- Linked objects --\x3e\n        <ng-container *ngIf="(lb.widgets[\'aw-bubble-chart\'].ds.out$ | async)?.selected.length > 0;">\n            <div class="aw-home__bubble-results" id="home-bubble-results">\n                <div *ngIf="lb.dataSource.numOfItemsStr" class="aw-home__bubble-results-title-wrapper">\n                    <h1 class="aw-home__bubble-results-title"><strong class="aw-home__bubble-results-title-counter">\n                            {{ lb.dataSource.numOfItemsStr }}</strong> <span> Oggetti culturali</span>\n                    </h1>\n                </div>\n                <div class="aw-home__bubble-tags-wrapper">\n                    <h3 class="aw-home__bubble-tags-title">Collegati a </h3>\n                    <ng-container *ngFor="let widgetData of lb.widgets[\'aw-home-item-tags-wrapper\'].ds.out$ | async;">\n                        <n7-tag [data]="widgetData" [emit]="lb.widgets[\'aw-home-item-tags-wrapper\'].emit">\n                        </n7-tag>\n                        <br>\n                    </ng-container>\n                </div>\n                <div class="aw-home__bubble-results-list-wrapper">\n                    <div class="aw-home__bubble-results-list-loading" *ngIf="lb.dataSource.resultsListIsLoading">\n                        <n7-content-placeholder \n                            *ngFor="let i of [1, 2, 3, 4, 5]"\n                            [data]="{\n                                blocks: [{\n                                    classes: \'search-result-placeholder-title\'\n                                }, {\n                                    classes: \'search-result-placeholder-metadata\'\n                                }]\n                        }"></n7-content-placeholder>\n                    </div>\n                    <div *ngIf="!lb.dataSource.resultsListIsLoading" class="aw-home__bubble-results-list"\n                        [attr.id]="\'bubble-results-list\'" (scroll)="lb.eventHandler.emitOuter(\'scroll\', $event.target)">\n\n                        <div class="aw-home__bubble-results-fallback"\n                            *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result.length < 1;">\n                            <p class="aw-home__bubble-results-fallback-text">\n                                {{ (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.fallback }}\n                            </p>\n                            <button class="n7-btn aw-home__bubble-results-reset"\n                                (click)="lb.eventHandler.emitInner(\'clearselection\')">\n                                Resetta la ricerca\n                            </button>\n                        </div>\n\n                        <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result">\n                            <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                            </n7-smart-breadcrumbs>\n                            <n7-item-preview [data]="preview"\n                                                [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                            </n7-item-preview>\n                        </ng-container>\n                        \x3c!-- <ng-container\n                            *ngFor="let widgetData of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result;">\n                            <n7-item-preview [data]="widgetData" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                            </n7-item-preview>\n                        </ng-container> --\x3e\n\n                        <ng-container *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.isLoading">\n                            <div class="aw-home__bubble-results-list-loader">\n                                <n7-loader [data]="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.loaderData">\n                                </n7-loader>\n                            </div>\n                        </ng-container>\n                    </div>\n                    <div [ngClass]="{ \'is-visible\' : lb.dataSource.hasScrollBackground }"\n                        class="aw-home__bubble-results-list-wrapper-with-scroll"></div>\n                </div>\n                \x3c!-- aw-linked-objects__actions --\x3e\n                <ng-container\n                    *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.result.length > 0 && !lb.dataSource.resultsListIsLoading">\n                    <div *ngIf="(lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.actions as action"\n                        class="aw-home__bubble-results-list-actions">\n                        <button (click)="lb.eventHandler.emitInner(\'bubbleresultsviewallclick\')"\n                            class="n7-btn n7-btn-light n7-btn-l aw-home__bubble-results-list-view-all">\n                            {{action[0].label}}\n                        </button>\n                    </div>\n                </ng-container>\n\n            </div>\n        </ng-container>\n    </div>\n\n    \x3c!-- Outer links --\x3e\n    <div *ngIf="lb.dataSource.outerLinks && lb.dataSource.outerLinks.length > 0" class="aw-home__outer-links">\n        <section class="aw-home__outer-links-wrapper n7-side-auto-padding">\n            <h2 class="aw-home__outer-links-title" *ngIf="lb.dataSource.outerLinksTitle">\n                {{ lb.dataSource.outerLinksTitle }}\n            </h2>\n            <div class="aw-home__outer-links-items">\n                \x3c!-- Item preview --\x3e\n                <n7-item-preview *ngFor="let outerLink of lb.dataSource.outerLinks" [data]="outerLink"\n                    [emit]="lb.eventHandler.outerLinkClick.bind(lb.eventHandler)">\n                </n7-item-preview>\n                \x3c!-- END // Item preview --\x3e\n            </div>\n        </section>\n    </div>\n    \x3c!-- END // Outer links --\x3e\n\n    \x3c!-- Hero section at the bottom of the page --\x3e\n    <div class="aw-home__bottom-hero">\n        <n7-hero [data]="lb.widgets[\'aw-home-hero-patrimonio\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-hero-patrimonio\'].emit">\n        </n7-hero>\n    </div>\n\n    \x3c!-- Adavanced autocomplete popover  --\x3e\n    <div class="aw-home__advanced-autocomplete" id="aw-home-advanced-autocomplete-popover" style="display: none;">\n        <div class="aw-home__advanced-autocomplete-loader" *ngIf="lb.dataSource.homeAutocompleteIsLoading">\n            <n7-loader [data]="{}"></n7-loader>\n        </div>\n        <n7-advanced-autocomplete *ngIf="!lb.dataSource.homeAutocompleteIsLoading"\n            [data]="lb.widgets[\'aw-home-autocomplete\'].ds.out$ | async"\n            [emit]="lb.widgets[\'aw-home-autocomplete\'].emit">\n        </n7-advanced-autocomplete>\n    </div>\n\n    \x3c!-- Simple autocomplete popover. DO NOT CHANGE parent div class! --\x3e\n    \x3c!-- Creating one template for each facet --\x3e\n    <div *ngFor="let widgetData of lb.widgets[\'aw-home-facets-wrapper\'].ds.out$ | async;"\n        class="aw-home__simple-autocomplete aw-simple-autocomplete__template" style="display: none;">\n        <div class="aw-home__simple-autocomplete-content aw-simple-autocomplete__tippy-wrapper">\n            <div class="aw-home__simple-autocomplete-loader aw-simple-autocomplete__tippy-wrapper-loader"\n                *ngIf="(lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async)?.loading">\n                <n7-loader [data]="{}"></n7-loader>\n            </div>\n            <n7-simple-autocomplete *ngIf="!(lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async)?.loading"\n                [data]="lb.widgets[\'aw-autocomplete-wrapper\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-autocomplete-wrapper\'].emit">\n            </n7-simple-autocomplete>\n        </div>\n    </div>\n</div>\n'}]}],a.ctorParameters=function(){return[{type:_},{type:s.Router},{type:S},{type:C},{type:k}]},a}(x);var re=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.destroyed$=new r.Subject,a.stickyControlTrigger$=new r.Subject,a.contentParts={},a.sidebarIsSticky=!1,a.treeMaxHeight="100%",a.contentIsLoading=!1,a.currentId=null,a.getTree=function(){return e.tree},a}return m(e,t),e.prototype.onInit=function(t){var e=t.configuration,a=t.mainState,n=t.router,i=t.options,r=t.titleService,o=t.communication;this.configuration=e,this.mainState=a,this.router=n,this.titleService=r,this.communication=o,this.options=i,this.sidebarCollapsed=!1,this.bubbleChartSectionTitle=this.configuration.get("scheda-layout")["bubble-chart"].title,this.similarItemsSectionTitle=this.configuration.get("scheda-layout")["related-items"].title,this.metadataSectionTitle=this.configuration.get("scheda-layout").metadata.title,this.hasSimilarItems=!1,this.bubblesEnabled=!!this.configuration.get("features-enabled")&&this.configuration.get("features-enabled").bubblechart,this.one("aw-bubble-chart").updateOptions({selectable:!1,simple:!0,config:this.configuration,limit:this.configuration.get("bubble-chart").bubbleLimit}),this.one("aw-chart-tippy").updateOptions({basePath:this.configuration.get("paths").entitaBasePath}),this.emptyLabel=this.configuration.get("scheda-layout")["empty-label"],this.one("aw-tree").updateOptions({config:this.configuration.get("config-keys")}),this.mainState.update("headTitle","Arianna Web > Patrimonio"),this.mainState.update("pageTitle","Arianna Web: patrimonio Layout"),this.mainState.updateCustom("currentNav","patrimonio"),this._sidebarStickyControl()},e.prototype.onDestroy=function(){this.destroyed$.next()},e.prototype.getNavigation=function(t){return e.tree?r.of(e.tree):this.communication.request$("getTree",{onError:function(t){return console.error(t)},params:{treeId:t}})},e.prototype.setTree=function(t){e.tree=t},e.prototype.updateNavigation=function(t){this.one("aw-sidebar-header").update({text:t})},e.prototype.loadItem=function(t){var e=this.configuration.get("scheda-layout")["related-items"]["max-related-items"];return this.communication.request$("getNode",{onError:function(t){return console.error(t)},params:{id:t,maxSimilarItems:e}})},e.prototype.loadContent=function(t){var e=this;if(t){this.hasMetadata=Array.isArray(t.fields)&&t.fields.length,this.hasSimilarItems=Array.isArray(t.relatedItems)&&t.relatedItems.length,this.hasBreadcrumb=Array.isArray(t.breadcrumbs)&&t.breadcrumbs.length,this.hasBubbles=Array.isArray(t.relatedEntities)&&t.relatedEntities.length,this.hasImage=!!t.image,this.contentParts=[];var a={content:null};if(t.text&&(a.content=t.text),this.contentParts.push(a),t.images){var n=this.getWidgetDataSource("aw-scheda-image");n.hasInstance()?n.updateImages(t):this.one("aw-scheda-image").update(t)}var i={icon:t.icon,title:{main:{text:t.title||t.label,classes:"bold"}},tools:t.subTitle,actions:{}};this.one("aw-scheda-inner-title").update(i),this.one("aw-scheda-metadata").updateOptions({labels:this.configuration.get("labels"),metadataToExclude:this.configuration.get("scheda-layout")["metadata-to-exclude"]}),this.one("aw-scheda-metadata").update(t);var r={items:[]};t.breadcrumbs&&(t.breadcrumbs.forEach((function(t){r.items.push({label:t.label,anchor:{href:[e.configuration.get("paths").schedaBasePath,t.link+"/",L.slugify(t.label)].join("")}})})),this.one("aw-scheda-breadcrumbs").update(r)),this.mainState.update("headTitle","Arianna Web > Patrimonio > "+(t.title||t.label))}t.relatedItems&&(this.one("aw-linked-objects").updateOptions({context:"scheda",config:this.configuration}),this.one("aw-linked-objects").update(t)),setTimeout((function(){e.stickyControlTrigger$.next()}))},e.prototype.collapseSidebar=function(){this.sidebarCollapsed=!this.sidebarCollapsed},e.prototype._sidebarStickyControl=function(){var t=this;if(!L.browserIsIE()){var e=r.fromEvent(window,"scroll");r.merge(e,this.stickyControlTrigger$).pipe(o.takeUntil(this.destroyed$)).subscribe((function(){var e=window.pageYOffset,a=window.scrollY+window.innerHeight,n=document.getElementsByClassName("sticky-parent")[0],i=n.offsetTop,r=i+n.clientHeight;t.sidebarIsSticky=i<=e,t.sidebarIsSticky&&a<r?t.treeMaxHeight=a-e-50+"px":t.sidebarIsSticky&&a>=r?t.treeMaxHeight=r-e-50+"px":t.treeMaxHeight=a<r?a-i-50+"px":r-i-50+"px"}))}},e.tree=null,e}(u.LayoutDataSource);var oe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new r.Subject,e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-scheda-layout.init":t.dataSource.onInit(n),t.configuration=n.configuration,t.route=n.route;var i=t.route.snapshot.params.id||"";i&&(t.dataSource.currentId=i),t.listenRoute(),t.loadNavigation(i),t.emitOuter("viewleaf");break;case"aw-scheda-layout.destroy":t.destroyed$.next(),t.dataSource.onDestroy()}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-bubble-chart.d3end":t.emitOuter("d3end",n);break;case"aw-sidebar-header.click":t.dataSource.collapseSidebar();break;case"aw-bubble-chart.bubble-tooltip-goto-click":var i=n.id,r=n.label;t.emitGlobal("navigate",{handler:"router",path:[t.configuration.get("paths").entitaBasePath,i,L.slugify(r),"overview"]})}}))},e.prototype.listenRoute=function(){var t=this;this.route.paramMap.subscribe((function(e){var a=e.get("id");a&&(a&&(t.dataSource.currentId=a,t.emitOuter("routechanged",a)),t.dataSource.contentIsLoading=!0,t.dataSource.loadItem(a).subscribe((function(e){t.dataSource.contentIsLoading=!1,e&&(t.dataSource.loadContent(e),Array.isArray(e.relatedEntities)&&e.relatedEntities.length&&t.dataSource.bubblesEnabled&&(e.relatedEntities.forEach((function(t){t.entity.relationName=e.label.length>30?e.label.substr(0,30)+"... ":e.label})),t.emitOuter("filterbubbleresponse",e.relatedEntities)))})))}))},e.prototype.loadNavigation=function(t){var e=this;this.dataSource.updateNavigation("Loading..."),this.dataSource.getNavigation("patrimonio").subscribe((function(a){a&&(e.dataSource.setTree(a),e.dataSource.updateNavigation(e.dataSource.getTree().label),e.emitOuter("navigationresponse",{tree:e.dataSource.getTree(),currentItem:t,basePath:e.configuration.get("paths").schedaBasePath}))}))},e}(l.EventHandler);var se={layoutId:"aw-scheda-layout",widgets:[{id:"aw-sidebar-header"},{id:"aw-tree"},{id:"aw-scheda-breadcrumbs"},{id:"aw-scheda-metadata"},{id:"aw-scheda-image"},{id:"aw-scheda-inner-title"},{id:"aw-bubble-chart"},{id:"aw-chart-tippy"},{id:"aw-linked-objects"}],layoutDS:re,layoutEH:oe,widgetsDataSources:Ht,widgetsEventHandlers:Zt,options:{}},ce=function(t){function a(e,a,n,i,r,o,s){var c=t.call(this,i.get("AwPatrimonioLayoutConfig")||se)||this;return c.router=e,c.route=a,c.configuration=n,c.layoutsConfiguration=i,c.mainState=r,c.titleService=o,c.communication=s,c}return m(a,t),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,communication:this.communication,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"aw-scheda-layout",template:'<div class="aw-scheda"\n     id="scheda-layout">\n    <div class="aw-scheda__content n7-side-auto-padding sticky-parent"\n         [ngClass]="{ \'is-collapsed\' : lb.dataSource.sidebarCollapsed }">\n        \x3c!-- Left sidebar: tree --\x3e\n        <div class="aw-scheda__tree sticky-target"\n             [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <n7-sidebar-header [data]="lb.widgets[\'aw-sidebar-header\'].ds.out$ | async"\n                               [emit]="lb.widgets[\'aw-sidebar-header\'].emit"></n7-sidebar-header>\n            <div class="aw-scheda__tree-content-loading"\n                 *ngIf="!(lb.widgets[\'aw-tree\'].ds.out$ | async)">\n                <n7-content-placeholder *ngFor="let n of [0,1,2,3]"\n                                        [data]="{\n                    blocks: [{\n                        classes: \'tree-placeholder-item\'\n                    }]\n                }"></n7-content-placeholder>\n            </div>\n            <div class="aw-scheda__tree-content"\n                 (click)="lb.eventHandler.emitOuter(\'treeposition\', $event)"\n                 [ngStyle]="{\n                    \'max-height\': lb.dataSource.treeMaxHeight,\n                    \'overflow\': \'auto\'\n                }">\n                <n7-tree [data]="lb.widgets[\'aw-tree\'].ds.out$ | async"\n                         [emit]="lb.widgets[\'aw-tree\'].emit"\n                         *ngIf="!lb.dataSource.sidebarCollapsed">\n                </n7-tree>\n            </div>\n        </div>\n\n        \x3c!-- Scheda details --\x3e\n        <div class="aw-scheda__scheda-wrapper-loading"\n             [hidden]="!lb.dataSource.contentIsLoading">\n            \x3c!--\n                <n7-content-placeholder [data]="{\n                blocks: [{\n                    classes: \'content-placeholder-title\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }, {\n                    classes: \'content-placeholder-item-preview\'\n                }]\n            }"></n7-content-placeholder>\n            --\x3e\n        </div>\n        <div class="aw-scheda__scheda-wrapper"\n             [hidden]="lb.dataSource.contentIsLoading">\n            <n7-smart-breadcrumbs *ngIf="lb.dataSource.hasBreadcrumb"\n                                  [data]="lb.widgets[\'aw-scheda-breadcrumbs\'].ds.out$ | async"\n                                  [emit]="lb.widgets[\'aw-scheda-breadcrumbs\'].emit">\n            </n7-smart-breadcrumbs>\n\n            <div *ngIf="!lb.dataSource.hasBreadcrumb"\n                 class="aw-scheda__fake-breadcrumbs">\n            </div>\n\n            <div *ngIf="!lb.dataSource.currentId"\n                 class="aw-scheda__intro-text"\n                 [innerHTML]="lb.dataSource.emptyLabel">\n            </div>\n\n            <n7-inner-title [data]="lb.widgets[\'aw-scheda-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n\n            <n7-image-viewer [hidden]="!lb.dataSource.hasImage"\n                             [data]="lb.widgets[\'aw-scheda-image\'].ds.out$ | async">\n            </n7-image-viewer>\n\n            <section class="aw-scheda__description"\n                     *ngIf="lb.dataSource.contentParts.content">\n                <div *ngFor="let part of lb.dataSource.contentParts">\n                    <div [innerHTML]="part.content"></div>\n                </div>\n            </section>\n\n            <section class="aw-scheda__metadata"\n                     *ngIf="lb.dataSource.hasMetadata">\n                <div class="aw-scheda__inner-title">\n                    {{lb.dataSource.metadataSectionTitle}}\n                </div>\n                <n7-metadata-viewer [data]="lb.widgets[\'aw-scheda-metadata\'].ds.out$ | async">\n                </n7-metadata-viewer>\n            </section>\n\n            <section class="aw-scheda__bubble-chart"\n                     *ngIf="lb.dataSource.bubblesEnabled && lb.dataSource.hasBubbles">\n                <div *ngIf="lb.dataSource.hasBubbles"\n                     class="aw-scheda__inner-title">\n                    {{lb.dataSource.bubbleChartSectionTitle}}\n                </div>\n                <aw-bubble-chart-wrapper>\n                    <aw-chart-tippy [data]="lb.widgets[\'aw-chart-tippy\'].ds.out$ | async"\n                                    [emit]="lb.widgets[\'aw-chart-tippy\'].emit">\n                    </aw-chart-tippy>\n                    <n7-bubble-chart [data]="lb.widgets[\'aw-bubble-chart\'].ds.out$ | async"\n                                     [emit]="lb.widgets[\'aw-bubble-chart\'].emit">\n                    </n7-bubble-chart>\n                </aw-bubble-chart-wrapper>\n            </section>\n\n            <section *ngIf="lb.dataSource.hasSimilarItems && lb.dataSource.hasBubbles"\n                     id="related-item-container"\n                     class="aw-scheda__related">\n                <div class="aw-scheda__inner-title">\n                    {{lb.dataSource.similarItemsSectionTitle}}\n                </div>\n                <div class="aw-scheda__related-items n7-grid-2">\n                    <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <n7-item-preview [data]="preview"\n                                         [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                        </n7-item-preview>\n                    </ng-container>\n                </div>\n            </section>\n        </div>\n    </div>\n</div>\n'}]}],a.ctorParameters=function(){return[{type:s.Router},{type:s.ActivatedRoute},{type:S},{type:_},{type:k},{type:c.Title},{type:C}]},a}(x);var le={totalCount:0,facets:[{id:"query",type:"value"},{id:"query-all",type:"value",hasStaticData:!0,data:[{value:"1",label:"Cerca in tutti campi delle schede"}]},{id:"query-links",type:"value"},{id:"entity-types",type:"value",operator:"OR",limit:10,order:"count"},{id:"entity-search",type:"value"},{id:"entity-links",type:"value",searchData:["entity-type"]}],fields:[{inputs:[{type:"text",facetId:"query",placeholder:"Cerca nei titoli delle schede",filterConfig:{delay:500,minChars:3,searchIn:[{key:"label.ngrams",operator:"LIKE"}]}},{type:"checkbox",facetId:"query-all",filterConfig:{searchIn:[{key:"label.ngrams^5,text^4,fields.*^3",operator:"="}]}},{type:"link",facetId:"query-links",filterConfig:{isArray:!0,searchIn:[{key:"source.entityType",operator:"="}]}}]},{header:{label:"Relazione con",classes:"related-class"},inputs:[{type:"checkbox",facetId:"entity-types",filterConfig:{isArray:!0,context:"internal",target:"entity-links",searchIn:[{key:"searchData.entity-type",operator:"="}]}},{type:"text",facetId:"entity-search",placeholder:"Cerca entità",filterConfig:{delay:500,minChars:3,context:"internal",target:"entity-links",searchIn:[{key:"label",operator:"LIKE"}]}},{type:"link",facetId:"entity-links",emptyState:{label:"La tua ricerca non ha dato risultati, prova a cambiare i filtri"},filterConfig:{isArray:!0,limit:20,searchIn:[{key:"relatedEntities.id",operator:"="}]}}]}],results:{order:{type:"score",key:"_score",direction:"DESC"},fields:[{id:"description",highlight:!0,limit:200}]},page:{offset:0,limit:10}},ue=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new r.Subject,e.resetButtonEnabled=!0,e.currentPage=1,e.pageSize=10,e.sidebarIsSticky=!1,e.isFirstLoading=!0,e.resultsLoading=!1,e.orderBy="_score",e.orderDirection="DESC",e.orderByLabel="Ordina per",e.orderByOptions=[{value:"_score_DESC",label:"Ordine per pertinenza",type:"score",selected:!0},{value:"label_sort_ASC",label:"Ordine alfabetico (A→Z)",type:"text",selected:!1},{value:"label_sort_DESC",label:"Ordine alfabetico (Z→A)",type:"text",selected:!1}],e.drawPagination=function(){var t=e._getPaginationParams(),a=t.href,n=t.queryParams;e.one("n7-smart-pagination").updateOptions({mode:"href",href:a,queryParams:n}),e.one("n7-smart-pagination").update({totalPages:Math.ceil(e.totalCount/e.pageSize),currentPage:e.currentPage,pageLimit:5,sizes:{list:[10,25,50],active:e.pageSize}})},e.getSearchModelId=function(){return"aw-search-layout"},e}return m(e,t),e.prototype.onInit=function(t){var e=t.configuration,a=t.mainState,n=t.options,i=t.communication,r=t.search;this.configuration=e,this.mainState=a,this.communication=i,this.search=r,this.options=n,this.prettifyLabels=this.configuration.get("labels"),this.configKeys=this.configuration.get("config-keys"),this.fallback=this.configuration.get("search-layout").fallback,this.pageTitle=this.configuration.get("search-layout").title,this.search.model("aw-search-layout")&&this.search.remove("aw-search-layout"),this.search.add("aw-search-layout",p.cloneDeep(le)),this.searchModel=this.search.model("aw-search-layout"),B.queryParams&&(this.searchModel.updateFiltersFromQueryParams(B.queryParams),B.queryParams=null),this._sidebarStickyControl(),this.mainState.updateCustom("currentNav","ricerca"),this.mainState.update("headTitle","Arianna Web > Ricerca")},e.prototype.onDestroy=function(){this.destroyed$.next(),B.queryParams=null},e.prototype.onSearchResponse=function(){this.resetButtonEnabled=!0,this.isFirstLoading&&(this.isFirstLoading=!1,this.one("facets-wrapper").update({searchModel:this.searchModel}),this.searchModel.updateInputsFromFilters())},e.prototype.onOrderByChange=function(t){var e=t.substring(0,t.lastIndexOf("_")),a=t.substring(t.lastIndexOf("_")+1),n="";this.orderByOptions.forEach((function(e){e.value===t?(e.selected=!0,n=e.type):e.selected=!1})),this.orderBy=e,this.orderDirection=a,this.searchModel.setSearchConfigOrderBy(e),this.searchModel.setSearchConfigDirection(a),this.searchModel.setSearchConfigType(n)},e.prototype.onPageSizeChange=function(t){return this.pageSize=t,this._updateSearchPage(this.currentPage)},e.prototype.onPaginationChange=function(t){var e=t.replace("page-","");return this._updateSearchPage(e)},e.prototype.onPaginationGoToChange=function(t){var e=t.replace("goto-","");return this._updateSearchPage(e)},e.prototype.resetPagination=function(){this._updateSearchPage(1)},e.prototype.onResultsLimitChange=function(t){this.setLimit(t),this.currentPage=1,this.searchModel.setPageConfigOffset(0)},e.prototype.setLimit=function(t){this.pageSize=t,this.searchModel.setPageConfigLimit(t),this.searchModel.setPageConfigOffset((this.currentPage-1)*this.pageSize)},e.prototype.doSearchRequest$=function(){var t=this,e=this.searchModel.getRequestParams(),a={searchParameters:b({totalCount:100},e)};return this.communication.request$("search",{onError:function(t){return console.error(t)},params:a}).pipe(o.tap((function(e){var a=e.totalCount,n=e.results,i=e.facets;t.totalCount=a;var r=0;t.totalCount>1?r=2:1===t.totalCount&&(r=1),t.resultsTitle=t.configuration.get("search-layout").results[r],t._addFacetsLabels(i),t._addFacetsOptions(i),t.searchModel.updateFacets(i),t.searchModel.updateTotalCount(a),t.one("aw-linked-objects").updateOptions({context:"search",config:t.configuration,page:t.currentPage,pagination:!0,paginationParams:t._getPaginationParams(),dynamicPagination:{total:a},size:t.pageSize}),t.drawPagination(),t.one("aw-linked-objects").update({items:t._normalizeItems(n.items)})})))},e.prototype._updateSearchPage=function(t){if(+t===this.currentPage)return r.of(!1);this.currentPage=+t;var e=this.searchModel.getConfig().page.limit,a=(this.currentPage-1)*e;return this.searchModel.setPageConfigOffset(a),r.of(!0)},e.prototype._addFacetsLabels=function(t){var e=this;t.filter((function(t){return Array.isArray(t.data)})).forEach((function(t){t.data.forEach((function(t){var a=t.label;t.label=L.prettifySnakeCase(a,e.prettifyLabels[a])}))}))},e.prototype._addFacetsOptions=function(t){var e=this;t.filter((function(t){return"query-links"===t.id})).forEach((function(t){t.data.forEach((function(t){var a=e.configKeys[t.value];a&&(t.options={icon:a.icon,classes:"color-"+a["class-name"]})}))}))},e.prototype._normalizeItems=function(t){return t.map((function(t){return{item:b({},t)}}))},e.prototype._sidebarStickyControl=function(){var t=this;L.browserIsIE()||r.fromEvent(window,"scroll").pipe(o.takeUntil(this.destroyed$)).subscribe((function(){var e=window.pageYOffset,a=document.getElementsByClassName("sticky-parent")[0],n=a?a.offsetTop:0;t.sidebarIsSticky=n<=e}))},e.prototype._getPaginationParams=function(){var t=this.searchModel.getRequestParams(),e=this.searchModel.filtersAsQueryParams(t.filters);return Object.keys(e).forEach((function(t){e[t]=e[t]||null})),e.orderby=this.orderBy,e.orderdirection=this.orderDirection,e.page=this.currentPage,e.limit=this.pageSize,{queryParams:e,href:this.configuration.get("paths").searchBasePath}},e}(u.LayoutDataSource);var de=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new r.Subject,e.facetsChange$=new r.Subject,e.aditionalParamsChange$=new r.Subject,e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-search-layout.init":t.route=n.route,t.configuration=n.configuration,t.dataSource.onInit(n),t._listenToFacetsChange(),t._listenToAditionalParamsChange(),t._listenToRouterChanges();break;case"aw-search-layout.destroy":t.dataSource.onDestroy(),t.destroyed$.next();break;case"aw-search-layout.orderbychange":t.dataSource.onOrderByChange(n),t.aditionalParamsChange$.next();break;case"aw-search-layout.searchreset":t.dataSource.resetButtonEnabled=!1,t.dataSource.searchModel.clear(),t.aditionalParamsChange$.next();break;default:console.warn("(search) unhandled inner event of type",a)}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"facets-wrapper.facetschange":t.dataSource.resetPagination();break;case"n7-smart-pagination.change":t.dataSource.onResultsLimitChange(n.value),t.aditionalParamsChange$.next()}}))},e.prototype._listenToFacetsChange=function(){var t=this;this.facetsChange$.pipe(o.debounceTime(500)).subscribe((function(){t.dataSource.resultsLoading=!0,t.dataSource.doSearchRequest$().subscribe((function(){t.dataSource.resultsLoading=!1,t.dataSource.onSearchResponse(),t.emitGlobal("searchresponse",t.dataSource.getSearchModelId())}))}))},e.prototype._listenToAditionalParamsChange=function(){var t=this;this.aditionalParamsChange$.subscribe((function(){var e=t.dataSource.searchModel,a=e.getRequestParams(),n=e.filtersAsQueryParams(a.filters);Object.keys(n).forEach((function(t){n[t]=n[t]||null})),n.orderby=t.dataSource.orderBy,n.orderdirection=t.dataSource.orderDirection,n.page=t.dataSource.currentPage,n.limit=t.dataSource.pageSize,t.emitGlobal("navigate",{handler:"router",path:[],queryParams:n})}))},e.prototype._listenToRouterChanges=function(){var t=this;this.route.queryParams.pipe(o.takeUntil(this.destroyed$)).subscribe((function(e){t.emitOuter("queryparamschange",e),e.orderby&&e.orderdirection&&t.dataSource.onOrderByChange(e.orderby+"_"+e.orderdirection),e.page&&t.dataSource.onPaginationChange("page-"+e.page),e.limit&&t.dataSource.setLimit(+e.limit),t.facetsChange$.next()}))},e}(l.EventHandler);var pe={layoutId:"aw-search-layout",widgets:[{id:"facets-wrapper",dataSource:W,eventHandler:J},{id:"aw-linked-objects"},{id:"aw-search-layout-tabs",hasStaticData:!0},{id:"n7-smart-pagination",dataSource:U,eventHandler:et}],layoutDS:ue,layoutEH:de,widgetsDataSources:Ht,widgetsEventHandlers:Zt,options:{}},he=function(t){function a(e,a,n,i,r,o){var s=t.call(this,a.get("AwSearchLayoutConfig")||pe)||this;return s.configuration=e,s.layoutsConfiguration=a,s.mainState=n,s.communication=i,s.search=r,s.route=o,s}return m(a,t),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,communication:this.communication,search:this.search,route:this.route,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"aw-search-layout",template:'<div class="aw-search n7-side-auto-padding" id="search-layout">\n    <div class="aw-search__header">\n        <div class="aw-search__header-left">\n            <h1 class="aw-search__header-title">{{ lb.dataSource.pageTitle }}</h1>\n        </div>\n        \x3c!--\n        <div class="aw-search__header-right">\n            <n7-nav\n                [data]="lb.widgets[\'aw-search-layout-tabs\'].ds.out$ | async"\n                [emit]="lb.widgets[\'aw-search-layout-tabs\'].emit">\n            </n7-nav>\n        </div>\n        --\x3e\n    </div>\n    <div class="aw-search__content-wrapper sticky-parent">\n        \x3c!-- Left sidebar: facets --\x3e\n        <div *ngIf="!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)" class="aw-search__sidebar-loading sticky-target">\n            <div class="aw-search__facets-loading">\n                <n7-content-placeholder [data]="{\n                    blocks: [{\n                        classes: \'search-placeholder-facet-input\'\n                    }, {\n                        classes: \'search-placeholder-facet-check\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }]\n                }">\n                </n7-content-placeholder>\n            </div>\n        </div>\n        <div *ngIf="!!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)" class="aw-search__sidebar sticky-target"\n            [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <div class="aw-search__facets">\n                <n7-facets-wrapper [data]="lb.widgets[\'facets-wrapper\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'facets-wrapper\'].emit">\n                </n7-facets-wrapper>\n            </div>\n        </div>\n        <div class="aw-search__content">\n            <div class="aw-search__results-header">\n                <div class="aw-search__results-header-left">\n                    <h3 *ngIf="!lb.dataSource.resultsLoading" class="aw-search__total">\n                        <span class="aw-search__total-number">{{ lb.dataSource.totalCount }}</span>&nbsp;\n                        <span class="aw-search__total-title">{{ lb.dataSource.resultsTitle }}</span>\n                    </h3>\n                </div>\n                <div class="aw-search__results-header-right">\n                    <label class="aw-search__results-select-orderby-label"\n                        for="aw-search__results-select-orderby">{{ lb.dataSource.orderByLabel }}</label>\n                    <select (change)="lb.eventHandler.emitInner(\'orderbychange\', $event.target.value)"\n                        id="aw-search__results-select-orderby">\n                        <option *ngFor="let option of lb.dataSource.orderByOptions" [value]="option.value"\n                            [selected]="option.selected">\n                            {{ option.label }}</option>\n                    </select>\n                </div>\n            </div>\n            \x3c!-- Search details --\x3e\n            <div *ngIf="lb.dataSource.resultsLoading" class="aw-search__results-wrapper-loading">\n                <n7-content-placeholder *ngFor="let n of [0,1,2,3,4,5,6,7,8,9]" [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n            </div>\n            <div *ngIf="!lb.dataSource.resultsLoading" class="aw-search__results-wrapper">\n                <ng-container *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                    <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                    </n7-smart-breadcrumbs>\n                    <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                    </n7-item-preview>\n                </ng-container>\n                <ng-container *ngIf="lb.dataSource.totalCount == 0">\n                    <div class="aw-search__fallback">\n                        <p class="aw-search__fallback-string">\n                            {{ lb.dataSource.fallback }}\n                        </p>\n                        <button [disabled]="!lb.dataSource.resetButtonEnabled" class="n7-btn aw-search__fallback-button"\n                            (click)="lb.eventHandler.emitInner(\'searchreset\', {})">\n                            Resetta la ricerca\n                        </button>\n                    </div>\n                </ng-container>\n                <n7-smart-pagination *ngIf="lb.dataSource.totalCount > 10"\n                    [data]="lb.widgets[\'n7-smart-pagination\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'n7-smart-pagination\'].emit">\n                </n7-smart-pagination>\n            </div>\n        </div>\n    </div>\n</div>'}]}],a.ctorParameters=function(){return[{type:S},{type:_},{type:k},{type:C},{type:B},{type:s.ActivatedRoute}]},a}(x);var fe={totalCount:0,facets:[{id:"query",type:"value"},{id:"query-all",type:"value",hasStaticData:!0,data:[{value:"1",label:"Cerca in tutti campi delle schede"}]},{id:"entity-types",type:"value",operator:"OR",limit:10,order:"count"},{id:"entity-search",type:"value"},{id:"entity-links",type:"value",searchData:["entity-type"]}],fields:[{inputs:[{type:"text",facetId:"query",placeholder:"Cerca nei titoli delle schede",filterConfig:{delay:500,minChars:3,searchIn:[{key:"label.ngrams",operator:"LIKE"}]}},{type:"checkbox",facetId:"query-all",filterConfig:{searchIn:[{key:"label.ngrams^5,text^4,fields.*^3",operator:"="}]}}]},{header:{label:"Relazione con",classes:"related-class"},inputs:[{type:"checkbox",facetId:"entity-types",filterConfig:{isArray:!0,context:"internal",target:"entity-links",searchIn:[{key:"searchData.entity-type",operator:"="}]}},{type:"text",facetId:"entity-search",placeholder:"Cerca entità",filterConfig:{delay:500,minChars:3,context:"internal",target:"entity-links",searchIn:[{key:"label",operator:"LIKE"}]}},{type:"link",facetId:"entity-links",emptyState:{label:"La tua ricerca non ha dato risultati, prova a cambiare i filtri"},filterConfig:{isArray:!0,limit:20,searchIn:[{key:"relatedEntities.id",operator:"="}]}}]}],results:{order:{type:"score",key:"_score",direction:"DESC"},fields:[{id:"description",highlight:!0,limit:200}]},page:{offset:0,limit:12}},ge=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new r.Subject,e.resetButtonEnabled=!0,e.currentPage=1,e.pageSize=12,e.sidebarIsSticky=!1,e.isFirstLoading=!0,e.resultsLoading=!1,e.orderBy="_score",e.orderDirection="DESC",e.orderByLabel="Ordina per",e.orderByOptions=[{value:"_score_DESC",label:"Ordine per pertinenza",type:"score",selected:!0},{value:"label_sort_ASC",label:"Ordine alfabetico (A→Z)",type:"text",selected:!1},{value:"label_sort_DESC",label:"Ordine alfabetico (Z→A)",type:"text",selected:!1}],e.drawPagination=function(){var t=e._getPaginationParams(),a=t.href,n=t.queryParams;e.one("n7-smart-pagination").updateOptions({mode:"href",href:a,queryParams:n}),e.one("n7-smart-pagination").update({totalPages:Math.ceil(e.totalCount/e.pageSize),currentPage:e.currentPage,pageLimit:5,sizes:{list:[12,24,48],active:e.pageSize}})},e.getSearchModelId=function(){return"aw-gallery-layout"},e}return m(e,t),e.prototype.onInit=function(t){var e=t.configuration,a=t.mainState,n=t.options,i=t.communication,r=t.search;this.configuration=e,this.mainState=a,this.communication=i,this.search=r,this.options=n,this.prettifyLabels=this.configuration.get("labels"),this.configKeys=this.configuration.get("config-keys"),this.fallback=this.configuration.get("gallery-layout").fallback,this.pageTitle=this.configuration.get("gallery-layout").title,this.search.model("aw-gallery-layout")&&this.search.remove("aw-gallery-layout"),this.search.add("aw-gallery-layout",p.cloneDeep(fe)),this.searchModel=this.search.model("aw-gallery-layout"),B.queryParams&&(this.searchModel.updateFiltersFromQueryParams(B.queryParams),B.queryParams=null),this._sidebarStickyControl(),this.mainState.updateCustom("currentNav","galleria"),this.mainState.update("headTitle","Arianna Web > Galleria")},e.prototype.onDestroy=function(){this.destroyed$.next(),B.queryParams=null},e.prototype.onSearchResponse=function(){this.resetButtonEnabled=!0,this.isFirstLoading&&(this.isFirstLoading=!1,this.one("facets-wrapper").update({searchModel:this.searchModel}),this.searchModel.updateInputsFromFilters())},e.prototype.onOrderByChange=function(t){var e=t.substring(0,t.lastIndexOf("_")),a=t.substring(t.lastIndexOf("_")+1),n="";this.orderByOptions.forEach((function(e){e.value===t?(e.selected=!0,n=e.type):e.selected=!1})),this.orderBy=e,this.orderDirection=a,this.searchModel.setSearchConfigOrderBy(e),this.searchModel.setSearchConfigDirection(a),this.searchModel.setSearchConfigType(n)},e.prototype.onPageSizeChange=function(t){return this.pageSize=t,this._updateSearchPage(this.currentPage)},e.prototype.onPaginationChange=function(t){var e=t.replace("page-","");return this._updateSearchPage(e)},e.prototype.onPaginationGoToChange=function(t){var e=t.replace("goto-","");return this._updateSearchPage(e)},e.prototype.resetPagination=function(){this._updateSearchPage(1)},e.prototype.onResultsLimitChange=function(t){this.setLimit(t),this.currentPage=1,this.searchModel.setPageConfigOffset(0)},e.prototype.setLimit=function(t){this.pageSize=t,this.searchModel.setPageConfigLimit(t),this.searchModel.setPageConfigOffset((this.currentPage-1)*this.pageSize)},e.prototype.doSearchRequest$=function(){var t=this,e=this.searchModel.getRequestParams(),a={searchParameters:b({totalCount:100,gallery:!0},e)};return this.communication.request$("search",{onError:function(t){return console.error(t)},params:a}).pipe(o.tap((function(e){var a=e.totalCount,n=e.results,i=e.facets;t.totalCount=a;var r=0;t.totalCount>1?r=2:1===t.totalCount&&(r=1),t.resultsTitle=t.configuration.get("gallery-layout").results[r],t._addFacetsLabels(i),t._addFacetsOptions(i),t.searchModel.updateFacets(i),t.searchModel.updateTotalCount(a),t.one("aw-linked-objects").updateOptions({context:"gallery",config:t.configuration,page:t.currentPage,pagination:!0,paginationParams:t._getPaginationParams(),dynamicPagination:{total:a},size:t.pageSize}),t.drawPagination(),t.one("aw-linked-objects").update({items:t._normalizeItems(n.items)})})))},e.prototype._updateSearchPage=function(t){if(+t===this.currentPage)return r.of(!1);this.currentPage=+t;var e=this.searchModel.getConfig().page.limit,a=(this.currentPage-1)*e;return this.searchModel.setPageConfigOffset(a),r.of(!0)},e.prototype._addFacetsLabels=function(t){var e=this;t.filter((function(t){return Array.isArray(t.data)})).forEach((function(t){t.data.forEach((function(t){var a=t.label;t.label=L.prettifySnakeCase(a,e.prettifyLabels[a])}))}))},e.prototype._addFacetsOptions=function(t){var e=this;t.filter((function(t){return"query-links"===t.id})).forEach((function(t){t.data.forEach((function(t){var a=e.configKeys[t.value];a&&(t.options={icon:a.icon,classes:"color-"+a["class-name"]})}))}))},e.prototype._normalizeItems=function(t){return t.map((function(t){return{item:b({},t)}}))},e.prototype._sidebarStickyControl=function(){var t=this;L.browserIsIE()||r.fromEvent(window,"scroll").pipe(o.takeUntil(this.destroyed$)).subscribe((function(){var e=window.pageYOffset,a=document.getElementsByClassName("sticky-parent")[0],n=a?a.offsetTop:0;t.sidebarIsSticky=n<=e}))},e.prototype._getPaginationParams=function(){var t=this.searchModel.getRequestParams(),e=this.searchModel.filtersAsQueryParams(t.filters);return Object.keys(e).forEach((function(t){e[t]=e[t]||null})),e.orderby=this.orderBy,e.orderdirection=this.orderDirection,e.page=this.currentPage,e.limit=this.pageSize,{queryParams:e,href:this.configuration.get("paths").galleryBasePath}},e}(u.LayoutDataSource);var ye=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyed$=new r.Subject,e.facetsChange$=new r.Subject,e.aditionalParamsChange$=new r.Subject,e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"aw-gallery-layout.init":t.route=n.route,t.configuration=n.configuration,t.dataSource.onInit(n),t._listenToFacetsChange(),t._listenToAditionalParamsChange(),t._listenToRouterChanges();break;case"aw-gallery-layout.destroy":t.dataSource.onDestroy(),t.destroyed$.next();break;case"aw-gallery-layout.orderbychange":t.dataSource.onOrderByChange(n),t.aditionalParamsChange$.next();break;case"aw-gallery-layout.searchreset":t.dataSource.resetButtonEnabled=!1,t.dataSource.searchModel.clear(),t.aditionalParamsChange$.next();break;default:console.warn("(search) unhandled inner event of type",a)}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"facets-wrapper.facetschange":t.dataSource.resetPagination();break;case"n7-smart-pagination.change":t.dataSource.onResultsLimitChange(n.value),t.aditionalParamsChange$.next()}}))},e.prototype._listenToFacetsChange=function(){var t=this;this.facetsChange$.pipe(o.debounceTime(500)).subscribe((function(){t.dataSource.resultsLoading=!0,t.dataSource.doSearchRequest$().subscribe((function(){t.dataSource.resultsLoading=!1,t.dataSource.onSearchResponse(),t.emitGlobal("searchresponse",t.dataSource.getSearchModelId())}))}))},e.prototype._listenToAditionalParamsChange=function(){var t=this;this.aditionalParamsChange$.subscribe((function(){var e=t.dataSource.searchModel,a=e.getRequestParams(),n=e.filtersAsQueryParams(a.filters);Object.keys(n).forEach((function(t){n[t]=n[t]||null})),n.orderby=t.dataSource.orderBy,n.orderdirection=t.dataSource.orderDirection,n.page=t.dataSource.currentPage,n.limit=t.dataSource.pageSize,t.emitGlobal("navigate",{handler:"router",path:[],queryParams:n})}))},e.prototype._listenToRouterChanges=function(){var t=this;this.route.queryParams.pipe(o.takeUntil(this.destroyed$)).subscribe((function(e){t.emitOuter("queryparamschange",e),e.orderby&&e.orderdirection&&t.dataSource.onOrderByChange(e.orderby+"_"+e.orderdirection),e.page&&t.dataSource.onPaginationChange("page-"+e.page),e.limit&&t.dataSource.setLimit(+e.limit),t.facetsChange$.next()}))},e}(l.EventHandler);var me={layoutId:"aw-gallery-layout",widgets:[{id:"facets-wrapper",dataSource:W,eventHandler:J},{id:"aw-linked-objects"},{id:"aw-search-layout-tabs",hasStaticData:!0},{id:"n7-smart-pagination",dataSource:U,eventHandler:et}],layoutDS:ge,layoutEH:ye,widgetsDataSources:Ht,widgetsEventHandlers:Zt,options:{}},be=function(t){function a(e,a,n,i,r,o,s,c){var l=t.call(this,me)||this;return l.router=e,l.configuration=a,l.titleService=n,l.layoutsConfiguration=i,l.mainState=r,l.communication=o,l.search=s,l.route=c,l}return m(a,t),a.prototype.initPayload=function(){return{configuration:this.configuration,mainState:this.mainState,router:this.router,route:this.route,titleService:this.titleService,communication:this.communication,options:this.config.options||{},search:this.search}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"aw-gallery-layout",template:'<div class="aw-search aw-gallery n7-side-auto-padding" id="gallery-layout">\n    <div class="aw-search__header">\n        <div class="aw-search__header-left">\n            <h1 class="aw-search__header-title">{{ lb.dataSource.pageTitle }}</h1>\n        </div>\n    </div>\n    <div class="aw-search__content-wrapper sticky-parent">\n        \x3c!-- Left sidebar: facets --\x3e\n        <div *ngIf="!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)" class="aw-search__sidebar-loading sticky-target">\n            <div class="aw-search__facets-loading">\n                <n7-content-placeholder [data]="{\n                    blocks: [{\n                        classes: \'search-placeholder-facet-input\'\n                    }, {\n                        classes: \'search-placeholder-facet-check\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }, {\n                        classes: \'search-placeholder-facet-item\'\n                    }]\n                }">\n                </n7-content-placeholder>\n            </div>\n        </div>\n        <div *ngIf="!!(lb.widgets[\'facets-wrapper\'].ds.out$ | async)" class="aw-search__sidebar sticky-target"\n            [ngClass]="{ \'is-sticky\': lb.dataSource.sidebarIsSticky }">\n            <div class="aw-search__facets">\n                <n7-facets-wrapper [data]="lb.widgets[\'facets-wrapper\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'facets-wrapper\'].emit">\n                </n7-facets-wrapper>\n            </div>\n        </div>\n        <div class="aw-search__content">\n            <div class="aw-search__results-header">\n                <div class="aw-search__results-header-left">\n                    <h3 *ngIf="!lb.dataSource.resultsLoading" class="aw-search__total">\n                        <span class="aw-search__total-number">{{ lb.dataSource.totalCount }}</span>&nbsp;\n                        <span class="aw-search__total-title">{{ lb.dataSource.resultsTitle }}</span>\n                    </h3>\n                </div>\n                <div class="aw-search__results-header-right">\n                    <label class="aw-search__results-select-orderby-label"\n                        for="aw-search__results-select-orderby">{{ lb.dataSource.orderByLabel }}</label>\n                    <select (change)="lb.eventHandler.emitInner(\'orderbychange\', $event.target.value)"\n                        id="aw-search__results-select-orderby">\n                        <option *ngFor="let option of lb.dataSource.orderByOptions" [value]="option.value"\n                            [selected]="option.selected">\n                            {{ option.label }}</option>\n                    </select>\n                </div>\n            </div>\n            \x3c!-- Search details --\x3e\n            <div *ngIf="lb.dataSource.resultsLoading" class="aw-search__results-wrapper-loading">\n                <n7-content-placeholder *ngFor="let n of [0,1,2,3,4,5,6,7,8,9]" [data]="{\n                    blocks: [\n                        { classes: \'search-result-placeholder-title\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' },\n                        { classes: \'search-result-placeholder-metadata\' }\n                    ]\n                }"></n7-content-placeholder>\n            </div>\n            <div *ngIf="!lb.dataSource.resultsLoading" class="aw-search__results-wrapper">\n                <div class="n7-grid-3">\n                    <div *ngFor="let preview of (lb.widgets[\'aw-linked-objects\'].ds.out$ | async)?.previews">\n                        <n7-smart-breadcrumbs [data]="preview.breadcrumbs">\n                        </n7-smart-breadcrumbs>\n                        <n7-item-preview [data]="preview" [emit]="lb.widgets[\'aw-linked-objects\'].emit">\n                        </n7-item-preview>\n                    </div>\n                </div>\n                <ng-container *ngIf="lb.dataSource.totalCount == 0">\n                    <div class="aw-search__fallback">\n                        <p class="aw-search__fallback-string">\n                            {{ lb.dataSource.fallback }}\n                        </p>\n                        <button [disabled]="!lb.dataSource.resetButtonEnabled" class="n7-btn aw-search__fallback-button"\n                            (click)="lb.eventHandler.emitInner(\'searchreset\', {})">\n                            Resetta la ricerca\n                        </button>\n                    </div>\n                </ng-container>\n                <n7-smart-pagination *ngIf="lb.dataSource.totalCount > 10"\n                    [data]="lb.widgets[\'n7-smart-pagination\'].ds.out$ | async"\n                    [emit]="lb.widgets[\'n7-smart-pagination\'].emit">\n                </n7-smart-pagination>\n            </div>\n        </div>\n    </div>\n</div>'}]}],a.ctorParameters=function(){return[{type:s.Router},{type:S},{type:c.Title},{type:_},{type:k},{type:C},{type:B},{type:s.ActivatedRoute}]},a}(x);var ve=function(){function t(){}return t.prototype.onClick=function(t,e){this.emit(t,e)},t.decorators=[{type:e.Component,args:[{selector:"aw-chart-tippy",template:'<div *ngIf="data" style="display: none;">\n  <div *ngFor="let d of data" id="template__{{d.id}}" class="bubble-chart__tippy-template">\n    <div id="bubble-popup-menu" class="aw-bubble-popup-menu">\n      <h2 class="aw-bubble-popup-menu__title">{{ d.title }}</h2>\n      <p class="aw-bubble-popup-menu__text">\n        {{ d.text }}\n      </p>\n\n      <div *ngIf="d.relation.value" class="aw-bubble-popup-menu__relation">\n        <p class="aw-bubble-popup-menu__relation-description">Relazione con \n          <span class="aw-bubble-popup-menu__relation-key">{{d.relation.key}}</span>: \n          <span class="aw-bubble-popup-menu__relation-label"> {{d.relation.value}}</span>\n        </p>\n      </div>\n\n      <div class="aw-bubble-popup-menu__actions">\n        <n7-anchor-wrapper [classes]="\'aw-bubble-popup-menu__link\'" [data]="d.anchorData">\n          Vai alla scheda\n        </n7-anchor-wrapper>\n        <span *ngIf="d.selectable" class="aw-bubble-popup-menu__link" (click)="onClick(\'select\', {id: d.id})">\n          {{ d.isSelected ? \'Deseleziona\' : \'Seleziona\'}}\n        </span>\n      </div>\n    </div>\n  </div>\n</div>'}]}],t.propDecorators={data:[{type:e.Input}],emit:[{type:e.Input}],anchorData:[{type:e.Input}]},t}();var we=function(){function t(){}return t.prototype.onClick=function(t,e){this.emit(t,e)},t.decorators=[{type:e.Component,args:[{selector:"aw-bubble-chart-wrapper",template:'<div class="aw-bubble-chart-wrapper">\n    <ng-content></ng-content>\n</div>'}]}],t.propDecorators={emit:[{type:e.Input}],container:[{type:e.Input}],buttons:[{type:e.Input}]},t}();var Se=function(){function t(){var t=this;this.tippyBuilder=function(t,e){return g(t,{content:e,interactive:!0,arrow:!0,theme:"light-border no-padding",appendTo:document.body})},this.getWidths=function(e,a){var n=e.nativeElement.clientWidth,i=a.nativeElement.clientWidth;return{parentWidth:n-t.getSidePadding(e.nativeElement),childWidth:i}},this.getSidePadding=function(t){return+window.getComputedStyle(t,null).getPropertyValue("padding-left").match(/\d+/)[0]+ +window.getComputedStyle(t,null).getPropertyValue("padding-right").match(/\d+/)[0]}}return t.prototype.ngAfterViewInit=function(){var t;if(this.bcdiv&&this.bcol){var e=this.getWidths(this.bcdiv,this.bcol),a=e.parentWidth,n=e.childWidth,i=this.bcol.nativeElement.children;if(a===n)for(var r=1;a===n&&r<i.length-1;){var o=document.createElement("ol");o.className="n7-smart-breadcrumbs__tippy-content",o.appendChild(i[r].cloneNode(!0)),i[r].children[0].innerText="…",i[r].className="n7-breadcrumbs__item-ellipsis",this.tippyBuilder(i[r],o),r+=1,a=(t=this.getWidths(this.bcdiv,this.bcol)).parentWidth,n=t.childWidth}}},t.prototype.onClick=function(t){this.emit&&this.emit("click",t)},t.decorators=[{type:e.Component,args:[{selector:"n7-smart-breadcrumbs",template:'<div *ngIf="data" class="n7-breadcrumbs {{ data.classes || \'\' }}" #bcdiv>\n    <nav class="n7-breadcrumbs__nav">\n        <ol class="n7-breadcrumbs__list" #bcol>\n            <li *ngFor="let item of data.items" class="n7-breadcrumbs__item {{ item.classes || \'\' }}">\n                <n7-anchor-wrapper [classes]="item.classes"\n                [data]="item.anchor"\n                (clicked)="onClick($event)">\n                    {{ item.label }}\n                </n7-anchor-wrapper>\n            </li>\n        </ol>\n    </nav>\n</div>'}]}],t.propDecorators={data:[{type:e.Input}],emit:[{type:e.Input}],bcol:[{type:e.ViewChild,args:["bcol",{read:e.ElementRef,static:!1}]}],bcdiv:[{type:e.ViewChild,args:["bcdiv",{read:e.ElementRef,static:!1}]}]},t}();var _e={getLastPosts:{queryName:"getLastPosts",queryBody:"\n        {\n          getLastPosts(__PARAMS__) {\n            id\n            title\n          }\n        }\n      "},getTree:{queryName:"getTreeOfItems",queryBody:"\n      {\n        getTreeOfItems{\n          label\n          id\n          img\n          document_type\n          document_classification\n          branches {\n            label\n            id\n            img\n            document_type\n            document_classification\n            branches {\n              label\n              id\n              img\n              document_type\n              document_classification\n              branches {\n                label\n                id\n                img\n                document_type\n                document_classification\n                branches {\n                  label\n                  id\n                  img\n                  document_type\n                  document_classification\n                  branches {\n                    label\n                    id\n                    img\n                    document_type\n                    document_classification\n                    branches {\n                      label\n                      id\n                      img\n                      document_type\n                      document_classification\n                      branches {\n                        label\n                        id\n                        img\n                        document_type\n                        document_classification\n                        branches {\n                          label\n                          id\n                          img\n                          document_type\n                          document_classification\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      "},globalFilter:{queryName:"globalFilter",queryBody:"{\n        globalFilter(__PARAMS__){\n          entitiesData {\n            entity {\n                id\n                label\n                typeOfEntity\n            } count\n          }\n          typeOfEntityData {\n            type\n            count\n          }\n          itemsPagination {\n            totalCount\n            items {\n              thumbnail\n              item {\n                id\n                label\n                fields\n                {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                }\n                breadcrumbs {\n                  label\n                  link\n                }\n                relatedTypesOfEntity {\n                  type\n                  count\n                }\n              }\n            }\n          }\n        }\n        }"},getEntityDetails:{queryName:"getEntity",queryBody:"{\n        getEntity(__PARAMS__){\n          overviewTab\n          label\n          id\n          typeOfEntity\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on\n            KeyValueFieldGroup {\n              label\n              fields\n              {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n          extraTab\n          wikiTab {\n            text\n            url\n          }\n          relatedItems {\n            thumbnail\n            relation\n            item {\n              label\n              id\n              fields\n              {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n              breadcrumbs {\n                label\n                link\n              }\n            }\n            relatedTypesOfEntity {\n              type\n              count\n            }\n          }\n          relatedEntities {\n            entity {\n                id\n                label\n                typeOfEntity\n            }\n            count\n          }\n        }\n      }\n      "},getItem:{queryName:"getItem",queryBody:"{\n        getItem(__PARAMS__) {\n          id\n          label\n          icon\n          title\n          subTitle\n          image\n          text\n          fields {\n            ...\n            on KeyValueField {\n              key\n              value\n            }\n            ... on KeyValueFieldGroup {\n              label\n              fields {\n                ...\n                on KeyValueField {\n                  key\n                  value\n                }\n              }\n            }\n          }\n          relatedEntities {\n            count\n            entity{\n              id\n              label\n              typeOfEntity\n            }\n          }\n          relatedItems {\n            thumbnail\n            item {\n              label\n              id\n              relatedTypesOfEntity {\n                type\n                count\n              }\n            }\n          }\n          breadcrumbs {\n            label\n            link\n          }\n        }\n      }"},getNode:{queryName:"getNode",queryBody:"{\n        getNode(__PARAMS__) {\n          ... on Item {\n            id\n            label\n            title\n            subTitle\n            image\n            images\n            text\n            document_type\n            fields {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n              ... on KeyValueFieldGroup {\n                label\n                fields {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                }\n              }\n            }\n            relatedEntities {\n                count\n                entity{\n                  id\n                  label\n                  typeOfEntity\n                  relation\n                }\n            }\n            relatedItems {\n                thumbnail\n                item {\n                  label\n                  id\n                  fields {\n                    ...\n                    on KeyValueField {\n                      key\n                      value\n                    }\n                    ... on KeyValueFieldGroup {\n                      label\n                      fields {\n                        ...\n                        on KeyValueField {\n                          key\n                          value\n                        }\n                      }\n                    }\n                  }\n                  relatedTypesOfEntity {\n                    type\n                    count\n                  }\n                }\n              }\n            breadcrumbs {\n              label\n              link\n            }\n          }\n          ... on Node {\n            id\n            label\n            img\n            document_type\n            fields {\n              ...\n              on KeyValueField {\n                key\n                value\n              }\n              ... on KeyValueFieldGroup {\n                label\n                fields {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                }\n              }\n            }\n          }\n        }\n      }"},autoComplete:{queryName:"autoComplete",queryBody:"{\n        autoComplete(__PARAMS__){\n          totalCount\n          results {\n            ... on EntityCountData {\n              count\n              entity {\n                id\n                label\n                typeOfEntity\n                fields {\n                  ... on KeyValueField {\n                    key\n                    value\n                  }\n                  ... on KeyValueFieldGroup {\n                    label\n                    fields {\n                      ... on KeyValueField {\n                        key\n                        value\n                      }\n                    }\n                  }\n                }\n              }\n            }\n            ... on ItemListing {\n              item {\n                id\n                label\n                document_type\n                fields {\n                  ... on KeyValueField {\n                    key\n                    value\n                  }\n                  ... on KeyValueFieldGroup {\n                    label\n                    fields {\n                      ... on KeyValueField {\n                        key\n                        value\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }"},search:{queryName:"search",queryBody:"{\n        search(__PARAMS__){\n          totalCount\n          facets {\n            id\n            type\n            operator\n            limit\n            order\n            data {\n              label\n              value\n              counter\n              searchData {\n                key\n                value\n              }\n            }\n          }\n          results {\n            order{\n              type\n              key\n              direction\n            }\n            fields\n            {\n              id\n              highlight\n              limit\n            }\n            items {\n              ... on Entity {\n                id\n                label\n                typeOfEntity\n                fields {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                  ... on KeyValueFieldGroup {\n                    label\n                    fields {\n                      ...\n                      on KeyValueField {\n                        key\n                        value\n                      }\n                    }\n                  }\n                }\n                relatedEntities {\n                    count\n                    entity{\n                      id\n                      label\n                      typeOfEntity\n                    }\n                }\n                relatedItems {\n                    thumbnail\n                    item {\n                      label\n                      id\n                      fields {\n                        ...\n                        on KeyValueField {\n                          key\n                          value\n                        }\n                        ... on KeyValueFieldGroup {\n                          label\n                          fields {\n                            ...\n                            on KeyValueField {\n                              key\n                              value\n                            }\n                          }\n                        }\n                      }\n                  }\n                  relatedTypesOfEntity {\n                    type\n                    count\n                  }\n                }\n              }\n              ... on Item {\n                id\n                label\n                icon\n                title\n                subTitle\n                image\n                text\n                relatedTypesOfEntity {\n                  type\n                  count\n                }\n                breadcrumbs {\n                  label\n                  link\n                }\n                fields {\n                  ...\n                  on KeyValueField {\n                    key\n                    value\n                  }\n                  ... on KeyValueFieldGroup {\n                    label\n                    fields {\n                      ...\n                      on KeyValueField {\n                        key\n                        value\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }"},getMissingBubble:{queryName:"getEntity",queryBody:"{\n        getEntity(__PARAMS__){\n          label\n          id\n          typeOfEntity\n        }\n      }"}},ke=[te,ie,ce,he,be,we,ve,Se],Ie=function(){function t(t,e){t.donePromise.then((function(){var t=e.get("communication"),a=t.defaultProvider;t.providers[a].config=_e,e.set("communication",t)}))}return t.decorators=[{type:e.NgModule,args:[{declarations:ke,imports:[a.CommonModule,s.RouterModule,i.DvComponentsLibModule,pt],entryComponents:ke,exports:ke}]}],t.ctorParameters=function(){return[{type:e.ApplicationInitStatus},{type:S}]},t}();var Ee=function(){function t(){}return t.decorators=[{type:e.Component,args:[{selector:"dv-data-widget-wrapper",template:"<div class=\"dv-data-widget-wrapper {{ data && data.classes || '' }}\">\n    <ng-content></ng-content>\n</div>"}]}],t.propDecorators={data:[{type:e.Input}]},t}();var Ce=function(){function t(){}return t.prototype.onClick=function(t){this.emit&&this.emit("click",t)},t.prototype.toggleDropDown=function(t){this.emit&&this.emit("toggle",t)},t.decorators=[{type:e.Component,args:[{selector:"dv-datepicker-wrapper",template:'<div *ngIf="data" class="dv-datepicker-wrapper {{ data.select.classes || \'\' }}">\n    <div class="dv-datepicker-wrapper__label" (click)="toggleDropDown(data.payload)">\n        <input type="text" [value]="data.select.label" [readOnly]="true"/>\n        <span class="{{data.select.icon}}"></span>\n    </div>\n    <div class="dv-datepicker-wrapper__dropdown" [hidden]="data.select.hidden">\n        <ul class="dv-datepicker-wrapper__dropdown-list">\n            <li class="dv-datepicker-wrapper__dropdown-list-option {{ opt.classes || \'\' }}" *ngFor="let opt of data.select.items" (click)="onClick(opt.payload)">{{opt.text}}</li>\n        </ul>\n    </div>\n    <n7-datepicker\n        [data]="data.datepicker.data"\n        [emit]="emit">\n    </n7-datepicker>\n</div>\n'}]}],t.propDecorators={data:[{type:e.Input}],emit:[{type:e.Input}]},t}();var xe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Items=[{text:"Last week",payload:"Last week"},{text:"Last month",payload:"Last month"},{text:"Last year",payload:"Last year"},{text:"Select Date",payload:"ByDate"}],e.datepickerOptions={dateFormat:"Y-m-d",mode:"range"},e.datePickerExternalData={select:{id:"dv-select",label:"Last week",items:e.Items},datepicker:{id:"datepicker",libOptions:e.datepickerOptions}},e}return m(e,t),e.prototype.onInit=function(){this.one("dv-datepicker-wrapper").update(this.datePickerExternalData)},e}(u.LayoutDataSource);var De=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){e.type,e.payload;t.dataSource.onInit()}))},e}(l.EventHandler),Pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return null},e}(l.DataSource),Oe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._datepicker=null,e}return m(e,t),e.prototype.transform=function(t){var e=this;return t?{select:{id:t.select.id,hidden:!0,icon:t.select.icon||"n7-icon-angle-down",label:t.select.label,items:t.select.items,classes:t.select.classes},datepicker:{hidden:!0,data:{id:t.datepicker.id,libOptions:t.datepicker.libOptions,getInstance:function(t){e._datepicker=t}}}}:null},e.prototype.openDatepicker=function(){var t=this;setTimeout((function(){return t._datepicker.open()})),this.output.select.hidden=!0,this.output.datepicker.hidden=!1},e.prototype.closeDatepicker=function(){var t=this;setTimeout((function(){return t._datepicker.close()})),this.output.select.hidden=!0,this.output.datepicker.hidden=!0},e.prototype.setLabel=function(t){this.output.select.label=t,this.output.datepicker.hidden=!0},e.prototype.toggleDropDown=function(){!1===this.output.select.hidden?this.output.select.hidden=!0:this.output.select.hidden=!1},e}(l.DataSource);var Ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(){return{containerId:"test-Chart",libOptions:{chart:{height:550,width:1500,type:"area",toolbar:{show:!0}},dataLabels:{enabled:!1},colors:["rgba(15,200,255)"],fill:{colors:["#0fc8ff"],gradient:{opacityFrom:.5,opacityTo:.1}},stroke:{curve:"straight",width:[2,1]},series:[{name:"Reddish value",data:[["2019-08-01","770.17"],["2019-08-02","645.03"],["2019-08-03","709.32"],["2019-08-04","708.11"],["2019-08-05","706.59"],["2019-08-06","607.28"],["2019-08-07","494.59"],["2019-08-08","636.81"],["2019-08-09","709.04"],["2019-08-10","717.31"],["2019-08-11","805.61"],["2019-08-12","758.60"],["2019-08-13","612.82"],["2019-08-14","608.90"],["2019-08-15","734.68"],["2019-08-16","838.54"],["2019-08-17","692.88"]]}],grid:{borderColor:"#e7e7e7",strokeDashArray:3,xaxis:{lines:{show:!0}}},markers:{size:3,hover:{size:6}},xaxis:{axisBorder:{show:!0,color:"#f4f6fc"},labels:{},type:"datetime",tickAmount:6},yaxis:[{show:!0,showAlways:!1,opposite:!1,reversed:!1,logarithmic:!1,forceNiceScale:!1,floating:!1,labels:{show:!0,minWidth:0,maxWidth:160,offsetX:0,offsetY:0,rotate:0,padding:20,style:{colors:[],fontSize:"11px",cssClass:""}},axisBorder:{show:!0,color:"#f4f6fc",offsetX:0,offsetY:0},axisTicks:{show:!1,color:"#78909C",width:6,offsetX:0,offsetY:0},title:{text:"P Totale °C",rotate:90,offsetY:0,offsetX:0,style:{fontSize:"11px",cssClass:""}},tooltip:{enabled:!1,offsetX:0},crosshairs:{show:!0,position:"front",stroke:{color:"#b6b6b6",width:1,dashArray:0}}}],legend:{show:!0},tooltip:{},annotations:{yaxis:[],xaxis:[],points:[]}}}},e}(l.DataSource),Te=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(){return{title:{main:{text:"Dipendenti",classes:"n7-main-widget-title"},secondary:{text:"Dipendeti al 10/10/10",classes:"n7-secondary-widget-title"}}}},e}(l.DataSource),Le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(){return i.DATA_WIDGET_MOCK},e}(l.DataSource),Fe=Object.freeze({__proto__:null,DvDataWidgetDS:Pe,DvDatepickerWrapperDS:Oe,DvGraphDS:Ae,DvInnerTitleDS:Te,DvWidgetDS:Le}),He=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"dv-datepicker-wrapper.click":t.dataSource.setLabel(n),"ByDate"===n?t.dataSource.openDatepicker():t.dataSource.closeDatepicker();break;case"dv-datepicker-wrapper.toggle":t.dataSource.toggleDropDown();break;case"dv-datepicker-wrapper.change":t.dataSource.setLabel(n.dateStr)}}))},e}(l.EventHandler),$e={layoutId:"dv-example-layout",widgets:[{id:"dv-inner-title",hasStaticData:!0},{id:"dv-widget",hasStaticData:!0},{id:"dv-datepicker-wrapper"},{id:"dv-graph",hasStaticData:!0}],layoutDS:xe,layoutEH:De,widgetsDataSources:Fe,widgetsEventHandlers:Object.freeze({__proto__:null,DvDatepickerWrapperEH:He}),options:{}},Me=function(t){function a(){return t.call(this,$e)||this}return m(a,t),a.prototype.initPayload=function(){return{}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"dv-example-layout",template:'<div class="dv-example-layout" id="example-layout">\n\n    \x3c!-- Data widget wrapper with not-fixed height, two rows --\x3e\n    <dv-data-widget-wrapper>\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-chart\n                    [data]="lb.widgets[\'dv-graph\'].ds.out$ | async">\n                </n7-chart>\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n\n    \x3c!-- Data widget wrapper with fixed height, two rows --\x3e\n    <dv-data-widget-wrapper [data]="{ classes: \'dv-data-widget-wrapper-fixed-height\' }">\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n            <div class="dv-data-widget-wrapper__content-row">\n                Row content\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n\n    \x3c!-- Data widget wrapper with fixed height, one row --\x3e\n    <dv-data-widget-wrapper [data]="{ classes: \'dv-data-widget-wrapper-fixed-height\' }">\n        <div class="dv-data-widget-wrapper__title">\n            <n7-inner-title\n                [data]="lb.widgets[\'dv-inner-title\'].ds.out$ | async">\n            </n7-inner-title>\n        </div>\n        <div class="dv-data-widget-wrapper__content">\n            <div class="dv-data-widget-wrapper__content-row">\n                <n7-data-widget\n                    [data]="lb.widgets[\'dv-widget\'].ds.out$ | async">\n                </n7-data-widget>\n            </div>\n        </div>\n    </dv-data-widget-wrapper>\n    \n    <dv-datepicker-wrapper \n        [data]="lb.widgets[\'dv-datepicker-wrapper\'].ds.out$ | async"\n        [emit]="lb.widgets[\'dv-datepicker-wrapper\'].emit">\n    </dv-datepicker-wrapper>\n</div>'}]}],a.ctorParameters=function(){return[]},a}(x),je=[Ee,Ce,Me],qe=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:je,imports:[a.CommonModule,i.DvComponentsLibModule,pt],providers:[],exports:je}]}],t}(),Be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.onInit=function(){this.one("mr-resources").updateOptions({source:"resources"}),this.one("mr-collections").updateOptions({source:"collections"}),this.some(["mr-resources","mr-collections"]).update({}),this.one("mr-res-header").update({title:"Le mappe",subtitle:"Una selezione di alcune mappe di Totus Mundus.",button:{text:"Visita il catalogo",link:"/catalogo"}}),this.one("mr-coll-header").update({title:"I percorsi",subtitle:"Visita il mondo di Totus Mundus con una serie di percorsi per te.",button:{text:"Visita il catalogo",link:"/catalogo"}}),this.one("mr-hero").update({text:"The Totus Mundus project presents a series of information and data about the jesuit Matteo Ricci, its life, the maps he created and the people he collaborated with",button:{title:"",text:"Cerca",anchor:{href:"/button-url",target:"_blank"}},image:"https://i.imgur.com/VHTbVbm.png"})},e}(u.LayoutDataSource),Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"mr-home-layout.init":t.dataSource.onInit(n)}}))},e}(l.EventHandler),Ne=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mock={resources:[{image:"https://i.imgur.com/8bNcgR6.png",title:"Unattributed version",text:"A japanese colored version",metadata:[{classes:"metadata",items:[{label:"Artista",value:"Massimo Berruti"},{label:"Tecnica",value:"Fotografia"},{label:"Galleria",value:"Galleria Tonelli"}]}]},{image:"https://i.imgur.com/52UFqca.png",title:"Yudi Shanhai Quantu",text:"Complete Map of all mountains and seas"},{image:"https://i.imgur.com/sLu7u2v.png",title:"Reconstruction of D'Elia's map",text:'A digital collage of the map portions from Pasquale D\'Elia "mappamondo"',metadata:[{classes:"metadata",items:[{label:"Artista",value:"Massimo Berruti"},{label:"Tecnica",value:"Fotografia"},{label:"Galleria",value:"Galleria Tonelli"}]}]},{image:"https://i.imgur.com/8bNcgR6.png",title:"Unattributed version",text:"A japanese colored version"}],collections:[{image:"https://i.imgur.com/8bNcgR6.png",title:"Unattributed version",text:"A japanese colored version"},{image:"https://i.imgur.com/52UFqca.png",title:"Yudi Shanhai Quantu",text:"Complete Map of all mountains and seas"},{image:"https://i.imgur.com/sLu7u2v.png",title:"Reconstruction of D'Elia's map",text:'A digital collage of the map portions from Pasquale D\'Elia "mappamondo"'}],search:[{image:"https://i.imgur.com/52UFqca.png",title:"Yudi Shanhai Quantu",text:"Complete Map of all mountains and seas"},{image:"https://i.imgur.com/52UFqca.png",title:"World Map based on Matteo Ricci 1850",text:"Complete Map fo all mountains and seas"},{image:"",title:"Reconstruction of D'Elia's map",text:'A digital collage of the map portions from Pasquale D\'Elia "mappamondo"'},{image:"",title:"Unattributed version",text:"A japanese colored version"},{image:"",title:"Matteo Ricci's way from Macau to Beijing",text:"A japanese colored version"},{image:"",title:"The 400-year-old map that shows China as the centre of the world",text:"A japanese colored version"},{image:"https://i.imgur.com/52UFqca.png",title:"Yudi Shanhai Quantu",text:"Complete Map of all mountains and seas"},{image:"https://i.imgur.com/52UFqca.png",title:"World Map based on Matteo Ricci 1850",text:"Complete Map fo all mountains and seas"},{image:"",title:"Reconstruction of D'Elia's map",text:'A digital collage of the map portions from Pasquale D\'Elia "mappamondo"'},{image:"",title:"Unattributed version",text:"A japanese colored version"},{image:"",title:"Matteo Ricci's way from Macau to Beijing",text:"A japanese colored version"},{image:"",title:"The 400-year-old map that shows China as the centre of the world",text:"A japanese colored version"}]},e}return m(e,t),e.prototype.transform=function(t){return this.mock[this.options.source]},e}(l.DataSource);var ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){var e=t.title,a=t.subtitle,n=t.button;return{title:{main:{text:e,classes:"bold"},secondary:{text:a,classes:"italic"}},actions:{buttons:[{text:n.text,payload:n.link,classes:"n7-btn-cta"}]}}},e}(l.DataSource),Ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),Ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.transform=function(t){return t},e}(l.DataSource),We=Object.freeze({__proto__:null,MrItemPreviewsDS:Ne,MrInnerTitleDS:ze,MrHeroDS:Ve,MrFiltersDS:Ge}),Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){},e}(l.EventHandler),Ue=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){},e}(l.EventHandler),Qe=Object.freeze({__proto__:null,MrDummyEH:Ke,MrFiltersEH:Ue}),Ye={layoutId:"mr-home-layout",widgets:[{id:"mr-resources",dataSource:Ne},{id:"mr-collections",dataSource:Ne},{id:"mr-res-header",dataSource:ze},{id:"mr-coll-header",dataSource:ze},{id:"mr-hero",dataSource:Ve}],layoutDS:Be,layoutEH:Re,widgetsDataSources:We,widgetsEventHandlers:Qe,options:{}},Xe=function(t){function a(e){return t.call(this,e.get("MrHomeLayoutConfig")||Ye)||this}return m(a,t),a.prototype.initPayload=function(){return{options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"mr-home-layout",template:'<div class="mr-home" *ngIf="lb.dataSource">\n    \x3c!-- TODO: Replace with <n7-carousel-component> --\x3e\n    <div style="\n        height: 300px;\n        border: 1px solid #dddddd;\n        line-height: 300px;\n        text-align: center;">\n        <em>n7-carousel-component</em>\n    </div>\n    \x3c!-- ========================================== --\x3e\n    <n7-inner-title [data]="lb.widgets[\'mr-res-header\'].ds.out$ | async"></n7-inner-title>\n    <n7-item-preview\n        *ngFor="let resource of (lb.widgets[\'mr-resources\'].ds.out$ | async)"\n        [data]="resource">\n    </n7-item-preview>\n    <n7-hero [data]="lb.widgets[\'mr-hero\'].ds.out$ | async">\n    </n7-hero>\n    <n7-inner-title [data]="lb.widgets[\'mr-coll-header\'].ds.out$ | async">\n    </n7-inner-title>\n    <n7-item-preview\n        *ngFor="let collection of (lb.widgets[\'mr-collections\'].ds.out$ | async)" \n        [data]="collection">\n    </n7-item-preview>\n</div>\n'}]}],a.ctorParameters=function(){return[{type:_}]},a}(x),Ze={totalCount:0,facets:[{id:"query",type:"value"},{id:"query-all",type:"value",hasStaticData:!0,data:[{value:"1",label:"Cerca in tutti campi delle schede"}]},{id:"query-links",type:"value"},{id:"entity-types",type:"value",operator:"OR",limit:10,order:"count"},{id:"entity-search",type:"value"},{id:"entity-links",type:"value",searchData:["entity-type"]}],fields:[{inputs:[{type:"text",facetId:"query",placeholder:"Cerca nei titoli delle schede",filterConfig:{delay:500,minChars:3,searchIn:[{key:"label.ngrams",operator:"LIKE"}]}},{type:"checkbox",facetId:"query-all",filterConfig:{searchIn:[{key:"label.ngrams^5,text^4,fields.*^3",operator:"="}]}},{type:"link",facetId:"query-links",filterConfig:{isArray:!0,searchIn:[{key:"source.entityType",operator:"="}]}}]},{header:{label:"Relazione con",classes:"related-class"},inputs:[{type:"checkbox",facetId:"entity-types",filterConfig:{isArray:!0,context:"internal",target:"entity-links",searchIn:[{key:"searchData.entity-type",operator:"="}]}},{type:"text",facetId:"entity-search",placeholder:"Cerca entità",filterConfig:{delay:500,minChars:3,context:"internal",target:"entity-links",searchIn:[{key:"label",operator:"LIKE"}]}},{type:"link",facetId:"entity-links",emptyState:{label:"La tua ricerca non ha dato risultati, prova a cambiare i filtri"},filterConfig:{isArray:!0,limit:20,searchIn:[{key:"relatedEntities.id",operator:"="}]}}]}],results:{order:{type:"text",key:"label_sort",direction:"ASC"},fields:[{id:"description",highlight:!0,limit:200}]},page:{offset:0,limit:10}},Je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.onInit=function(t){var e=t.search;this.search=e,this.search.model("mr-search-layout")&&this.search.remove("mr-search-layout"),this.search.add("mr-search-layout",p.cloneDeep(Ze)),this.searchModel=this.search.model("mr-search-layout"),this.one("mr-resources").updateOptions({source:"search"}),this.one("mr-resources").update({})},e}(l.LayoutDataSource);var ta=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"mr-search-layout.init":t.dataSource.onInit(n);break;default:console.warn("unhandled inner event of type",a)}}))},e}(l.EventHandler),ea={layoutId:"mr-search-layout",widgets:[{id:"facets-wrapper",dataSource:W,eventHandler:J},{id:"mr-resources",dataSource:Ne},{id:"n7-smart-pagination",dataSource:U,eventHandler:et}],layoutDS:Je,layoutEH:ta,widgetsDataSources:We,widgetsEventHandlers:Qe,layoutOptions:{}},aa=function(t){function a(e,a){var n=t.call(this,e.get("MrSearchLayoutConfig")||ea)||this;return n.search=a,n}return m(a,t),a.prototype.initPayload=function(){return{search:this.search,options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"mr-search-layout",template:'<div class="search-layout" *ngIf="lb.dataSource">\n    <div class="search-wrapper">\n        <div class="filter-section">\n            <h2>Filtra i risultati</h2>\n            <n7-facets-wrapper \n                [data]="lb.widgets[\'facets-wrapper\'].ds.out$ | async" \n                [emit]="lb.widgets[\'facets-wrapper\'].emit">\n            </n7-facets-wrapper>\n        </div>\n        <n7-item-preview \n            *ngFor="let resource of (lb.widgets[\'mr-resources\'].ds.out$ | async)" \n            [data]="resource">\n        </n7-item-preview>\n    </div>\n</div>\n'}]}],a.ctorParameters=function(){return[{type:_},{type:B}]},a}(x);var na=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.onInit=function(){},e}(l.LayoutDataSource),ia=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"mr-glossary-layout.init":t.dataSource.onInit(n);break;default:console.warn("unhandled inner event of type",a)}}))},e}(l.EventHandler),ra={layoutId:"n7-glossary-layout",widgets:[],layoutDS:na,layoutEH:ia,widgetsDataSources:We,widgetsEventHandlers:Qe,layoutOptions:{}},oa=function(t){function a(e){return t.call(this,e.get("MrGlossaryLayoutConfig")||ra)||this}return m(a,t),a.prototype.initPayload=function(){return{options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"mr-glossary-layout",template:'<div class="glossary-layout" *ngIf="lb.dataSource">\n    Hello, from Glossary layout!\n</div>\n'}]}],a.ctorParameters=function(){return[{type:_}]},a}(x),sa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.onInit=function(){},e}(l.LayoutDataSource),ca=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"mr-static-layout.init":t.dataSource.onInit(n);break;default:console.warn("unhandled inner event of type",a)}}))},e}(l.EventHandler),la={layoutId:"n7-static-layout",widgets:[],layoutDS:sa,layoutEH:ca,widgetsDataSources:We,widgetsEventHandlers:Qe,layoutOptions:{}},ua=function(t){function a(e){return t.call(this,e.get("MrStaticLayoutConfig")||la)||this}return m(a,t),a.prototype.initPayload=function(){return{options:this.config.options||{}}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"mr-static-layout",template:'<div class="static-layout" *ngIf="lb.dataSource">\n    Hello, from Static layout!\n</div>\n'}]}],a.ctorParameters=function(){return[{type:_}]},a}(x),da=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.onInit=function(t){this.data=t.data,this.initInputs()},e.prototype.onDestroy=function(){},e.prototype.initInputs=function(){var t=this;this.data.sections.forEach((function(e){e.inputs.forEach((function(e){t.getWidgetDataSource(e.id).id=e.id,t.one(e.id).update(e.data)}))}))},e}(l.LayoutDataSource);var pa=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.changed$={},e}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"mr-search-facets-layout.init":t.dataSource.onInit(n),t.initChangedListener(n.data);break;case"mr-search-facets-layout.destroy":t.dataSource.onDestroy()}})),this.outerEvents$.subscribe((function(e){var a=e.type,n=e.payload;a.indexOf("change")&&t.changed$[n.id].next(n)}))},e.prototype.initChangedListener=function(t){var e=this;t.sections.forEach((function(t){t.inputs.forEach((function(t){e.changed$[t.id]=new r.Subject,e.changed$[t.id].pipe(o.debounceTime(t.delay||1)).subscribe((function(t){console.warn("#todo",t)}))}))}))},e}(l.EventHandler);var ha={layoutId:"mr-search-facets-layout",widgets:[],layoutDS:da,layoutEH:pa,widgetsDataSources:We,widgetsEventHandlers:Qe,layoutOptions:{}},fa=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getValue=function(){return e.value},e}return m(e,t),e.prototype.transform=function(t){return t},e.prototype.setValue=function(t,e){void 0===e&&(e=!1),this.value=t,e&&this.update(b({},this.input,{value:t}))},e.prototype.clear=function(){this.value=null},e}(l.DataSource);var ga=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getValue=function(){return e.value},e}return m(e,t),e.prototype.transform=function(t){return t},e.prototype.setValue=function(t,e){if(void 0===e&&(e=!1),this.value=t,e){var a=this.input.checkboxes.map((function(e){return b({},e,{checked:-1!==t.indexOf(e.payload)})}));this.update(b({},this.input,{checkboxes:a}))}},e.prototype.clear=function(){this.value=[]},e}(l.DataSource);var ya=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getValue=function(){return e.value},e}return m(e,t),e.prototype.transform=function(t){return t},e.prototype.setValue=function(t,e){if(void 0===e&&(e=!1),this.value=t,e){var a=this.input.options.map((function(e){return b({},e,{selected:t===e.value})}));this.update(b({},this.input,{options:a}))}},e.prototype.clear=function(){this.value=null},e}(l.DataSource);var ma=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getValue=function(){return e.value},e}return m(e,t),e.prototype.transform=function(t){return t},e.prototype.setValue=function(t,e){if(void 0===e&&(e=!1),this.value=t,e){var a=this.input.links.map((function(e){return b({},e,{classes:-1!==t.indexOf(e.payload)?"is-active":""})}));this.update(b({},this.input,{links:a}))}},e.prototype.clear=function(){this.value=[]},e}(l.DataSource);var ba=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case t.dataSource.id+".change":t.emitOuter("change",b({},n,{id:t.dataSource.id}))}}))},e}(l.EventHandler),va={text:fa,checkbox:ga,select:ya,link:ma},wa=function(t){function a(){return t.call(this,ha)||this}return m(a,t),a.prototype.initPayload=function(){return{data:this.data}},a.prototype.ngOnInit=function(){this.loadWidgets(),this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.prototype.loadWidgets=function(){var t=this;this.widgets=[],this.data.sections.forEach((function(e){e.inputs.forEach((function(e){t.widgets.push({id:e.id,dataSource:va[e.type],eventHandler:ba})}))}))},a.decorators=[{type:e.Component,args:[{selector:"mr-search-facets-layout",template:'<div *ngIf="lb.dataSource.data" class="mr-search-facets {{ lb.dataSource.data.classes || \'\' }}">\n    <div *ngFor="let section of lb.dataSource.data.sections" class="mr-search-facets__section {{ section.classes || \'\' }}">\n        <n7-facet-header\n            [data]="section.header"\n        ></n7-facet-header>\n\n        <div *ngFor="let input of section.inputs" class="mr-search-facets__input {{ input.classes || \'\' }}">\n            <ng-container [ngSwitch]="input.type">\n\n                \x3c!-- INPUT TEXT --\x3e\n                <n7-input-text \n                *ngSwitchCase="\'text\'"\n                [data]="lb.widgets[input.id].ds.out$ | async"\n                [emit]="lb.widgets[input.id].emit"></n7-input-text>\n\n                \x3c!-- INPUT CHECKBOX --\x3e\n                <n7-input-checkbox \n                *ngSwitchCase="\'checkbox\'"\n                [data]="lb.widgets[input.id].ds.out$ | async"\n                [emit]="lb.widgets[input.id].emit"></n7-input-checkbox>\n                \n                \x3c!-- INPUT SELECT --\x3e\n                <n7-input-select \n                *ngSwitchCase="\'select\'"\n                [data]="lb.widgets[input.id].ds.out$ | async"\n                [emit]="lb.widgets[input.id].emit"></n7-input-select>\n                \n                \x3c!-- INPUT LINK --\x3e\n                <n7-input-link \n                *ngSwitchCase="\'link\'"\n                [data]="lb.widgets[input.id].ds.out$ | async"\n                [emit]="lb.widgets[input.id].emit"></n7-input-link>\n            \n            </ng-container>\n        </div>\n        \n    </div>\n</div>'}]}],a.ctorParameters=function(){return[]},a.propDecorators={data:[{type:e.Input}]},a}(x);var Sa={layoutId:"mr-search-test-layout",widgets:[],layoutDS:function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.onInit=function(){},e}(l.LayoutDataSource),layoutEH:function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.listen=function(){var t=this;this.innerEvents$.subscribe((function(e){var a=e.type,n=e.payload;switch(a){case"mr-search-test-layout.init":t.dataSource.onInit(n)}}))},e}(l.EventHandler),widgetsDataSources:We,widgetsEventHandlers:Qe,layoutOptions:{}},_a=function(t){function a(){var e=t.call(this,Sa)||this;return e.searchConfig={classes:"search-test-facets",sections:[{header:{text:"Sezione I",classes:"first-section"},inputs:[{id:"fullsearch",type:"text",delay:300,data:{id:"fullsearch",placeholder:"Search...",inputPayload:"key-event",enterPayload:"enter-event"}}]},{header:{text:"Sezione II",classes:"second-section"},inputs:[{id:"hasinternal",type:"checkbox",data:{checkboxes:[{id:"hasinternal",label:"Filtro interno",payload:"click"}]}},{id:"internalsearch",type:"text",delay:5e3,data:{id:"internalsearch",placeholder:"Internal...",inputPayload:"key-event",enterPayload:"enter-event"}}]}]},e}return m(a,t),a.prototype.initPayload=function(){return{}},a.prototype.ngOnInit=function(){this.onInit()},a.prototype.ngOnDestroy=function(){this.onDestroy()},a.decorators=[{type:e.Component,args:[{selector:"mr-search-test-layout",template:'<div>\n    <mr-search-facets-layout\n    [data]="searchConfig"></mr-search-facets-layout>\n</div>'}]}],a.ctorParameters=function(){return[]},a}(x);var ka=[Xe,aa,oa,ua,wa,_a],Ia=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:ka,imports:[a.CommonModule,i.DvComponentsLibModule,pt],providers:[],exports:ka}]}],t}(),Ea=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[a.CommonModule],providers:[],exports:[pt,Ie,qe,Ia]}]}],t}();t.AbstractLayout=x,t.ApolloProvider=I,t.AwAutocompleteWrapperDS=yt,t.AwAutocompleteWrapperEH=Ut,t.AwBubbleChartDS=mt,t.AwBubbleChartEH=Qt,t.AwChartTippyDS=bt,t.AwChartTippyEH=Xt,t.AwEntitaLayoutComponent=te,t.AwEntitaLayoutConfig=Jt,t.AwEntitaLayoutDS=ht,t.AwEntitaLayoutEH=ft,t.AwEntitaMetadataViewerDS=Ct,t.AwEntitaNavDS=Et,t.AwEntitaNavEH=Rt,t.AwGalleryLayoutComponent=be,t.AwGalleryLayoutConfig=me,t.AwGalleryLayoutDS=ge,t.AwGalleryLayoutEH=ye,t.AwGalleryResultsDS=Ft,t.AwGalleryResultsEH=Wt,t.AwHeroDS=vt,t.AwHeroEH=$t,t.AwHomeAutocompleteDS=It,t.AwHomeAutocompleteEH=Bt,t.AwHomeFacetsWrapperDS=_t,t.AwHomeFacetsWrapperEH=Mt,t.AwHomeHeroPatrimonioDS=St,t.AwHomeHeroPatrimonioEH=jt,t.AwHomeItemTagsWrapperDS=kt,t.AwHomeItemTagsWrapperEH=qt,t.AwHomeLayoutComponent=ie,t.AwHomeLayoutConfig=ne,t.AwHomeLayoutDS=ee,t.AwHomeLayoutEH=ae,t.AwLinkedObjectsDS=gt,t.AwLinkedObjectsEH=Kt,t.AwPatrimonioLayoutConfig=se,t.AwSchedaBreadcrumbsDS=Pt,t.AwSchedaImageDS=At,t.AwSchedaInnerTitleDS=Tt,t.AwSchedaLayoutComponent=ce,t.AwSchedaLayoutDS=re,t.AwSchedaLayoutEH=oe,t.AwSchedaMetadataDS=Ot,t.AwSchedaSidebarEH=Nt,t.AwSearchLayoutComponent=he,t.AwSearchLayoutConfig=pe,t.AwSearchLayoutDS=ue,t.AwSearchLayoutEH=de,t.AwSearchLayoutTabsDS=Lt,t.AwSearchLayoutTabsEH=Gt,t.AwSidebarHeaderDS=Dt,t.AwSidebarHeaderEH=zt,t.AwTableDS=wt,t.AwTableEH=Yt,t.AwTreeDS=xt,t.AwTreeEH=Vt,t.BreadcrumbsDS=V,t.BreadcrumbsEH=Z,t.BubbleChartWrapperComponent=we,t.ChartTippyComponent=ve,t.CommunicationService=C,t.ConfigurationService=S,t.DataWidgetWrapperComponent=Ee,t.DatepickerWrapperComponent=Ce,t.DvDataWidgetDS=Pe,t.DvDatepickerWrapperDS=Oe,t.DvDatepickerWrapperEH=He,t.DvExampleLayoutComponent=Me,t.DvExampleLayoutConfig=$e,t.DvExampleLayoutDS=xe,t.DvExampleLayoutEH=De,t.DvGraphDS=Ae,t.DvInnerTitleDS=Te,t.DvWidgetDS=Le,t.FacetInput=O,t.FacetInputCheckbox=A,t.FacetInputLink=H,t.FacetInputSelect=$,t.FacetInputText=F,t.FacetsDS=G,t.FacetsWrapperComponent=lt,t.FacetsWrapperDS=W,t.FacetsWrapperEH=J,t.FooterDS=K,t.FooterEH=tt,t.HeaderDS=N,t.HeaderEH=Y,t.JsonConfigService=P,t.LayoutsConfigurationService=_,t.MainLayoutComponent=it,t.MainLayoutConfig=nt,t.MainLayoutDS=D,t.MainLayoutEH=R,t.MainStateService=k,t.MrDummyEH=Ke,t.MrFiltersDS=Ge,t.MrFiltersEH=Ue,t.MrGlossaryLayoutComponent=oa,t.MrGlossaryLayoutConfig=ra,t.MrGlossaryLayoutDS=na,t.MrGlossaryLayoutEH=ia,t.MrHeroDS=Ve,t.MrHomeLayoutComponent=Xe,t.MrHomeLayoutConfig=Ye,t.MrHomeLayoutDS=Be,t.MrHomeLayoutEH=Re,t.MrInnerTitleDS=ze,t.MrItemPreviewsDS=Ne,t.MrSearchLayoutComponent=aa,t.MrSearchLayoutConfig=ea,t.MrSearchLayoutDS=Je,t.MrSearchLayoutEH=ta,t.MrStaticLayoutComponent=ua,t.MrStaticLayoutConfig=la,t.MrStaticLayoutDS=sa,t.MrStaticLayoutEH=ca,t.N7BoilerplateAriannaWebModule=Ie,t.N7BoilerplateCommonModule=pt,t.N7BoilerplateDataVizModule=qe,t.N7BoilerplateLibModule=Ea,t.N7BoilerplateMurucaModule=Ia,t.Page404LayoutComponent=ct,t.Page404LayoutConfig=st,t.Page404LayoutDS=rt,t.Page404LayoutEH=ot,t.RestProvider=E,t.SearchModel=q,t.SearchService=B,t.SmartBreadcrumbsComponent=Se,t.SmartPaginationComponent=ut,t.SmartPaginationDS=U,t.SmartPaginationEH=et,t.SubnavDS=z,t.SubnavEH=X,t.ɵa=it,t.ɵb=x,t.ɵba=ua,t.ɵbb=wa,t.ɵbc=_a,t.ɵc=S,t.ɵd=_,t.ɵe=k,t.ɵf=ct,t.ɵg=lt,t.ɵh=ut,t.ɵi=C,t.ɵj=I,t.ɵk=E,t.ɵl=te,t.ɵm=ie,t.ɵn=ce,t.ɵo=he,t.ɵp=B,t.ɵq=be,t.ɵr=we,t.ɵs=ve,t.ɵt=Se,t.ɵu=Ee,t.ɵv=Ce,t.ɵw=Me,t.ɵx=Xe,t.ɵy=aa,t.ɵz=oa,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=n7-frontend-boilerplate.umd.min.js.map